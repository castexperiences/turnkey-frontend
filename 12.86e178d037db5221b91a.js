(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+EnD":function(e,t,n){"use strict";n.r(t),n.d(t,"KitModule",(function(){return Dt}));var c=n("ofXK"),i=n("PCNd"),o=n("tyNb"),d=n("9TxS"),r=n("zz98"),a=n("p8L8"),s=n("7ape"),l=n("zOkP"),g=n("fXoL"),u=n("1OyB"),h=n("vuIU"),f=new g.x("WindowToken","undefined"!=typeof window&&window.document?{providedIn:"root",factory:function(){return window}}:void 0),p=n("XNiG"),m=function(){var e=function(){function e(t,n){Object(u.a)(this,e),this.document=t,this.window=n,this.copySubject=new p.a,this.copyResponse$=this.copySubject.asObservable(),this.config={}}return Object(h.a)(e,[{key:"configure",value:function(e){this.config=e}},{key:"copy",value:function(e){if(!this.isSupported||!e)return this.pushCopyResponse({isSuccess:!1,content:e});var t=this.copyFromContent(e);return this.pushCopyResponse(t?{content:e,isSuccess:t}:{isSuccess:!1,content:e})}},{key:"isTargetValid",value:function(e){if(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement){if(e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}},{key:"copyFromInputElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{this.selectTarget(e);var n=this.copyText();return this.clearSelection(t?e:void 0,this.window),n&&this.isCopySuccessInIE11()}catch(c){return!1}}},{key:"isCopySuccessInIE11",value:function(){var e=this.window.clipboardData;return!(e&&e.getData&&!e.getData("Text"))}},{key:"copyFromContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.document.body;if(this.tempTextArea&&!t.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{t.appendChild(this.tempTextArea)}catch(c){throw new Error("Container should be a Dom element")}}this.tempTextArea.value=e;var n=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.document.body;this.tempTextArea&&(e.removeChild(this.tempTextArea),this.tempTextArea=void 0)}},{key:"selectTarget",value:function(e){return e.select(),e.setSelectionRange(0,e.value.length),e.value.length}},{key:"copyText",value:function(){return this.document.execCommand("copy")}},{key:"clearSelection",value:function(e,t){var n;e&&e.focus(),null===(n=t.getSelection())||void 0===n||n.removeAllRanges()}},{key:"createTempTextArea",value:function(e,t){var n,c="rtl"===e.documentElement.getAttribute("dir");return(n=e.createElement("textarea")).style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[c?"right":"left"]="-9999px",n.style.top=(t.pageYOffset||e.documentElement.scrollTop)+"px",n.setAttribute("readonly",""),n}},{key:"pushCopyResponse",value:function(e){this.copySubject.next(e)}},{key:"pushCopyReponse",value:function(e){this.pushCopyResponse(e)}},{key:"isSupported",get:function(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.pc(c.e),g.pc(f,8))},e.\u0275prov=Object(g.Xb)({factory:function(){return new e(Object(g.pc)(c.e),Object(g.pc)(f,8))},token:e,providedIn:"root"}),e}(),b=function(){var e=function e(){Object(u.a)(this,e)};return e.\u0275mod=g.Zb({type:e}),e.\u0275inj=g.Yb({factory:function(t){return new(t||e)},imports:[[c.c]]}),e}(),v=n("5eHb"),y=n("n4kJ"),C=n("IfPz"),w=n("wOBz"),k=n("3Pt+"),S=n("1QgP"),N=n("sMau"),D=n("57tZ"),M=n("z17N"),T=n("ZtzB"),x=n("9tk/"),P=function(e,t,n,c){return new(n||(n=Promise))((function(i,o){function d(e){try{a(c.next(e))}catch(t){o(t)}}function r(e){try{a(c.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,r)}a((c=c.apply(e,t||[])).next())}))},I=function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},K=["generateCodeForm"];function z(e,t){if(1&e&&(g.fc(0),g.cc(1,"kit-and-casting-label",4),g.ec()),2&e){var n=g.wc();g.Nb(1),g.Dc("castingCode",n.data.generatedCode)("kit",n.data.generatedKit)}}function O(e,t){1&e&&(g.hc(0,"div",5),g.cc(1,"loading-ring",6),g.gc()),2&e&&(g.Nb(1),g.Dc("size",60))}function A(e,t){if(1&e){var n=g.ic();g.hc(0,"div",19),g.hc(1,"div",20),g.hc(2,"input",27),g.sc("change",(function(){return g.Pc(n),g.wc(2).resetModel()}))("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.kitType=e})),g.gc(),g.hc(3,"label",28),g.dd(4),g.gc(),g.gc(),g.gc()}if(2&e){var c=t.$implicit,i=g.wc(2);g.Nb(2),g.Dc("ngModel",i.model.kitType)("id",c.node.name)("value",c),g.Nb(1),g.Dc("for",c.node.name),g.Nb(1),g.fd(" ",c.node.name," ")}}function R(e,t){if(1&e){var n=g.ic();g.hc(0,"div",20),g.hc(1,"input",30),g.sc("change",(function(){return g.Pc(n),g.wc(3).resetModel()}))("ngModelChange",(function(e){return g.Pc(n),g.wc(3).model.castingType=e})),g.gc(),g.hc(2,"label",28),g.dd(3),g.xc(4,"titlecase"),g.gc(),g.gc()}if(2&e){var c=g.wc().$implicit,i=g.wc(2);g.Nb(1),g.Dc("ngModel",i.model.castingType)("id",c.node.name)("value",c),g.Nb(1),g.Dc("for",c.node.name),g.Nb(1),g.fd(" ",g.yc(4,5,c.node.name)," ")}}function F(e,t){if(1&e&&(g.hc(0,"div",19),g.bd(1,R,5,7,"div",29),g.gc()),2&e){var n=t.$implicit,c=g.wc(2);g.Nb(1),g.Dc("ngIf",null===n.node.id||c.model.kitType&&n.node.kitType.id===c.model.kitType.node.id)}}function E(e,t){1&e&&(g.hc(0,"p",38),g.dd(1,"Fetching..."),g.gc())}function q(e,t){1&e&&(g.hc(0,"p",39),g.dd(1,"Code is Valid"),g.gc())}function _(e,t){if(1&e){var n=g.ic();g.fc(0),g.hc(1,"div",14),g.hc(2,"label",31),g.dd(3,"Existing Kit Code"),g.gc(),g.hc(4,"input",32,33),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.existingKitCode=e}))("blur",(function(){return g.Pc(n),g.wc(2).fetchKitInfo()})),g.gc(),g.hc(6,"app-error-messages",34),g.hc(7,"app-error-message",35),g.dd(8,"Code not found"),g.gc(),g.gc(),g.bd(9,E,2,0,"p",36),g.bd(10,q,2,0,"p",37),g.gc(),g.ec()}if(2&e){var c=g.Mc(5),i=g.wc(2);g.Nb(4),g.Dc("ngModel",i.model.existingKitCode),g.Nb(2),g.Dc("field",c),g.Nb(1),g.Dc("errorType","invalid-code"),g.Nb(2),g.Dc("ngIf",i.state.fetchingKitInfo),g.Nb(1),g.Dc("ngIf",!i.state.fetchingKitInfo&&i.data.existingKit&&i.data.existingKit.valid)}}function j(e,t){if(1&e&&(g.hc(0,"option",52),g.dd(1),g.gc()),2&e){var n=t.$implicit;g.Dc("ngValue",n),g.Nb(1),g.ed(n.node.name)}}function $(e,t){if(1&e&&(g.hc(0,"option",52),g.dd(1),g.gc()),2&e){var n=t.$implicit;g.Dc("ngValue",n),g.Nb(1),g.ed(n.node.name)}}function V(e,t){if(1&e&&(g.hc(0,"option",52),g.dd(1),g.gc()),2&e){var n=t.$implicit;g.Dc("ngValue",n),g.Nb(1),g.ed(n.node.name)}}function L(e,t){if(1&e){var n=g.ic();g.hc(0,"div",14),g.hc(1,"label",57),g.dd(2,"Order Ring Size Custom"),g.gc(),g.hc(3,"select",58,55),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(4).model.orderRingSizeCustom=e})),g.hc(5,"option",43),g.dd(6,"-- Please Select --"),g.gc(),g.bd(7,V,2,2,"option",44),g.gc(),g.gc()}if(2&e){var c=g.wc(4);g.Nb(3),g.Dc("ngModel",c.model.orderRingSizeCustom),g.Nb(2),g.Dc("value",null),g.Nb(2),g.Dc("ngForOf",c.data.ringSizeCustoms)}}function Y(e,t){if(1&e){var n=g.ic();g.fc(0),g.hc(1,"div",14),g.hc(2,"label",53),g.dd(3,"Order Ring Size"),g.gc(),g.hc(4,"select",54,55),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(3).model.orderRingSize=e})),g.hc(6,"option",43),g.dd(7,"-- Please Select --"),g.gc(),g.bd(8,$,2,2,"option",44),g.gc(),g.gc(),g.bd(9,L,8,3,"div",56),g.ec()}if(2&e){var c=g.wc(3);g.Nb(4),g.Dc("ngModel",c.model.orderRingSize),g.Nb(2),g.Dc("value",null),g.Nb(2),g.Dc("ngForOf",c.data.ringSizes),g.Nb(1),g.Dc("ngIf",c.model.orderRingSize&&"custom"===c.model.orderRingSize.node.name)}}function B(e,t){if(1&e){var n=g.ic();g.hc(0,"div",59),g.hc(1,"input",60),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(3).model.preOrdered=e})),g.gc(),g.hc(2,"label",61),g.dd(3,"Pre-ordered"),g.gc(),g.gc()}if(2&e){var c=g.wc(3);g.Nb(1),g.Dc("ngModel",c.model.preOrdered)("value",c.model.preOrdered)}}function G(e,t){if(1&e){var n=g.ic();g.fc(0),g.hc(1,"div",14),g.hc(2,"label",40),g.dd(3,"Order Purchase Location"),g.gc(),g.hc(4,"select",41,42),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.purchaseSource=e})),g.hc(6,"option",43),g.dd(7,"-- Please Select --"),g.gc(),g.bd(8,j,2,2,"option",44),g.gc(),g.gc(),g.hc(9,"div",14),g.hc(10,"label",45),g.dd(11,"Order Reference"),g.gc(),g.hc(12,"input",46),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.orderReference=e})),g.gc(),g.gc(),g.hc(13,"div",14),g.hc(14,"label",47),g.dd(15,"Order Date"),g.gc(),g.hc(16,"input",48),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.orderDate=e})),g.gc(),g.cc(17,"owl-date-time",49,50),g.gc(),g.bd(19,Y,10,4,"ng-container",0),g.hc(20,"div",14),g.bd(21,B,4,2,"div",51),g.gc(),g.ec()}if(2&e){var c=g.Mc(18),i=g.wc(2);g.Nb(4),g.Dc("ngModel",i.model.purchaseSource),g.Nb(2),g.Dc("value",null),g.Nb(2),g.Dc("ngForOf",i.data.purchaseSources),g.Nb(4),g.Dc("ngModel",i.model.orderReference),g.Nb(4),g.Dc("ngModel",i.model.orderDate)("max",i.timeNow)("owlDateTimeTrigger",c)("owlDateTime",c),g.Nb(1),g.Dc("pickerType","calendar"),g.Nb(2),g.Dc("ngIf",i.model.castingType&&i.model.kitType.node.name===i.kitTypeJewelleryMaking&&i.model.castingType.node.name===i.castingTypeNone&&!i.state.generateCode),g.Nb(2),g.Dc("ngIf",!i.state.loading)}}function J(e,t){if(1&e){var n=g.ic();g.fc(0),g.hc(1,"h4"),g.dd(2,"Also Generate Casting Code?"),g.gc(),g.hc(3,"div",14),g.hc(4,"div",20),g.hc(5,"input",62),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).state.generateCode=e})),g.gc(),g.hc(6,"label",63),g.dd(7,"No"),g.gc(),g.gc(),g.hc(8,"div",20),g.hc(9,"input",64),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).state.generateCode=e})),g.gc(),g.hc(10,"label",65),g.dd(11,"Yes"),g.gc(),g.gc(),g.gc(),g.ec()}if(2&e){var c=g.wc(2);g.Nb(5),g.Dc("ngModel",c.state.generateCode)("value",!1),g.Nb(4),g.Dc("ngModel",c.state.generateCode)("value",!0)}}function U(e,t){if(1&e&&(g.hc(0,"option",52),g.dd(1),g.gc()),2&e){var n=t.$implicit;g.Dc("ngValue",n),g.Nb(1),g.ed(n.node.name)}}function X(e,t){if(1&e&&(g.hc(0,"option",52),g.dd(1),g.gc()),2&e){var n=t.$implicit;g.Dc("ngValue",n),g.Nb(1),g.ed(n.node.name)}}function H(e,t){if(1&e){var n=g.ic();g.hc(0,"div"),g.hc(1,"div",14),g.hc(2,"label",104),g.dd(3,"Ring Size Custom"),g.gc(),g.hc(4,"select",105,106),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(4).model.ringSizeCustom=e})),g.hc(6,"option",43),g.dd(7,"-- Please Select --"),g.gc(),g.bd(8,X,2,2,"option",44),g.gc(),g.gc(),g.gc()}if(2&e){var c=g.wc(4);g.Nb(4),g.Dc("ngModel",c.model.ringSizeCustom),g.Nb(2),g.Dc("value",null),g.Nb(2),g.Dc("ngForOf",c.data.ringSizeCustoms)}}function Z(e,t){if(1&e){var n=g.ic();g.fc(0),g.hc(1,"div",14),g.hc(2,"label",102),g.dd(3,"Ring Size (Optional)"),g.gc(),g.hc(4,"select",103,55),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(3).model.ringSize=e})),g.hc(6,"option",43),g.dd(7,"-- Please Select --"),g.gc(),g.bd(8,U,2,2,"option",44),g.gc(),g.gc(),g.bd(9,H,9,3,"div",0),g.ec()}if(2&e){var c=g.wc(3);g.Nb(4),g.Dc("ngModel",c.model.ringSize),g.Nb(2),g.Dc("value",null),g.Nb(2),g.Dc("ngForOf",c.data.ringSizes),g.Nb(1),g.Dc("ngIf",c.model.ringSize&&"custom"===c.model.ringSize.node.name)}}function Q(e,t){if(1&e){var n=g.ic();g.hc(0,"div",14),g.hc(1,"label",107),g.dd(2,"Casting Price Paid (\xa3)"),g.gc(),g.hc(3,"div",91),g.hc(4,"div",92),g.hc(5,"div",93),g.dd(6,"\xa3"),g.gc(),g.gc(),g.hc(7,"input",108),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(3).model.castingPricePaid=e})),g.gc(),g.gc(),g.gc()}if(2&e){var c=g.wc(3);g.Nb(7),g.Dc("ngModel",c.model.castingPricePaid)("decimalPlaces",2)}}function W(e,t){if(1&e){var n=g.ic();g.fc(0),g.bd(1,Z,10,4,"ng-container",0),g.hc(2,"div",14),g.hc(3,"label"),g.dd(4,"Finish / Plating Included"),g.gc(),g.hc(5,"div",20),g.hc(6,"input",66),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.finish=e})),g.gc(),g.hc(7,"label",67),g.dd(8,"No"),g.gc(),g.gc(),g.hc(9,"div",20),g.hc(10,"input",68),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.finish=e})),g.gc(),g.hc(11,"label",69),g.dd(12,"Yes"),g.gc(),g.gc(),g.gc(),g.hc(13,"div",14),g.hc(14,"label"),g.dd(15,"Include Chain"),g.gc(),g.hc(16,"div",20),g.hc(17,"input",70),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.chain=e})),g.gc(),g.hc(18,"label",71),g.dd(19,"No"),g.gc(),g.gc(),g.hc(20,"div",20),g.hc(21,"input",72),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.chain=e})),g.gc(),g.hc(22,"label",73),g.dd(23,"Yes"),g.gc(),g.gc(),g.gc(),g.hc(24,"div",14),g.hc(25,"label"),g.dd(26,"Engraving"),g.gc(),g.hc(27,"div",20),g.hc(28,"input",74),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.internalEngraving=e})),g.gc(),g.hc(29,"label",75),g.dd(30,"No"),g.gc(),g.gc(),g.hc(31,"div",20),g.hc(32,"input",76),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.internalEngraving=e})),g.gc(),g.hc(33,"label",77),g.dd(34,"Yes"),g.gc(),g.gc(),g.gc(),g.hc(35,"div",14),g.hc(36,"label"),g.dd(37,"Stone Setting"),g.gc(),g.hc(38,"div",20),g.hc(39,"input",78),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.stoneSetting=e})),g.gc(),g.hc(40,"label",79),g.dd(41,"No"),g.gc(),g.gc(),g.hc(42,"div",20),g.hc(43,"input",80),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.stoneSetting=e})),g.gc(),g.hc(44,"label",81),g.dd(45,"Yes"),g.gc(),g.gc(),g.gc(),g.hc(46,"div",14),g.hc(47,"label"),g.dd(48,"Free Shipping"),g.gc(),g.hc(49,"div",20),g.hc(50,"input",82),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.freeShipping=e})),g.gc(),g.hc(51,"label",83),g.dd(52,"No"),g.gc(),g.gc(),g.hc(53,"div",20),g.hc(54,"input",84),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.freeShipping=e})),g.gc(),g.hc(55,"label",85),g.dd(56,"Yes"),g.gc(),g.gc(),g.gc(),g.hc(57,"div",14),g.hc(58,"label",86),g.dd(59,"Expires At (Optional)"),g.gc(),g.hc(60,"input",87),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.expiresAt=e})),g.gc(),g.cc(61,"owl-date-time",88,89),g.gc(),g.bd(63,Q,8,2,"div",56),g.hc(64,"div",14),g.hc(65,"label",90),g.dd(66,"Discount (\xa3)"),g.gc(),g.hc(67,"div",91),g.hc(68,"div",92),g.hc(69,"div",93),g.dd(70,"\xa3"),g.gc(),g.gc(),g.hc(71,"input",94),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.discount=e})),g.gc(),g.gc(),g.gc(),g.hc(72,"div",14),g.hc(73,"label",95),g.dd(74,"Discount Description"),g.gc(),g.hc(75,"p",96),g.dd(76,"The "),g.hc(77,"b"),g.dd(78,"customer will see this"),g.gc(),g.dd(79," if they have a discount"),g.gc(),g.hc(80,"textarea",97),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.discountDescription=e})),g.gc(),g.gc(),g.hc(81,"div",14),g.hc(82,"label",98),g.dd(83,"Internal Reference"),g.gc(),g.hc(84,"textarea",99),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.reference=e})),g.gc(),g.gc(),g.hc(85,"div",14),g.hc(86,"label",100),g.dd(87,"Existing Casting Code (Optional)"),g.gc(),g.hc(88,"input",101),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc(2).model.castingCode=e})),g.gc(),g.gc(),g.ec()}if(2&e){var c=g.Mc(62),i=g.wc(2);g.Nb(1),g.Dc("ngIf",i.model.kitType.node.name===i.kitTypeJewelleryMaking),g.Nb(5),g.Dc("ngModel",i.model.finish)("value",!1),g.Nb(4),g.Dc("ngModel",i.model.finish)("value",!0),g.Nb(7),g.Dc("ngModel",i.model.chain)("value",!1),g.Nb(4),g.Dc("ngModel",i.model.chain)("value",!0),g.Nb(7),g.Dc("ngModel",i.model.internalEngraving)("value",!1),g.Nb(4),g.Dc("ngModel",i.model.internalEngraving)("value",!0),g.Nb(7),g.Dc("ngModel",i.model.stoneSetting)("value",!1),g.Nb(4),g.Dc("ngModel",i.model.stoneSetting)("value",!0),g.Nb(7),g.Dc("ngModel",i.model.freeShipping)("value",!1),g.Nb(4),g.Dc("ngModel",i.model.freeShipping)("value",!0),g.Nb(6),g.Dc("ngModel",i.model.expiresAt)("min",i.timeNow)("owlDateTimeTrigger",c)("owlDateTime",c),g.Nb(1),g.Dc("pickerType","calendar")("startAt",i.getExpiryStart()),g.Nb(2),g.Dc("ngIf",i.model.castingType&&i.model.castingType.node.name!==i.castingTypeNone),g.Nb(8),g.Dc("ngModel",i.model.discount)("decimalPlaces",2),g.Nb(9),g.Dc("ngModel",i.model.discountDescription),g.Nb(4),g.Dc("ngModel",i.model.reference),g.Nb(4),g.Dc("ngModel",i.model.castingCode)}}function ee(e,t){1&e&&(g.fc(0),g.hc(1,"h4"),g.dd(2,"Generate Another Kit"),g.gc(),g.ec())}function te(e,t){1&e&&(g.fc(0),g.dd(1," Another"),g.ec())}function ne(e,t){if(1&e&&(g.hc(0,"div"),g.bd(1,ee,3,0,"ng-container",0),g.hc(2,"button",109),g.dd(3," Generate "),g.bd(4,te,2,0,"ng-container",0),g.dd(5," Kit "),g.gc(),g.gc()),2&e){var n=g.wc(2);g.Nb(1),g.Dc("ngIf",n.data.generatedCode),g.Nb(1),g.Dc("disabled",n.state.creatingCode||n.state.generating||n.state.fetchingKitInfo),g.Nb(2),g.Dc("ngIf",n.data.generatedCode)}}function ce(e,t){if(1&e){var n=g.ic();g.hc(0,"div"),g.cc(1,"hr"),g.hc(2,"h4",110),g.dd(3,"Generated Kit"),g.gc(),g.hc(4,"h2",111,112),g.sc("click",(function(){g.Pc(n);var e=g.wc(2);return e.copyCodeToClipboard(e.data.generatedKit.regCode,"Copied the Kit registration code to clipboard!")})),g.dd(6),g.gc(),g.gc()}if(2&e){var c=g.wc(2);g.Nb(6),g.ed(c.data.generatedKit.regCode)}}function ie(e,t){if(1&e){var n=g.ic();g.hc(0,"div"),g.cc(1,"hr"),g.hc(2,"h4",110),g.dd(3,"Generated Code"),g.gc(),g.hc(4,"h2",111,112),g.sc("click",(function(){g.Pc(n);var e=g.wc(2);return e.copyCodeToClipboard(e.data.generatedCode.code,"Copied the casting code to the clipboard!")})),g.dd(6),g.gc(),g.gc()}if(2&e){var c=g.wc(2);g.Nb(6),g.ed(c.data.generatedCode.code)}}function oe(e,t){if(1&e&&(g.hc(0,"div",10),g.hc(1,"div",113),g.hc(2,"p"),g.hc(3,"strong"),g.dd(4,"Kit Details:"),g.gc(),g.cc(5,"br"),g.dd(6),g.cc(7,"br"),g.dd(8),g.xc(9,"simpleDateTime"),g.gc(),g.gc(),g.gc()),2&e){var n=g.wc(2);g.Nb(6),g.gd(" For order ref: ",n.data.generatedKit.orderReference?n.data.generatedKit.orderReference:"No ref"," (",n.data.generatedKit.purchaseSource?n.data.generatedKit.purchaseSource.name:"Unknown",")"),g.Nb(2),g.fd(" Created: ",g.yc(9,3,n.data.generatedKit.createdAt)," ")}}function de(e,t){if(1&e){var n=g.ic();g.hc(0,"div",10),g.hc(1,"div",113),g.hc(2,"button",114),g.sc("click",(function(){g.Pc(n);var e=g.wc(2);return e.printLabel(e.data.generatedKit.id)})),g.dd(3),g.gc(),g.gc(),g.gc()}if(2&e){var c=g.wc(2);g.Nb(2),g.Dc("disabled",c.state.creatingCode||c.state.generating),g.Nb(1),g.fd("",c.state.creatingCode||c.state.generating?"Please wait...":"Print Label"," ")}}function re(e,t){if(1&e){var n=g.ic();g.hc(0,"form",7,8),g.sc("submit",(function(){return g.Pc(n),g.wc().onSubmit()})),g.hc(2,"div",9),g.hc(3,"div",10),g.hc(4,"div",11),g.hc(5,"div",12),g.hc(6,"div",13),g.hc(7,"div",14),g.hc(8,"label",15),g.dd(9,"Kit Type"),g.gc(),g.bd(10,A,5,5,"div",16),g.gc(),g.hc(11,"div",14),g.hc(12,"label",17),g.dd(13,"Casting Type"),g.gc(),g.bd(14,F,2,1,"div",16),g.gc(),g.hc(15,"div",14),g.hc(16,"label",18),g.dd(17,"New or Existing?"),g.gc(),g.hc(18,"div",19),g.hc(19,"div",20),g.hc(20,"input",21),g.sc("change",(function(){return g.Pc(n),g.wc().resetModel()}))("ngModelChange",(function(e){return g.Pc(n),g.wc().model.generateNewKit=e})),g.gc(),g.hc(21,"label",22),g.dd(22," Create New Kit "),g.gc(),g.gc(),g.hc(23,"div",20),g.hc(24,"input",23),g.sc("change",(function(){return g.Pc(n),g.wc().resetModel()}))("ngModelChange",(function(e){return g.Pc(n),g.wc().model.generateNewKit=e})),g.gc(),g.hc(25,"label",24),g.dd(26," Add Casting to Existing Kit "),g.gc(),g.gc(),g.gc(),g.gc(),g.bd(27,_,11,5,"ng-container",0),g.bd(28,G,22,11,"ng-container",0),g.bd(29,J,12,4,"ng-container",0),g.bd(30,W,89,33,"ng-container",0),g.bd(31,ne,6,3,"div",0),g.hc(32,"div",10),g.hc(33,"div",25),g.bd(34,ce,7,1,"div",0),g.gc(),g.hc(35,"div",25),g.bd(36,ie,7,1,"div",0),g.gc(),g.gc(),g.bd(37,oe,10,5,"div",26),g.bd(38,de,4,2,"div",26),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.gc()}if(2&e){var c=g.Mc(1),i=g.wc();g.Nb(10),g.Dc("ngForOf",i.data.kitTypes),g.Nb(4),g.Dc("ngForOf",i.data.castingTypes),g.Nb(6),g.Dc("ngModel",i.model.generateNewKit)("value",!0),g.Nb(4),g.Dc("ngModel",i.model.generateNewKit)("value",!1),g.Nb(3),g.Dc("ngIf",!1===i.model.generateNewKit),g.Nb(1),g.Dc("ngIf",i.model.castingType||i.state.generateCode),g.Nb(1),g.Dc("ngIf",i.model.castingType&&i.model.castingType.node.name===i.castingTypeNone),g.Nb(1),g.Dc("ngIf",i.model.castingType&&i.model.castingType.node.name!==i.castingTypeNone||i.state.generateCode),g.Nb(1),g.Dc("ngIf",c.form.valid),g.Nb(3),g.Dc("ngIf",i.data.generatedKit),g.Nb(2),g.Dc("ngIf",i.data.generatedCode),g.Nb(1),g.Dc("ngIf",i.data.generatedKit),g.Nb(1),g.Dc("ngIf",i.data.generatedKit||i.data.generatedCode)}}var ae,se=function(){return function(){this.finish=!1,this.chain=!1,this.freeShipping=!1,this.internalEngraving=!1,this.castingCode="",this.stoneSetting=!1,this.preOrdered=null,this.generateNewKit=!0}}(),le=function(){function e(e,t,n,c,i,o,d){this.castingCodeService=e,this.clipBoardService=t,this.kitService=n,this.pricingAndWeightService=c,this.toastr=i,this.exportToPdfService=o,this.route=d,this.castingTypeNone="none",this.kitTypeNone="none",this.kitTypeHeirloom=l.b,this.kitTypeJewelleryMaking=l.c,this.data={castingTypes:[],kitTypes:[],ringSizes:[],ringSizeCustoms:[],purchaseSources:[],generatedCode:null,generatedKit:null,existingKit:null},this.state={generateCode:!1,loading:!0,creatingPdf:!1,creatingCode:!1,generating:!1,fetchingKitInfo:!1},this.model=new se,this.timeNow=new Date}return e.prototype.ngOnInit=function(){var e=this;this.kitService.getKitCreateParams().subscribe((function(t){e.data.kitTypes=t.data.kitTypes.edges,e.model.kitType=e.data.kitTypes[0],e.data.ringSizes=t.data.ringSizes.edges,e.data.ringSizeCustoms=t.data.ringSizeCustoms.edges,e.data.purchaseSources=t.data.purchaseSources.edges;for(var n=0,c=t.data.castingTypes.edges;n<c.length;n++)e.data.castingTypes.push(c[n]);e.data.castingTypes.push({__typename:"CastingTypeEdge",node:{__typename:"CastingType",id:null,name:e.castingTypeNone,price:null,castingPrice:null,description:null,kitType:{__typename:"KitType",id:null,name:null}}});var i=e.route.snapshot.queryParamMap.get("preOrder");i&&"true"===i&&(e.model.preOrdered=!0),e.state.loading=!1}))},e.prototype.onSubmit=function(){return P(this,void 0,void 0,(function(){var e,t,n,c,i,o=this;return I(this,(function(d){switch(d.label){case 0:if(this.data.generatedCode=null,this.state.generating=!0,this.model.orderDate)try{e=this.dateTimeISO(this.model.orderDate)}catch(r){return this.toastr.warning(this.model.orderDate+" is not a valid date. Needs to be in format: YYYY-MM-DD."),[2]}else e=null;return t=new Date,this.model.generateNewKit?(n={createdAt:t.toUTCString(),kitType:this.model.kitType.node.id,purchaseSource:this.model.purchaseSource?this.model.purchaseSource.node.id:null,orderReference:this.model.orderReference,orderRingSize:this.model.orderRingSize?this.model.orderRingSize.node.id:null,orderRingSizeCustom:this.model.orderRingSizeCustom?this.model.orderRingSizeCustom.node.id:null,orderDate:e,preOrdered:this.model.preOrdered&&!0===this.model.preOrdered?this.model.preOrdered:null},[4,this.kitService.create(n)]):[3,2];case 1:c=d.sent(),this.data.generatedKit=c.data.createKit,d.label=2;case 2:if(this.model.castingType&&this.model.castingType.node.name===this.castingTypeNone&&!this.state.generateCode)return this.resetModel(),this.state.generating=!1,[2];if(this.state.creatingCode=!0,this.model.discount||(this.model.discountDescription=null),this.model.castingType&&!this.model.castingPricePaid&&(this.model.castingPricePaid=Math.round(this.model.castingType.node.castingPrice/100)),this.model.expiresAt)try{i=this.dateTimeISO(this.model.expiresAt)}catch(r){return this.toastr.warning(this.model.expiresAt+" is not a valid date. Needs to be in format: YYYY-MM-DD."),[2]}else(i=new Date).setDate(i.getDate()+182.5),i.setHours(23,59,59,999),i=i.toISOString();return this.toastr.success("","Creating"),this.castingCodeService.create({castingType:this.model.castingType?this.model.castingType.node.id:null,ringSize:this.model.ringSize?this.model.ringSize.node.id:null,ringSizeCustom:this.model.ringSizeCustom?this.model.ringSizeCustom.node.id:null,jewelleryType:null,ringThickness:null,chainLength:null,chainType:null,earringConfig:null,freeShipping:this.model.freeShipping,chain:this.model.chain,engraving:this.model.internalEngraving,plating:this.model.finish,stoneSetting:this.model.stoneSetting,createdAt:t.toISOString(),expiresAt:i,discount:this.formatCurrency(this.model.discount),castingPricePaid:this.formatCurrency(this.model.castingPricePaid),discountDescription:this.model.discountDescription,castingCode:this.model.castingCode.toUpperCase(),reference:this.model.reference,kit:this.model.generateNewKit?this.data.generatedKit.id:"/kits/"+this.data.existingKit.id}).subscribe((function(e){o.data.generatedCode=e.data.createCastingCode,o.resetModel(),o.toastr.success("","Created"),o.state.creatingCode=!1,o.state.generating=!1}),(function(e){o.toastr.error(e,"Error, possible duplicate code"),o.state.creatingCode=!1,o.state.generating=!1})),[2]}}))}))},e.prototype.fetchKitInfo=function(){return P(this,void 0,void 0,(function(){var e;return I(this,(function(t){switch(t.label){case 0:return this.state.fetchingKitInfo=!0,this.form.controls.existingKitCode.setErrors(null),[4,this.kitService.getByCodeKitOnly(this.model.existingKitCode)];case 1:return(e=t.sent()).valid?(this.data.existingKit=e,this.form.controls.existingKitCode.setErrors(null)):this.form.controls.existingKitCode.setErrors({"invalid-code":!0}),this.state.fetchingKitInfo=!1,[2]}}))}))},e.prototype.resetModel=function(){var e=this.model.kitType,t=this.model.castingType,n=this.model.generateNewKit,c=this.model.existingKitCode;this.model=new se,this.model.kitType=e,this.model.castingType=t,this.model.generateNewKit=n,this.model.existingKitCode=c,this.model.castingType&&this.model.castingType.node.id&&this.model.castingType.node.kitType.id!==this.model.kitType.node.id&&(this.model.castingType=null),this.model.kitType.node.name===l.b&&(this.model.chain=!0);var i=this.route.snapshot.queryParamMap.get("preOrder");i&&"true"===i&&(this.model.preOrdered=!0),this.model.castingType&&(this.model.castingPricePaid=Math.round(this.model.castingType.node.castingPrice/100))},e.prototype.copyCodeToClipboard=function(e,t){void 0===t&&(t=null),this.clipBoardService.copyFromContent(e),this.toastr.success(t,"Copied!")},e.prototype.formatCurrency=function(e){return null===e?null:Math.round(100*e)},e.prototype.printLabel=function(e){return P(this,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return this.state.creatingPdf?[2]:(e=e.replace(/\D/g,""),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+e))]);case 1:return t.sent(),this.state.creatingPdf=!1,[2]}}))}))},e.prototype.getExpiryStart=function(){return(new Date).getDate()+182.5},e.prototype.dateTimeISO=function(e){return e=new Date(e),new Date(e.getTime()-6e4*e.getTimezoneOffset())},e.\u0275fac=function(t){return new(t||e)(g.bc(d.a),g.bc(m),g.bc(a.a),g.bc(r.a),g.bc(v.b),g.bc(s.a),g.bc(o.a))},e.\u0275cmp=g.Vb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&g.jd(K,!0),2&e&&g.Lc(n=g.tc())&&(t.form=n.first)},decls:4,vars:3,consts:[[4,"ngIf"],["subtitle","Generate kits and casting codes","title","Kit Generator"],["class","mt-5",4,"ngIf"],["novalidate","",3,"submit",4,"ngIf"],[3,"castingCode","kit"],[1,"mt-5"],[3,"size"],["novalidate","",3,"submit"],["generateCodeForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12","col-lg-8","col-xl-6"],[1,"card"],[1,"card-body"],[1,"form-group"],["for","kitType"],["class","cell option",4,"ngFor","ngForOf"],["for","castingType"],["for","generateNewKitTrue"],[1,"cell","option"],[1,"form-check"],["id","generateNewKitTrue","name","generateNewKit","required","","type","radio",1,"form-check-input",3,"ngModel","value","change","ngModelChange"],["for","generateNewKitTrue",1,"form-check-label"],["id","generateNewKitFalse","name","generateNewKit","required","","type","radio",1,"form-check-input",3,"ngModel","value","change","ngModelChange"],["for","generateNewKitFalse",1,"form-check-label"],[1,"col-md-6"],["class","row",4,"ngIf"],["id","kitType","name","kits","required","","type","radio",1,"form-check-input",3,"ngModel","id","value","change","ngModelChange"],[1,"form-check-label",3,"for"],["class","form-check",4,"ngIf"],["id","castingType","name","castings","required","","type","radio",1,"form-check-input",3,"ngModel","id","value","change","ngModelChange"],["for","existingKitCode"],["id","existingKitCode","name","existingKitCode","required","","type","text","placeholder","0000-0000","appShowErrorInputClass","",1,"form-control",3,"ngModel","ngModelChange","blur"],["existingKitCode","ngModel"],[1,"error-messages",3,"field"],[1,"message",3,"errorType"],["class","ml-2",4,"ngIf"],["class","ml-2 color-success",4,"ngIf"],[1,"ml-2"],[1,"ml-2","color-success"],["for","purchaseSource"],["id","purchaseSource","name","purchaseSource",1,"form-control",3,"ngModel","ngModelChange"],["purchaseSource","ngModel"],["disabled","disabled","selected","true",3,"value"],[3,"ngValue",4,"ngFor","ngForOf"],["for","orderReference"],["id","orderReference","name","orderReference","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","orderDate"],["id","orderDate","name","orderDate","placeholder","-- Please Select --",1,"form-control",3,"ngModel","max","owlDateTimeTrigger","owlDateTime","ngModelChange"],[3,"pickerType"],["dt1",""],["class","checkbox-wrapper with-label mt-2","style","margin: 0;",4,"ngIf"],[3,"ngValue"],["for","orderRingSize",1,"req"],["id","orderRingSize","name","orderRingSize",1,"form-control",3,"ngModel","ngModelChange"],["ringSize","ngModel"],["class","form-group",4,"ngIf"],["for","orderRingSizeCustom",1,"req"],["id","orderRingSizeCustom","name","orderRingSizeCustom",1,"form-control",3,"ngModel","ngModelChange"],[1,"checkbox-wrapper","with-label","mt-2",2,"margin","0"],["id","preOrdered","name","preOrdered","type","checkbox",3,"ngModel","value","ngModelChange"],["for","preOrdered"],["checked","checked","id","no_code","name","codeGen","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_code",1,"form-check-label"],["id","yes_code","name","codeGen","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_code",1,"form-check-label"],["checked","checked","id","no_finish","name","finish","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_finish",1,"form-check-label"],["id","yes_finish","name","finish","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_finish",1,"form-check-label"],["checked","checked","id","no_chain","name","chain","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_chain",1,"form-check-label"],["id","yes_chain","name","chain","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_chain",1,"form-check-label"],["checked","checked","id","no_engraving","name","engraving","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_engraving",1,"form-check-label"],["id","yes_engraving","name","engraving","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_engraving",1,"form-check-label"],["checked","checked","id","noStoneSetting","name","stoneSetting","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","noStoneSetting",1,"form-check-label"],["id","yesStoneSetting","name","stoneSetting","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yesStoneSetting",1,"form-check-label"],["checked","checked","id","noFreeShipping","name","freeShipping","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","noFreeShipping",1,"form-check-label"],["id","yesFreeShipping","name","freeShipping","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yesFreeShipping",1,"form-check-label"],["for","expires-at"],["id","expires-at","name","expires-at",1,"form-control",3,"ngModel","min","owlDateTimeTrigger","owlDateTime","ngModelChange"],[3,"pickerType","startAt"],["dt2",""],["for","discount"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["id","discount","limitDecimalPlaces","","min","0","name","discount","step",".01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","discountDescription"],[1,"mt-0","mb-0"],["id","discountDescription","maxlength","511","name","discountDescription","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","reference"],["id","reference","maxlength","255","name","reference","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","casting-code"],["id","casting-code","name","casting-code","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","ringSize",1,"req"],["id","ringSize","name","ringSize",1,"form-control",3,"ngModel","ngModelChange"],["for","ringSizeCustom",1,"req"],["id","ringSizeCustom","name","ringSizeCustom","required","",1,"form-control",3,"ngModel","ngModelChange"],["ringSizeCustom","ngModel"],["for","castingPricePaid"],["id","castingPricePaid","limitDecimalPlaces","","min","0","name","castingPricePaid","step",".01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["type","submit",1,"btn","btn-primary","expanded",3,"disabled"],[2,"text-transform","uppercase"],[2,"margin-top","0","border","2px dashed black","padding","20px","text-transform","uppercase","color","#fa6f6d",3,"click"],["generatedCode",""],[1,"col"],["type","button",1,"btn","btn-secondary","btn-sm",3,"disabled","click"]],template:function(e,t){1&e&&(g.bd(0,z,2,2,"ng-container",0),g.cc(1,"page-title",1),g.bd(2,O,2,1,"div",2),g.bd(3,re,39,15,"form",3)),2&e&&(g.Dc("ngIf",t.data.generatedKit||t.data.generatedCode),g.Nb(2),g.Dc("ngIf",t.state.loading),g.Nb(1),g.Dc("ngIf",!t.state.loading))},directives:[c.u,y.a,C.a,w.a,k.z,k.l,k.m,c.t,k.s,k.d,k.u,k.k,k.n,S.a,N.a,D.a,k.v,k.p,k.y,M.e,M.g,M.c,k.a,k.q,T.a,k.g],pipes:[c.G,x.a],styles:[""]}),e}(),ge=n("HKlZ"),ue=n("1kSV"),he=n("Xv7A"),fe=n("PxxC"),pe=n("mhvR"),me=n("r1eF"),be=n("VdD3"),ve=(ae=function(e,t){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}ae(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ye=function(e,t,n,c){return new(n||(n=Promise))((function(i,o){function d(e){try{a(c.next(e))}catch(t){o(t)}}function r(e){try{a(c.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,r)}a((c=c.apply(e,t||[])).next())}))},Ce=function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},we=["quickAddKitModal"];function ke(e,t){if(1&e&&(g.hc(0,"div",22),g.cc(1,"kit-and-casting-label",23),g.gc()),2&e){var n=t.$implicit,c=g.wc();g.Nb(1),g.Dc("castingCode",n.activeCastingCodes&&1===n.activeCastingCodes.length?n.activeCastingCodes[0].node:null)("kit",n.kit)("refill",c.refill)}}function Se(e,t){1&e&&(g.hc(0,"td"),g.hc(1,"app-loading-shimmer"),g.hc(2,"div",34),g.hc(3,"div",35),g.cc(4,"div",36),g.gc(),g.gc(),g.gc(),g.gc())}function Ne(e,t){1&e&&g.cc(0,"td")}function De(e,t){if(1&e&&(g.hc(0,"td"),g.dd(1),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(1),g.ed(n.castingCodes[0].node.code)}}function Me(e,t){if(1&e&&(g.hc(0,"td"),g.cc(1,"status-pill",37),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(1),g.Dc("content","Multiple")("pillType","warning")("tooltipText",n.castingCodes.length+" Casting Codes")}}function Te(e,t){1&e&&g.cc(0,"span",38)}function xe(e,t){if(1&e){var n=g.ic();g.fc(0),g.hc(1,"tr",25),g.hc(2,"td",26),g.dd(3),g.xc(4,"simpleDateTime"),g.gc(),g.hc(5,"td"),g.dd(6),g.gc(),g.hc(7,"td"),g.dd(8),g.gc(),g.hc(9,"td"),g.dd(10),g.gc(),g.bd(11,Se,5,0,"td",18),g.bd(12,Ne,1,0,"td",18),g.bd(13,De,2,1,"td",18),g.bd(14,Me,2,3,"td",18),g.hc(15,"td",17),g.hc(16,"div",27),g.hc(17,"div",28),g.hc(18,"button",29),g.bd(19,Te,1,0,"span",30),g.gc(),g.hc(20,"div",31),g.hc(21,"button",32),g.sc("click",(function(){g.Pc(n);var e=t.$implicit;return g.wc(2).printCode(e.kit)})),g.dd(22," Print Kit Label "),g.gc(),g.hc(23,"button",32),g.sc("click",(function(){g.Pc(n);var e=t.$implicit;return g.wc(2).printCode(e.kit,!0)})),g.dd(24," Print Refill Label "),g.gc(),g.gc(),g.gc(),g.hc(25,"button",33),g.sc("click",(function(){g.Pc(n);var e=t.$implicit;return g.wc(2).viewKit(e.kit.id)})),g.gc(),g.gc(),g.gc(),g.gc(),g.ec()}if(2&e){var c=t.$implicit,i=g.wc(2);g.Nb(3),g.ed(g.yc(4,12,c.kit.createdAt)),g.Nb(3),g.ed(c.kit.regCode),g.Nb(2),g.ed(c.kit.purchaseSource?c.kit.purchaseSource.name:""),g.Nb(2),g.ed(c.kit.orderReference),g.Nb(1),g.Dc("ngIf",i.loadingCastingCodes),g.Nb(1),g.Dc("ngIf",!i.loadingCastingCodes&&0===c.castingCodes.length),g.Nb(1),g.Dc("ngIf",!i.loadingCastingCodes&&1===c.castingCodes.length),g.Nb(1),g.Dc("ngIf",!i.loadingCastingCodes&&c.castingCodes.length>1),g.Nb(4),g.Tb("fa-print",!i.state.creatingPdf),g.Dc("disabled",i.state.creatingPdf),g.Nb(1),g.Dc("ngIf",!0===i.state.creatingPdf)}}function Pe(e,t){1&e&&(g.hc(0,"tr"),g.hc(1,"td",39),g.hc(2,"p",40),g.dd(3,"No kits found"),g.gc(),g.gc(),g.gc())}function Ie(e,t){if(1&e&&(g.hc(0,"tbody"),g.bd(1,xe,26,14,"ng-container",24),g.bd(2,Pe,4,0,"tr",18),g.gc()),2&e){var n=g.wc();g.Nb(1),g.Dc("ngForOf",n.data.kitInfos),g.Nb(1),g.Dc("ngIf",!n.data.kitInfos.length)}}function Ke(e,t){1&e&&(g.hc(0,"div",41),g.cc(1,"loading-ring",42),g.gc()),2&e&&(g.Nb(1),g.Dc("size",60))}function ze(e,t){if(1&e){var n=g.ic();g.cc(0,"modal-header",43),g.hc(1,"div",44),g.hc(2,"form",7,45),g.hc(4,"div",46),g.hc(5,"label",47),g.dd(6,"Order Reference"),g.gc(),g.hc(7,"input",48),g.sc("ngModelChange",(function(e){return g.Pc(n),g.wc().quickAdd.orderRef=e})),g.gc(),g.gc(),g.gc(),g.gc(),g.hc(8,"modal-footer",49),g.sc("modalSaved",(function(){return g.Pc(n),g.wc().requestToAddKit()})),g.gc()}if(2&e){var c=t.$implicit,i=g.Mc(3),o=g.wc();g.Dc("modal",c),g.Nb(7),g.Dc("ngModel",o.quickAdd.orderRef),g.Nb(1),g.Dc("form",i)("modal",c)("saveButtonName","Add")}}var Oe,Ae,Re,Fe=function(){return function(){this.regCode=null,this.source=null,this.reference=null}}(),Ee=function(e){function t(t,n,c,i,o,d){var r=e.call(this)||this;return r.router=t,r.kitService=n,r.castingCodeService=c,r.exportToPdfService=i,r.toastrService=o,r.modalService=d,r.data={kitInfos:[]},r.quickAdd={orderRef:null},r.model=new Fe,r.refill=!1,r.loadingCastingCodes=!0,r.currentKitSearch=null,r}return ve(t,e),t.prototype.ngOnInit=function(){return ye(this,void 0,void 0,(function(){return Ce(this,(function(e){switch(e.label){case 0:return[4,this.updateTable(null)];case 1:return e.sent(),[2]}}))}))},t.prototype.updateTable=function(e){return ye(this,void 0,void 0,(function(){var t=this;return Ce(this,(function(n){return clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(n){t.state.loading=!0,t.loadingCastingCodes=!0,t.currentKitSearch&&t.currentKitSearch.unsubscribe(),Object.keys(t.model).forEach((function(e,n){t.model[e]=t.model[e]?t.model[e]:null})),t.currentKitSearch=t.kitService.list(25,e,"DESC",t.model.regCode,t.model.source,t.model.reference).subscribe((function(e){var n=[];t.data.kitInfos=[];for(var c=0,i=e.data.kits.edges;c<i.length;c++){var o=i[c];t.data.kitInfos.push({kit:o.node,castingCodes:[],activeCastingCodes:[]});var d=o.node.id.replace(/^\D+/,"");n.push(d)}t.currentKitSearch=null,t.handlePagination(e.data.kits),0!==n.length&&t.castingCodeService.listByKitIds(n).subscribe((function(e){var n=(new Date).toISOString();if(e&&e.data&&e.data.castingCodes)for(var c=0,i=t.data.kitInfos;c<i.length;c++)for(var o=i[c],d=0,r=e.data.castingCodes.edges;d<r.length;d++){var a=r[d];a.node.kit.id===o.kit.id&&(o.castingCodes.push(a),!0!==a.node.redeemed&&n<a.node.expiresAt&&o.activeCastingCodes.push(a))}t.loadingCastingCodes=!1}))}))}),500),[2]}))}))},t.prototype.clearSearches=function(){this.model=new Fe,this.updateTable(null)},t.prototype.viewKit=function(e){this.router.navigate(["kit","view",e.replace(/\D/g,"")])},t.prototype.printCode=function(e,t){return void 0===t&&(t=!1),ye(this,void 0,void 0,(function(){var n=this;return Ce(this,(function(c){return this.state.creatingPdf||(this.refill=t,setTimeout((function(t){return ye(n,void 0,void 0,(function(){var t;return Ce(this,(function(n){switch(n.label){case 0:return t=e.id.replace(/\D/g,""),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+t))];case 1:return n.sent(),this.state.creatingPdf=!1,this.refill=!1,[2]}}))}))}),100)),[2]}))}))},t.prototype.openAddKitModal=function(){this.modalService.open(this.quickAddKitModal,{keyboard:!0,centered:!0,backdrop:"static",size:"sm"})},t.prototype.requestToAddKit=function(){return ye(this,void 0,void 0,(function(){var e=this;return Ce(this,(function(t){return this.quickAdd.orderRef||this.toastrService.warning("You must provide an order reference from WooCommerce","Warning"),this.kitService.quickAddKit(this.quickAdd.orderRef).subscribe((function(t){e.toastrService.info(t,"Info"),e.updateTable(null)})),this.quickAdd.orderRef=null,[2]}))}))},t.\u0275fac=function(e){return new(e||t)(g.bc(o.b),g.bc(a.a),g.bc(d.a),g.bc(s.a),g.bc(v.b),g.bc(ue.i))},t.\u0275cmp=g.Vb({type:t,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&g.jd(we,!0),2&e&&g.Lc(n=g.tc())&&(t.quickAddKitModal=n.first)},features:[g.Kb],decls:47,vars:7,consts:[["class","print_wrapper",4,"ngFor","ngForOf"],["subtitle","All Outstanding Kits","title","All Kits"],[1,"card","mt-5"],[1,"card-body"],[1,"row"],[1,"col"],[1,"btn","btn-primary",3,"click"],["novalidate",""],["kitsForm","ngForm"],[1,"table-responsive"],[1,"data-table"],[1,"search-head-top"],[1,"search-head"],["name","regCode",1,"form-control",3,"ngModel","keyup","ngModelChange"],["name","source",1,"form-control",3,"ngModel","keyup","ngModelChange"],["name","reference",1,"form-control",3,"ngModel","keyup","ngModelChange"],["disabled","","name","ghost",1,"form-control"],[1,"tr"],[4,"ngIf"],["class","text-center",4,"ngIf"],[3,"state","nextPage","previousPage"],["quickAddKitModal",""],[1,"print_wrapper"],[3,"castingCode","kit","refill"],[4,"ngFor","ngForOf"],[1,"nowrap"],[1,"color-muted"],[1,"btn-group"],["ngbDropdown","","placement","left auto",1,"d-inline-block"],["id","printMenu","ngbDropdownToggle","",1,"btn","icon-btn-outline","mx-1","fas",3,"disabled"],["aria-hidden","true","class","spinner-border spinner-border-sm",4,"ngIf"],["aria-labelledby","printMenu","ngbDropdownMenu",""],["ngbDropdownItem","",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","icon-btn-outline","mx-1","fas","fa-search",3,"click"],[1,"row","align-items-center"],[1,"col-6"],[1,"shimmer","py-2"],[3,"content","pillType","tooltipText"],["aria-hidden","true",1,"spinner-border","spinner-border-sm"],["colspan","6"],[1,"text-muted","text-center"],[1,"text-center"],[3,"size"],["title","Quick Add - Kit Create",3,"modal"],[1,"modal-body"],["quickAddKit","ngForm"],[1,"form-group"],["for","orderRef",1,"req"],["appShowErrorInputClass","","id","orderRef","name","orderRef","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],[3,"form","modal","saveButtonName","modalSaved"]],template:function(e,t){1&e&&(g.bd(0,ke,2,3,"div",0),g.cc(1,"page-title",1),g.hc(2,"div",2),g.hc(3,"div",3),g.hc(4,"div",4),g.hc(5,"div",5),g.hc(6,"h5"),g.dd(7,"Quick Add"),g.gc(),g.hc(8,"button",6),g.sc("click",(function(){return t.openAddKitModal()})),g.dd(9," Add a Kit "),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.hc(10,"form",7,8),g.hc(12,"div",2),g.hc(13,"div",3),g.hc(14,"div",9),g.hc(15,"table",10),g.hc(16,"thead"),g.hc(17,"tr",11),g.hc(18,"th"),g.dd(19,"Created"),g.gc(),g.hc(20,"th"),g.dd(21,"Code"),g.gc(),g.hc(22,"th"),g.dd(23,"Source"),g.gc(),g.hc(24,"th"),g.dd(25,"Reference"),g.gc(),g.hc(26,"th"),g.dd(27,"Casting Code"),g.gc(),g.cc(28,"th"),g.gc(),g.hc(29,"tr",12),g.cc(30,"th"),g.hc(31,"th"),g.hc(32,"input",13),g.sc("keyup",(function(){return t.updateTable(null)}))("ngModelChange",(function(e){return t.model.regCode=e})),g.gc(),g.gc(),g.hc(33,"th"),g.hc(34,"input",14),g.sc("keyup",(function(){return t.updateTable(null)}))("ngModelChange",(function(e){return t.model.source=e})),g.gc(),g.gc(),g.hc(35,"th"),g.hc(36,"input",15),g.sc("keyup",(function(){return t.updateTable(null)}))("ngModelChange",(function(e){return t.model.reference=e})),g.gc(),g.gc(),g.hc(37,"th"),g.cc(38,"input",16),g.gc(),g.hc(39,"th",17),g.hc(40,"button",6),g.sc("click",(function(){return t.clearSearches()})),g.dd(41,"Clear"),g.gc(),g.gc(),g.gc(),g.gc(),g.bd(42,Ie,3,2,"tbody",18),g.gc(),g.bd(43,Ke,2,1,"div",19),g.gc(),g.hc(44,"table-controls",20),g.sc("nextPage",(function(){return t.nextPage()}))("previousPage",(function(){return t.previousPage()})),g.gc(),g.gc(),g.gc(),g.gc(),g.bd(45,ze,9,5,"ng-template",null,21,g.cd)),2&e&&(g.Dc("ngForOf",t.data.kitInfos),g.Nb(32),g.Dc("ngModel",t.model.regCode),g.Nb(2),g.Dc("ngModel",t.model.source),g.Nb(2),g.Dc("ngModel",t.model.reference),g.Nb(6),g.Dc("ngIf",!t.state.loading),g.Nb(1),g.Dc("ngIf",t.state.loading),g.Nb(1),g.Dc("state",t.state))},directives:[c.t,y.a,k.z,k.l,k.m,k.d,k.k,k.n,c.u,he.a,C.a,ue.c,ue.h,ue.f,ue.e,fe.a,pe.a,w.a,me.a,S.a,k.u,be.a],pipes:[x.a],styles:[""]}),t}(ge.a),qe=n("1uah"),_e=n("aLF9"),je=n("ALmS"),$e=Object(je.gql)(Oe||(Ae=["\n    query submissionsByKit($kit: String!) {\n        submissions(\n            first: 999,\n            kit: $kit\n        ) {\n            edges  {\n                node {\n                    id\n                    castingCode\n                    submittedAt\n                    jewelleryType {\n                        id\n                        name\n                    }\n                    status {\n                        id\n                        name\n                    }\n                    customer {\n                        id\n                        fullName\n                    }\n                }\n            }\n        }\n    }\n"],Re=["\n    query submissionsByKit($kit: String!) {\n        submissions(\n            first: 999,\n            kit: $kit\n        ) {\n            edges  {\n                node {\n                    id\n                    castingCode\n                    submittedAt\n                    jewelleryType {\n                        id\n                        name\n                    }\n                    status {\n                        id\n                        name\n                    }\n                    customer {\n                        id\n                        fullName\n                    }\n                }\n            }\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(Ae,"raw",{value:Re}):Ae.raw=Re,Oe=Ae)),Ve=n("/IUn"),Le=n("tk/3"),Ye=function(){function e(e,t){this.apollo=e,this.http=t}return e.prototype.listByKitId=function(e){return this.apollo.query({query:$e,variables:{kit:e}})},e.\u0275fac=function(t){return new(t||e)(g.pc(Ve.b),g.pc(Le.b))},e.\u0275prov=g.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Be=n("G0jp"),Ge=n("zVvu"),Je=n("XXSO");function Ue(e,t){if(1&e&&(g.hc(0,"div",5),g.cc(1,"kit-and-casting-label",6),g.gc()),2&e){var n=t.$implicit,c=g.wc(2);g.Nb(1),g.Dc("castingCode",n.node)("kit",n.node.kit)("useCastingCodeForId",c.data.castingCodes.length>1)}}function Xe(e,t){if(1&e&&(g.fc(0),g.bd(1,Ue,2,3,"div",4),g.ec()),2&e){var n=g.wc();g.Nb(1),g.Dc("ngForOf",n.data.castingCodes)}}function He(e,t){if(1&e&&(g.fc(0),g.hc(1,"div",5),g.cc(2,"kit-and-casting-label",7),g.gc(),g.ec()),2&e){var n=g.wc();g.Nb(2),g.Dc("castingCode",null)("kit",n.data.kit)}}function Ze(e,t){if(1&e&&(g.hc(0,"span"),g.dd(1),g.xc(2,"uppercase"),g.gc()),2&e){var n=g.wc(3);g.Nb(1),g.fd(" - ",g.yc(2,1,n.model.orderRingSizeCustom.name),"")}}function Qe(e,t){if(1&e&&(g.hc(0,"li"),g.dd(1," Ring Size: "),g.hc(2,"strong"),g.dd(3),g.xc(4,"titlecase"),g.bd(5,Ze,3,3,"span",0),g.gc(),g.gc()),2&e){var n=g.wc(2);g.Nb(3),g.ed(g.yc(4,2,n.model.orderRingSize.name)),g.Nb(2),g.Dc("ngIf",n.model.orderRingSizeCustom)}}function We(e,t){if(1&e&&(g.hc(0,"li"),g.dd(1," Ring Size: "),g.hc(2,"strong"),g.dd(3),g.xc(4,"titlecase"),g.gc(),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(3),g.ed(n.node.ringSize?n.node.ringSize.name:g.yc(4,1,""))}}function et(e,t){if(1&e&&(g.hc(0,"li"),g.dd(1," Ring Size Custom: "),g.hc(2,"strong"),g.dd(3),g.xc(4,"titlecase"),g.gc(),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(3),g.ed(n.node.ringSizeCustom?n.node.ringSize.name:g.yc(4,1,""))}}function tt(e,t){if(1&e&&(g.hc(0,"li"),g.dd(1," Redeemed At: "),g.hc(2,"strong"),g.dd(3),g.xc(4,"simpleDate"),g.gc(),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(3),g.ed(g.yc(4,1,n.node.redeemedAt))}}function nt(e,t){if(1&e&&(g.hc(0,"li"),g.dd(1,"Casting Price Paid: "),g.hc(2,"strong"),g.dd(3),g.xc(4,"currency"),g.gc(),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(3),g.ed(g.yc(4,1,n.node.castingPricePaid))}}function ct(e,t){if(1&e&&(g.hc(0,"li"),g.dd(1," Discount Description: "),g.hc(2,"strong"),g.dd(3),g.gc(),g.gc()),2&e){var n=g.wc().$implicit;g.Nb(3),g.ed(n.node.discount)}}function it(e,t){if(1&e){var n=g.ic();g.hc(0,"div",24),g.hc(1,"button",25),g.sc("click",(function(){g.Pc(n);var e=g.wc().$implicit;return g.wc(2).printKit(e.node)})),g.cc(2,"span",26),g.dd(3," Print "),g.gc(),g.gc()}}function ot(e,t){if(1&e&&(g.hc(0,"div",23),g.hc(1,"div",13),g.hc(2,"div",14),g.hc(3,"div",15),g.hc(4,"h5",16),g.dd(5),g.gc(),g.hc(6,"div",11),g.hc(7,"div",17),g.hc(8,"ul",18),g.hc(9,"li"),g.dd(10,"Jewellery Type: "),g.hc(11,"strong"),g.dd(12),g.xc(13,"titlecase"),g.gc(),g.gc(),g.hc(14,"li"),g.dd(15,"Casting Type: "),g.hc(16,"strong"),g.dd(17),g.xc(18,"titlecase"),g.gc(),g.gc(),g.bd(19,We,5,3,"li",0),g.bd(20,et,5,3,"li",0),g.hc(21,"li"),g.dd(22,"Engraving: "),g.hc(23,"strong"),g.dd(24),g.gc(),g.gc(),g.hc(25,"li"),g.dd(26,"Redeemed: "),g.hc(27,"strong"),g.dd(28),g.gc(),g.gc(),g.bd(29,tt,5,3,"li",0),g.hc(30,"li"),g.dd(31,"Expires At: "),g.hc(32,"strong"),g.dd(33),g.xc(34,"simpleDate"),g.gc(),g.gc(),g.bd(35,nt,5,3,"li",0),g.gc(),g.gc(),g.hc(36,"div",17),g.hc(37,"ul",18),g.hc(38,"li"),g.dd(39,"Reference: "),g.hc(40,"strong"),g.dd(41),g.gc(),g.gc(),g.hc(42,"li"),g.dd(43,"Stone Setting: "),g.hc(44,"strong"),g.dd(45),g.gc(),g.gc(),g.hc(46,"li"),g.dd(47,"Discount: "),g.hc(48,"strong"),g.dd(49),g.gc(),g.gc(),g.bd(50,ct,4,1,"li",0),g.hc(51,"li"),g.dd(52,"Estimated Cost: "),g.hc(53,"strong"),g.dd(54),g.xc(55,"currency"),g.gc(),g.gc(),g.gc(),g.gc(),g.bd(56,it,4,0,"div",22),g.gc(),g.gc(),g.gc(),g.gc(),g.gc()),2&e){var n=t.$implicit,c=g.wc(2);g.Nb(5),g.fd("Casting Code: ",n.node.code,""),g.Nb(7),g.ed(g.yc(13,16,n.node.jewelleryType?n.node.jewelleryType.name:"")),g.Nb(5),g.ed(g.yc(18,18,n.node.castingType?n.node.castingType.name:"")),g.Nb(2),g.Dc("ngIf",n.node.ringSize&&n.node.ringSize.name!==c.ringSizeCustom),g.Nb(1),g.Dc("ngIf",n.node.ringSize&&n.node.ringSize.name===c.ringSizeCustom),g.Nb(4),g.ed(n.node.engraving),g.Nb(4),g.ed(n.node.redeemed),g.Nb(1),g.Dc("ngIf",n.node.redeemed),g.Nb(4),g.ed(g.yc(34,20,n.node.expiresAt)),g.Nb(2),g.Dc("ngIf",n.node.castingPricePaid),g.Nb(6),g.ed(n.node.reference),g.Nb(4),g.ed(n.node.stoneSetting),g.Nb(4),g.ed(n.node.discount),g.Nb(1),g.Dc("ngIf",n.node.discount>0),g.Nb(4),g.ed(g.yc(55,22,n.node.estimatedCost)),g.Nb(2),g.Dc("ngIf",c.data.castingCodes.length>1)}}function dt(e,t){if(1&e&&(g.fc(0),g.hc(1,"tr"),g.hc(2,"th"),g.dd(3),g.xc(4,"numericId"),g.gc(),g.hc(5,"td"),g.dd(6),g.xc(7,"titlecase"),g.gc(),g.hc(8,"td"),g.dd(9),g.xc(10,"uppercase"),g.gc(),g.hc(11,"td"),g.dd(12),g.xc(13,"titlecase"),g.gc(),g.hc(14,"td",36),g.dd(15),g.xc(16,"simpleDateTime"),g.gc(),g.hc(17,"td"),g.dd(18),g.gc(),g.hc(19,"td",37),g.hc(20,"div",38),g.cc(21,"button",39),g.xc(22,"numericId"),g.gc(),g.gc(),g.gc(),g.ec()),2&e){var n=t.$implicit;g.Nb(3),g.ed(g.yc(4,7,n.node.id)),g.Nb(3),g.ed(g.yc(7,9,n.node.customer.fullName)),g.Nb(3),g.ed(g.yc(10,11,n.node.castingCode)),g.Nb(3),g.ed(g.yc(13,13,n.node.jewelleryType.name)),g.Nb(3),g.ed(g.yc(16,15,n.node.submittedAt)),g.Nb(3),g.ed(n.node.status.name),g.Nb(3),g.Dc("routerLink","/submission/view/"+g.yc(22,17,n.node.id))}}function rt(e,t){1&e&&(g.hc(0,"tr",40),g.hc(1,"td",41),g.hc(2,"p",42),g.dd(3,"No submissions yet for this kit \ud83c\udfd6"),g.gc(),g.gc(),g.gc())}function at(e,t){if(1&e&&(g.hc(0,"div",27),g.hc(1,"div",28),g.hc(2,"div",29),g.hc(3,"h5",30),g.dd(4,"Submissions"),g.gc(),g.gc(),g.gc(),g.hc(5,"div",31),g.hc(6,"div",32),g.hc(7,"table",33),g.hc(8,"thead"),g.hc(9,"tr"),g.hc(10,"th"),g.dd(11,"ID"),g.gc(),g.hc(12,"th"),g.dd(13,"Customer"),g.gc(),g.hc(14,"th"),g.dd(15,"Code"),g.gc(),g.hc(16,"th"),g.dd(17,"Type"),g.gc(),g.hc(18,"th"),g.dd(19,"Submitted"),g.gc(),g.hc(20,"th"),g.dd(21,"Status"),g.gc(),g.cc(22,"th"),g.gc(),g.gc(),g.hc(23,"tbody"),g.bd(24,dt,23,19,"ng-container",34),g.bd(25,rt,4,0,"tr",35),g.gc(),g.gc(),g.gc(),g.gc(),g.gc()),2&e){var n=g.wc(2);g.Nb(24),g.Dc("ngForOf",n.data.submissions),g.Nb(1),g.Dc("ngIf",!n.data.submissions.length)}}function st(e,t){if(1&e){var n=g.ic();g.hc(0,"div",24),g.hc(1,"button",25),g.sc("click",(function(){return g.Pc(n),g.wc(2).printKit(null)})),g.cc(2,"span",26),g.dd(3," Print "),g.gc(),g.gc()}}function lt(e,t){if(1&e&&(g.hc(0,"form",8,9),g.hc(2,"div",10),g.hc(3,"div",11),g.hc(4,"div",12),g.hc(5,"div",13),g.hc(6,"div",14),g.hc(7,"div",15),g.hc(8,"h5",16),g.dd(9,"Kit"),g.gc(),g.hc(10,"div",11),g.hc(11,"div",17),g.hc(12,"ul",18),g.hc(13,"li"),g.dd(14,"RegCod: "),g.hc(15,"strong"),g.dd(16),g.gc(),g.gc(),g.bd(17,Qe,6,4,"li",0),g.hc(18,"li"),g.dd(19,"Customer: "),g.hc(20,"strong"),g.dd(21),g.gc(),g.gc(),g.hc(22,"li"),g.dd(23,"Source: "),g.hc(24,"strong"),g.dd(25),g.xc(26,"titlecase"),g.gc(),g.gc(),g.gc(),g.gc(),g.hc(27,"div",17),g.hc(28,"ul",18),g.hc(29,"li"),g.dd(30,"Reference: "),g.hc(31,"strong"),g.dd(32),g.gc(),g.gc(),g.hc(33,"li"),g.dd(34,"Created At: "),g.hc(35,"strong"),g.dd(36),g.xc(37,"simpleDate"),g.gc(),g.gc(),g.hc(38,"li"),g.dd(39,"Order Date: "),g.hc(40,"strong"),g.dd(41),g.xc(42,"simpleDate"),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.gc(),g.bd(43,ot,57,24,"div",19),g.bd(44,at,26,2,"div",20),g.gc(),g.hc(45,"div",21),g.bd(46,st,4,0,"div",22),g.gc(),g.gc(),g.gc()),2&e){var n=g.wc();g.Nb(16),g.ed(n.model.regCode),g.Nb(1),g.Dc("ngIf",n.model.orderRingSize),g.Nb(4),g.ed(n.model.customer?n.model.customer.fullName:""),g.Nb(4),g.ed(n.model.purchaseSource?n.model.purchaseSource.name:g.yc(26,10,"")),g.Nb(7),g.ed(n.model.orderReference),g.Nb(4),g.ed(g.yc(37,12,n.model.createdAt)),g.Nb(5),g.ed(g.yc(42,14,n.model.orderDate)),g.Nb(2),g.Dc("ngForOf",n.data.castingCodes),g.Nb(1),g.Dc("ngIf",n.data.submissions),g.Nb(2),g.Dc("ngIf",n.data.castingCodes.length<2)}}function gt(e,t){1&e&&(g.hc(0,"h3"),g.dd(1,"Kit Not Found"),g.gc())}function ut(e,t){1&e&&g.cc(0,"loading-ring",43),2&e&&g.Dc("size",60)}var ht=function(){return function(){}}(),ft=function(){function e(e,t,n,c,i,o){this.route=e,this.router=t,this.kitService=n,this.castingCodeService=c,this.exportToPdfService=i,this.submissionService=o,this.state={creatingPdf:!1,found:!1,isAdmin:!1,loading:!0},this.data={id:null,kit:null,castingCodes:null,submissions:null},this.model=new ht,this.ringSizeCustom=_e.a}return e.prototype.ngOnInit=function(){var e=this;this.route.paramMap.subscribe((function(t){e.data.id=t.get("id"),Object(qe.a)(e.kitService.getById("/kits/"+e.data.id),e.castingCodeService.listByKitId("/kits/"+e.data.id),e.submissionService.listByKitId("/kits/"+e.data.id)).subscribe((function(t){var n=t[0],c=t[1],i=t[2];n.data.kit?(e.state.found=!0,e.model=JSON.parse(JSON.stringify(n.data.kit)),e.data.kit=n.data.kit,e.data.castingCodes=c.data.castingCodes.edges,e.data.submissions=i.data.submissions.edges,e.state.loading=!1):e.state.loading=!1}))}))},e.prototype.printKit=function(e){return t=this,void 0,c=function(){var t;return function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}(this,(function(n){switch(n.label){case 0:return this.state.creatingPdf?[2]:(t=this.data.kit.id.replace(/\D/g,""),e&&(t="0"+e.id.replace(/\D/g,"")),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+t))]);case 1:return n.sent(),this.state.creatingPdf=!1,[2]}}))},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{r(c.next(e))}catch(t){i(t)}}function d(e){try{r(c.throw(e))}catch(t){i(t)}}function r(t){var c;t.done?e(t.value):(c=t.value,c instanceof n?c:new n((function(e){e(c)}))).then(o,d)}r((c=c.apply(t,[])).next())}));var t,n,c},e.\u0275fac=function(t){return new(t||e)(g.bc(o.a),g.bc(o.b),g.bc(a.a),g.bc(d.a),g.bc(s.a),g.bc(Ye))},e.\u0275cmp=g.Vb({type:e,selectors:[["ng-component"]],decls:6,vars:5,consts:[[4,"ngIf"],["subtitle","View Kit Details","title","Kit Info"],["novalidate","",4,"ngIf"],[3,"size",4,"ngIf"],["class","print_wrapper",4,"ngFor","ngForOf"],[1,"print_wrapper"],[3,"castingCode","kit","useCastingCodeForId"],[3,"castingCode","kit"],["novalidate",""],["viewKitForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"inner-section"],[1,"card-title"],[1,"col-sm-6"],[1,"card-details"],["class","col-md-12 mt-3",4,"ngFor","ngForOf"],["class","col Section mb-5",4,"ngIf"],[1,"row","mt-3"],["class","col-12 tc",4,"ngIf"],[1,"col-md-12","mt-3"],[1,"col-12","tc"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-print"],[1,"col","Section","mb-5"],[1,"row","py-3","box-divider-bottom","justify-content-start"],[1,"col"],[1,"mb-2"],[1,"row","mb-4"],[1,"table-responsive"],[1,"data-table"],[4,"ngFor","ngForOf"],["style","border-bottom: none;",4,"ngIf"],[1,"text-muted"],[1,"tr"],[1,"btn-group"],["type","button",1,"btn","icon-btn-outline","mx-1","fas","fa-search",3,"routerLink"],[2,"border-bottom","none"],["colspan","68"],[1,"text-muted","text-center"],[3,"size"]],template:function(e,t){1&e&&(g.bd(0,Xe,2,1,"ng-container",0),g.bd(1,He,3,2,"ng-container",0),g.cc(2,"page-title",1),g.bd(3,lt,47,16,"form",2),g.bd(4,gt,2,0,"h3",0),g.bd(5,ut,1,1,"loading-ring",3)),2&e&&(g.Dc("ngIf",t.data.castingCodes&&t.data.castingCodes.length>0),g.Nb(1),g.Dc("ngIf",t.data.kit&&(!t.data.castingCodes||0===t.data.castingCodes.length)),g.Nb(2),g.Dc("ngIf",!t.state.loading&&t.state.found),g.Nb(1),g.Dc("ngIf",!t.state.loading&&!t.state.found),g.Nb(1),g.Dc("ngIf",t.state.loading))},directives:[c.u,y.a,c.t,C.a,k.z,k.l,k.m,o.c,w.a],pipes:[c.G,Be.a,c.I,Ge.a,Je.a,x.a],styles:[""]}),e}(),pt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function c(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(c.prototype=n.prototype,new c)}}();function mt(e,t){1&e&&(g.hc(0,"span"),g.dd(1,"Chain "),g.gc())}function bt(e,t){1&e&&(g.hc(0,"span"),g.dd(1,"Engraving "),g.gc())}function vt(e,t){1&e&&(g.hc(0,"span"),g.dd(1,"Engraving "),g.gc())}function yt(e,t){1&e&&(g.hc(0,"span"),g.dd(1,"Stone Setting "),g.gc())}function Ct(e,t){if(1&e&&(g.fc(0),g.hc(1,"tr",12),g.hc(2,"td",13),g.dd(3),g.xc(4,"simpleDate"),g.gc(),g.hc(5,"td"),g.dd(6),g.gc(),g.hc(7,"td"),g.hc(8,"a",14),g.dd(9),g.gc(),g.gc(),g.hc(10,"td"),g.dd(11),g.xc(12,"titlecase"),g.gc(),g.hc(13,"td"),g.dd(14),g.xc(15,"simpleDate"),g.gc(),g.hc(16,"td"),g.bd(17,mt,2,0,"span",8),g.bd(18,bt,2,0,"span",8),g.bd(19,vt,2,0,"span",8),g.bd(20,yt,2,0,"span",8),g.gc(),g.hc(21,"td"),g.dd(22),g.gc(),g.hc(23,"td"),g.dd(24),g.gc(),g.gc(),g.ec()),2&e){var n=t.$implicit;g.Nb(3),g.ed(g.yc(4,12,n.node.createdAt)),g.Nb(3),g.ed(n.node.code),g.Nb(2),g.Dc("href","mailto:"+n.node.senderEmail,g.Sc),g.Nb(1),g.ed(n.node.senderEmail),g.Nb(2),g.ed(g.yc(12,14,n.node.castingType.name)),g.Nb(3),g.ed(g.yc(15,16,n.node.expiresAt)),g.Nb(3),g.Dc("ngIf",n.node.chain),g.Nb(1),g.Dc("ngIf",n.node.plating),g.Nb(1),g.Dc("ngIf",n.node.engraving),g.Nb(1),g.Dc("ngIf",n.node.stoneSetting),g.Nb(2),g.ed(n.node.redeemed?"Yes":"No"),g.Nb(2),g.ed(n.node.uuid)}}function wt(e,t){if(1&e&&(g.hc(0,"tbody"),g.bd(1,Ct,25,18,"ng-container",11),g.gc()),2&e){var n=g.wc();g.Nb(1),g.Dc("ngForOf",n.data.vouchers)}}function kt(e,t){1&e&&(g.hc(0,"div",15),g.cc(1,"loading-ring",16),g.gc()),2&e&&(g.Nb(1),g.Dc("size",60))}var St=[{path:"generate",component:le},{path:"list",component:Ee},{path:"view/:id",component:ft},{path:"vouchers",component:function(e){function t(t){var n=e.call(this)||this;return n.castingCodeService=t,n.data={vouchers:[]},n}return pt(t,e),t.prototype.ngOnInit=function(){return e=this,void 0,n=function(){return function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}(this,(function(e){return this.updateTable(null),[2]}))},new((t=void 0)||(t=Promise))((function(c,i){function o(e){try{r(n.next(e))}catch(t){i(t)}}function d(e){try{r(n.throw(e))}catch(t){i(t)}}function r(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,d)}r((n=n.apply(e,[])).next())}));var e,t,n},t.prototype.updateTable=function(e){var t=this;this.castingCodeService.listVouchers(e).subscribe((function(e){t.data.vouchers=e.data.castingCodes.edges,t.handlePagination(e.data.castingCodes),t.state.loading=!1}))},t.\u0275fac=function(e){return new(e||t)(g.bc(d.a))},t.\u0275cmp=g.Vb({type:t,selectors:[["ng-component"]],features:[g.Kb],decls:28,vars:3,consts:[["subtitle","All Vouchers","title","All Vouchers"],["novalidate",""],["voucherForm","ngForm"],[1,"card","mt-5"],[1,"card-body"],[1,"table-responsive"],[1,"data-table"],[1,"search-head-top"],[4,"ngIf"],["class","text-center",4,"ngIf"],[3,"state","nextPage","previousPage"],[4,"ngFor","ngForOf"],[1,"nowrap"],[1,"color-muted"],[3,"href"],[1,"text-center"],[3,"size"]],template:function(e,t){1&e&&(g.cc(0,"page-title",0),g.hc(1,"form",1,2),g.hc(3,"div",3),g.hc(4,"div",4),g.hc(5,"div",5),g.hc(6,"table",6),g.hc(7,"thead"),g.hc(8,"tr",7),g.hc(9,"th"),g.dd(10,"Created"),g.gc(),g.hc(11,"th"),g.dd(12,"Code"),g.gc(),g.hc(13,"th"),g.dd(14,"Email"),g.gc(),g.hc(15,"th"),g.dd(16,"Type"),g.gc(),g.hc(17,"th"),g.dd(18,"Expires"),g.gc(),g.hc(19,"th"),g.dd(20,"Extras"),g.gc(),g.hc(21,"th"),g.dd(22,"Redeemed"),g.gc(),g.hc(23,"th"),g.dd(24,"UUID"),g.gc(),g.gc(),g.gc(),g.bd(25,wt,2,1,"tbody",8),g.gc(),g.bd(26,kt,2,1,"div",9),g.gc(),g.hc(27,"table-controls",10),g.sc("nextPage",(function(){return t.nextPage()}))("previousPage",(function(){return t.previousPage()})),g.gc(),g.gc(),g.gc(),g.gc()),2&e&&(g.Nb(25),g.Dc("ngIf",!t.state.loading),g.Nb(1),g.Dc("ngIf",t.state.loading),g.Nb(1),g.Dc("state",t.state))},directives:[y.a,k.z,k.l,k.m,c.u,he.a,c.t,w.a],pipes:[Be.a,c.G],styles:[""]}),t}(ge.a)}],Nt=function(){function e(){}return e.\u0275mod=g.Zb({type:e}),e.\u0275inj=g.Yb({factory:function(t){return new(t||e)},imports:[[o.f.forChild(St)],o.f]}),e}(),Dt=function(){function e(){}return e.\u0275mod=g.Zb({type:e}),e.\u0275inj=g.Yb({factory:function(t){return new(t||e)},providers:[{provide:M.a,useValue:"gb"}],imports:[[b,c.c,k.f,Nt,M.f,M.j,i.a,ue.g]]}),e}()}}]);