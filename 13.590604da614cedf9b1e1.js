(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{G81l:function(t,e,n){"use strict";n.r(e),n.d(e,"ManufacturingModule",(function(){return wo}));var c,i,o,a,s,d,l,r,u,g=n("ofXK"),h=n("3Pt+"),b=n("PCNd"),m=n("tyNb"),p=n("HKlZ"),f=n("QVjv"),v=n("i7jn"),S=n("w44T"),y=n("UYTu"),C=Object(y.a)(c||(r=["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],u=["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(r,"raw",{value:u}):r.raw=u,c=r)),I=n("fXoL"),N=n("/IUn"),w="Plating",j="Engraving",A="Jump Ring",x="Earring Posts",D="Stone Setting",M="Resizing",P="Repairing",T="Hallmarking",B=function(){function t(t){this.apollo=t}return t.prototype.list=function(){return this.apollo.watchQuery({query:C}).valueChanges},t.\u0275fac=function(e){return new(e||t)(I.pc(N.b))},t.\u0275prov=I.Xb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),k=n("5Ndf"),O=n("BaBC"),E=Object(y.a)(i||(i=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            supplierAction {\n                id\n            }\n        }\n    }\n'],['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            supplierAction {\n                id\n            }\n        }\n    }\n']))),R=n("EY2u"),J=Object(y.a)(o||(o=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"],["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"]))),F=function(){function t(t){this.apollo=t}return t.prototype.create=function(t){return this.apollo.mutate({mutation:E,variables:t})},t.prototype.getBySupplierIds=function(t){return t.length?this.apollo.query({query:J,variables:{suppliers:t}}):R.a},t.\u0275fac=function(e){return new(e||t)(I.pc(N.b))},t.\u0275prov=I.Xb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),_=n("1uah"),z=n("CIHE"),Q=n("Nlbt"),H=n("uA1o"),L=n("S6Vu"),$=n("bCT2"),W=n("KPdS"),G=n("PC64"),q=n("Vf4f"),U=n("PTlN"),Y=n("1kSV"),V=n("5eHb"),X=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),K=function(t,e,n,c){return new(n||(n=Promise))((function(i,o){function a(t){try{d(c.next(t))}catch(e){o(e)}}function s(t){try{d(c.throw(t))}catch(e){o(e)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}d((c=c.apply(t,e||[])).next())}))},Z=function(t,e){var n,c,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,c=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},tt=["searchComponent"];function et(t,e){1&t&&(I.hc(0,"button",34),I.ed(1,"Action"),I.gc())}function nt(t,e){if(1&t){var n=I.ic();I.hc(0,"button",36),I.sc("click",(function(){I.Qc(n);var t=I.wc(2),e=I.Nc(64);return t.openModalWithSelected(e)})),I.ed(1," Send to Outworker "),I.gc()}}function ct(t,e){if(1&t){var n=I.ic();I.hc(0,"button",36),I.sc("click",(function(){I.Qc(n);var t=I.wc(2),e=I.Nc(66);return t.openModalWithSelected(e)})),I.ed(1," Complete Action "),I.gc()}}function it(t,e){if(1&t){var n=I.ic();I.hc(0,"button",36),I.sc("click",(function(){I.Qc(n);var t=I.wc(2),e=I.Nc(72);return t.openModalWithSelected(e)})),I.ed(1," Put Items on Hold "),I.gc()}}function ot(t,e){if(1&t){var n=I.ic();I.hc(0,"button",36),I.sc("click",(function(){I.Qc(n);var t=I.wc(2),e=I.Nc(74);return t.openModalWithSelected(e)})),I.ed(1," Take Items off Hold "),I.gc()}}function at(t,e){if(1&t){var n=I.ic();I.fc(0),I.hc(1,"button",36),I.sc("click",(function(){I.Qc(n);var t=I.wc(2),e=I.Nc(68);return t.prepareOutgoingBatch(e)})),I.ed(2," Create Outgoing Batch "),I.gc(),I.hc(3,"button",36),I.sc("click",(function(){I.Qc(n);var t=I.wc(2),e=I.Nc(70);return t.modalService.open(e)})),I.ed(4," Add To Outgoing Batch "),I.gc(),I.ec()}}function st(t,e){if(1&t&&(I.fc(0),I.cd(1,nt,2,0,"button",35),I.cd(2,ct,2,0,"button",35),I.cd(3,it,2,0,"button",35),I.cd(4,ot,2,0,"button",35),I.cd(5,at,5,0,"ng-container",13),I.ec()),2&t){var n=I.wc();I.Nb(1),I.Dc("ngIf",n.availableActions.sendToOutworker),I.Nb(1),I.Dc("ngIf",n.availableActions.completeAction),I.Nb(1),I.Dc("ngIf",n.availableActions.putItemsOnHold),I.Nb(1),I.Dc("ngIf",n.availableActions.takeItemsOffHold),I.Nb(1),I.Dc("ngIf",n.availableActions.addToOutgoingBatch)}}function dt(t,e){1&t&&(I.hc(0,"button",37),I.ed(1," Loading Actions... "),I.gc())}function lt(t,e){if(1&t){var n=I.ic();I.hc(0,"div",38),I.hc(1,"input",39),I.sc("click",(function(){return I.Qc(n),I.wc().selectAll()}))("ngModelChange",(function(t){return I.Qc(n),I.wc().state.allSelected=t})),I.gc(),I.cc(2,"label",40),I.gc()}if(2&t){var c=I.wc();I.Nb(1),I.Dc("ngModel",c.state.allSelected)("value",c.state.allSelected)}}function rt(t,e){1&t&&(I.fc(0),I.cc(1,"loading-ring",41),I.hc(2,"p"),I.ed(3,"Loading jobs..."),I.gc(),I.ec())}function ut(t,e){if(1&t&&(I.hc(0,"span",63),I.ed(1),I.xc(2,"numericId"),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.fd(I.yc(2,1,n.job.node.outgoingBatch.id))}}function gt(t,e){1&t&&I.cc(0,"i",64)}function ht(t,e){1&t&&I.cc(0,"i",65)}function bt(t,e){if(1&t&&(I.hc(0,"span",66),I.ed(1),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.gd(" Kit - ",n.job.node.submission.castingCode," ")}}var mt=function(){return[20]};function pt(t,e){if(1&t&&(I.hc(0,"span",66),I.ed(1),I.xc(2,"truncate"),I.gc()),2&t){var n=I.wc().$implicit,c=I.wc(2);I.Nb(1),I.hd(" ",n.job.node.submission.customer.event.eventType.name===c.eventTypeWedding?"Wedding":"Event"," - ",I.zc(2,2,n.job.node.submission.customer.event.name,I.Hc(5,mt))," ")}}function ft(t,e){1&t&&(I.hc(0,"span",67),I.ed(1," Wedding "),I.gc())}var vt=function(){return{addSuffix:!0,unit:"day"}},St=function(){return{addSuffix:!1,unit:"day"}};function yt(t,e){if(1&t&&(I.hc(0,"span",68),I.xc(1,"dfnsIsFuture"),I.xc(2,"dfnsIsPast"),I.xc(3,"dfnsIsPast"),I.ed(4),I.xc(5,"dfnsIsFuture"),I.xc(6,"dfnsFormatDistanceToNowStrict"),I.xc(7,"dfnsFormatDistanceToNowStrict"),I.gc()),2&t){var n=I.wc().$implicit;I.Tb("text-muted",I.yc(1,7,n.jobDueDate))("text-danger",I.yc(2,9,n.jobDueDate))("font-weight-bold",I.yc(3,11,n.jobDueDate)),I.Nb(4),I.gd(" ",I.yc(5,13,n.jobDueDate)?"Due "+I.zc(6,15,n.jobDueDate,I.Hc(21,vt)):I.zc(7,18,n.jobDueDate,I.Hc(22,St))+" late"," ")}}function Ct(t,e){1&t&&(I.hc(0,"span",69),I.ed(1,"On Hold"),I.gc())}function It(t,e){1&t&&(I.hc(0,"span",72),I.ed(1,"HD"),I.gc())}function Nt(t,e){if(1&t&&(I.hc(0,"div",70),I.cd(1,It,2,0,"span",71),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.Dc("ngIf",n.job.node.submission.hardDeadline)}}function wt(t,e){if(1&t&&(I.fc(0),I.cc(1,"li",75),I.ec()),2&t){var n=e.$implicit;I.Nb(1),I.Tb("complete",n.node.completed),I.Dc("ngbTooltip",n.node.action.name)("placement","top")}}function jt(t,e){if(1&t&&(I.hc(0,"ul",73),I.cd(1,wt,2,4,"ng-container",74),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.Dc("ngForOf",n.jobActionObj)}}function At(t,e){1&t&&(I.hc(0,"app-loading-shimmer"),I.hc(1,"div",76),I.hc(2,"div",77),I.cc(3,"div",78),I.gc(),I.hc(4,"div",77),I.cc(5,"div",78),I.gc(),I.hc(6,"div",77),I.cc(7,"div",78),I.gc(),I.hc(8,"div",77),I.cc(9,"div",78),I.gc(),I.gc(),I.gc())}function xt(t,e){if(1&t){var n=I.ic();I.fc(0,43),I.hc(1,"tr"),I.hc(2,"th",44),I.hc(3,"div",38),I.hc(4,"input",45),I.sc("click",(function(){I.Qc(n);var t=e.$implicit;return I.wc(2).selectRow(t)}))("ngModelChange",(function(t){return I.Qc(n),e.$implicit.selected=t})),I.xc(5,"numericId"),I.gc(),I.cc(6,"label",46),I.xc(7,"numericId"),I.gc(),I.gc(),I.hc(8,"td",47),I.ed(9),I.xc(10,"numericId"),I.gc(),I.hc(11,"td",47),I.cd(12,ut,3,3,"span",48),I.gc(),I.hc(13,"td",47),I.ed(14),I.cd(15,gt,1,0,"i",49),I.cd(16,ht,1,0,"i",50),I.cd(17,bt,2,1,"span",51),I.cd(18,pt,3,6,"span",51),I.gc(),I.hc(19,"td",47),I.ed(20),I.xc(21,"titlecase"),I.gc(),I.hc(22,"td",47),I.cd(23,ft,2,0,"span",52),I.gc(),I.hc(24,"td",47),I.hc(25,"div",53),I.hc(26,"div"),I.ed(27),I.xc(28,"simpleDate"),I.cd(29,yt,8,23,"span",54),I.cd(30,Ct,2,0,"span",55),I.gc(),I.cd(31,Nt,2,1,"div",56),I.gc(),I.gc(),I.hc(32,"td",47),I.hc(33,"span"),I.xc(34,"lowercaseDashes"),I.ed(35),I.xc(36,"titlecase"),I.gc(),I.gc(),I.hc(37,"td",47),I.cd(38,jt,2,1,"ul",57),I.cd(39,At,10,0,"app-loading-shimmer",13),I.gc(),I.hc(40,"td",47),I.hc(41,"div",58),I.hc(42,"button",59),I.sc("click",(function(){I.Qc(n);var t=e.$implicit;return I.wc(2).openJobSidebar(t)})),I.hc(43,"span"),I.ed(44,"Tasks"),I.gc(),I.gc(),I.cc(45,"view-submission-photos-modal",60),I.cc(46,"view-submission-comms-modal",61),I.cc(47,"view-submission-modal",62),I.gc(),I.gc(),I.gc(),I.ec()}if(2&t){var c=e.$implicit,i=I.wc(2);I.Nb(4),I.Fc("id","job-",I.yc(5,35,c.job.node.id),""),I.Dc("ngModel",c.selected)("name","job-"+c.job.node.id),I.Nb(2),I.Fc("for","job-",I.yc(7,37,c.job.node.id),""),I.Nb(3),I.gd(" #",I.yc(10,39,c.job.node.id)," "),I.Nb(3),I.Dc("ngIf",c.job.node.outgoingBatch),I.Nb(2),I.gd(" ",c.job.node.submission.customer.fullName," "),I.Nb(1),I.Dc("ngIf",null==c.job.node.submission||null==c.job.node.submission.kit?null:c.job.node.submission.kit.starred),I.Nb(1),I.Dc("ngIf",c.job.node.rush),I.Nb(1),I.Dc("ngIf",c.job.node.submission.castingCode),I.Nb(1),I.Dc("ngIf",c.job.node.submission.customer.event),I.Nb(2),I.gd(" ",I.yc(21,41,null==c.job.node.submission?null:c.job.node.submission.jewelleryType.name)," "),I.Nb(3),I.Dc("ngIf",(null==c.job.node.submission.customer||null==c.job.node.submission.customer.event?null:c.job.node.submission.customer.event.eventType.name)===i.eventTypeWedding),I.Nb(4),I.gd(" ",I.yc(28,43,c.job.node.due)," "),I.Nb(2),I.Dc("ngIf",!c.job.node.onHold),I.Nb(1),I.Dc("ngIf",c.job.node.onHold),I.Nb(1),I.Dc("ngIf",null==c.job.node.submission?null:c.job.node.submission.hardDeadline),I.Nb(2),I.Qb("metal-color color-",I.yc(34,45,c.job.node.submission.baseMetal.name),""),I.Nb(2),I.gd(" ",I.yc(36,47,c.job.node.submission.baseMetal.name)," "),I.Nb(3),I.Dc("ngIf",!c.loadingJobActions),I.Nb(1),I.Dc("ngIf",c.loadingJobActions),I.Nb(6),I.Dc("photos",c.job.node.submission.submissionPhotos.edges),I.Nb(1),I.Dc("customerNote",c.job.node.submission.customerNotes)("isAdmin",i.isAdmin)("hover",!c.job.node.submission.customerNotes&&!c.notes)("loadingNotes",i.loadingNotes)("notes",c.notes)("submissionId",c.job.node.submission.id),I.Nb(1),I.Dc("buttonStyle",!0)("isAdmin",i.isAdmin)("loadingStones",i.loadingStones)("stones",c.stones)("submission",c.job.node.submission)}}function Dt(t,e){if(1&t&&(I.fc(0),I.cd(1,xt,48,49,"ng-container",42),I.ec()),2&t){var n=I.wc();I.Nb(1),I.Dc("ngForOf",n.data.jobsAndJobActions)}}function Mt(t,e){if(1&t&&(I.hc(0,"ng-option",89),I.ed(1),I.xc(2,"titlecase"),I.gc()),2&t){var n=e.$implicit;I.Dc("value",n),I.Nb(1),I.gd("",I.yc(2,2,n.supplier.node.company)," ")}}function Pt(t,e){if(1&t){var n=I.ic();I.hc(0,"div",93),I.hc(1,"label",94),I.hc(2,"input",95),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(3).model.selectedOutworkerAction=t})),I.gc(),I.ed(3),I.gc(),I.gc()}if(2&t){var c=e.$implicit,i=I.wc(3);I.Nb(1),I.Tb("active",i.model.selectedOutworkerAction===c),I.Nb(1),I.Dc("ngModel",i.model.selectedOutworkerAction)("value",c),I.Nb(1),I.gd("",c.node.action.name," ")}}function Tt(t,e){if(1&t&&(I.hc(0,"div",82),I.hc(1,"label",90),I.ed(2,"What Action"),I.gc(),I.hc(3,"div",91),I.cd(4,Pt,4,5,"div",92),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.Dc("ngForOf",n.model.selectedSupplierAndActions.actions)}}function Bt(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",79),I.hc(1,"div",80),I.hc(2,"form",null,81),I.hc(4,"div",82),I.hc(5,"label",83),I.ed(6,"Which Outworker?"),I.gc(),I.hc(7,"ng-select",84,85),I.sc("change",(function(){return I.Qc(n),I.wc().onChangeSelectedOutworker()}))("ngModelChange",(function(t){return I.Qc(n),I.wc().model.selectedSupplierAndActions=t})),I.cd(9,Mt,3,4,"ng-option",86),I.gc(),I.gc(),I.cd(10,Tt,5,1,"div",87),I.gc(),I.gc(),I.hc(11,"modal-footer",88),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().sendToOutworker()})),I.gc()}if(2&t){var c=e.$implicit,i=I.Nc(3),o=I.wc();I.Dc("modal",c),I.Nb(7),I.Dc("ngModel",o.model.selectedSupplierAndActions)("searchable",!1),I.Nb(2),I.Dc("ngForOf",o.data.suppliersAndActions),I.Nb(1),I.Dc("ngIf",o.model.selectedSupplierAndActions),I.Nb(1),I.Dc("form",i)("modal",c)("saveButtonName","Send")}}function kt(t,e){if(1&t){var n=I.ic();I.hc(0,"div",93),I.hc(1,"label",94),I.hc(2,"input",98),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.selectedCompleteAction=t})),I.gc(),I.ed(3),I.gc(),I.gc()}if(2&t){var c=e.$implicit,i=I.wc(2);I.Nb(1),I.Tb("active",i.model.selectedCompleteAction===c),I.Nb(1),I.Dc("ngModel",i.model.selectedCompleteAction)("value",c),I.Nb(1),I.gd("",c.node.name," ")}}function Ot(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",96),I.hc(1,"div",80),I.hc(2,"form",null,97),I.hc(4,"div",82),I.hc(5,"label",90),I.ed(6,"What Action"),I.gc(),I.hc(7,"div",91),I.cd(8,kt,4,5,"div",92),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(9,"modal-footer",88),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().completeActions()})),I.gc()}if(2&t){var c=e.$implicit,i=I.Nc(3),o=I.wc();I.Dc("modal",c),I.Nb(8),I.Dc("ngForOf",o.data.actions),I.Nb(1),I.Dc("form",i)("modal",c)("saveButtonName","Complete")}}function Et(t,e){if(1&t&&(I.hc(0,"ng-option",89),I.ed(1),I.xc(2,"titlecase"),I.gc()),2&t){var n=e.$implicit;I.Dc("value",n),I.Nb(1),I.gd("",I.yc(2,2,n.node.company)," ")}}function Rt(t,e){if(1&t){var n=I.ic();I.hc(0,"div",82),I.hc(1,"label",83),I.ed(2,"Which Supplier?"),I.gc(),I.hc(3,"ng-select",104,85),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.selectedManufacturer=t})),I.cd(5,Et,3,4,"ng-option",86),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(3),I.Dc("ngModel",c.model.selectedManufacturer)("searchable",!1),I.Nb(2),I.Dc("ngForOf",c.data.manufacturers)}}function Jt(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",99),I.hc(1,"div",80),I.hc(2,"form",null,100),I.cd(4,Rt,6,3,"div",87),I.hc(5,"h5"),I.ed(6),I.gc(),I.hc(7,"h5"),I.ed(8),I.gc(),I.hc(9,"h5"),I.ed(10),I.gc(),I.hc(11,"div",101),I.hc(12,"label",102),I.hc(13,"input",103),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc().allItemsPresent=t})),I.gc(),I.ed(14," All Items Are Present "),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(15,"modal-footer",88),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().createOutgoingBatch()})),I.gc()}if(2&t){var c=e.$implicit,i=I.Nc(3),o=I.wc();I.Dc("modal",c),I.Nb(4),I.Dc("ngIf",o.isAdmin),I.Nb(2),I.gd("# Rings: ",o.model.numItemTypes[o.jewelleryTypeRing],""),I.Nb(2),I.gd("# Pendants: ",o.model.numItemTypes[o.jewelleryTypePendant],""),I.Nb(2),I.gd("# Earring Pairs: ",o.model.numItemTypes[o.jewelleryTypeEarring],""),I.Nb(3),I.Dc("ngModel",o.allItemsPresent)("value",!0),I.Nb(2),I.Dc("form",i)("modal",c)("saveButtonName","Create")}}function Ft(t,e){if(1&t&&(I.hc(0,"ng-option",89),I.ed(1),I.xc(2,"numericId"),I.gc()),2&t){var n=e.$implicit;I.Dc("value",n.node.id),I.Nb(1),I.gd("Batch #",I.yc(2,2,n.node.id)," ")}}function _t(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",105),I.hc(1,"div",80),I.hc(2,"form",null,106),I.hc(4,"div",82),I.hc(5,"label",83),I.ed(6,"Which Batch?"),I.gc(),I.hc(7,"ng-select",107,85),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc().data.mutationBatchId=t})),I.cd(9,Ft,3,4,"ng-option",86),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(10,"modal-footer",88),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().addJobsToBatch()})),I.gc()}if(2&t){var c=e.$implicit,i=I.Nc(3),o=I.wc();I.Dc("modal",c),I.Nb(7),I.Dc("ngModel",o.data.mutationBatchId)("searchable",!1),I.Nb(2),I.Dc("ngForOf",o.data.availableBatches),I.Nb(1),I.Dc("form",i)("modal",c)("saveButtonName","Create")}}function zt(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",108),I.hc(1,"div",80),I.hc(2,"h5"),I.ed(3),I.gc(),I.gc(),I.hc(4,"modal-footer",109),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().putJobsOnHold()})),I.gc()}if(2&t){var c=e.$implicit,i=I.wc();I.Dc("modal",c),I.Nb(3),I.hd("Add a hold to ",i.data.selections.length," item",i.data.selections.length>1?"s":"","?"),I.Nb(1),I.Dc("modal",c)("saveButtonName","Add Hold")}}function Qt(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",110),I.hc(1,"div",80),I.hc(2,"h5"),I.ed(3),I.gc(),I.gc(),I.hc(4,"modal-footer",109),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().takeJobsOffHold()})),I.gc()}if(2&t){var c=e.$implicit,i=I.wc();I.Dc("modal",c),I.Nb(3),I.hd("Remove hold from ",i.data.selections.length," item",i.data.selections.length>1?"s":"","?"),I.Nb(1),I.Dc("modal",c)("saveButtonName","Remove Hold")}}var Ht="inProgress",Lt="readyToReturn",$t="complete",Wt="onHold",Gt=function(){return function(){this.currentJobSearch=null,this.reference=null,this.regCode=null,this.searchInfo=null,this.source=null}}(),qt=function(){return function(){this[s]=0,this[d]=0,this[l]=0}}();s=S.e,d=S.d,l=S.c;var Ut=function(t){function e(e,n,c,i,o,a,s,d,l,r,u,g,h,b){var m,p=t.call(this)||this;return p.actionService=e,p.appUserService=n,p.jobActionService=c,p.jobService=i,p.modalService=o,p.route=a,p.router=s,p.stoneSubmissionService=d,p.submissionBatchService=l,p.submissionService=r,p.supplierActionService=u,p.supplierService=g,p.toastrService=h,p.submissionNoteService=b,p.data={actions:[],availableBatches:[],jobsAndJobActions:[],manufacturers:[],mutationBatchId:null,selections:[],suppliersAndActions:[],jobInFocus:null,jobInFocusIndex:-1},p.actionCastAndMount="Cast & Mount",p.actionFinishing="Finishing",p.actionPlating=w,p.actionEngraving=j,p.actionDuplicate="Duplicate",p.actionJumpRing=A,p.actionEarringPosts=x,p.actionStoneSetting=D,p.actionResizing=M,p.actionRepairing=P,p.actionOther="Other",p.actionHallmarking=T,p.jewelleryTypeRing=S.e,p.jewelleryTypePendant=S.d,p.jewelleryTypeEarring=S.c,p.eventTypeWedding=U.a,p.tablePageCollectionSize=50,p.paginationData={totalCount:null,pageInfo:{hasNextPage:null}},p.model=new Gt,p.tabInProgress=Ht,p.tabReadyToReturn=Lt,p.tabComplete=$t,p.tabOnHold=Wt,p.tabAll="all",p.tabs=((m={}).inProgress={completed:!1,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:Ht,onHold:null},m.readyToReturn={completed:!0,dueOrder:"ASC",incomingBatched:!1,inProduction:!0,name:Lt,onHold:null},m.complete={completed:!0,dueOrder:"ASC",incomingBatched:!0,inProduction:!1,name:$t,onHold:null},m.onHold={completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:Wt,onHold:!0},m.all={completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:null,name:"all",onHold:null},m),p.activeTab=p.tabs.inProgress,p.allItemsPresent=!1,p.availableActions={sendToOutworker:!1,completeAction:!1,putItemsOnHold:!1,takeItemsOffHold:!1,addToOutgoingBatch:!1,actionsAvailable:!1},p.isAdmin=!1,p.loadingJobActions=!0,p.loadingStones=!0,p.loadingNotes=!0,p.loadingSupplierActions=!0,p.now=new Date,p.setSearch=null,p.submitting=!1,p._jobSidebar={isOpen:!1},p._submissionSidebar={isOpen:!1},p.jobId="Job ID",p.submissionId="Submission ID",p.customerName="Customer Name",p.eventName="Event Name",p.castingCode="Casting Code",p.baseMetalSilver=G.m,p.searchFields=[{name:p.jobId,allowedType:W.b.integer,searchPath:"job.node.id"},{name:p.submissionId,allowedType:W.b.integer,searchPath:"job.node.submission.id"},{name:p.customerName,allowedType:W.b.any,searchPath:"job.node.submission.customer.fullName"},{name:p.castingCode,allowedType:W.b.any,searchPath:"job.node.submission.castingCode"},{name:p.eventName,allowedType:W.b.any,searchPath:"job.node.submission.customer.event.name"}],p.defaultSearch={searchField:p.searchFields[2],searchQuery:null},p}return X(e,t),e.prototype.ngOnInit=function(){return K(this,void 0,void 0,(function(){var t,e,n,c,i,o,a=this;return Z(this,(function(s){switch(s.label){case 0:for(this.activeTab=this.tabs[this.route.snapshot.queryParamMap.get("tab")],this.activeTab||(this.activeTab=this.tabs.inProgress),t=this.route.snapshot.queryParamMap.get("searchField"),e=null,n=0,c=this.searchFields;n<c.length;n++)if((i=c[n]).name===t){e=i;break}return o=this.route.snapshot.queryParamMap.get("query"),e&&o?(this.setSearch={searchQuery:o,searchField:e},this.search(this.setSearch),[3,3]):[3,1];case 1:return this.setSearch=this.defaultSearch,[4,this.updateTable(null)];case 2:s.sent(),s.label=3;case 3:return this.appUserService.getMe().subscribe((function(t){a.isAdmin=a.appUserService.isAdmin(t.data.appUser.roles)})),this.submissionBatchService.list(null,null,!0,!0,"DESC",null,!1).subscribe((function(t){a.data.availableBatches=t.data.submissionBatches.edges})),this.supplierService.list(null).subscribe((function(t){for(var e=[],n=0,c=t.data.suppliers.edges;n<c.length;n++){var i=c[n];i.node.isManufacturer?a.data.manufacturers.push(i):(e.push(i.node.id.replace(/^\D+/,"")),a.data.suppliersAndActions.push({supplier:i,actions:[]})),1===a.data.manufacturers.length&&(a.model.selectedManufacturer=a.data.manufacturers[0])}a.supplierActionService.getBySupplierIds(e).subscribe((function(t){for(var e=0,n=a.data.suppliersAndActions;e<n.length;e++)for(var c=n[e],i=0,o=t.data.supplierActions.edges;i<o.length;i++){var s=o[i];c.supplier.node.id===s.node.supplier.id&&c.actions.push(s)}a.loadingSupplierActions=!1})),e.length||(a.loadingSupplierActions=!1)})),this.actionService.list().subscribe((function(t){a.data.actions=t.data.actions.edges})),[2]}}))}))},e.prototype.updateTableWithSearch=function(t,e){return K(this,void 0,void 0,(function(){var t,n=this;return Z(this,(function(c){return this.state.loading=!0,this.loadingJobActions=!0,this.loadingStones=!0,this.model.currentJobSearch&&this.model.currentJobSearch.unsubscribe(),t=!(!this.model.searchInfo||!this.model.searchInfo.searchQuery),this.model.currentJobSearch=e.subscribe((function(e){n.paginationData.totalCount=e.data.jobs.totalCount,n.paginationData.pageInfo.hasNextPage=e.data.jobs.pageInfo.hasNextPage,e=JSON.parse(JSON.stringify(e));var c=JSON.parse(JSON.stringify(n.data.jobsAndJobActions));t||(n.data.jobsAndJobActions=[]);for(var i=[],o=[],a=function(t){var e;if(n.data.jobsAndJobActions.some((function(e){return e.job.node.id===t.node.id})))return"continue";i.push(t.node.id.replace(/^\D+/,"")),o.push(t.node.submission.id.replace(/^\D+/,""));for(var a=!1,s=!1,d=0,l=c;d<l.length;d++){var r=l[d];r.job.node.id===t.node.id&&(a=r.selected,s=r.expanded)}t.node.submission.hardDeadline=t.node.submission.hardDeadline?new Date(t.node.submission.hardDeadline):null,n.data.jobsAndJobActions.push({job:t,jobActions:(e={},e["Cast & Mount"]=null,e.Finishing=null,e.Plating=null,e.Engraving=null,e.Duplicate=null,e["Jump Ring"]=null,e["Earring Posts"]=null,e["Stone Setting"]=null,e.Resizing=null,e.Repairing=null,e.Other=null,e.Hallmarking=null,e),jobActionObj:[],jobDueDate:t.node.due?new Date(t.node.due):null,jobActionsCompleted:0,jobActionsNeeded:0,loadingJobActions:!0,selected:a,expanded:s,stones:[],notes:[]})},s=0,d=e.data.jobs.edges;s<d.length;s++)a(d[s]);n.handlePagination(e.data.jobs),n.jobActionService.getByJobIds(i).subscribe((function(t){t=JSON.parse(JSON.stringify(t));for(var e=0,c=n.data.jobsAndJobActions;e<c.length;e++)for(var i=c[e],o=0,a=t.data.jobActions.edges;o<a.length;o++){var s=a[o];s.node.job.id===i.job.node.id&&(i.jobActions[s.node.action.name]=s,i.jobActionObj.push(s),i.jobActionsNeeded+=1,s.node.completed&&(i.jobActionsCompleted+=1),i.loadingJobActions=!1)}n.loadingJobActions=!1})),n.stoneSubmissionService.listBySubmission(o).subscribe((function(t){for(var e=0,c=n.data.jobsAndJobActions;e<c.length;e++)for(var i=c[e],o=0,a=t.data.stoneSubmissions.edges;o<a.length;o++){var s=a[o];i.job.node.submission.id===s.node.submission.id&&i.stones.push(s)}n.loadingStones=!1})),n.submissionNoteService.listBySubmission(o).subscribe((function(t){for(var e=0,c=n.data.jobsAndJobActions;e<c.length;e++)for(var i=c[e],o=0,a=t.data.submissionNotes.edges;o<a.length;o++){var s=a[o];i.job.node.submission.id===s.node.submission.id&&i.notes.push(s)}n.loadingNotes=!1}))})),[2]}))}))},e.prototype.updateTable=function(t){return K(this,void 0,void 0,(function(){return Z(this,(function(e){return this.updateTableWithSearch(t,this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,t,null,null,null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder,this.tablePageCollectionSize)),[2]}))}))},e.prototype.search=function(t){if(this.model.searchInfo=t,!t.searchQuery||!t.searchField)return this.resetSearchQueryParams(),void this.updateTable(null);this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:t.searchField.name,query:t.searchQuery},queryParamsHandling:"merge"});var e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,t.searchField.name===this.jobId?parseInt(t.searchQuery):null,t.searchField.name===this.submissionId?parseInt(t.searchQuery):null,t.searchField.name===this.customerName?t.searchQuery:null,t.searchField.name===this.eventName?t.searchQuery:null,t.searchField.name===this.castingCode?t.searchQuery:null);this.searchLocally(),this.updateTableWithSearch(null,e)},e.prototype.searchLocally=function(){for(var t=[],e=0,n=this.data.jobsAndJobActions;e<n.length;e++){var c=n[e],i=Object($.b)(c,this.model.searchInfo.searchField.searchPath);i&&i.toLowerCase().includes(this.model.searchInfo.searchQuery.toLowerCase())&&t.push(c)}this.data.jobsAndJobActions=t},e.prototype.changeTab=function(t){return K(this,void 0,void 0,(function(){return Z(this,(function(e){switch(e.label){case 0:return this.setSearch=this.defaultSearch,[4,this.resetSearchQueryParams()];case 1:return e.sent(),this.router.navigate([],{relativeTo:this.route,queryParams:{tab:t},queryParamsHandling:"merge"}),this.activeTab=this.tabs[t],this.searchComponent.clearSearch(),this.resetSelections(),this.updateTable(null),[2]}}))}))},e.prototype.selectRow=function(t){if(!this.submitting){if(t.selected){t.selected=!t.selected;var e=this.data.selections.findIndex((function(e){return e.job.node.id===t.job.node.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t);this.getAvailableActions()}},e.prototype.getAvailableActions=function(){var t=this;this.availableActions={sendToOutworker:!0,completeAction:!0,putItemsOnHold:!0,takeItemsOffHold:!0,addToOutgoingBatch:!0,actionsAvailable:!1};for(var e=0,n=this.data.selections;e<n.length;e++){var c=n[e];c.jobActionsNeeded===c.jobActionsCompleted?(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1):this.availableActions.addToOutgoingBatch=!1,c.job.node.status.name!==k.r.name&&(this.availableActions.addToOutgoingBatch=!1),c.job.node.onHold&&(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1,this.availableActions.putItemsOnHold=!1,this.availableActions.addToOutgoingBatch=!1),c.job.node.onHold||(this.availableActions.takeItemsOffHold=!1)}this.availableActions.actionsAvailable=!Object.keys(this.availableActions).every((function(e){return!t.availableActions[e]}))},e.prototype.selectAll=function(){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(i=e[t]).selected=!0,this.selectRow(i);for(var n=0,c=this.data.jobsAndJobActions;n<c.length;n++){var i;(i=c[n]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(i)&&this.data.selections.push(i)}},e.prototype.expandJobs=function(t){this.submitting||(t.expanded=!t.expanded)},e.prototype.expandAll=function(){if(this.state.allExpanded=!this.state.allExpanded,!this.state.allExpanded)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(i=e[t]).expanded=!0,this.expandJobs(i);for(var n=0,c=this.data.jobsAndJobActions;n<c.length;n++){var i;(i=c[n]).expanded=this.state.allExpanded}},e.prototype.updateJobAction=function(t){for(var e=null,n=0,c=this.data.jobsAndJobActions;n<c.length;n++){var i=c[n];if(i.job.node.id===t.node.job.id){e=i;break}}if(e.job.node.onHold)this.onHoldMessage(e.job.node.id);else{this.jobActionService.update({id:t.node.id,started:t.node.started,startedAt:t.node.startedAt,completed:t.node.completed,completedAt:t.node.completedAt}).subscribe();var o=t.node.completed,a=t.node.started&&!t.node.completed;e.jobActionsCompleted=0;for(var s=0,d=Object.keys(e.jobActions);s<d.length;s++){var l=e.jobActions[d[s]];l&&(l.node.completed?e.jobActionsCompleted+=1:(o=!1,l.node.started&&(a=!0)))}a||(e.job.node.currentlyWith=null),e.job.node.status=o?k.r:k.j}},e.prototype.openModalWithSelected=function(t){this.data.selections.length?this.modalService.open(t):this.toastrService.info(null,"Please select job(s) before performing action")},e.prototype.sendToOutworker=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;for(var e=(new Date).toISOString(),n=this.toastrService.success(null,"Sending 0 Jobs to Outworkers",{timeOut:3e4}),c=0,i=0,o=function(o){if(o.job.node.onHold)return a.onHoldMessage(o.job.node.id),"continue";var s=o.jobActions[a.model.selectedOutworkerAction.node.action.name];if(!s||s.node.completed||s.node.started)return a.toastrService.info(null,"Item "+a.getNumericId(o.job.node.id)+" does not need "+a.model.selectedOutworkerAction.node.action.name),"continue";if(o.job.node.currentlyWith&&o.job.node.currentlyWith.id!==a.model.selectedSupplierAndActions.supplier.node.id)return a.toastrService.info(null,"Item "+a.getNumericId(o.job.node.id)+" is currently with a different outworker: "+o.job.node.currentlyWith.company),"continue";var d=" Job"+((i+=1)>1?"s":"")+" to Outworkers";n.toastRef.componentInstance.title="Sending "+i+d,n.toastRef.timeoutReset(),s.node.started=!0,s.node.startedAt=e;for(var l={id:s.node.id,started:!0,startedAt:e,completed:!1,completedAt:null},r=0,u=a.data.jobsAndJobActions;r<u.length;r++){var g=u[r];if(g.job.node.id===s.node.job.id){g.job.node.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;break}}s.node.job.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;var h={id:o.job.node.id,currentlyWith:a.model.selectedSupplierAndActions.supplier.node.id};Object(_.a)(a.jobActionService.update(l),a.jobService.update(h)).subscribe((function(e){(c+=1)===i?(n.toastRef.close(),t.toastrService.success(null,"Sent "+i+d),t.model.selectedOutworkerAction=null,t.model.selectedSupplierAndActions=null,t.submitting=!1):(n.toastRef.componentInstance.title="Sent "+c+"/"+i+d,n.toastRef.timeoutReset())}))},a=this,s=0,d=this.data.selections;s<d.length;s++)o(d[s]);0===i&&(n.toastRef.close(),this.model.selectedOutworkerAction=null,this.model.selectedSupplierAndActions=null,this.submitting=!1)}},e.prototype.completeActions=function(){for(var t,e=this,n=0,c=this.data.selections;n<c.length;n++){var i=c[n];if(i.job.node.onHold)this.onHoldMessage(i.job.node.id);else{var o=new Date,a=i.jobActions[this.model.selectedCompleteAction.node.name];if(a){t=!0;var s={__typename:"JobActionEdge",node:{__typename:"JobAction",id:a.node.id,job:a.node.job,action:a.node.action,supplier:null,started:null,startedAt:null,completed:!0,completedAt:o.toISOString()}};a.node.completed=!0,this.updateJobAction(s)}else this.toastrService.info(null,"Item "+this.getNumericId(i.job.node.id)+" does not need "+this.model.selectedCompleteAction.node.name)}}t&&(this.toastrService.success(null,"Completing "+this.model.selectedCompleteAction.node.name),setTimeout((function(){e.toastrService.success(null,"Completed "+e.model.selectedCompleteAction.node.name),e.model.selectedCompleteAction=null}),3e3))},e.prototype.prepareOutgoingBatch=function(t){var e;this.model.numItemTypes=new qt;for(var n=0,c=this.data.selections;n<c.length;n++){var i=c[n];i.job.node.onHold?this.onHoldMessage(i.job.node.id):(e=!0,this.model.numItemTypes[i.job.node.submission.jewelleryType.name]+=1)}e&&this.modalService.open(t)},e.prototype.createOutgoingBatch=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;var e=(new Date).toISOString();this.toastrService.success(null,"Creating Batch"),this.submissionBatchService.create({status:k.d.id,createdAt:e,updatedAt:e,supplier:this.model.selectedManufacturer.node.id}).subscribe((function(e){t.data.mutationBatchId=e.data.createSubmissionBatch.submissionBatch.id,t.toastrService.success(null,"Batch Created"),t.addJobsToBatch()}))}},e.prototype.addJobsToBatch=function(){for(var t=this,e=0,n=0,c=this.toastrService.success(null,"Adding Items to Batch",{timeOut:3e4}),i=0,o=this.data.selections;i<o.length;i++){var a=o[i];a.job.node.onHold?this.onHoldMessage(a.job.node.id):(n+=1,this.jobService.updateIncomingBatch({id:a.job.node.id,incomingBatch:this.data.mutationBatchId,status:k.d.id}).subscribe((function(i){e+=1;for(var o=0,a=t.data.selections;o<a.length;o++){var s=a[o];if(i.data.updateJob.job.id===s.job.node.id){s.job.node.status=k.d;break}}e===n?(c.toastRef.close(),t.toastrService.success(null,"Added "+n+" Items to Batch"),t.router.navigate(["manufacturing","batches","view",t.data.mutationBatchId.replace(/\D/g,"")])):(c.toastRef.componentInstance.title="Added "+e+"/"+n+" Items to Batch",c.toastRef.timeoutReset())})))}0===n&&(c.toastRef.close(),this.submitting=!1)},e.prototype.putJobsOnHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!0,"Putting job"+t+" on hold.","Job"+t+" put on hold.")},e.prototype.takeJobsOffHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!1,"Taking job"+t+" off hold.","Job"+t+" back in production.")},e.prototype.updateJob=function(t,e,n){var c=this,i=((new Date).toISOString(),0),o=0;this.toastrService.success(null,e);for(var a=function(e){o+=1;var a={id:e.job.node.id};null!==t&&(a.onHold=t,setTimeout((function(n){e.job.node.onHold=t}),3e3)),s.jobService.update(a).subscribe((function(t){(i+=1)===o&&c.toastrService.success(null,n)}))},s=this,d=0,l=this.data.selections;d<l.length;d++)a(l[d])},e.prototype.resetSelections=function(){this.data.selections=[];for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)e[t].selected=!1;this.availableActions.actionsAvailable=!1},e.prototype.resetSearchQueryParams=function(){return K(this,void 0,void 0,(function(){return Z(this,(function(t){switch(t.label){case 0:return[4,this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:null,query:null},queryParamsHandling:"merge"})];case 1:return t.sent(),[2]}}))}))},e.prototype.nextPage=function(){this.data.jobsAndJobActions=[],t.prototype.nextPage.call(this)},e.prototype.previousPage=function(){this.data.jobsAndJobActions=[],t.prototype.previousPage.call(this)},e.prototype.onHoldMessage=function(t){this.toastrService.warning(null,"Item "+this.getNumericId(t)+" is on hold")},e.prototype.onChangeSelectedOutworker=function(){this.model.selectedOutworkerAction=null},e.prototype.getDaysBetween=function(t,e){return $.a.getDaysBetween(t,e)},e.prototype.openJobSidebar=function(t){var e=this.data.jobsAndJobActions.findIndex((function(e){return e.job.node.id===t.job.node.id}));this.data.jobInFocusIndex=e||null,this.data.jobInFocus=t,this._jobSidebar.isOpen=!0},e.prototype.openSubmissionSidebar=function(t){this.data.jobInFocus=t,this._submissionSidebar.isOpen=!0},e.prototype.closeSidebar=function(t){this.data.jobInFocusIndex=-1,this.data.jobInFocus=null,t.isOpen=!1},e.prototype.changeFocussedJob=function(t,e){if(-1!=this.data.jobInFocusIndex&&this.data.jobInFocus){var n=t+e;if(!(1===e&&n>this.tablePageCollectionSize-1||-1===e&&n<0))return this.data.jobInFocusIndex=n,this.data.jobInFocus=this.data.jobsAndJobActions[n]}},e.prototype.handleKeyboardEvent=function(t){this.state.loading||this.data.jobInFocus&&("ArrowRight"===t.key&&this.changeFocussedJob(this.data.jobInFocusIndex,1),"ArrowLeft"===t.key&&this.changeFocussedJob(this.data.jobInFocusIndex,-1))},e.\u0275fac=function(t){return new(t||e)(I.bc(B),I.bc(Q.a),I.bc(v.a),I.bc(f.a),I.bc(Y.i),I.bc(m.a),I.bc(m.b),I.bc(z.a),I.bc(H.a),I.bc(L.a),I.bc(F),I.bc(O.a),I.bc(V.b),I.bc(q.a))},e.\u0275cmp=I.Vb({type:e,selectors:[["ng-component"]],viewQuery:function(t,e){var n;1&t&&I.kd(tt,!0),2&t&&I.Mc(n=I.tc())&&(e.searchComponent=n.first)},hostBindings:function(t,e){1&t&&I.sc("keydown",(function(t){return e.handleKeyboardEvent(t)}),!1,I.Oc)},features:[I.Kb],decls:81,vars:30,consts:[[3,"backdropClass"],["ng-sidebar-content",""],[1,"page-padding"],["title","Production Jobs"],[1,"row","justify-content-between","mb-4"],[1,"col"],[1,"search-container","flex-grow-1","align-items-center"],["aria-label","Search","role","toolbar",1,"btn-toolbar"],[3,"setSearch","searchFields","searchEmitter"],["searchComponent",""],["ngbDropdown","",1,"d-inline-block","float-right"],["class","btn btn-outline-primary","id","sortMenu","ngbDropdownToggle","",4,"ngIf"],["aria-labelledby","sortMenu","ngbDropdownMenu",""],[4,"ngIf"],["class","btn btn-outline-primary","ngbDropdownItem","",4,"ngIf"],[1,"row"],[1,"nav","table-navigation"],[1,"nav-item"],[3,"click"],[1,"table-responsive"],["cellpadding","0",1,"table"],["role","columnheader",1,"sticky"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[1,"spacer"],["colspan","100",1,"text-center"],[3,"state","totalCount","pageSize","hasNextPage","currentPage","nextPage","previousPage"],["modalSendToOutworker",""],["modalCompleteAction",""],["modalCreateOutgoingBatch",""],["modalAddToOutgoingBatch",""],["modalPutOnHold",""],["modalTakeOffHold",""],["ng-sidebar","",3,"isOpen","keyCloseOff","closedSidebar"],[3,"data","confirmJobAction","openSubmission"],["id","sortMenu","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["class","btn btn-outline-primary","ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",1,"btn","btn-outline-primary",3,"click"],["ngbDropdownItem","",1,"btn","btn-outline-primary"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["size","30"],["role","rowgroup",4,"ngFor","ngForOf"],["role","rowgroup"],["role","rowheader"],["type","checkbox",3,"ngModel","name","id","click","ngModelChange"],[3,"for"],["role","gridcell"],["class","text-muted",4,"ngIf"],["class","fas fa-star text-warning",4,"ngIf"],["class","fas fa-shipping-fast text-danger",4,"ngIf"],["class","d-block text-muted",4,"ngIf"],["class","pill-tag wedding",4,"ngIf"],[1,"d-flex","align-items-center"],["class","d-block",3,"text-muted","text-danger","font-weight-bold",4,"ngIf"],["class","d-block text-info",4,"ngIf"],["class","pl-1",4,"ngIf"],["class","job-actions tooltip-wrapper",4,"ngIf"],[1,"btn-group","justify-content-end"],["type","button",1,"btn","mx-1","icon-btn-outline","fas","fa-tasks",3,"click"],[3,"photos"],[3,"customerNote","isAdmin","hover","loadingNotes","notes","submissionId"],[3,"buttonStyle","isAdmin","loadingStones","stones","submission"],[1,"text-muted"],[1,"fas","fa-star","text-warning"],[1,"fas","fa-shipping-fast","text-danger"],[1,"d-block","text-muted"],[1,"pill-tag","wedding"],[1,"d-block"],[1,"d-block","text-info"],[1,"pl-1"],["class","pill-tag hard-deadline",4,"ngIf"],[1,"pill-tag","hard-deadline"],[1,"job-actions","tooltip-wrapper"],[4,"ngFor","ngForOf"],[1,"action","tooltip-wrapper",3,"ngbTooltip","placement"],[1,"row","align-items-center"],[1,"col-3","p-0","pr-1"],[1,"shimmer","py-1"],["title","Send To Outworker?",3,"modal"],[1,"modal-body"],["sendToOutworkerModalForm","ngForm"],[1,"form-group"],["for","selectSupplier",1,"req"],["appShowErrorInputClass","","id","selectSupplier","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","change","ngModelChange"],["selectSupplier","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[3,"form","modal","saveButtonName","modalSaved"],[3,"value"],[1,"req"],["data-toggle","buttons",1,"btn-group-toggle","row"],["class","btn-group-toggle col-md-4 mb-1",4,"ngFor","ngForOf"],[1,"btn-group-toggle","col-md-4","mb-1"],[1,"btn","btn-primary"],["autocomplete","off","id","selectedSupplierAction","name","selectedSupplierAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Complete Action?",3,"modal"],["completeActionModalForm","ngForm"],["autocomplete","off","id","selectedAction","name","selectedAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Create Outgoing Batch?",3,"modal"],["createOutgoingBatchModalForm","ngForm"],[1,"mt-5","form-group"],["for","allItemsPresent",1,"req","mr-3"],["id","allItemsPresent","name","allItemsPresent","required","","type","checkbox",1,"mr-2",2,"vertical-align","middle",3,"ngModel","value","ngModelChange"],["appShowErrorInputClass","","id","selectSupplierForOutgoingBatch","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add to Outgoing Batch",3,"modal"],["addToOutgoingBatchModalForm","ngForm"],["appShowErrorInputClass","","id","selectBatch","name","selectBatch","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add Hold to Items",3,"modal"],[3,"modal","saveButtonName","modalSaved"],["title","Remove Hold from Items",3,"modal"]],template:function(t,e){1&t&&(I.hc(0,"ng-sidebar-container",0),I.hc(1,"div",1),I.hc(2,"div",2),I.cc(3,"page-title",3),I.hc(4,"div",4),I.hc(5,"div",5),I.hc(6,"div",6),I.hc(7,"div",7),I.hc(8,"search",8,9),I.sc("searchEmitter",(function(t){return e.search(t)})),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(10,"div",5),I.hc(11,"div",10),I.cd(12,et,2,0,"button",11),I.hc(13,"div",12),I.cd(14,st,6,5,"ng-container",13),I.cd(15,dt,2,0,"button",14),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(16,"div",15),I.hc(17,"div",5),I.hc(18,"ul",16),I.hc(19,"li",17),I.hc(20,"a",18),I.sc("click",(function(){return e.changeTab(e.tabInProgress)})),I.ed(21,"In Progress"),I.gc(),I.gc(),I.hc(22,"li",17),I.hc(23,"a",18),I.sc("click",(function(){return e.changeTab(e.tabReadyToReturn)})),I.ed(24,"Ready to Return"),I.gc(),I.gc(),I.hc(25,"li",17),I.hc(26,"a",18),I.sc("click",(function(){return e.changeTab(e.tabComplete)})),I.ed(27,"Complete"),I.gc(),I.gc(),I.hc(28,"li",17),I.hc(29,"a",18),I.sc("click",(function(){return e.changeTab(e.tabOnHold)})),I.ed(30,"On Hold"),I.gc(),I.gc(),I.hc(31,"li",17),I.hc(32,"a",18),I.sc("click",(function(){return e.changeTab(e.tabAll)})),I.ed(33,"All"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(34,"div",15),I.hc(35,"div",19),I.hc(36,"table",20),I.hc(37,"thead"),I.hc(38,"tr"),I.hc(39,"td",21),I.cd(40,lt,3,2,"div",22),I.gc(),I.hc(41,"td",21),I.ed(42,"#"),I.gc(),I.hc(43,"td",21),I.ed(44,"BA"),I.gc(),I.hc(45,"td",21),I.ed(46,"Customer"),I.gc(),I.hc(47,"td",21),I.ed(48,"Type"),I.gc(),I.cc(49,"td",21),I.hc(50,"td",21),I.ed(51,"Due Back"),I.gc(),I.hc(52,"td",21),I.ed(53,"Base Metal"),I.gc(),I.hc(54,"td",21),I.ed(55,"Task Progress"),I.gc(),I.cc(56,"td",21),I.gc(),I.gc(),I.hc(57,"tbody"),I.hc(58,"tr",23),I.hc(59,"td",24),I.cd(60,rt,4,0,"ng-container",13),I.gc(),I.gc(),I.cd(61,Dt,2,1,"ng-container",13),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(62,"table-controls",25),I.sc("nextPage",(function(){return e.nextPage()}))("previousPage",(function(){return e.previousPage()})),I.gc(),I.gc(),I.cd(63,Bt,12,8,"ng-template",null,26,I.dd),I.cd(65,Ot,10,5,"ng-template",null,27,I.dd),I.cd(67,Jt,16,10,"ng-template",null,28,I.dd),I.cd(69,_t,11,7,"ng-template",null,29,I.dd),I.cd(71,zt,5,5,"ng-template",null,30,I.dd),I.cd(73,Qt,5,5,"ng-template",null,31,I.dd),I.gc(),I.hc(75,"sidebar-content",32),I.sc("closedSidebar",(function(){return e.closeSidebar(e._jobSidebar)})),I.hc(76,"job-detail-sidebar",33),I.sc("confirmJobAction",(function(t){return e.updateJobAction(t)}))("openSubmission",(function(){return e.openSubmissionSidebar(e.data.jobInFocus)})),I.gc(),I.gc(),I.hc(77,"sidebar-content",32),I.sc("closedSidebar",(function(){return e.closeSidebar(e._submissionSidebar)})),I.hc(78,"p"),I.ed(79,"Submission details"),I.gc(),I.hc(80,"button",18),I.sc("click",(function(){return e.closeSidebar(e._submissionSidebar)})),I.gc(),I.gc(),I.gc()),2&t&&(I.Zc("height","100vh"),I.Dc("backdropClass","sidebar-backdrop"),I.Nb(8),I.Dc("setSearch",e.setSearch)("searchFields",e.searchFields),I.Nb(4),I.Dc("ngIf",e.availableActions.actionsAvailable),I.Nb(2),I.Dc("ngIf",!e.state.loading&&!e.loadingSupplierActions&&!e.loadingJobActions),I.Nb(1),I.Dc("ngIf",e.state.loading||e.loadingSupplierActions||e.loadingJobActions),I.Nb(4),I.Tb("active",e.activeTab.name===e.tabInProgress),I.Nb(3),I.Tb("active",e.activeTab.name===e.tabReadyToReturn),I.Nb(3),I.Tb("active",e.activeTab.name===e.tabComplete),I.Nb(3),I.Tb("active",e.activeTab.name===e.tabOnHold),I.Nb(3),I.Tb("active",e.activeTab.name===e.tabAll),I.Nb(9),I.Dc("ngIf",!e.state.loading),I.Nb(20),I.Dc("ngIf",e.state.loading),I.Nb(1),I.Dc("ngIf",!e.state.loading||e.data.jobsAndJobActions.length),I.Nb(1),I.Dc("state",e.state)("totalCount",e.paginationData.totalCount)("pageSize",e.tablePageCollectionSize)("hasNextPage",e.paginationData.pageInfo.hasNextPage),I.Nb(13),I.Dc("isOpen",e._jobSidebar.isOpen)("keyCloseOff",e._jobSidebar.isOpen&&e._submissionSidebar.isOpen),I.Nb(1),I.Dc("data",e.data.jobInFocus),I.Nb(1),I.Dc("isOpen",e._submissionSidebar.isOpen)("keyCloseOff",e._jobSidebar.isOpen&&e._submissionSidebar.isOpen))},styles:[""]}),e}(p.a),Yt=n("n4kJ"),Vt=n("wOBz"),Xt=n("1QgP"),Kt=n("ZtzB");function Zt(t,e){1&t&&(I.hc(0,"div",3),I.cc(1,"loading-ring",4),I.gc()),2&t&&(I.Nb(1),I.Dc("size",60))}function te(t,e){if(1&t){var n=I.ic();I.hc(0,"div",12),I.hc(1,"label",24),I.ed(2,"Email"),I.gc(),I.hc(3,"input",27,28),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.email=t})),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(3),I.Dc("ngModel",c.model.email)}}function ee(t,e){if(1&t){var n=I.ic();I.hc(0,"div",12),I.hc(1,"label",29),I.ed(2,"Telephone"),I.gc(),I.hc(3,"input",30,31),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.telephone=t})),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(3),I.Dc("ngModel",c.model.telephone)}}function ne(t,e){if(1&t){var n=I.ic();I.hc(0,"div",12),I.hc(1,"label",32),I.ed(2,"Address"),I.gc(),I.hc(3,"textarea",33,34),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.address=t})),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(3),I.Dc("ngModel",c.model.address)}}function ce(t,e){if(1&t){var n=I.ic();I.hc(0,"div",35),I.hc(1,"label"),I.ed(2,"Supplier Type"),I.gc(),I.hc(3,"div",36),I.hc(4,"div",37),I.hc(5,"div",38),I.hc(6,"input",39),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.isManufacturer=t})),I.gc(),I.hc(7,"label",40),I.ed(8," Manufacturer "),I.gc(),I.gc(),I.gc(),I.hc(9,"div",41),I.hc(10,"div",38),I.hc(11,"input",42),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.isManufacturer=t})),I.gc(),I.hc(12,"label",43),I.ed(13," Outworker "),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(6),I.Dc("value",!0)("ngModel",c.model.isManufacturer),I.Nb(5),I.Dc("value",!1)("ngModel",c.model.isManufacturer)}}function ie(t,e){if(1&t){var n=I.ic();I.hc(0,"input",52),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).$implicit.cost=t})),I.gc()}if(2&t){var c=I.wc(2).$implicit;I.Dc("ngModel",c.cost)("decimalPlaces",2)("id","cost-"+c.action.node.id)("name","cost-"+c.action.node.id)}}function oe(t,e){if(1&t&&(I.hc(0,"div",48),I.hc(1,"div",49),I.hc(2,"div",50),I.ed(3,"\xa3"),I.gc(),I.gc(),I.cd(4,ie,1,4,"input",51),I.gc()),2&t){var n=I.wc(3);I.Nb(4),I.Dc("ngIf",n.state.admin)}}function ae(t,e){if(1&t){var n=I.ic();I.hc(0,"div",44),I.hc(1,"input",45),I.sc("ngModelChange",(function(t){return I.Qc(n),e.$implicit.selected=t})),I.gc(),I.hc(2,"label",46),I.ed(3),I.gc(),I.cd(4,oe,5,1,"div",47),I.gc()}if(2&t){var c=e.$implicit,i=I.wc(2);I.Nb(1),I.Dc("ngModel",c.selected)("name","checkbox-"+c.action.node.id)("id","checkbox-"+c.action.node.id)("value",!0),I.Nb(1),I.Dc("for","checkbox-"+c.action.node.id),I.Nb(1),I.fd(c.action.node.name),I.Nb(1),I.Dc("ngIf",c.selected&&i.state.admin)}}function se(t,e){1&t&&(I.hc(0,"div",53),I.hc(1,"button",54),I.ed(2,"Create Supplier"),I.gc(),I.gc())}function de(t,e){if(1&t){var n=I.ic();I.hc(0,"form",5,6),I.sc("submit",(function(){return I.Qc(n),I.wc().onSubmit()})),I.hc(2,"div",7),I.hc(3,"div",8),I.hc(4,"div",9),I.hc(5,"div",10),I.hc(6,"div",11),I.hc(7,"h5"),I.ed(8,"Essential Details"),I.gc(),I.hc(9,"div",12),I.hc(10,"label",13),I.ed(11,"Company Name"),I.gc(),I.hc(12,"input",14,15),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc().model.company=t})),I.gc(),I.gc(),I.hc(14,"div",12),I.hc(15,"label",16),I.ed(16,"Contact Name"),I.gc(),I.hc(17,"input",17,18),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc().model.contactName=t})),I.gc(),I.gc(),I.cd(19,te,5,1,"div",19),I.cd(20,ee,5,1,"div",19),I.cd(21,ne,5,1,"div",19),I.hc(22,"div",12),I.hc(23,"label",20),I.ed(24,"Notes"),I.gc(),I.hc(25,"textarea",21,22),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc().model.notes=t})),I.gc(),I.gc(),I.cd(27,ce,14,4,"div",23),I.hc(28,"div"),I.hc(29,"label",24),I.hc(30,"b"),I.ed(31,"Actions"),I.gc(),I.gc(),I.hc(32,"div",8),I.cd(33,ae,5,7,"div",25),I.gc(),I.gc(),I.cd(34,se,3,0,"div",26),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.Nc(1),i=I.wc();I.Nb(12),I.Dc("ngModel",i.model.company),I.Nb(5),I.Dc("ngModel",i.model.contactName),I.Nb(2),I.Dc("ngIf",i.state.admin),I.Nb(1),I.Dc("ngIf",i.state.admin),I.Nb(1),I.Dc("ngIf",i.state.admin),I.Nb(4),I.Dc("ngModel",i.model.notes),I.Nb(2),I.Dc("ngIf",i.state.admin),I.Nb(6),I.Dc("ngForOf",i.model.actionCosts),I.Nb(1),I.Dc("ngIf",!i.state.submitting&&c.form.valid)}}var le=function(){return function(){this.isManufacturer=!1}}(),re=function(){function t(t,e,n,c,i){this.actionService=t,this.appUserService=e,this.supplierActionService=n,this.supplierService=c,this.toastrService=i,this.model=new le,this.data={actions:[]},this.state={admin:!1,loading:!0,submitting:!1}}return t.prototype.ngOnInit=function(){var t=this;this.model.actionCosts=[],Object(_.a)(this.actionService.list(),this.appUserService.getMe()).subscribe((function(e){var n=e[1];t.data.actions=e[0].data.actions.edges,t.state.admin=t.appUserService.isAdmin(n.data.appUser.roles);for(var c=0,i=t.data.actions;c<i.length;c++)t.model.actionCosts.push({action:i[c],cost:null,selected:!1});t.state.loading=!1}))},t.prototype.onSubmit=function(){return t=this,void 0,n=function(){var t=this;return function(t,e){var n,c,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,c=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){return this.state.submitting=!0,this.toastrService.success(null,"Creating Supplier"),this.supplierService.create({company:this.model.company,contactName:this.model.contactName,email:this.model.email,telephone:this.model.telephone,address:this.model.address,notes:this.model.notes,isManufacturer:this.model.isManufacturer}).subscribe((function(e){for(var n=0,c=0,i=t.toastrService.success(null,"Supplier Created, Adding Actions",{timeOut:3e4}),o=0,a=t.model.actionCosts;o<a.length;o++){var s=a[o];s.selected&&(c+=1,t.supplierActionService.create({supplier:e.data.createSupplier.supplier.id,action:s.action.node.id,cost:t.formatCurrency(s.cost)}).subscribe((function(e){(n+=1)===c?(i.toastRef.close(),t.toastrService.success(null,"Added "+c+" Actions to Supplier"),t.state.submitting=!1):(i.toastRef.componentInstance.title="Added "+n+"/"+c+" Actions to Supplier",i.toastRef.timeoutReset())})))}})),[2]}))},new((e=void 0)||(e=Promise))((function(c,i){function o(t){try{s(n.next(t))}catch(e){i(e)}}function a(t){try{s(n.throw(t))}catch(e){i(e)}}function s(t){var n;t.done?c(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(o,a)}s((n=n.apply(t,[])).next())}));var t,e,n},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.\u0275fac=function(e){return new(e||t)(I.bc(B),I.bc(Q.a),I.bc(F),I.bc(O.a),I.bc(V.b))},t.\u0275cmp=I.Vb({type:t,selectors:[["ng-component"]],decls:3,vars:2,consts:[["subtitle","I get by with a little help from my friends","title","Create Supplier"],["class","mt-5",4,"ngIf"],["novalidate","",3,"submit",4,"ngIf"],[1,"mt-5"],[3,"size"],["novalidate","",3,"submit"],["createSupplierForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"form-group"],["for","company",1,"req"],["appShowErrorInputClass","","id","company","maxlength","255","name","comapny","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],["for","contactName",1,"req"],["appShowErrorInputClass","","id","contactName","maxlength","255","name","contactName","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["contactName","ngModel"],["class","form-group",4,"ngIf"],["for","notes"],["appShowErrorInputClass","","id","notes","placeholder","These are for your own internal reference, supplier will not see these","maxlength","255","name","notes","type","text",1,"form-control",3,"ngModel","ngModelChange"],["notes","ngModel"],["class","container order-count-selection mb-3 mt-1 form-group",4,"ngIf"],["for","email"],["class","mb-2 col-sm-6",4,"ngFor","ngForOf"],["class","float-right",4,"ngIf"],["appShowErrorInputClass","","id","email","maxlength","255","name","email","type","text",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["for","telephone"],["appShowErrorInputClass","","id","telephone","maxlength","255","name","telephone","type","text",1,"form-control",3,"ngModel","ngModelChange"],["telephone","ngModel"],["for","address"],["appShowErrorInputClass","","id","address","maxlength","255","name","address","type","text",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],[1,"container","order-count-selection","mb-3","mt-1","form-group"],[1,"row","ml-2","inline-options",2,"margin-bottom","0"],[1,"col-sm-3","pl-0"],[1,"option"],["type","radio","name","isManufacturer","id","trueIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","trueIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"col-sm-3","pr-0"],["type","radio","name","isManufacturer","id","falseIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","falseIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"mb-2","col-sm-6"],["type","checkbox",1,"mr-2",3,"ngModel","name","id","value","ngModelChange"],[3,"for"],["class","input-group mb-1",4,"ngIf"],[1,"input-group","mb-1"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","class","form-control","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",3,"ngModel","decimalPlaces","id","name","ngModelChange",4,"ngIf"],["appShowErrorInputClass","","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","id","name","ngModelChange"],[1,"float-right"],["type","submit",1,"btn","btn-primary"]],template:function(t,e){1&t&&(I.cc(0,"page-title",0),I.cd(1,Zt,2,1,"div",1),I.cd(2,de,35,9,"form",2)),2&t&&(I.Nb(1),I.Dc("ngIf",e.state.submitting||e.state.loading),I.Nb(1),I.Dc("ngIf",!e.state.loading))},directives:[Yt.a,g.u,Vt.a,h.z,h.l,h.m,h.d,Xt.a,h.g,h.u,h.k,h.n,g.t,h.s,h.a,h.q,Kt.a],styles:[""]}),t}(),ue=n("/tv0");function ge(t,e){1&t&&I.cc(0,"page-title",6)}function he(t,e){1&t&&I.cc(0,"page-title",7)}function be(t,e){1&t&&I.cc(0,"page-title",8)}function me(t,e){1&t&&I.cc(0,"page-title",9)}function pe(t,e){if(1&t&&(I.hc(0,"div",10),I.hc(1,"h4",11),I.ed(2),I.gc(),I.cc(3,"batches-table",12),I.gc()),2&t){var n=I.wc();I.Nb(2),I.fd(n.state.isSupplier?"Incoming Batches":"Sent to Suppliers"),I.Nb(1),I.Dc("partnerComplete",!0)("manufacturerComplete",!1)("inProduction",null)("supplierExists",!0)("isAdmin",n.state.isAdmin)("isSupplier",n.state.isSupplier)("isToSupplier",n.state.toSupplier)("isFromSupplier",n.state.fromSupplier)("order","DESC")("deletable",!1)}}function fe(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"h4",11),I.ed(2),I.gc(),I.cc(3,"batches-table",14),I.gc()),2&t){var n=I.wc();I.Nb(2),I.fd(n.state.isSupplier?"Outgoing Batches to CAST":"Incoming from Suppliers"),I.Nb(1),I.Dc("partnerComplete",!0)("manufacturerComplete",!0)("inProduction",!1)("supplierExists",!0)("isAdmin",n.state.isAdmin)("isSupplier",n.state.isSupplier)("inQualityControl",!1)("isToSupplier",n.state.toSupplier)("isFromSupplier",n.state.fromSupplier)("order","DESC")("deletable",!1)}}function ve(t,e){if(1&t&&(I.hc(0,"div",10),I.hc(1,"h4",11),I.ed(2,"Completed"),I.gc(),I.cc(3,"batches-table",15),I.gc()),2&t){var n=I.wc();I.Nb(3),I.Dc("supplierExists",!0)("isAdmin",n.state.isAdmin)("isSupplier",n.state.isSupplier)("inQualityControl",!0)("isToSupplier",n.state.toSupplier)("isFromSupplier",n.state.fromSupplier)("deletable",!1)("order","DESC")}}var Se=function(){function t(t,e){this.appUserService=t,this.router=e,this.state={isAdmin:!1,isSupplier:!1,toSupplier:!1,fromSupplier:!1}}return t.prototype.ngOnInit=function(){var t=this,e=this.router.url;e.includes("incoming")&&(this.state.toSupplier=!0),e.includes("outgoing")&&(this.state.fromSupplier=!0),this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(e.data.appUser.roles)}))},t.\u0275fac=function(e){return new(e||t)(I.bc(Q.a),I.bc(m.b))},t.\u0275cmp=I.Vb({type:t,selectors:[["ng-component"]],decls:7,vars:7,consts:[["title","Batches Sent","subtitle","Batches sent from CAST to suppliers",4,"ngIf"],["title","Incoming Batches","subtitle","Batches of jobs from CAST",4,"ngIf"],["title","Incoming Batches","subtitle","Batches returned from suppliers",4,"ngIf"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST",4,"ngIf"],["class","container-fluid mx-0",4,"ngIf"],["class","container-fluid mx-0 mb-4",4,"ngIf"],["title","Batches Sent","subtitle","Batches sent from CAST to suppliers"],["title","Incoming Batches","subtitle","Batches of jobs from CAST"],["title","Incoming Batches","subtitle","Batches returned from suppliers"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST"],[1,"container-fluid","mx-0"],[1,"card-title"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","isToSupplier","isFromSupplier","order","deletable"],[1,"container-fluid","mx-0","mb-4"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","order","deletable"],[3,"supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","deletable","order"]],template:function(t,e){1&t&&(I.cd(0,ge,1,0,"page-title",0),I.cd(1,he,1,0,"page-title",1),I.cd(2,be,1,0,"page-title",2),I.cd(3,me,1,0,"page-title",3),I.cd(4,pe,4,11,"div",4),I.cd(5,fe,4,12,"div",5),I.cd(6,ve,4,8,"div",4)),2&t&&(I.Dc("ngIf",e.state.toSupplier&&e.state.isAdmin),I.Nb(1),I.Dc("ngIf",e.state.toSupplier&&e.state.isSupplier),I.Nb(1),I.Dc("ngIf",e.state.fromSupplier&&e.state.isAdmin),I.Nb(1),I.Dc("ngIf",e.state.fromSupplier&&e.state.isSupplier),I.Nb(1),I.Dc("ngIf",e.state.toSupplier),I.Nb(1),I.Dc("ngIf",e.state.fromSupplier),I.Nb(1),I.Dc("ngIf",e.state.fromSupplier))},directives:[g.u,Yt.a,ue.a],styles:[""]}),t}(),ye=n("7ape"),Ce=n("uzfv"),Ie=n("rYPC"),Ne=n("cXB8"),we=n("r1eF"),je=n("jmmt");function Ae(t,e){if(1&t&&(I.cc(0,"modal-header",2),I.hc(1,"div",3),I.hc(2,"div",4),I.hc(3,"div",5),I.cc(4,"submission-view-photos",6),I.gc(),I.gc(),I.gc()),2&t){var n=e.$implicit,c=I.wc();I.Dc("modal",n),I.Nb(4),I.Dc("photos",c._photos)}}var xe=function(){function t(t,e){this.modalService=t,this.toastr=e}return Object.defineProperty(t.prototype,"photos",{set:function(t){this._photos=t},enumerable:!1,configurable:!0}),t.prototype.openModal=function(t,e){this._photos.length>0?(e.stopPropagation(),this.modalService.open(t,{size:"lg"})):this.toastr.warning("This submission has no photos logged")},t.\u0275fac=function(e){return new(e||t)(I.bc(Y.i),I.bc(V.b))},t.\u0275cmp=I.Vb({type:t,selectors:[["view-submission-photos-modal"]],inputs:{photos:"photos"},decls:3,vars:4,consts:[["type","button",1,"btn","mx-1","icon-btn-outline","fas","fa-camera",3,"click"],["modalViewPhotos",""],["title","View Submission Photos",3,"modal"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[3,"photos"]],template:function(t,e){if(1&t){var n=I.ic();I.hc(0,"button",0),I.sc("click",(function(t){I.Qc(n);var c=I.Nc(2);return e.openModal(c,t)})),I.gc(),I.cd(1,Ae,5,2,"ng-template",null,1,I.dd)}2&t&&I.Tb("text-muted",0===e._photos.length)("text-success",e._photos.length>0)},directives:[we.a,je.a],encapsulation:2}),t}(),De=n("JEAg"),Me=n("z17N"),Pe=n("XhFI"),Te=n("6QD7"),Be=n("VdD3"),ke=n("G0jp"),Oe=n("SjCM"),Ee=n("zVvu"),Re=n("KWY1"),Je=n("XXSO"),Fe=n("9WpQ"),_e=function(t,e,n,c){return new(n||(n=Promise))((function(i,o){function a(t){try{d(c.next(t))}catch(e){o(e)}}function s(t){try{d(c.throw(t))}catch(e){o(e)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}d((c=c.apply(t,e||[])).next())}))},ze=function(t,e){var n,c,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,c=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Qe=["batchInvoiceDataForm"];function He(t,e){if(1&t&&I.cc(0,"page-title",9),2&t){var n=I.wc();I.Dc("title",n.data.incomingBatch?"Incoming Batch":"Outgoing Batch")}}function Le(t,e){if(1&t&&I.cc(0,"page-title",9),2&t){var n=I.wc();I.Dc("title",!0===n.data.incomingBatch?"Batch to CAST":"Incoming Batch")}}function $e(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th",21),I.ed(2,"Est Cost:"),I.gc(),I.hc(3,"td"),I.ed(4),I.xc(5,"currency"),I.xc(6,"currency"),I.xc(7,"currency"),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.id(" ",I.yc(5,3,n.data.totalEstMetalCost+n.data.totalEstLaborCost)," (L:",I.yc(6,5,n.data.totalEstLaborCost),") (M: ",I.yc(7,7,n.data.totalEstMetalCost),") ")}}function We(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th",21),I.ed(2,"Income:"),I.gc(),I.hc(3,"td"),I.ed(4),I.xc(5,"currency"),I.xc(6,"currency"),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.hd(" ",I.yc(5,2,n.data.totalPayments/1.2)," (Net: ",I.yc(6,4,n.data.totalPayments),") ")}}function Ge(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th"),I.ed(2,"P&L"),I.gc(),I.hc(3,"td",26),I.ed(4),I.xc(5,"currency"),I.xc(6,"percentage"),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.hd(" ",I.yc(5,2,n.data.totalPayments/1.2-(n.data.totalEstMetalCost+n.data.totalEstLaborCost))," (",I.yc(6,4,(n.data.totalPayments/1.2-(n.data.totalEstMetalCost+n.data.totalEstLaborCost))/n.data.totalPayments)," ) ")}}function qe(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th",21),I.ed(2,"Date Sent:"),I.gc(),I.hc(3,"td"),I.ed(4),I.xc(5,"simpleDate"),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.gd(" ",I.yc(5,1,n.data.batch.dateSent)," ")}}function Ue(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th",21),I.ed(2,"Sent From:"),I.gc(),I.hc(3,"td"),I.ed(4),I.xc(5,"titlecase"),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.gd(" ",I.yc(5,1,n.data.batch.supplier.company)," ")}}function Ye(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th",21),I.ed(2,"Live time:"),I.gc(),I.hc(3,"td"),I.ed(4),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(4),I.gd(" ",n.liveTime," ")}}function Ve(t,e){if(1&t){var n=I.ic();I.hc(0,"button",27),I.sc("click",(function(){return I.Qc(n),I.wc(2).printAll("jobLabels",100)})),I.ed(1," Print Manufacture Labels "),I.gc()}if(2&t){var c=I.wc(2);I.Dc("disabled",c.state.printAll)}}function Xe(t,e){if(1&t){var n=I.ic();I.hc(0,"button",27),I.sc("click",(function(){return I.Qc(n),I.wc(2).printAll("idLabels",29)})),I.ed(1," Print ID Labels "),I.gc()}if(2&t){var c=I.wc(2);I.Dc("disabled",c.state.printAll)}}function Ke(t,e){if(1&t){var n=I.ic();I.hc(0,"button",28),I.sc("click",(function(){return I.Qc(n),I.wc(2).exportAddressData()})),I.ed(1," Export Addresses "),I.gc()}}function Ze(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",53),I.ed(4,"Silver"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",54),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._silverBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._silverBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function tn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",55),I.ed(4,"9ct Yellow Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",56),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._9ctYellowGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._9ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function en(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",57),I.ed(4,"9ct Rose Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",58),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._9ctRoseGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._9ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function nn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",59),I.ed(4,"9ct White Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",60),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._9ctWhiteGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._9ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function cn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",61),I.ed(4,"14ct Yellow Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",62),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._14ctYellowGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._14ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function on(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",63),I.ed(4,"14ct Rose Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",64),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._14ctRoseGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._14ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function an(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",65),I.ed(4,"14ct White Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",66),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._14ctWhiteGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._14ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function sn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",34),I.hc(3,"label",67),I.ed(4,"18ct Yellow Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",68),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._18ctYellowGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._18ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function dn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",69),I.ed(4,"18ct Rose Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",70),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._18ctRoseGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._18ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ln(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",71),I.ed(4,"18ct White Gold"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",72),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._18ctWhiteGoldBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._18ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function rn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",11),I.hc(1,"div",14),I.hc(2,"div",44),I.hc(3,"label",73),I.ed(4,"Platinum"),I.gc(),I.hc(5,"div",46),I.hc(6,"div",47),I.hc(7,"div",48),I.ed(8,"\xa3"),I.gc(),I.gc(),I.hc(9,"input",74),I.sc("ngModelChange",(function(t){I.Qc(n);var e=I.wc(4);return e.metalsInBatch[e._platinumBaseMetalName].actualCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(4);I.Nb(9),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.metalsInBatch[c._platinumBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function un(t,e){if(1&t){var n=I.ic();I.fc(0),I.hc(1,"div",11),I.hc(2,"div",14),I.hc(3,"div",44),I.hc(4,"label",45),I.ed(5,"Labour"),I.gc(),I.hc(6,"div",46),I.hc(7,"div",47),I.hc(8,"div",48),I.ed(9,"\xa3"),I.gc(),I.gc(),I.hc(10,"input",49),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(3).model.labourCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.cd(11,Ze,10,3,"div",50),I.cd(12,tn,10,3,"div",50),I.cd(13,en,10,3,"div",50),I.cd(14,nn,10,3,"div",50),I.cd(15,cn,10,3,"div",50),I.cd(16,on,10,3,"div",50),I.cd(17,an,10,3,"div",50),I.cd(18,sn,10,3,"div",50),I.cd(19,dn,10,3,"div",50),I.cd(20,ln,10,3,"div",50),I.cd(21,rn,10,3,"div",50),I.hc(22,"div",11),I.hc(23,"div",14),I.hc(24,"div",44),I.hc(25,"label",51),I.ed(26,"Delivery Cost"),I.gc(),I.hc(27,"div",46),I.hc(28,"div",47),I.hc(29,"div",48),I.ed(30,"\xa3"),I.gc(),I.gc(),I.hc(31,"input",52),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(3).model.deliveryCostStaging=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.ec()}if(2&t){var c=I.wc(3);I.Nb(10),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.model.labourCostStaging)("decimalPlaces",2),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._silverBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._9ctYellowGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._9ctRoseGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._9ctWhiteGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._14ctYellowGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._14ctRoseGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._14ctWhiteGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._18ctYellowGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._18ctRoseGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._18ctWhiteGoldBaseMetalName].present),I.Nb(1),I.Dc("ngIf",c.metalsInBatch[c._platinumBaseMetalName].present),I.Nb(10),I.Dc("disabled",c.data.batch.journalReference)("ngModel",c.model.deliveryCostStaging)("decimalPlaces",2)}}function gn(t,e){1&t&&(I.hc(0,"span"),I.ed(1,"Save"),I.gc())}function hn(t,e){1&t&&I.cc(0,"span",75)}function bn(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th"),I.ed(2),I.gc(),I.hc(3,"td"),I.ed(4),I.xc(5,"number"),I.gc(),I.hc(6,"td"),I.ed(7),I.xc(8,"number"),I.gc(),I.hc(9,"td"),I.ed(10),I.xc(11,"number"),I.gc(),I.gc()),2&t){var n=I.wc().$implicit,c=I.wc(4);I.Nb(2),I.fd(n),I.Nb(2),I.fd(I.zc(5,8,c.metalsInBatch[n].estimateCost/100,"1.2-2")),I.Nb(3),I.fd(I.zc(8,11,c.metalsInBatch[n].actualCostExisting,"1.2-2")),I.Nb(2),I.Tb("color-danger",c.metalsInBatch[n].estimateCost/100-c.metalsInBatch[n].actualCostExisting<0)("color-success",c.metalsInBatch[n].estimateCost/100-c.metalsInBatch[n].actualCostExisting>=0),I.Nb(1),I.fd(I.zc(11,14,c.metalsInBatch[n].estimateCost/100-c.metalsInBatch[n].actualCostExisting,"1.2-2"))}}function mn(t,e){if(1&t&&(I.fc(0),I.cd(1,bn,12,17,"tr",20),I.ec()),2&t){var n=e.$implicit,c=I.wc(4);I.Nb(1),I.Dc("ngIf",c.metalsInBatch[n].present)}}function pn(t,e){1&t&&(I.hc(0,"span"),I.ed(1,"Post Journal to Xero"),I.gc())}function fn(t,e){1&t&&I.cc(0,"span",75)}function vn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",14),I.hc(1,"button",80),I.sc("click",(function(t){return I.Qc(n),I.wc(4).postJournalToXero(t)})),I.cd(2,pn,2,0,"span",20),I.cd(3,fn,1,0,"span",42),I.gc(),I.gc()}if(2&t){I.wc(2);var c=I.Nc(9),i=I.wc(2);I.Nb(1),I.Dc("disabled",!i.data.batch.invoiced||!c.pristine),I.Nb(1),I.Dc("ngIf",!i.state.postingJournal),I.Nb(1),I.Dc("ngIf",i.state.postingJournal)}}function Sn(t,e){if(1&t&&(I.hc(0,"div",14),I.hc(1,"p",81),I.ed(2),I.xc(3,"simpleDate"),I.gc(),I.hc(4,"p",81),I.hc(5,"i"),I.ed(6,"Reference: "),I.hc(7,"a",82),I.ed(8),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(4);I.Nb(2),I.gd(" Journal posted at ",I.yc(3,3,n.data.batch.journalPostedAt)," "),I.Nb(5),I.Fc("href","https://go.xero.com/Journal/View.aspx?invoiceID=",null==n.data.batch?null:n.data.batch.journalReference,"",I.Tc),I.Nb(1),I.gd(" ",n.data.batch.journalReference?n.data.batch.journalReference:"n/a"," ")}}function yn(t,e){if(1&t&&(I.hc(0,"div",76),I.hc(1,"div",15),I.hc(2,"div",16),I.hc(3,"h6"),I.ed(4,"Cost Analysis"),I.gc(),I.gc(),I.hc(5,"div",17),I.hc(6,"p"),I.hc(7,"strong"),I.ed(8,"Invoice Costs"),I.gc(),I.gc(),I.hc(9,"table",77),I.hc(10,"thead"),I.hc(11,"tr"),I.cc(12,"th"),I.hc(13,"th"),I.ed(14,"EST"),I.gc(),I.hc(15,"th"),I.ed(16,"ACT"),I.gc(),I.hc(17,"th"),I.ed(18,"DIFF"),I.gc(),I.gc(),I.gc(),I.hc(19,"tbody"),I.hc(20,"tr"),I.hc(21,"th"),I.ed(22,"Labour"),I.gc(),I.hc(23,"td"),I.ed(24),I.xc(25,"number"),I.gc(),I.hc(26,"td"),I.ed(27),I.xc(28,"number"),I.gc(),I.hc(29,"td"),I.ed(30),I.xc(31,"number"),I.gc(),I.gc(),I.cd(32,mn,2,1,"ng-container",4),I.hc(33,"tr"),I.cc(34,"td"),I.hc(35,"td"),I.hc(36,"strong"),I.ed(37),I.xc(38,"number"),I.gc(),I.gc(),I.hc(39,"td"),I.hc(40,"strong"),I.ed(41),I.xc(42,"number"),I.gc(),I.gc(),I.hc(43,"td"),I.hc(44,"strong"),I.ed(45),I.xc(46,"number"),I.gc(),I.gc(),I.gc(),I.hc(47,"tr"),I.hc(48,"th"),I.ed(49,"Delivery"),I.gc(),I.hc(50,"td"),I.hc(51,"span",78),I.ed(52),I.gc(),I.gc(),I.hc(53,"td"),I.ed(54),I.xc(55,"number"),I.gc(),I.hc(56,"td"),I.ed(57),I.xc(58,"number"),I.gc(),I.gc(),I.hc(59,"tr"),I.cc(60,"td"),I.hc(61,"td"),I.hc(62,"strong"),I.ed(63),I.xc(64,"number"),I.gc(),I.gc(),I.hc(65,"td"),I.hc(66,"strong"),I.ed(67),I.xc(68,"number"),I.gc(),I.gc(),I.hc(69,"td"),I.hc(70,"strong"),I.ed(71),I.xc(72,"number"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(73,"div",11),I.cd(74,vn,4,3,"div",79),I.cd(75,Sn,9,5,"div",79),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(24),I.fd(I.zc(25,27,n.data.totalEstLaborCost/100,"1.2-2")),I.Nb(3),I.fd(I.zc(28,30,n.model.labourCostExisting,"1.2-2")),I.Nb(2),I.Tb("color-danger",n.data.totalEstLaborCost/100-n.model.labourCostExisting<0)("color-success",n.data.totalEstLaborCost/100-n.model.labourCostExisting>=0),I.Nb(1),I.fd(I.zc(31,33,n.data.totalEstLaborCost/100-n.model.labourCostExisting,"1.2-2")),I.Nb(2),I.Dc("ngForOf",n.objectKeys(n.metalsInBatch)),I.Nb(5),I.fd(I.zc(38,36,n.data.totalEstimatedCost/100,"1.2-2")),I.Nb(4),I.fd(I.zc(42,39,n.data.totalActualCost-n.model.deliveryCostExisting,"1.2-2")),I.Nb(2),I.Tb("color-danger",n.data.totalEstimatedCost/100-(n.data.totalActualCost-n.model.deliveryCostExisting)<0)("color-success",n.data.totalEstimatedCost/100-(n.data.totalActualCost-n.model.deliveryCostExisting)>=0),I.Nb(2),I.fd(I.zc(46,42,n.data.totalEstimatedCost/100-(n.data.totalActualCost-n.model.deliveryCostExisting),"1.2-2")),I.Nb(7),I.fd(n.data.anticipatedPostageCost),I.Nb(2),I.fd(I.zc(55,45,n.model.deliveryCostExisting,"1.2-2")),I.Nb(3),I.fd(I.zc(58,48,n.data.anticipatedPostageCost-n.model.deliveryCostExisting,"1.2-2")),I.Nb(6),I.fd(I.zc(64,51,n.data.totalEstimatedCost/100+n.data.anticipatedPostageCost,"1.2-2")),I.Nb(4),I.fd(I.zc(68,54,n.data.totalActualCost,"1.2-2")),I.Nb(2),I.Tb("color-danger",n.data.totalEstimatedCost/100+n.data.anticipatedPostageCost-n.data.totalActualCost<0)("color-success",n.data.totalEstimatedCost/100+n.data.anticipatedPostageCost-n.data.totalActualCost>=0),I.Nb(2),I.fd(I.zc(72,57,n.data.totalEstimatedCost/100+n.data.anticipatedPostageCost-n.data.totalActualCost,"1.2-2")),I.Nb(3),I.Dc("ngIf",!n.data.batch.journalReference),I.Nb(1),I.Dc("ngIf",n.data.batch.journalReference)}}function Cn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",29),I.hc(1,"div",13),I.hc(2,"div",30),I.hc(3,"div",15),I.hc(4,"div",16),I.hc(5,"h6"),I.ed(6,"Invoicing Details"),I.gc(),I.gc(),I.hc(7,"div",17),I.hc(8,"form",31,32),I.sc("ngSubmit",(function(){return I.Qc(n),I.wc(2).onSubmit()})),I.hc(10,"div",33),I.hc(11,"div",14),I.hc(12,"div",34),I.hc(13,"label",35),I.ed(14,"Invoice / Advice"),I.gc(),I.hc(15,"input",36),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.invoice=t})),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(16,"h6"),I.ed(17,"Invoice Costs"),I.gc(),I.hc(18,"div",11),I.hc(19,"div",14),I.hc(20,"div",37),I.hc(21,"input",38),I.sc("ngModelChange",(function(t){return I.Qc(n),I.wc(2).model.invoiced=t})),I.gc(),I.hc(22,"label",39),I.ed(23,"Invoice Received"),I.gc(),I.gc(),I.gc(),I.gc(),I.cd(24,un,32,17,"ng-container",20),I.hc(25,"div",40),I.hc(26,"div",14),I.hc(27,"button",41),I.cd(28,gn,2,0,"span",20),I.cd(29,hn,1,0,"span",42),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.cd(30,yn,76,60,"div",43),I.gc(),I.gc()}if(2&t){var c=I.Nc(9),i=I.wc(2);I.Nb(15),I.Dc("ngModel",i.model.invoice)("disabled",i.data.batch.journalReference),I.Nb(6),I.Dc("disabled",i.data.batch.journalReference)("ngModel",i.model.invoiced),I.Nb(3),I.Dc("ngIf",i.model.invoiced),I.Nb(3),I.Dc("disabled",!c.valid||i.state.submitting||c.pristine||i.data.batch.journalReference),I.Nb(1),I.Dc("ngIf",!i.state.submitting),I.Nb(1),I.Dc("ngIf",i.state.submitting),I.Nb(1),I.Dc("ngIf",i.state.isAdmin&&i.data.incomingBatch)}}function In(t,e){if(1&t&&(I.hc(0,"div",10),I.hc(1,"div",11),I.hc(2,"div",12),I.hc(3,"div",13),I.hc(4,"div",14),I.hc(5,"div",15),I.hc(6,"div",16),I.hc(7,"h6"),I.ed(8,"Batch Information"),I.gc(),I.gc(),I.hc(9,"div",17),I.hc(10,"h6"),I.ed(11,"Make Up"),I.gc(),I.hc(12,"div",11),I.cc(13,"div",18),I.hc(14,"div",19),I.hc(15,"div",11),I.hc(16,"div",14),I.ed(17),I.cc(18,"br"),I.ed(19),I.cc(20,"br"),I.ed(21),I.cc(22,"br"),I.ed(23),I.gc(),I.gc(),I.cc(24,"hr"),I.hc(25,"div",11),I.hc(26,"div",14),I.hc(27,"table"),I.hc(28,"tbody"),I.cd(29,$e,8,9,"tr",20),I.cd(30,We,7,6,"tr",20),I.cd(31,Ge,7,6,"tr",20),I.hc(32,"tr"),I.hc(33,"th",21),I.ed(34,"Created:"),I.gc(),I.hc(35,"td"),I.ed(36),I.xc(37,"simpleDate"),I.gc(),I.gc(),I.cd(38,qe,6,3,"tr",20),I.cd(39,Ue,6,3,"tr",20),I.cd(40,Ye,5,1,"tr",20),I.hc(41,"tr",22),I.hc(42,"th",21),I.ed(43,"Batch Status"),I.gc(),I.hc(44,"td"),I.xc(45,"lowercaseDashes"),I.hc(46,"span"),I.ed(47),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(48,"div",13),I.hc(49,"div",14),I.hc(50,"div",15),I.hc(51,"div",16),I.hc(52,"h6"),I.ed(53,"Actions"),I.gc(),I.gc(),I.hc(54,"div",17),I.cd(55,Ve,2,1,"button",23),I.cd(56,Xe,2,1,"button",23),I.cd(57,Ke,2,0,"button",24),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.cd(58,Cn,31,9,"div",25),I.gc(),I.gc()),2&t){var n=I.wc();I.Nb(17),I.gd(" Total: ",n.data.jobCount,""),I.Nb(2),I.gd(" Ring: ",n.data.ringCount,""),I.Nb(2),I.gd(" Pendant: ",n.data.pendantCount,""),I.Nb(2),I.gd(" Earring: ",n.data.earringCount," "),I.Nb(6),I.Dc("ngIf",n.state.isAdmin),I.Nb(1),I.Dc("ngIf",n.state.isAdmin),I.Nb(1),I.Dc("ngIf",n.state.isAdmin),I.Nb(5),I.gd(" ",I.yc(37,19,n.data.batch.createdAt)," "),I.Nb(2),I.Dc("ngIf",n.data.batch.dateSent),I.Nb(1),I.Dc("ngIf",n.state.isAdmin),I.Nb(1),I.Dc("ngIf",n.state.isAdmin),I.Nb(4),I.Qb("status-pill status-",I.yc(45,21,n.data.batch.status.name),""),I.Nb(3),I.fd(n.data.batch.status.name),I.Nb(8),I.Dc("ngIf",!n.state.loading&&n.state.isAdmin),I.Nb(1),I.Dc("ngIf",!n.state.loading&&n.state.isAdmin),I.Nb(1),I.Dc("ngIf",!n.state.loading&&n.state.isAdmin),I.Nb(1),I.Dc("ngIf",n.data.incomingBatch)}}function Nn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",97),I.hc(1,"input",98),I.sc("click",(function(){return I.Qc(n),I.wc(3).selectAll()}))("ngModelChange",(function(t){return I.Qc(n),I.wc(3).state.allSelected=t})),I.gc(),I.cc(2,"label",99),I.gc()}if(2&t){var c=I.wc(3);I.Nb(1),I.Dc("ngModel",c.state.allSelected)("value",c.state.allSelected)}}function wn(t,e){if(1&t&&(I.hc(0,"th",95),I.cd(1,Nn,3,2,"div",96),I.gc()),2&t){var n=I.wc(2);I.Nb(1),I.Dc("ngIf",!n.state.loading)}}function jn(t,e){1&t&&(I.hc(0,"th",100),I.ed(1,"Due By"),I.gc())}function An(t,e){1&t&&(I.hc(0,"th",89),I.ed(1,"Metal Weight"),I.gc())}function xn(t,e){1&t&&(I.hc(0,"th",89),I.ed(1,"Est Cost (\xa3)"),I.gc())}function Dn(t,e){1&t&&(I.hc(0,"th",89),I.ed(1,"Paid (\xa3)"),I.gc())}function Mn(t,e){if(1&t){var n=I.ic();I.hc(0,"th",117),I.hc(1,"div",97),I.hc(2,"input",118),I.sc("click",(function(){I.Qc(n);var t=I.wc().$implicit;return I.wc(2).selectRow(t)}))("ngModelChange",(function(t){return I.Qc(n),I.wc().$implicit.selected=t})),I.gc(),I.cc(3,"label",119),I.gc(),I.gc()}if(2&t){var c=I.wc().$implicit;I.Nb(2),I.Fc("id","sub-cb-",c.submission.id,""),I.Dc("ngModel",c.selected)("name","submission"+c.submission.id),I.Nb(1),I.Fc("for","sub-cb-",c.submission.id,"")}}var Pn=function(){return[20]};function Tn(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"truncate"),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.fd(I.zc(2,1,n.submission.customer.event.name,I.Hc(4,Pn)))}}function Bn(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.fd(n.submission.castingCode)}}function kn(t,e){1&t&&I.cc(0,"span",122),2&t&&I.Dc("ngbTooltip","Rush")}function On(t,e){1&t&&I.cc(0,"span",123),2&t&&I.Dc("ngbTooltip","Standard")}function En(t,e){if(1&t&&(I.fc(0),I.cd(1,kn,1,1,"span",120),I.cd(2,On,1,1,"span",121),I.ec()),2&t){var n=I.wc().$implicit;I.Nb(1),I.Dc("ngIf",n.job.rush),I.Nb(1),I.Dc("ngIf",!n.job.rush)}}function Rn(t,e){1&t&&I.cc(0,"span",124)}function Jn(t,e){if(1&t){var n=I.ic();I.hc(0,"td"),I.hc(1,"input",125),I.sc("ngModelChange",(function(){I.Qc(n);var t=I.wc().$implicit;return I.wc(2).updateJob(t)}))("ngModelChange",(function(t){return I.Qc(n),I.wc().$implicit.job.due=t})),I.gc(),I.cc(2,"owl-date-time",126,127),I.gc()}if(2&t){var c=I.Nc(3),i=I.wc().$implicit;I.Nb(1),I.Tb("is-invalid",i.job.due>(null==i.submission?null:i.submission.specialDate)&&i.job.due>(null==i.submission?null:i.submission.hardDeadline)),I.Dc("ngModel",i.job.due)("owlDateTimeTrigger",c)("owlDateTime",c)("max",null==i.submission?null:i.submission.specialDate),I.Nb(1),I.Dc("pickerType","calendar")}}function Fn(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"simpleDate"),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.gd(" ",n.job.due?I.yc(2,1,n.job.due):""," ")}}function _n(t,e){if(1&t){var n=I.ic();I.hc(0,"td"),I.hc(1,"input",128),I.sc("blur",(function(){I.Qc(n);var t=I.wc().$implicit;return I.wc(2).updateSubmission(t)}))("ngModelChange",(function(t){return I.Qc(n),I.wc().$implicit.submission.metalWeight=t})),I.gc(),I.gc()}if(2&t){var c=I.wc().$implicit;I.Nb(1),I.Dc("ngModel",c.submission.metalWeight)}}function zn(t,e){if(1&t&&(I.hc(0,"span",130),I.ed(1),I.xc(2,"currency"),I.xc(3,"currency"),I.gc()),2&t){var n=I.wc(2).$implicit;I.Nb(1),I.hd(" (",I.yc(2,2,n.jobLabourCostEst)," + ",I.yc(3,4,n.jobMetalCostEst),") ")}}function Qn(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"currency"),I.cc(3,"br"),I.cd(4,zn,4,6,"span",129),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.gd(" ",n.jobTotalCostEst?I.yc(2,2,n.jobTotalCostEst):"",""),I.Nb(3),I.Dc("ngIf",n.jobTotalCostEst)}}function Hn(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"currency"),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.gd(" ",n.jobPayments>0?I.yc(2,1,n.jobPayments):""," ")}}function Ln(t,e){if(1&t){var n=I.ic();I.hc(0,"button",131),I.sc("click",(function(){I.Qc(n);var t=I.wc().$implicit,e=I.wc(2),c=I.Nc(9);return e.viewJobActionModal(t,c)})),I.gc()}if(2&t){var c=I.wc(3);I.Dc("disabled",c.state.loadingActions||c.state.loadingJobActions)}}function $n(t,e){if(1&t){var n=I.ic();I.hc(0,"button",132),I.sc("click",(function(){I.Qc(n);var t=I.wc().$implicit,e=I.wc(2),c=I.Nc(11);return e.viewJobCostsModal(t,c)})),I.gc()}}function Wn(t,e){1&t&&I.cc(0,"span",75)}function Gn(t,e){if(1&t){var n=I.ic();I.hc(0,"button",133),I.sc("click",(function(){I.Qc(n);var t=I.wc().$implicit;return I.wc(2).createPdf(t)})),I.cd(1,Wn,1,0,"span",42),I.gc()}if(2&t){var c=I.wc().$implicit,i=I.wc(2);I.Tb("fa-print",!c.printing),I.Dc("disabled",i.state.loadingStones&&i.state.loadingJobActions||c.printing),I.Nb(1),I.Dc("ngIf",c.printing)}}function qn(t,e){1&t&&I.cc(0,"span",136)}function Un(t,e){if(1&t){var n=I.ic();I.hc(0,"button",134),I.sc("click",(function(){I.Qc(n);var t=I.wc().$implicit;return I.wc(2).toggleSubmissionPhotoTimer(t.submission.id)})),I.cd(1,qn,1,0,"span",135),I.gc()}if(2&t){var c=I.wc().$implicit,i=I.wc(2);I.Tb("fa-camera",!i.data.submissionPhotoTimingMap[c.submission.id]&&!1===i.state.submitting)("fa-stop",i.data.submissionPhotoTimingMap[c.submission.id]&&!1===i.state.submitting)("hover",!i.data.submissionPhotoTimingMap[c.submission.id]),I.Dc("disabled",i.state.submitting),I.Nb(1),I.Dc("ngIf",!0===i.state.submitting)}}function Yn(t,e){if(1&t){var n=I.ic();I.hc(0,"button",137),I.sc("click",(function(){I.Qc(n);var t=I.wc().$implicit;return I.wc(2).deleteJob(t)})),I.gc()}}function Vn(t,e){if(1&t&&I.cc(0,"view-submission-modal",138),2&t){var n=I.wc().$implicit,c=I.wc(2);I.Dc("buttonStyle",!0)("isAdmin",c.state.isAdmin)("loadingStones",c.state.loadingStones)("photos",n.submission.submissionPhotos.edges)("stones",n.stones)("submission",n.submission)}}function Xn(t,e){if(1&t&&(I.hc(0,"span"),I.ed(1),I.xc(2,"date"),I.gc()),2&t){var n=I.wc(3);I.Nb(1),I.gd(" Elapsed: ",I.Ac(2,1,1e3*n.timeElapsed,"mm:ss","UTC"),"s \xa0 ")}}function Kn(t,e){if(1&t){var n=I.ic();I.fc(0),I.hc(1,"tr"),I.xc(2,"lowercaseDashes"),I.cd(3,Mn,4,4,"th",101),I.hc(4,"th",102),I.cc(5,"view-submission-photos-modal",103),I.gc(),I.hc(6,"td",104),I.ed(7),I.xc(8,"numericId"),I.gc(),I.hc(9,"td",105),I.ed(10),I.xc(11,"numericId"),I.gc(),I.hc(12,"td"),I.ed(13),I.gc(),I.cd(14,Tn,3,5,"td",20),I.cd(15,Bn,2,1,"td",20),I.hc(16,"td",106),I.sc("click",(function(t){I.Qc(n);var c=e.$implicit;return I.wc(2).setRush(c,t)})),I.cd(17,En,3,2,"ng-container",20),I.cd(18,Rn,1,0,"span",107),I.gc(),I.cd(19,Jn,4,7,"td",20),I.cd(20,Fn,3,3,"td",20),I.hc(21,"td"),I.ed(22),I.xc(23,"titlecase"),I.gc(),I.hc(24,"td"),I.ed(25),I.xc(26,"number"),I.gc(),I.cd(27,_n,2,1,"td",20),I.cd(28,Qn,5,4,"td",20),I.cd(29,Hn,3,3,"td",20),I.hc(30,"td"),I.xc(31,"lowercaseDashes"),I.hc(32,"span"),I.ed(33),I.xc(34,"titlecase"),I.gc(),I.gc(),I.hc(35,"td",108),I.hc(36,"div",109),I.cd(37,Ln,1,1,"button",110),I.cd(38,$n,1,0,"button",111),I.cd(39,Gn,2,4,"button",112),I.cd(40,Un,2,8,"button",113),I.cd(41,Yn,1,0,"button",114),I.cc(42,"view-submission-comms-modal",115),I.gc(),I.cd(43,Vn,1,6,"view-submission-modal",116),I.cd(44,Xn,3,5,"span",20),I.gc(),I.gc(),I.ec()}if(2&t){var c=e.$implicit,i=I.wc(2);I.Nb(1),I.Qb("status-",I.yc(2,38,c.submission.status.name)," sm"),I.Tb("row-blocked",!i.data.submissionPhotoTimingMap[c.submission.id]&&!0===i.imageLoggingSessionState),I.Nb(2),I.Dc("ngIf",i.state.isAdmin),I.Nb(2),I.Dc("photos",c.submission.submissionPhotos.edges),I.Nb(2),I.fd(I.yc(8,40,c.job.id)),I.Nb(3),I.fd(I.yc(11,42,c.submission.id)),I.Nb(3),I.fd(c.submission.customer.fullName),I.Nb(1),I.Dc("ngIf",c.submission.customer.event),I.Nb(1),I.Dc("ngIf",c.submission.castingCode),I.Nb(2),I.Dc("ngIf",!c.pendingUpdateJob),I.Nb(1),I.Dc("ngIf",c.pendingUpdateJob),I.Nb(1),I.Dc("ngIf",i.state.isAdmin&&i.data.outgoingBatch),I.Nb(1),I.Dc("ngIf",!i.state.isAdmin&&i.data.outgoingBatch),I.Nb(2),I.fd(I.yc(23,44,c.submission.jewelleryType.name)),I.Nb(3),I.fd(I.zc(26,46,c.submission.waxWeight,"0.2-4")),I.Nb(2),I.Dc("ngIf",i.data.incomingBatch),I.Nb(1),I.Dc("ngIf",i.state.isAdmin),I.Nb(1),I.Dc("ngIf",i.state.isAdmin),I.Nb(1),I.Qb("status-",I.yc(31,49,c.submission.status.name)," status-pill"),I.Nb(3),I.fd(I.yc(34,51,c.submission.status.name)),I.Nb(4),I.Dc("ngIf",i.state.isAdmin&&!1===i.imageLoggingSessionState),I.Nb(1),I.Dc("ngIf",i.state.isAdmin&&!1===i.imageLoggingSessionState),I.Nb(1),I.Dc("ngIf",!1===i.imageLoggingSessionState),I.Nb(1),I.Dc("ngIf",(!1===i.imageLoggingSessionState||i.data.submissionPhotoTimingMap[c.submission.id])&&i.state.isAdmin),I.Nb(1),I.Dc("ngIf",i.state.isAdmin&&!1===i.imageLoggingSessionState),I.Nb(1),I.Dc("customerNote",c.submission.customerNotes)("hover",!0)("isAdmin",i.state.isAdmin)("loadingNotes",i.state.loadingNotes)("notes",c.notes)("submissionId",c.submission.id),I.Nb(1),I.Dc("ngIf",!1===i.imageLoggingSessionState),I.Nb(1),I.Dc("ngIf",i.data.submissionPhotoTimingMap[c.submission.id])}}function Zn(t,e){if(1&t){var n=I.ic();I.hc(0,"div",139),I.hc(1,"button",140),I.sc("click",(function(){I.Qc(n);var t=I.wc(2);return t.updateStatus(t.statusInProduction)})),I.ed(2),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(1),I.Dc("disabled",c.state.nextStatus.manuallyConfirmAll&&c.data.selections.length!==c.data.submissionInfos.length||c.state.submitting),I.Nb(1),I.gd(" ",c.state.nextStatus.buttonText," ")}}function tc(t,e){1&t&&(I.hc(0,"div",141),I.cc(1,"loading-ring",142),I.gc()),2&t&&(I.Nb(1),I.Dc("size",60))}function ec(t,e){if(1&t&&(I.hc(0,"div",83),I.hc(1,"div",14),I.hc(2,"h5",84),I.ed(3,"Items in Batch"),I.gc(),I.hc(4,"div",85),I.hc(5,"table",86),I.hc(6,"thead"),I.hc(7,"tr"),I.cd(8,wn,2,1,"th",87),I.cc(9,"th",88),I.hc(10,"th",88),I.ed(11,"JID"),I.gc(),I.hc(12,"th",88),I.ed(13,"SID"),I.gc(),I.hc(14,"th",89),I.ed(15,"Customer"),I.gc(),I.hc(16,"th",89),I.ed(17,"Source"),I.gc(),I.cc(18,"th",88),I.cd(19,jn,2,0,"th",90),I.hc(20,"th",89),I.ed(21,"Type"),I.gc(),I.hc(22,"th",89),I.ed(23,"Wax (g)"),I.gc(),I.cd(24,An,2,0,"th",91),I.cd(25,xn,2,0,"th",91),I.cd(26,Dn,2,0,"th",91),I.hc(27,"th",89),I.ed(28,"Status"),I.gc(),I.cc(29,"th",89),I.gc(),I.gc(),I.hc(30,"tbody"),I.cd(31,Kn,45,53,"ng-container",4),I.gc(),I.hc(32,"tfoot"),I.hc(33,"tr"),I.cc(34,"th",92),I.gc(),I.gc(),I.gc(),I.cd(35,Zn,3,2,"div",93),I.cd(36,tc,2,1,"div",94),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc();I.Nb(8),I.Dc("ngIf",n.state.isAdmin),I.Nb(11),I.Dc("ngIf",n.data.outgoingBatch),I.Nb(5),I.Dc("ngIf",n.data.incomingBatch),I.Nb(1),I.Dc("ngIf",n.state.isAdmin),I.Nb(1),I.Dc("ngIf",n.state.isAdmin),I.Nb(5),I.Dc("ngForOf",n.data.submissionInfos),I.Nb(4),I.Dc("ngIf",!n.state.loading&&n.state.nextStatus&&n.data.submissionInfos.length&&(!n.state.nextStatus.adminOnly||n.state.isAdmin)),I.Nb(1),I.Dc("ngIf",n.state.loading)}}function nc(t,e){1&t&&I.cc(0,"i",161),2&t&&I.Dc("ngbTooltip","Rush")}function cc(t,e){if(1&t&&(I.hc(0,"td",155),I.ed(1),I.gc()),2&t){var n=I.wc(2).$implicit;I.Dc("colSpan",100),I.Nb(1),I.gd("Kit - ",n.submission.castingCode,"")}}var ic=function(){return[20,".."]};function oc(t,e){if(1&t&&(I.hc(0,"td",155),I.ed(1),I.xc(2,"truncate"),I.gc()),2&t){var n=I.wc(2).$implicit,c=I.wc();I.Dc("colSpan",100),I.Nb(1),I.hd(" ",n.submission.customer.event.eventType.name===c.eventTypeWedding?"WEDDING ":""," ",I.zc(2,3,n.submission.customer.event.name,I.Hc(6,ic))," ")}}function ac(t,e){1&t&&(I.hc(0,"td",155),I.ed(1," Other "),I.gc()),2&t&&I.Dc("colSpan",100)}function sc(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"td"),I.ed(2,"Deadline"),I.gc(),I.hc(3,"td",155),I.ed(4),I.xc(5,"simpleDate"),I.xc(6,"simpleDate"),I.gc(),I.gc()),2&t){var n=I.wc(2).$implicit;I.Nb(3),I.Dc("colSpan",100),I.Nb(1),I.gd(" ",n.submission.hardDeadline>n.job.due?I.yc(5,2,n.job.due):I.yc(6,4,n.submission.hardDeadline)," ")}}function dc(t,e){if(1&t&&(I.fc(0),I.ed(1),I.xc(2,"uppercase"),I.ec()),2&t){var n=I.wc(4).$implicit;I.Nb(1),I.gd(" - ",I.yc(2,1,n.submission.measuredRingSize.name)," ")}}function lc(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"titlecase"),I.cd(3,dc,3,3,"ng-container",20),I.gc()),2&t){var n=I.wc(3).$implicit,c=I.wc();I.Nb(1),I.gd(" ",I.yc(2,2,n.submission.ringSizeCustom.name)," "),I.Nb(2),I.Dc("ngIf",n.submission.measuredRingSize&&n.submission.ringSizeCustom.name===c.ringSizeLeaveAsIs)}}function rc(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"uppercase"),I.gc()),2&t){var n=I.wc(3).$implicit;I.Nb(1),I.fd(I.yc(2,1,n.submission.ringSizeCustom.name))}}var uc=function(){return[110,"[...]"]};function gc(t,e){if(1&t&&(I.hc(0,"table",154),I.hc(1,"tbody"),I.hc(2,"tr"),I.hc(3,"td"),I.ed(4,"Metal"),I.gc(),I.hc(5,"td"),I.ed(6),I.xc(7,"titlecase"),I.gc(),I.gc(),I.hc(8,"tr"),I.hc(9,"td"),I.ed(10,"Size"),I.gc(),I.cd(11,lc,4,4,"td",20),I.cd(12,rc,3,3,"td",20),I.gc(),I.hc(13,"tr"),I.hc(14,"td"),I.ed(15,"Finish"),I.gc(),I.hc(16,"td"),I.ed(17),I.xc(18,"titlecase"),I.gc(),I.gc(),I.hc(19,"tr"),I.hc(20,"td"),I.ed(21,"Plating"),I.gc(),I.hc(22,"td"),I.ed(23),I.xc(24,"titlecase"),I.gc(),I.gc(),I.hc(25,"tr",162),I.hc(26,"td"),I.ed(27,"Notes"),I.gc(),I.hc(28,"td"),I.ed(29),I.xc(30,"truncate"),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2).$implicit,c=I.wc();I.Nb(2),I.Tb("invert",n.submission.baseMetal.name!==c.baseMetalSilver),I.Nb(4),I.fd(I.yc(7,8,n.submission.baseMetal.name)),I.Nb(5),I.Dc("ngIf",!n.submission.ringResize),I.Nb(1),I.Dc("ngIf",n.submission.ringResize),I.Nb(5),I.fd(I.yc(18,10,n.submission.finish.name)),I.Nb(6),I.fd(I.yc(24,12,n.submission.plating.name)),I.Nb(6),I.fd(n.submission.customerNotes?I.zc(30,14,n.submission.customerNotes,I.Hc(17,uc)):"-")}}function hc(t,e){1&t&&(I.hc(0,"td"),I.ed(1,"None"),I.gc())}function bc(t,e){1&t&&I.cc(0,"br")}function mc(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"titlecase"),I.xc(3,"titlecase"),I.cd(4,bc,1,0,"br",20),I.ed(5),I.xc(6,"titlecase"),I.gc()),2&t){var n=I.wc(3).$implicit;I.Nb(1),I.hd(" ",I.yc(2,4,n.submission.chainType.name)," - ",I.yc(3,6,n.submission.chainLength.name)," "),I.Nb(3),I.Dc("ngIf",n.submission.chainPlating),I.Nb(1),I.gd(" ",I.yc(6,8,n.submission.chainPlating.name)," ")}}var pc=function(){return[30,"[...]"]},fc=function(){return[90,"[...]"]};function vc(t,e){if(1&t&&(I.hc(0,"table",154),I.hc(1,"tbody"),I.hc(2,"tr"),I.hc(3,"td"),I.ed(4,"Metal"),I.gc(),I.hc(5,"td"),I.ed(6),I.xc(7,"titlecase"),I.gc(),I.gc(),I.hc(8,"tr"),I.hc(9,"td"),I.ed(10,"Finish"),I.gc(),I.hc(11,"td"),I.ed(12),I.xc(13,"titlecase"),I.gc(),I.gc(),I.hc(14,"tr"),I.hc(15,"td"),I.ed(16,"Plating"),I.gc(),I.hc(17,"td"),I.ed(18),I.xc(19,"titlecase"),I.gc(),I.gc(),I.hc(20,"tr"),I.hc(21,"td"),I.ed(22,"Jump Ring"),I.gc(),I.hc(23,"td"),I.ed(24),I.xc(25,"truncate"),I.gc(),I.gc(),I.hc(26,"tr"),I.hc(27,"td"),I.ed(28,"Chain"),I.gc(),I.cd(29,hc,2,0,"td",20),I.cd(30,mc,7,10,"td",20),I.gc(),I.hc(31,"tr",162),I.hc(32,"td"),I.ed(33,"Notes"),I.gc(),I.hc(34,"td"),I.ed(35),I.xc(36,"truncate"),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2).$implicit,c=I.wc();I.Nb(2),I.Tb("invert",n.submission.baseMetal.name!==c.baseMetalSilver),I.Nb(4),I.fd(I.yc(7,9,n.submission.baseMetal.name)),I.Nb(6),I.fd(I.yc(13,11,n.submission.finish.name)),I.Nb(6),I.fd(I.yc(19,13,n.submission.plating.name)),I.Nb(6),I.fd(n.submission.jumpRing?I.zc(25,15,n.submission.jumpRingPlacement,I.Hc(21,pc)):"None"),I.Nb(5),I.Dc("ngIf",!n.submission.chainType),I.Nb(1),I.Dc("ngIf",n.submission.chainType&&n.submission.chainLength),I.Nb(5),I.fd(n.submission.customerNotes?I.zc(36,18,n.submission.customerNotes,I.Hc(22,fc)):"-")}}var Sc=function(t){return[100,t]};function yc(t,e){if(1&t&&(I.hc(0,"table",154),I.hc(1,"tbody"),I.hc(2,"tr"),I.hc(3,"td"),I.ed(4,"Metal"),I.gc(),I.hc(5,"td"),I.ed(6),I.xc(7,"titlecase"),I.gc(),I.gc(),I.hc(8,"tr"),I.hc(9,"td"),I.ed(10,"Config"),I.gc(),I.hc(11,"td"),I.ed(12),I.xc(13,"titlecase"),I.gc(),I.gc(),I.hc(14,"tr"),I.hc(15,"td"),I.ed(16,"Finish"),I.gc(),I.hc(17,"td"),I.ed(18),I.xc(19,"titlecase"),I.gc(),I.gc(),I.hc(20,"tr"),I.hc(21,"td"),I.ed(22,"Plating"),I.gc(),I.hc(23,"td"),I.ed(24),I.gc(),I.gc(),I.hc(25,"tr",162),I.hc(26,"td"),I.ed(27,"Notes"),I.gc(),I.hc(28,"td"),I.ed(29),I.xc(30,"truncate"),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2).$implicit,c=I.wc();I.Nb(2),I.Tb("invert",n.submission.baseMetal.name!==c.baseMetalSilver),I.Nb(4),I.fd(I.yc(7,7,n.submission.baseMetal.name)),I.Nb(6),I.fd(I.yc(13,9,n.submission.earringConfig.name)),I.Nb(6),I.fd(I.yc(19,11,n.submission.finish.name)),I.Nb(6),I.fd(n.submission.plating.name),I.Nb(5),I.fd(n.submission.customerNotes?I.zc(30,13,n.submission.customerNotes,I.Ic(16,Sc,"[...]")):"-")}}function Cc(t,e){if(1&t&&(I.fc(0),I.hc(1,"table",154),I.hc(2,"tbody"),I.hc(3,"tr"),I.hc(4,"td"),I.ed(5,"Name"),I.gc(),I.hc(6,"td",155),I.cd(7,nc,1,1,"i",156),I.ed(8),I.gc(),I.gc(),I.hc(9,"tr"),I.hc(10,"td"),I.ed(11,"Type"),I.gc(),I.hc(12,"td"),I.ed(13),I.xc(14,"titlecase"),I.gc(),I.hc(15,"td"),I.ed(16),I.xc(17,"number"),I.gc(),I.hc(18,"td"),I.ed(19),I.xc(20,"numericId"),I.gc(),I.gc(),I.hc(21,"tr"),I.hc(22,"td"),I.ed(23,"Source"),I.gc(),I.cd(24,cc,2,2,"td",157),I.cd(25,oc,3,7,"td",157),I.cd(26,ac,2,1,"td",157),I.gc(),I.cd(27,sc,7,6,"tr",20),I.gc(),I.gc(),I.cd(28,gc,31,18,"table",158),I.cd(29,vc,37,23,"table",158),I.cd(30,yc,31,18,"table",158),I.hc(31,"div",159),I.hc(32,"div",160),I.hc(33,"div"),I.hc(34,"span"),I.ed(35,"BM"),I.gc(),I.gc(),I.gc(),I.hc(36,"div",160),I.hc(37,"div"),I.hc(38,"span"),I.ed(39,"PLA"),I.gc(),I.gc(),I.gc(),I.hc(40,"div",160),I.hc(41,"div"),I.hc(42,"span"),I.ed(43,"ENG"),I.gc(),I.gc(),I.gc(),I.hc(44,"div",160),I.hc(45,"div"),I.hc(46,"span"),I.ed(47,"HALM"),I.gc(),I.gc(),I.gc(),I.hc(48,"div",160),I.hc(49,"div"),I.hc(50,"span"),I.ed(51,"JR"),I.gc(),I.gc(),I.gc(),I.hc(52,"div",160),I.hc(53,"div"),I.hc(54,"span"),I.ed(55,"POST"),I.gc(),I.gc(),I.gc(),I.hc(56,"div",160),I.hc(57,"div"),I.hc(58,"span"),I.ed(59,"STN"),I.gc(),I.gc(),I.gc(),I.hc(60,"div",160),I.hc(61,"div"),I.hc(62,"span"),I.ed(63,"RZE"),I.gc(),I.gc(),I.gc(),I.hc(64,"div",160),I.hc(65,"div"),I.hc(66,"span"),I.ed(67,"RPR"),I.gc(),I.gc(),I.gc(),I.gc(),I.ec()),2&t){var n=I.wc().$implicit,c=I.wc();I.Nb(6),I.Dc("colSpan",100),I.Nb(1),I.Dc("ngIf",n.job.rush),I.Nb(1),I.gd(" ",n.submission.customer.fullName," "),I.Nb(5),I.fd(I.yc(14,31,n.submission.jewelleryType.name)),I.Nb(3),I.gd("",I.zc(17,33,n.submission.waxWeight,"1.2-2"),"g"),I.Nb(3),I.gd("#",I.yc(20,36,n.job.id),""),I.Nb(5),I.Dc("ngIf",n.submission.castingCode),I.Nb(1),I.Dc("ngIf",n.submission.customer.event),I.Nb(1),I.Dc("ngIf",!n.submission.customer.event&&!n.submission.castingCode),I.Nb(1),I.Dc("ngIf",null==n.submission?null:n.submission.hardDeadline),I.Nb(1),I.Dc("ngIf",n.submission.jewelleryType.name===c.jewelleryTypeRing),I.Nb(1),I.Dc("ngIf",n.submission.jewelleryType.name===c.jewelleryTypePendant),I.Nb(1),I.Dc("ngIf",n.submission.jewelleryType.name===c.jewelleryTypeEarring),I.Nb(2),I.Tb("off",n.submission.baseMetal.name===c.baseMetalSilver),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionPlating]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionEngraving]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionHallmarking]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionJumpRing]||null===n.jobActions[c.actionEarringPosts]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionEarringPosts]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionStoneSetting]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionResizing]),I.Nb(4),I.Tb("off",null===n.jobActions[c.actionRepairing])}}function Ic(t,e){if(1&t&&(I.fc(0),I.hc(1,"div",143),I.hc(2,"div",144),I.hc(3,"div",145),I.hc(4,"div",146),I.hc(5,"table",147),I.hc(6,"tr",148),I.hc(7,"th"),I.cc(8,"img",149),I.gc(),I.hc(9,"th",150),I.ed(10),I.xc(11,"numericId"),I.gc(),I.gc(),I.gc(),I.cd(12,Cc,68,38,"ng-container",20),I.cc(13,"ngx-barcode",151),I.hc(14,"p",152),I.ed(15),I.xc(16,"numericId"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.cc(17,"iframe",153),I.ec()),2&t){var n=e.$implicit,c=I.wc();I.Nb(1),I.Tb("pdfLabel",!(c.state.printAll||c.state.showToPrint&&c.state.showToPrint==="submission"+n.numericId||!c.state.showToPrint&&n.selected)),I.Dc("hidden",!(c.state.printAll||c.state.showToPrint&&c.state.showToPrint==="submission"+n.numericId||!c.state.showToPrint&&n.selected))("id","submission"+n.numericId),I.Nb(7),I.Dc("width",60),I.Nb(2),I.gd("Batch #",I.yc(11,13,c.data.batch.id),""),I.Nb(2),I.Dc("ngIf",!c.data.incomingBatch),I.Nb(1),I.Dc("bc-display-value",!1)("bc-element-type","svg")("bc-height",140)("bc-value",n.numericId)("bc-width",8),I.Nb(2),I.gd("Submission Ref #",I.yc(16,15,n.submission.id),"")}}function Nc(t,e){if(1&t&&(I.fc(0),I.ed(1),I.ec()),2&t){var n=I.wc().$implicit;I.Nb(1),I.gd(" ",n.submission.castingCode," - ")}}function wc(t,e){if(1&t&&(I.fc(0),I.ed(1),I.ec()),2&t){var n=I.wc().$implicit;I.Nb(1),I.gd(" ",n.submission.customer.event," - ")}}function jc(t,e){if(1&t&&(I.fc(0),I.hc(1,"div",163),I.hc(2,"div",145),I.hc(3,"div",164),I.hc(4,"table"),I.hc(5,"tbody"),I.hc(6,"tr"),I.hc(7,"td",165),I.cc(8,"ngx-barcode",151),I.gc(),I.hc(9,"td"),I.hc(10,"strong"),I.ed(11),I.gc(),I.cc(12,"br"),I.cd(13,Nc,2,1,"ng-container",20),I.cd(14,wc,2,1,"ng-container",20),I.ed(15),I.xc(16,"numericId"),I.cc(17,"br"),I.hc(18,"strong"),I.ed(19),I.gc(),I.ed(20),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.cc(21,"iframe",166),I.ec()),2&t){var n=e.$implicit;I.Nb(8),I.Dc("bc-display-value",!1)("bc-element-type","svg")("bc-height",100)("bc-value",n.numericId)("bc-width",2),I.Nb(3),I.fd(n.submission.customer.fullName),I.Nb(2),I.Dc("ngIf",n.submission.castingCode),I.Nb(1),I.Dc("ngIf",n.submission.customer.event),I.Nb(1),I.gd(" #",I.yc(16,11,n.submission.id),""),I.Nb(4),I.fd(n.submission.customer.postcode),I.Nb(1),I.gd(" - ",n.submission.customer.address1," ")}}function Ac(t,e){if(1&t){var n=I.ic();I.hc(0,"div",173),I.hc(1,"label",174),I.ed(2),I.gc(),I.hc(3,"input",175),I.sc("ngModelChange",(function(t){I.Qc(n);var c=e.$implicit;return I.wc(2).model.jobActions[c.key]=t})),I.gc(),I.gc()}if(2&t){var c=e.$implicit,i=I.wc(2);I.Nb(1),I.Dc("for","jobAction"+c.key),I.Nb(1),I.fd(c.key),I.Nb(1),I.Dc("ngModel",i.model.jobActions[c.key])("id","jobAction"+c.key)("name","jobAction"+c.key)}}function xc(t,e){if(1&t){var n=I.ic();I.cc(0,"modal-header",167),I.hc(1,"div",168),I.hc(2,"form",169,170),I.hc(4,"div",11),I.cd(5,Ac,4,5,"div",171),I.xc(6,"keyvalue"),I.gc(),I.gc(),I.gc(),I.hc(7,"modal-footer",172),I.sc("modalSaved",(function(){return I.Qc(n),I.wc().addJobActions()})),I.gc()}if(2&t){var c=e.$implicit,i=I.Nc(3),o=I.wc();I.Dc("modal",c),I.Nb(5),I.Dc("ngForOf",I.yc(6,5,o.model.jobActions)),I.Nb(2),I.Dc("form",i)("modal",c)("saveButtonName","Save")}}function Dc(t,e){if(1&t&&(I.fc(0),I.hc(1,"tr"),I.hc(2,"th"),I.ed(3),I.gc(),I.hc(4,"td"),I.ed(5),I.xc(6,"currency"),I.gc(),I.hc(7,"td"),I.ed(8),I.xc(9,"currency"),I.gc(),I.hc(10,"td"),I.hc(11,"strong"),I.ed(12),I.xc(13,"currency"),I.gc(),I.gc(),I.gc(),I.ec()),2&t){var n=e.$implicit;I.Nb(3),I.fd(n.node.action.name),I.Nb(2),I.fd(I.yc(6,4,n.node.estimatedLaborCost)),I.Nb(3),I.fd(I.yc(9,6,n.node.estimatedMetalCost)),I.Nb(4),I.fd(I.yc(13,8,n.node.estimatedMetalCost+n.node.estimatedLaborCost))}}function Mc(t,e){if(1&t&&(I.cc(0,"modal-header",176),I.xc(1,"numericId"),I.hc(2,"div",168),I.hc(3,"table",86),I.hc(4,"thead"),I.hc(5,"tr"),I.hc(6,"th"),I.ed(7,"Action"),I.gc(),I.hc(8,"th"),I.ed(9,"Labour"),I.gc(),I.hc(10,"th"),I.ed(11,"Metal"),I.gc(),I.hc(12,"th"),I.ed(13,"Total"),I.gc(),I.gc(),I.gc(),I.hc(14,"tbody"),I.cd(15,Dc,14,10,"ng-container",4),I.gc(),I.gc(),I.gc()),2&t){var n=e.$implicit,c=I.wc();I.Fc("title","Job Costs for #",I.yc(1,3,c.state.viewingJobForCosts.job.id),""),I.Dc("modal",n),I.Nb(15),I.Dc("ngForOf",c.state.viewingJobForCosts.job.jobActions.edges)}}function Pc(t,e){1&t&&I.cc(0,"loading-ring",177)}var Tc=function(){return function(){var t;this.jobActions=((t={})["Cast & Mount"]=!1,t.Finishing=!1,t.Plating=!1,t.Engraving=!1,t["Jump Ring"]=!1,t["Earring Posts"]=!1,t["Stone Setting"]=!1,t.Resizing=!1,t.Repairing=!1,t.Other=!1,t.Hallmarking=!1,t),this.submissionInfo=null}}(),Bc=function(){function t(t,e,n,c,i,o,a,s,d,l,r,u,g,h,b){var m;this.route=t,this.router=e,this.actionService=n,this.imageLoggingSessionService=c,this.appUserService=i,this.exportToPdfService=o,this.exportDataService=a,this.jobActionService=s,this.jobService=d,this.modalService=l,this.stoneSubmissionService=r,this.submissionBatchService=u,this.submissionNoteService=g,this.submissionService=h,this.toastr=b,this.actionPlating=w,this.actionEngraving=j,this.actionJumpRing=A,this.actionEarringPosts=x,this.actionStoneSetting=D,this.actionResizing=M,this.actionRepairing=P,this.actionHallmarking=T,this.statusInProduction=k.j,this.jewelleryTypeRing=S.e,this.jewelleryTypePendant=S.d,this.jewelleryTypeEarring=S.c,this.baseMetalSilver=G.m,this.ringSizeLeaveAsIs=Ne.c,this.eventTypeWedding=U.a,this.model=new Tc,this.data={actions:[],batch:null,nextStatuses:[{currentStatusId:k.k.id,setStatus:k.l,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!1,outgoing:!0},{currentStatusId:k.l.id,setStatus:k.m,buttonText:"Receive Batch",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!1,incoming:!1,outgoing:!0},{currentStatusId:k.d.id,setStatus:k.e,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!0,manuallyConfirmAll:!1,adminOnly:!1,incoming:!0,outgoing:!1},{currentStatusId:k.e.id,setStatus:k.f,buttonText:"Batch Received",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!0,outgoing:!1}],selections:[],submissionInfos:[],totalEstLaborCost:0,totalEstMetalCost:0,createImageLoggingSessionMap:{},submissionPhotoTimingMap:{},incomingBatch:!1,outgoingBatch:!1,jobCount:0,ringCount:0,pendantCount:0,earringCount:0,totalEstimatedCost:0,totalActualCost:0,totalPayments:0,anticipatedPostageCost:9.75},this.state={allSelected:!1,isAdmin:!1,isSupplier:!1,loading:!0,loadingActions:!1,loadingJobActions:!0,loadingStones:!0,loadingNotes:!0,nextStatus:null,showToPrint:null,printAll:!1,submitting:!1,exporting:!1,imageLoggingSessionState:!1,viewingJobForCosts:null,postingJournal:!1},this._silverBaseMetalName=G.l,this._9ctYellowGoldBaseMetalName=G.j,this._9ctRoseGoldBaseMetalName=G.h,this._9ctWhiteGoldBaseMetalName=G.i,this._14ctYellowGoldBaseMetalName=G.d,this._14ctRoseGoldBaseMetalName=G.b,this._14ctWhiteGoldBaseMetalName=G.c,this._18ctYellowGoldBaseMetalName=G.g,this._18ctRoseGoldBaseMetalName=G.e,this._18ctWhiteGoldBaseMetalName=G.f,this._platinumBaseMetalName=G.k,this.metalsInBatch=((m={})[G.l]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.j]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.h]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.i]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.d]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.b]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.c]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.g]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.e]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.f]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[G.k]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m),this.imageLoggingSessionState=!1,this.timeElapsed=0}return t.prototype.unloadNotification=function(t){var e=this;this.data.submissionInfos.some((function(t){return e.data.submissionPhotoTimingMap[t.submission.id]}))&&(t.returnValue=!0)},t.prototype.ngOnDestroy=function(){return _e(this,void 0,void 0,(function(){var t,e,n;return ze(this,(function(c){switch(c.label){case 0:t=0,e=this.data.submissionInfos,c.label=1;case 1:return t<e.length?this.data.submissionPhotoTimingMap[(n=e[t]).submission.id]?[4,this.endImageLoggingSession(n.submission)]:[3,3]:[3,4];case 2:c.sent(),c.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},t.prototype.ngOnInit=function(){var t=this;this.liveTimeInterval=setInterval((function(){t.liveTimeCreate()}),500),this.route.paramMap.subscribe((function(e){var n=e.get("id");Object(_.a)(t.submissionBatchService.get("submission_batches/"+n),t.jobService.listByOutgoingBatch(n,999),t.jobService.listByIncomingBatch(n,999),t.appUserService.getMe()).subscribe((function(e){var n,c=e[1],i=e[2],o=e[3];t.data.batch=JSON.parse(JSON.stringify(e[0].data.submissionBatch)),t.model.invoice=t.data.batch.invoice,t.model.invoiced=t.data.batch.invoiced,t.model.labourCostStaging=t.data.batch.invoiceLabourCost/100,t.model.labourCostExisting=t.data.batch.invoiceLabourCost/100,t.model.deliveryCostStaging=t.data.batch.invoiceDeliveryCost/100,t.model.deliveryCostExisting=t.data.batch.invoiceDeliveryCost/100,t.metalsInBatch[G.l].actualCostStaging=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[G.j].actualCostStaging=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[G.h].actualCostStaging=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[G.i].actualCostStaging=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[G.d].actualCostStaging=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[G.b].actualCostStaging=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[G.c].actualCostStaging=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[G.g].actualCostStaging=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[G.e].actualCostStaging=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[G.f].actualCostStaging=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[G.k].actualCostStaging=t.data.batch.invoicePlatinumCost/100,t.metalsInBatch[G.l].actualCostExisting=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[G.j].actualCostExisting=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[G.h].actualCostExisting=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[G.i].actualCostExisting=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[G.d].actualCostExisting=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[G.b].actualCostExisting=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[G.c].actualCostExisting=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[G.g].actualCostExisting=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[G.e].actualCostExisting=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[G.f].actualCostExisting=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[G.k].actualCostExisting=t.data.batch.invoicePlatinumCost/100;for(var a=0,s=t.data.nextStatuses;a<s.length;a++){var d=s[a];d.currentStatusId===t.data.batch.status.id&&(t.state.nextStatus=d)}t.data.batch.status.incomingBatched?t.data.incomingBatch=!0:t.data.outgoingBatch=!0;for(var l=0,r=c.data.jobs.edges.concat(i.data.jobs.edges);l<r.length;l++){var u=r[l];u=JSON.parse(JSON.stringify(u));for(var g=0,h=0,b=((n={})["Cast & Mount"]=null,n.Finishing=null,n.Plating=null,n.Engraving=null,n["Jump Ring"]=null,n["Earring Posts"]=null,n["Stone Setting"]=null,n.Resizing=null,n.Repairing=null,n.Other=null,n.Hallmarking=null,n),m=0,p=u.node.jobActions.edges;m<p.length;m++){var f=p[m];b[f.node.action.name]=f,g+=f.node.estimatedLaborCost,h+=f.node.estimatedMetalCost}t.metalsInBatch[u.node.submission.baseMetal.name].estimateCost+=h,t.data.totalEstLaborCost+=g,t.data.totalEstMetalCost+=h,t.data.jobCount++;var v=0;if(u.node.submission.jobs.edges.length<=1)for(var y=0,C=u.node.submission.payments.edges;y<C.length;y++){var I=C[y];I.node.success&&(v+=I.node.amount)}switch(t.data.totalPayments+=v,u.node.submission.jewelleryType.name){case S.e:t.data.ringCount++;break;case S.d:t.data.pendantCount++;break;case S.c:t.data.earringCount++}t.metalsInBatch[u.node.submission.baseMetal.name].present=!0,t.data.submissionInfos.push({job:u.node,jobActions:b,jobLabourCostEst:g,jobMetalCostEst:h,jobTotalCostEst:g+h,jobActionsFromRequest:u.node.jobActions.edges,numericId:t.getNumericId(u.node.submission.id),pendingUpdateJob:!1,printing:!1,selected:!1,stones:[],notes:[],submission:u.node.submission,jobPayments:v})}for(var N=0,w=Object.keys(t.metalsInBatch);N<w.length;N++){var j=w[N];t.data.totalActualCost+=t.metalsInBatch[j].actualCostExisting,t.data.totalEstimatedCost+=t.metalsInBatch[j].estimateCost}t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalEstimatedCost+=t.data.totalEstLaborCost,t.data.totalActualCost+=t.model.deliveryCostExisting,t.state.isAdmin=t.appUserService.isAdmin(o.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(o.data.appUser.roles);for(var A=[],x=0,D=t.data.submissionInfos;x<D.length;x++)A.push(D[x].submission.id);t.state.loadingJobActions=!1,t.state.isAdmin&&(t.state.loadingActions=!0,t.actionService.list().subscribe((function(e){t.data.actions=e.data.actions.edges,t.state.loadingActions=!1}))),t.stoneSubmissionService.listBySubmission(A).subscribe((function(e){for(var n=0,c=t.data.submissionInfos;n<c.length;n++)for(var i=c[n],o=0,a=e.data.stoneSubmissions.edges;o<a.length;o++){var s=a[o];s.node.submission.id===i.submission.id&&i.stones.push(s)}t.state.loadingStones=!1})),t.state.loading=!1,t.submissionNoteService.listBySubmission(A).subscribe((function(e){for(var n=0,c=t.data.submissionInfos;n<c.length;n++)for(var i=c[n],o=0,a=e.data.submissionNotes.edges;o<a.length;o++){var s=a[o];s.node.submission.id===i.submission.id&&i.notes.push(s)}t.state.loadingNotes=!1}))}))}))},t.prototype.updateStatus=function(t){return _e(this,void 0,void 0,(function(){var t,e,n=this;return ze(this,(function(c){return this.state.submitting||!this.state.nextStatus||(this.state.submitting=!0,this.toastr.success(null,"Updating Batch"),t=(new Date).toISOString(),e=this.data.batch.dateSent,this.state.nextStatus.currentStatusId===k.k.id&&(e=t),this.submissionBatchService.update({id:this.data.batch.id,status:this.state.nextStatus.setStatus.id,updatedAt:t,dateSent:e}).subscribe((function(t){n.data.batch.status=n.state.nextStatus.setStatus,n.data.batch.dateSent=e,n.data.selections=[];for(var c=0,i=n.data.submissionInfos;c<i.length;c++)i[c].selected=!1;n.state.nextStatus=null;for(var o=0,a=n.data.nextStatuses;o<a.length;o++){var s=a[o];s.currentStatusId===t.data.updateSubmissionBatch.submissionBatch.status.id&&(n.state.nextStatus=s)}n.toastr.success(null,"Batch Updated!"),n.state.submitting=!1}))),[2]}))}))},t.prototype.selectRow=function(t){if(!this.state.submitting)if(this.state.nextStatus&&this.state.nextStatus.takeMetalWeight&&!t.submission.metalWeight)this.toastr.info("","Please enter a Metal Weight for this item before confirming");else if(t.selected){t.selected=!1;var e=this.data.selections.findIndex((function(e){return e.submission.id===t.submission.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t)},t.prototype.selectAll=function(){if(!this.state.loading){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.submissionInfos;t<e.length;t++)(i=e[t]).selected=!0,this.selectRow(i);for(var n=0,c=this.data.submissionInfos;n<c.length;n++){var i;(i=c[n]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(i)&&this.data.selections.push(i)}}},t.prototype.setRush=function(t,e){this.state.isAdmin&&(e.stopPropagation(),t.pendingUpdateJob?(t.job.rush=!t.job.rush,t.pendingUpdateJob=!1,this.updateJob(t)):(t.pendingUpdateJob=!0,setTimeout((function(){t.pendingUpdateJob=!1}),3e3)))},t.prototype.updateJob=function(t){var e=this;this.toastr.info("","Updating Job"),setTimeout((function(n){e.jobService.update({id:t.job.id,due:$.a.removeTimezone(new Date(t.job.due)),rush:t.job.rush}).subscribe((function(t){e.toastr.success("","Job Updated")}))}),250)},t.prototype.deleteJob=function(t){this.toastr.warning("Sorry pal, this feature isn't available yet.")},t.prototype.viewJobActionModal=function(t,e){var n=this;this.model.jobActions["Cast & Mount"]=null!==t.jobActions["Cast & Mount"],this.model.jobActions.Finishing=null!==t.jobActions.Finishing,this.model.jobActions.Plating=null!==t.jobActions.Plating,this.model.jobActions.Engraving=null!==t.jobActions.Engraving,this.model.jobActions["Jump Ring"]=null!==t.jobActions["Jump Ring"],this.model.jobActions["Earring Posts"]=null!==t.jobActions["Earring Posts"],this.model.jobActions["Stone Setting"]=null!==t.jobActions["Stone Setting"],this.model.jobActions.Resizing=null!==t.jobActions.Resizing,this.model.jobActions.Repairing=null!==t.jobActions.Repairing,this.model.jobActions.Other=null!==t.jobActions.Other,this.model.jobActions.Hallmarking=null!==t.jobActions.Hallmarking,this.model.submissionInfo=t,this.modalService.open(e).result.then((function(){return _e(n,void 0,void 0,(function(){var e,n,c,i,o=this;return ze(this,(function(a){switch(a.label){case 0:e=function(e){var c;return ze(this,(function(i){switch(i.label){case 0:return n.model.jobActions[e]&&null===t.jobActions[e]?(n.toastr.success("","Adding action: "+e),c=n.data.actions.find((function(t){return t.node.name===e})),n.jobActionService.create({job:t.job.id,action:c.node.id,completed:!1}).subscribe((function(n){t.jobActions[n.data.createJobAction.jobAction.action.name]={node:n.data.createJobAction.jobAction},o.toastr.success("",e+" added!")})),[3,3]):[3,1];case 1:return n.model.jobActions[e]||null===t.jobActions[e]?[3,3]:(n.toastr.success("","Removing action: "+e),[4,n.jobActionService.delete(t.jobActions[e].node.id)]);case 2:i.sent(),t.jobActions[e]=null,n.toastr.success("",e+" removed!"),i.label=3;case 3:return[2]}}))},n=this,c=0,i=Object.keys(this.model.jobActions),a.label=1;case 1:return c<i.length?[5,e(i[c])]:[3,4];case 2:a.sent(),a.label=3;case 3:return c++,[3,1];case 4:return[2]}}))}))}),(function(){}))},t.prototype.viewJobCostsModal=function(t,e){this.state.viewingJobForCosts=t,this.modalService.open(e)},t.prototype.addJobActions=function(){},t.prototype.createPdf=function(t){return _e(this,void 0,void 0,(function(){var e=this;return ze(this,(function(n){return t.printing=!0,this.state.showToPrint="submission"+t.numericId,setTimeout((function(n){return _e(e,void 0,void 0,(function(){return ze(this,(function(e){switch(e.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(this.state.showToPrint),100)];case 1:return e.sent(),this.state.showToPrint=null,t.printing=!1,[2]}}))}))}),0),[2]}))}))},t.prototype.updateSubmission=function(t){return _e(this,void 0,void 0,(function(){return ze(this,(function(e){switch(e.label){case 0:return t.submission.metalWeight?(this.toastr.info("","Updating Submission"),[4,this.submissionService.update({id:t.submission.id,updatedAt:(new Date).toISOString(),metalWeight:t.submission.metalWeight})]):[2];case 1:return e.sent(),this.toastr.success("","Submission Updated"),[2]}}))}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.prototype.printAll=function(t,e){var n=this;this.data.selections.length||(this.state.printAll=!0),setTimeout((function(c){return _e(n,void 0,void 0,(function(){return ze(this,(function(n){switch(n.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(t),e)];case 1:return n.sent(),this.state.printAll=!1,[2]}}))}))}),10)},t.prototype.exportAddressData=function(){if(this.state.exporting=!0,this.data.selections.length<1)return this.toastr.error("You must select at least one submission."),void(this.state.exporting=!1);for(var t,e=[],n=[],c=0,i=this.data.selections;c<i.length;c++)t=this.exportDataService.flattenObject(i[c],e),n.push(t.data),e=t.headers;this.exportDataService.whiteListColumns(["submission.id","fullName","address1","address2","city","county","postcode","country","email","castingCode"],n),this.exportDataService.renameColumns({"submission.id":"Order Reference"},n),this.exportDataService.addStaticValues({weight:.03,packageSize:"large letter",serviceCode:"BPR1",serviceRegisterCode:"01"},n),this.exportDataService.exportToCsv("submission_export_"+(new Date).toLocaleString(),Object.keys(n[0]),n),this.toastr.success("Exported and downloading file"),this.state.exporting=!1},t.prototype.liveTimeCreate=function(){var t=new Date;this.liveTime=("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},t.prototype.startTimer=function(){var t=this;this.timeElapsed=0,this.interval=setInterval((function(){t.timeElapsed++}),1e3)},t.prototype.endTimer=function(){clearInterval(this.interval)},t.prototype.toggleSubmissionPhotoTimer=function(t){return _e(this,void 0,void 0,(function(){var e,n,c;return ze(this,(function(i){switch(i.label){case 0:this.state.submitting=!0,e=0,n=this.data.submissionInfos,i.label=1;case 1:return e<n.length?(c=n[e]).submission.id!==t?[3,6]:this.data.submissionPhotoTimingMap[c.submission.id]?[3,3]:[4,this.createImageLoggingSession(c.submission)]:[3,9];case 2:return i.sent(),[3,5];case 3:return[4,this.endImageLoggingSession(c.submission)];case 4:i.sent(),i.label=5;case 5:return[3,8];case 6:return this.data.submissionPhotoTimingMap[c.submission.id]?(this.data.submissionPhotoTimingMap[c.submission.id]=!1,[4,this.endImageLoggingSession(c.submission)]):[3,8];case 7:i.sent(),i.label=8;case 8:return e++,[3,1];case 9:return this.state.submitting=!1,[2]}}))}))},t.prototype.createImageLoggingSession=function(t){return _e(this,void 0,void 0,(function(){var e,n,c,i;return ze(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=(new Date).toISOString(),n=this.data.createImageLoggingSessionMap,c=t.id,[4,this.imageLoggingSessionService.create({startTime:e,submission:t.id})];case 1:return n[c]=o.sent(),this.imageLoggingSessionState=!0,this.startTimer(),this.toastr.success("Started photo timing session for submission "+t.jewelleryType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!this.data.submissionPhotoTimingMap[t.id],[3,3];case 2:return i=o.sent(),this.toastr.error("Error starting image logging session!"),console.error(i),[3,3];case 3:return[2]}}))}))},t.prototype.endImageLoggingSession=function(t){return _e(this,void 0,void 0,(function(){var e;return ze(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.imageLoggingSessionService.updateEndTime({id:this.data.createImageLoggingSessionMap[t.id].createImageLoggingSession.imageLoggingSession.id,endTime:(new Date).toISOString()})];case 1:return n.sent(),this.imageLoggingSessionState=!1,this.endTimer(),this.toastr.success("Ended photo timing session for "+t.jewelleryType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!1,[3,3];case 2:return e=n.sent(),this.toastr.error("Error stopping image logging session!"),console.error(e),[3,3];case 3:return[2]}}))}))},t.prototype.onSubmit=function(){var t=this;this.data.batch.journalReference?this.toastr.warning("Cannot modify the invoice details until the journal has been deleted"):this.model.invoice?(this.state.submitting=!0,this.submissionBatchService.update({id:this.data.batch.id,updatedAt:(new Date).toISOString(),invoice:this.model.invoice,invoiced:this.model.invoiced,invoiceLabourCost:this.formatCurrency(this.model.labourCostStaging),invoiceDeliveryCost:this.formatCurrency(this.model.deliveryCostStaging),invoiceSilverCost:this.formatCurrency(this.metalsInBatch[G.l].actualCostStaging),invoice9ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[G.j].actualCostStaging),invoice9ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[G.h].actualCostStaging),invoice9ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[G.i].actualCostStaging),invoice14ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[G.d].actualCostStaging),invoice14ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[G.b].actualCostStaging),invoice14ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[G.c].actualCostStaging),invoice18ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[G.g].actualCostStaging),invoice18ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[G.e].actualCostStaging),invoice18ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[G.f].actualCostStaging),invoicePlatinumCost:this.formatCurrency(this.metalsInBatch[G.k].actualCostStaging)}).subscribe((function(e){var n=e.data.updateSubmissionBatch.submissionBatch;t.model.labourCostExisting=n.invoiceLabourCost/100,t.model.deliveryCostExisting=n.invoiceDeliveryCost/100,t.metalsInBatch[G.l].actualCostExisting=n.invoiceSilverCost/100,t.metalsInBatch[G.j].actualCostExisting=n.invoice9ctYellowGoldCost/100,t.metalsInBatch[G.h].actualCostExisting=n.invoice9ctRoseGoldCost/100,t.metalsInBatch[G.i].actualCostExisting=n.invoice9ctWhiteGoldCost/100,t.metalsInBatch[G.d].actualCostExisting=n.invoice14ctYellowGoldCost/100,t.metalsInBatch[G.b].actualCostExisting=n.invoice14ctRoseGoldCost/100,t.metalsInBatch[G.c].actualCostExisting=n.invoice14ctWhiteGoldCost/100,t.metalsInBatch[G.g].actualCostExisting=n.invoice18ctYellowGoldCost/100,t.metalsInBatch[G.e].actualCostExisting=n.invoice18ctRoseGoldCost/100,t.metalsInBatch[G.f].actualCostExisting=n.invoice18ctWhiteGoldCost/100,t.metalsInBatch[G.k].actualCostExisting=n.invoicePlatinumCost/100,t.data.totalActualCost=0;for(var c=0,i=Object.keys(t.metalsInBatch);c<i.length;c++)t.data.totalActualCost+=t.metalsInBatch[i[c]].actualCostExisting;t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalActualCost+=t.model.deliveryCostExisting,t.data.batch.invoiced=t.model.invoiced,t.invoiceDataForm.form.markAsPristine(),t.toastr.success("","Batch Updated"),t.state.submitting=!1}))):this.toastr.warning("In order to update batch costs, please add an invoice number","Warning")},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.prototype.objectKeys=function(t){return Object.keys(t)},t.prototype.chartClicked=function(t){},t.prototype.chartHovered=function(t){},t.prototype.postJournalToXero=function(t){var e=this,n=this.getNumericId(this.data.batch.id);this.state.postingJournal=!0,this.submissionBatchService.postSubmissionBatchJournalToXero(n).subscribe((function(t){if(!t.valid)return e.toastr.error(t.message,"Failed"),void(e.state.postingJournal=!1);e.data.batch.journalReference=t.data.manualJournalID,e.data.batch.journalPostedAt=(new Date).toUTCString(),e.toastr.success(t.message,"Success"),e.state.postingJournal=!1}))},t.\u0275fac=function(e){return new(e||t)(I.bc(m.a),I.bc(m.b),I.bc(B),I.bc(Ie.a),I.bc(Q.a),I.bc(ye.a),I.bc(Ce.a),I.bc(v.a),I.bc(f.a),I.bc(Y.i),I.bc(z.a),I.bc(H.a),I.bc(q.a),I.bc(L.a),I.bc(V.b))},t.\u0275cmp=I.Vb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var n;1&t&&I.kd(Qe,!0),2&t&&I.Mc(n=I.tc())&&(e.invoiceDataForm=n.first)},hostBindings:function(t,e){1&t&&I.sc("beforeunload",(function(t){return e.unloadNotification(t)}),!1,I.Pc)},decls:13,vars:7,consts:[[3,"title",4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","batch-table-container row mt-5",4,"ngIf"],["id","jobLabels",1,"pdfLabel"],[4,"ngFor","ngForOf"],["id","idLabels",1,"pdfLabel"],["jobActionsModal",""],["jobCostsModal",""],["size","100",4,"ngIf"],[3,"title"],[1,"container-fluid"],[1,"row"],[1,"col-lg-12","col-xl-5"],[1,"row","mb-4"],[1,"col"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"col-md-6"],[1,"col-auto"],[4,"ngIf"],[1,"pr-2"],[1,"mt-2"],["class","btn btn-outline-primary mr-2",3,"disabled","click",4,"ngIf"],["class","btn btn-outline-primary mr-2",3,"click",4,"ngIf"],["class","col-lg-12 col-xl-7",4,"ngIf"],[1,"border-top"],[1,"btn","btn-outline-primary","mr-2",3,"disabled","click"],[1,"btn","btn-outline-primary","mr-2",3,"click"],[1,"col-lg-12","col-xl-7"],[1,"col-xl-4","col-lg-6","col-md-12","mb-4"],[3,"ngSubmit"],["batchInvoiceDataForm","ngForm"],[1,"row","mb-2"],[1,"form-group"],["for","invoice",1,"req"],["appShowErrorInputClass","","id","invoice","maxlength","50","name","invoice","placeholder","Invoice number","required","","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"checkbox-wrapper","with-label"],["id","invoicedCheckbox","name","invoicedCheckbox","type","checkbox",3,"disabled","ngModel","ngModelChange"],["for","invoicedCheckbox"],[1,"row","justify-content-end"],["type","submit",1,"btn","btn-lg","btn-primary","float-right","fas",3,"disabled"],["aria-hidden","true","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["class","col-xl-8 col-lg-6 col-md-12",4,"ngIf"],[1,"form-group","mb-2"],["for","labour"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","id","labour","limitDecimalPlaces","","min","0","name","labour","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["class","row",4,"ngIf"],["for","delivery"],["appShowErrorInputClass","","id","delivery","limitDecimalPlaces","","min","0","name","delivery","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","silver"],["appShowErrorInputClass","","id","silver","limitDecimalPlaces","","min","0","name","silver","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctYellow"],["appShowErrorInputClass","","id","invoice9ctYellow","limitDecimalPlaces","","min","0","name","invoice9ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctRose"],["appShowErrorInputClass","","id","invoice9ctRose","limitDecimalPlaces","","min","0","name","invoice9ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctWhite"],["appShowErrorInputClass","","id","invoice9ctWhite","limitDecimalPlaces","","min","0","name","invoice9ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctYellow"],["appShowErrorInputClass","","id","invoice14ctYellow","limitDecimalPlaces","","min","0","name","invoice14ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctRose"],["appShowErrorInputClass","","id","invoice14ctRose","limitDecimalPlaces","","min","0","name","invoice14ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctWhite"],["appShowErrorInputClass","","id","invoice14ctWhite","limitDecimalPlaces","","min","0","name","invoice14ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctYellow"],["appShowErrorInputClass","","id","invoice18ctYellow","limitDecimalPlaces","","min","0","name","invoice18ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctRose"],["appShowErrorInputClass","","id","invoice18ctRose","limitDecimalPlaces","","min","0","name","invoice18ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctWhite"],["appShowErrorInputClass","","id","invoice18ctWhite","limitDecimalPlaces","","min","0","name","invoice18ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoicePlatinum"],["appShowErrorInputClass","","id","invoicePlatinum","limitDecimalPlaces","","min","0","name","invoicePlatinum","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],[1,"col-xl-8","col-lg-6","col-md-12"],[1,"table","bs-table","table-sm"],[1,"text-muted"],["class","col",4,"ngIf"],[1,"btn","btn-secondary","xero","float-right","fas",3,"disabled","click"],[1,"text-muted","text-right","small","mb-0"],["target","_blank",3,"href"],[1,"batch-table-container","row","mt-5"],[1,"mb-2"],[1,"table-responsive"],[1,"data-table"],["class","checkbox sm",4,"ngIf"],["scope","col",1,"sm"],["scope","col"],["scope","col","style","min-width: 120px;",4,"ngIf"],["scope","col",4,"ngIf"],["colspan","72","scope","row"],["class","tc mt-5",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"checkbox","sm"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["scope","col",2,"min-width","120px"],["class","pr-0 checkbox","scope","row",4,"ngIf"],["scope","row",1,"sm"],[3,"photos"],[1,"sm"],[1,"sm","muted"],[1,"sm",3,"click"],["class","color-warning fas fa-circle",4,"ngIf"],[1,"tr"],[1,"btn-group"],["class","btn hover icon-btn-outline mx-1 fas fa-cogs color-primary","ngbTooltip","Edit Job Actions","type","button",3,"disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-pound-sign","type","button",3,"click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas","type","button",3,"fa-print","disabled","click",4,"ngIf"],["class","btn icon-btn-outline mx-1 fas","type","button",3,"fa-camera","fa-stop","hover","disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-trash","type","button",3,"click",4,"ngIf"],[3,"customerNote","hover","isAdmin","loadingNotes","notes","submissionId"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission",4,"ngIf"],["scope","row",1,"pr-0","checkbox"],["type","checkbox",3,"ngModel","name","id","click","ngModelChange"],[3,"for"],["class","fa fa-shipping-fast text-primary",3,"ngbTooltip",4,"ngIf"],["class","fa fa-shipping-fast text-muted",3,"ngbTooltip",4,"ngIf"],[1,"fa","fa-shipping-fast","text-primary",3,"ngbTooltip"],[1,"fa","fa-shipping-fast","text-muted",3,"ngbTooltip"],[1,"color-warning","fas","fa-circle"],["name","dueDate","placeholder","Due Date","required","",1,"form-control",3,"ngModel","owlDateTimeTrigger","owlDateTime","max","ngModelChange"],[3,"pickerType"],["dt2",""],["min","0","name","metalWeight","placeholder","Metal Weight (g)","required","","type","number",3,"ngModel","blur","ngModelChange"],["class","small muted",4,"ngIf"],[1,"small","muted"],["ngbTooltip","Edit Job Actions","type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-cogs","color-primary",3,"disabled","click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-pound-sign",3,"click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas",3,"disabled","click"],["type","button",1,"btn","icon-btn-outline","mx-1","fas",3,"disabled","click"],["aria-hidden","true","class","spinner-border spinner-border-sm",4,"ngIf"],["aria-hidden","true",1,"spinner-border","spinner-border-sm"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-trash",3,"click"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission"],[1,"tc","mt-5"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-center"],[3,"size"],[3,"hidden","id"],[1,"size-label","manufacturing","page"],[1,"label-inner-wrapper"],[1,"tin-size"],["border","0",1,"logoTable","mb-2","w-100"],["valign","middle"],["alt","CAST Logo","src","/assets/img/cast-logo-black.png",3,"width"],[1,"text-right"],[3,"bc-display-value","bc-element-type","bc-height","bc-value","bc-width"],[1,"footer"],["id","printPdf","name","printPdf"],[1,"job_details","mb-1"],[3,"colSpan"],["class","fa fa-shipping-fast mr-2",3,"ngbTooltip",4,"ngIf"],[3,"colSpan",4,"ngIf"],["class","job_details mb-1",4,"ngIf"],[1,"row","label-jobs","align-content-start"],[1,"action","col-2"],[1,"fa","fa-shipping-fast","mr-2",3,"ngbTooltip"],["valign","top",1,"notes"],[1,"size-label","page"],[1,"tin-size",2,"display","table-cell","vertical-align","middle"],[2,"width","100%"],["name","printPdf",1,"printIframeContainer"],["title","Add/Remove Job Actions",3,"modal"],[1,"modal-body"],["novalidate",""],["updateJobActionsForm","ngForm"],["class","col-sm-4 mb-3 tc",4,"ngFor","ngForOf"],[3,"form","modal","saveButtonName","modalSaved"],[1,"col-sm-4","mb-3","tc"],[1,"tc",3,"for"],["appShowErrorInputClass","","type","checkbox",1,"form-control",3,"ngModel","id","name","ngModelChange"],[3,"modal","title"],["size","100"]],template:function(t,e){1&t&&(I.cd(0,He,1,1,"page-title",0),I.cd(1,Le,1,1,"page-title",0),I.cd(2,In,59,23,"div",1),I.cd(3,ec,37,8,"div",2),I.hc(4,"div",3),I.cd(5,Ic,18,17,"ng-container",4),I.hc(6,"div",5),I.cd(7,jc,22,13,"ng-container",4),I.gc(),I.gc(),I.cd(8,xc,8,7,"ng-template",null,6,I.dd),I.cd(10,Mc,16,5,"ng-template",null,7,I.dd),I.cd(12,Pc,1,0,"loading-ring",8)),2&t&&(I.Dc("ngIf",e.state.isAdmin),I.Nb(1),I.Dc("ngIf",e.state.isSupplier),I.Nb(1),I.Dc("ngIf",!e.state.loading),I.Nb(1),I.Dc("ngIf",!e.state.loading),I.Nb(2),I.Dc("ngForOf",e.data.submissionInfos),I.Nb(2),I.Dc("ngForOf",e.data.selections),I.Nb(5),I.Dc("ngIf",e.state.loading))},directives:[g.u,g.t,Yt.a,h.z,h.l,h.m,h.d,Xt.a,h.g,h.u,h.k,h.n,h.a,h.q,Kt.a,xe,De.a,Y.m,Me.e,Me.g,Me.c,Pe.a,Vt.a,Te.a,we.a,Be.a],pipes:[ke.a,Oe.a,Ee.a,Re.a,g.G,g.g,Je.a,Fe.a,g.f,g.I,g.m],styles:[""]}),t}();function kc(t,e){1&t&&(I.hc(0,"th",7),I.ed(1,"Parent"),I.gc())}function Oc(t,e){if(1&t&&(I.hc(0,"td"),I.ed(1),I.xc(2,"titlecase"),I.gc()),2&t){var n=I.wc(2).$implicit;I.Tb("muted",!n.node.parent),I.Nb(1),I.gd(" ",n.node.parent?I.yc(2,3,n.node.parent.company):"None"," ")}}function Ec(t,e){if(1&t&&(I.hc(0,"tr"),I.hc(1,"th",11),I.ed(2),I.xc(3,"numericId"),I.gc(),I.hc(4,"td"),I.ed(5),I.xc(6,"titlecase"),I.gc(),I.hc(7,"td"),I.ed(8),I.xc(9,"titlecase"),I.gc(),I.cd(10,Oc,3,5,"td",12),I.cc(11,"td",13),I.gc()),2&t){var n=I.wc().$implicit,c=I.wc(2);I.Nb(2),I.gd("#",I.yc(3,4,n.node.id),""),I.Nb(3),I.fd(I.yc(6,6,n.node.company)),I.Nb(3),I.fd(n.node.contactName?I.yc(9,8,n.node.contactName):""),I.Nb(2),I.Dc("ngIf",c.state.isAdmin)}}function Rc(t,e){if(1&t&&(I.fc(0),I.cd(1,Ec,12,10,"tr",10),I.ec()),2&t){var n=e.$implicit,c=I.wc(2);I.Nb(1),I.Dc("ngIf",n.node.parent||c.state.isAdmin)}}function Jc(t,e){if(1&t&&(I.hc(0,"div",5),I.hc(1,"table",6),I.hc(2,"thead"),I.hc(3,"tr"),I.hc(4,"th"),I.ed(5,"ID"),I.gc(),I.hc(6,"th",7),I.ed(7,"Supplier"),I.gc(),I.hc(8,"th",7),I.ed(9,"Contact Name"),I.gc(),I.cd(10,kc,2,0,"th",8),I.cc(11,"th",7),I.gc(),I.gc(),I.hc(12,"tbody"),I.cd(13,Rc,2,1,"ng-container",9),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc();I.Nb(10),I.Dc("ngIf",n.state.isAdmin),I.Nb(3),I.Dc("ngForOf",n.data.suppliers)}}function Fc(t,e){1&t&&I.cc(0,"loading-ring",14),2&t&&I.Dc("size",60)}var _c=function(){function t(t,e,n){this.appUserService=t,this.supplierService=e,this.toastrService=n,this.data={suppliers:[]},this.state={isAdmin:!1,loading:!0}}return t.prototype.ngOnInit=function(){var t=this;this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles)})),this.supplierService.list(null).subscribe((function(e){for(var n=0,c=e.data.suppliers.edges;n<c.length;n++)t.data.suppliers.push(c[n]);t.state.loading=!1}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.\u0275fac=function(e){return new(e||t)(I.bc(Q.a),I.bc(O.a),I.bc(V.b))},t.\u0275cmp=I.Vb({type:t,selectors:[["app-supplier-view"]],decls:5,vars:3,consts:[[3,"title"],[1,"batch-table-container","row","mt-5"],[1,"col"],["class","table-responsive",4,"ngIf"],[3,"size",4,"ngIf"],[1,"table-responsive"],[1,"data-table"],["scope","col"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["scope","row"],[3,"muted",4,"ngIf"],[1,"sm"],[3,"size"]],template:function(t,e){1&t&&(I.cc(0,"page-title",0),I.hc(1,"div",1),I.hc(2,"div",2),I.cd(3,Jc,14,2,"div",3),I.cd(4,Fc,1,1,"loading-ring",4),I.gc(),I.gc()),2&t&&(I.Dc("title","Supplier List"),I.Nb(3),I.Dc("ngIf",!e.state.loading),I.Nb(1),I.Dc("ngIf",e.state.loading))},directives:[Yt.a,g.u,g.t,Vt.a],pipes:[Je.a,g.G],styles:[""]}),t}(),zc=[{path:"incoming-batches",component:Se},{path:"jobs",component:Ut},{path:"outgoing-batches",component:Se},{path:"create-supplier",component:re},{path:"suppliers",component:_c},{path:"batches/view/:id",component:Bc}],Qc=function(){function t(){}return t.\u0275mod=I.Zb({type:t}),t.\u0275inj=I.Yb({factory:function(e){return new(e||t)},imports:[[m.f.forChild(zc)],m.f]}),t}();function Hc(t,e){if(1&t&&(I.hc(0,"div",7),I.hc(1,"strong"),I.ed(2),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(2),I.fd(n._jobAction.node.action.name)}}function Lc(t,e){1&t&&I.cc(0,"span",11)}function $c(t,e){1&t&&(I.hc(0,"div",12),I.cc(1,"i",13),I.gc())}function Wc(t,e){if(1&t){var n=I.ic();I.hc(0,"div",8),I.sc("click",(function(t){I.Qc(n);var e=I.wc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),I.cd(1,Lc,1,0,"span",9),I.cd(2,$c,2,0,"div",10),I.gc()}if(2&t){var c=I.wc(2);I.Nb(1),I.Dc("ngIf",!c.expandedFormat),I.Nb(1),I.Dc("ngIf",c.expandedFormat)}}function Gc(t,e){if(1&t){var n=I.ic();I.hc(0,"div",14),I.hc(1,"span",15),I.sc("click",(function(t){I.Qc(n);var e=I.wc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Dc("ngbTooltip",c._jobAction.node.action.name+" at "+c._jobAction.node.job.currentlyWith.company)}}function qc(t,e){if(1&t){var n=I.ic();I.hc(0,"div"),I.hc(1,"div",16),I.sc("click",(function(t){return I.Qc(n),I.wc(2).confirmed(t)})),I.hc(2,"span",17),I.ed(3," Confirm "),I.gc(),I.gc(),I.gc()}if(2&t){var c=I.wc(2);I.Nb(1),I.Tb("awaiting",c.state.confirming)}}function Uc(t,e){1&t&&I.cc(0,"span",20)}function Yc(t,e){1&t&&(I.hc(0,"div",21),I.cc(1,"i",13),I.gc())}function Vc(t,e){if(1&t){var n=I.ic();I.hc(0,"div",8),I.sc("click",(function(t){I.Qc(n);var e=I.wc(2);return e.showConfirmAction(e.jobStateNotStarted,t)})),I.cd(1,Uc,1,0,"span",18),I.cd(2,Yc,2,0,"div",19),I.gc()}if(2&t){var c=I.wc(2);I.Nb(1),I.Dc("ngIf",!c.expandedFormat),I.Nb(1),I.Dc("ngIf",c.expandedFormat)}}function Xc(t,e){if(1&t&&(I.hc(0,"div"),I.hc(1,"p",22),I.ed(2),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(2),I.fd(n.descriptions[n._jobAction.node.action.name])}}function Kc(t,e){if(1&t&&(I.fc(0),I.hc(1,"div",3),I.cd(2,Hc,3,1,"div",4),I.cd(3,Wc,3,2,"div",5),I.cd(4,Gc,2,1,"div",6),I.cd(5,qc,4,2,"div",0),I.cd(6,Vc,3,2,"div",5),I.cd(7,Xc,3,1,"div",0),I.gc(),I.ec()),2&t){var n=I.wc();I.Nb(1),I.Tb("complete",n._jobAction.node.completed&&!n.state.loading)("expanded",n.expandedFormat),I.Nb(1),I.Dc("ngIf",n.expandedFormat),I.Nb(1),I.Dc("ngIf",!n.state.confirming&&!n._jobAction.node.started&&!n._jobAction.node.completed),I.Nb(1),I.Dc("ngIf",!n.state.confirming&&n._jobAction.node.started&&!n._jobAction.node.completed),I.Nb(1),I.Dc("ngIf",n.state.confirming),I.Nb(1),I.Dc("ngIf",!n.state.confirming&&n._jobAction.node.completed),I.Nb(1),I.Dc("ngIf",n.expandedFormat&&n.descriptions[n._jobAction.node.action.name])}}function Zc(t,e){if(1&t&&(I.hc(0,"div",7),I.ed(1),I.gc()),2&t){var n=I.wc(2);I.Nb(1),I.gd(" ",n.placeholder," ")}}function ti(t,e){1&t&&I.cc(0,"div",25)}function ei(t,e){if(1&t&&(I.hc(0,"div",23),I.cd(1,Zc,2,1,"div",4),I.cd(2,ti,1,0,"div",24),I.gc()),2&t){var n=I.wc();I.Tb("expanded",n.expandedFormat),I.Nb(1),I.Dc("ngIf",n.expandedFormat),I.Nb(1),I.Dc("ngIf",n.expandedFormat)}}function ni(t,e){if(1&t&&(I.hc(0,"div",3),I.cc(1,"span",26),I.gc()),2&t){var n=I.wc();I.Tb("expanded",n.expandedFormat)}}function ci(t,e){if(1&t&&(I.hc(0,"div",3),I.cc(1,"span",26),I.gc()),2&t){var n=I.wc();I.Tb("expanded",n.expandedFormat)}}var ii=function(){function t(t){this.toastrService=t,this.jobStateNotStarted="notStarted",this.jobStateCompleted="completed",this.confirmActionTimeout=null,this.placeholder=null,this.description=null,this.expandedFormat=null,this._onHold=null,this.state={confirming:!1,fakeLoading:!1,futureJobState:null,loading:!0},this.descriptions={},this.baseMetal=null,this.plating=null,this.finish=null,this.resizeTo=null,this.confirmedAction=new I.r}return Object.defineProperty(t.prototype,"jobAction",{set:function(t){this._jobAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loading",{set:function(t){this.state.loading=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullFormat",{set:function(t){this.expandedFormat=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderName",{set:function(t){this.placeholder=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descriptor",{set:function(t){this.description=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHold",{set:function(t){this._onHold=t},enumerable:!1,configurable:!0}),t.prototype.confirmed=function(t){var e=this;t.stopPropagation(),clearTimeout(this.confirmActionTimeout),this.confirmActionTimeout=null,this.state.confirming=!1,this.state.fakeLoading=!0,this.state.futureJobState===this.jobStateNotStarted?(this._jobAction.node.started=!1,this._jobAction.node.startedAt=null,this._jobAction.node.completed=!1,this._jobAction.node.completedAt=null):this.state.futureJobState===this.jobStateCompleted&&(this._jobAction.node.completed=!0,this._jobAction.node.completedAt=(new Date).toISOString()),this.state.futureJobState=null,this.confirmedAction.emit(this._jobAction),setTimeout((function(){e.state.fakeLoading=!1}),800)},t.prototype.showConfirmAction=function(t,e){var n=this;this._onHold?this.toastrService.warning(null,"Item is on hold"):(e.stopPropagation(),this.state.confirming=!0,this.state.futureJobState=t,this.confirmActionTimeout=setTimeout((function(){n.state.futureJobState=null,n.state.confirming=!1}),3e3))},t.prototype.ngOnChanges=function(t){this._jobAction&&(this.baseMetal&&(this.descriptions["Cast & Mount"]="in "+this.baseMetal),this.plating&&(this.descriptions.Plating="in "+this.plating),this.finish&&(this.descriptions.Finishing=this.finish),this.resizeTo&&(this.descriptions.Resizing="to size "+this.resizeTo.toUpperCase()))},t.\u0275fac=function(e){return new(e||t)(I.bc(V.b))},t.\u0275cmp=I.Vb({type:t,selectors:[["toggle-job-action-complete"]],inputs:{jobAction:"jobAction",baseMetal:"baseMetal",plating:"plating",finish:"finish",resizeTo:"resizeTo",loading:"loading",fullFormat:"fullFormat",placeholderName:"placeholderName",descriptor:"descriptor",onHold:"onHold"},outputs:{confirmedAction:"confirmedAction"},features:[I.Lb],decls:4,vars:4,consts:[[4,"ngIf"],["class","action-toggler not-required",3,"expanded",4,"ngIf"],["class","action-toggler",3,"expanded",4,"ngIf"],[1,"action-toggler"],["class","title",4,"ngIf"],[3,"click",4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],[1,"title"],[3,"click"],["class","job-incomplete color-muted far fa-circle fa-2x",4,"ngIf"],["class","toggle-button incomplete",4,"ngIf"],[1,"job-incomplete","color-muted","far","fa-circle","fa-2x"],[1,"toggle-button","incomplete"],[1,"fas","fa-check"],[3,"ngbTooltip"],[1,"color-info","far","fa-clock","fa-2x",3,"click"],[1,"double-confirm-container",3,"click"],[1,"confirm-button"],["class","color-success fas fa-check fa-2x",4,"ngIf"],["class","toggle-button complete",4,"ngIf"],[1,"color-success","fas","fa-check","fa-2x"],[1,"toggle-button","complete"],[1,"mb-0","pt-2","text-muted","small",2,"line-height","1.1"],[1,"action-toggler","not-required"],["class","toggle-button",4,"ngIf"],[1,"toggle-button"],[1,"color-muted","fa","fa-circle-notch","fa-spin","fa-2x"]],template:function(t,e){1&t&&(I.cd(0,Kc,8,10,"ng-container",0),I.cd(1,ei,3,4,"div",1),I.cd(2,ni,2,2,"div",2),I.cd(3,ci,2,2,"div",2)),2&t&&(I.Dc("ngIf",e._jobAction&&!e.state.fakeLoading),I.Nb(1),I.Dc("ngIf",!e._jobAction&&!e.state.loading),I.Nb(1),I.Dc("ngIf",e.state.fakeLoading),I.Nb(1),I.Dc("ngIf",e.state.loading))},directives:[g.u,Y.m],styles:[".action-toggler[_ngcontent-%COMP%]{text-align:center}.action-toggler[_ngcontent-%COMP%]   .job-incomplete[_ngcontent-%COMP%]{color:#dfe3e6}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]{background:#1c364c;border-radius:4px;color:#fff;padding:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none;text-transform:uppercase;font-weight:700;letter-spacing:.5px;background:linear-gradient(90deg,#1c364c 50%,#315e84 0);background-size:200% 100%;background-position:0 100%;cursor:pointer;font-size:12px}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container.awaiting[_ngcontent-%COMP%]{-webkit-animation:confirming-timeout-wipe 3s linear both;animation:confirming-timeout-wipe 3s linear both}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:6px}.action-toggler.expanded[_ngcontent-%COMP%]{padding:12px 10px 20px;text-align:center;border:2px solid #e1dcdc;border-radius:9px;transition:all .3s ease;height:100%;display:flex;flex-flow:column;justify-content:flex-start}.action-toggler.expanded[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{display:none!important}.action-toggler.expanded[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.action-toggler.expanded.complete[_ngcontent-%COMP%]{border-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:4px;margin:0 auto;background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;position:relative;line-height:35px}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]:hover{cursor:pointer}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]{background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.incomplete[_ngcontent-%COMP%]{background-color:#fff;box-shadow:inset 0 0 0 2px #c2c2c2}.action-toggler.expanded.not-required[_ngcontent-%COMP%], .action-toggler.expanded.not-required[_ngcontent-%COMP%]:focus, .action-toggler.expanded.not-required[_ngcontent-%COMP%]:hover{border:none!important}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{opacity:.5}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{background:#dadada;border:none}@-webkit-keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}@keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}"]}),t}(),oi=n("kvL/"),ai=n("ZOsW"),si=n("c3nT"),di=n("1lsF"),li=n("k4pO"),ri=n("UYcP"),ui=n("kIIl");function gi(t,e){1&t&&(I.hc(0,"span",27),I.ed(1,"HD"),I.gc())}function hi(t,e){1&t&&(I.hc(0,"p",28),I.cc(1,"i",29),I.ed(2," This job is ON HOLD "),I.gc())}function bi(t,e){1&t&&(I.hc(0,"p",28),I.cc(1,"i",30),I.ed(2," This item is important. Extra care required. "),I.gc())}function mi(t,e){1&t&&(I.hc(0,"p",28),I.cc(1,"i",31),I.ed(2," This job needs rushing through and completing ASAP! "),I.gc())}function pi(t,e){1&t&&(I.hc(0,"div",32),I.hc(1,"span",33),I.ed(2,"On Hold"),I.gc(),I.gc())}function fi(t,e){if(1&t&&(I.hc(0,"div",32),I.hc(1,"span",34),I.ed(2,"Wedding"),I.gc(),I.ed(3),I.xc(4,"simpleDate"),I.gc()),2&t){var n=I.wc(2);I.Nb(3),I.gd(" ",n.data.job.node.submission.specialDate?"Special date is "+I.yc(4,1,n.data.job.node.submission.specialDate):""," ")}}function vi(t,e){1&t&&(I.fc(0),I.hc(1,"div",2),I.cc(2,"loading-ring",35),I.hc(3,"p",36),I.ed(4,"Loading job actions..."),I.gc(),I.gc(),I.ec())}function Si(t,e){if(1&t){var n=I.ic();I.fc(0),I.hc(1,"div",37),I.hc(2,"toggle-job-action-complete",38),I.sc("confirmedAction",(function(t){return I.Qc(n),I.wc(2).updateJobAction(t)})),I.gc(),I.gc(),I.ec()}if(2&t){var c=e.$implicit,i=I.wc(2);I.Nb(2),I.Dc("fullFormat",!0)("jobAction",c)("loading",i.data.loadingJobActions)("onHold",i.data.job.node.onHold)("baseMetal",i.data.job.node.submission.baseMetal.name)("plating",(null==i.data.job.node.submission?null:i.data.job.node.submission.plating.name)!==i.noPlating?i.data.job.node.submission.plating.name:null)("finish",i.data.job.node.submission.finish.name)("resizeTo",i.data.job.node.submission.ringResize?i.data.job.node.submission.ringSizeCustom.name:null)}}function yi(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"div",2),I.hc(2,"p",3),I.hc(3,"strong"),I.ed(4,"Description"),I.gc(),I.gc(),I.hc(5,"p"),I.ed(6),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(6),I.fd(n.data.job.node.submission.stoneDescription)}}function Ci(t,e){if(1&t&&(I.hc(0,"div",47),I.cc(1,"img",48),I.xc(2,"lowercase"),I.xc(3,"lowercase"),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(1),I.Gc("src","/assets/img/stones/",I.yc(2,2,n.node.stoneType.name),"/",I.yc(3,4,n.node.stoneType.name),"_side.png",I.Tc)}}function Ii(t,e){if(1&t&&(I.hc(0,"p",3),I.hc(1,"strong"),I.ed(2),I.xc(3,"titlecase"),I.gc(),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(2),I.fd(I.yc(3,1,n.node.stoneType.name))}}function Ni(t,e){if(1&t&&(I.hc(0,"p",3),I.hc(1,"strong"),I.ed(2),I.xc(3,"titlecase"),I.gc(),I.gc()),2&t){var n=I.wc().$implicit;I.Nb(2),I.gd("Custom: ",I.yc(3,1,n.node.customName),"")}}function wi(t,e){if(1&t&&(I.fc(0),I.hc(1,"div",41),I.hc(2,"p",3),I.hc(3,"strong"),I.ed(4),I.gc(),I.gc(),I.hc(5,"div",42),I.hc(6,"div",43),I.cd(7,Ci,4,6,"div",44),I.hc(8,"div",45),I.cd(9,Ii,4,3,"p",46),I.cd(10,Ni,4,3,"p",46),I.hc(11,"p",5),I.ed(12),I.cc(13,"br"),I.ed(14),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.ec()),2&t){var n=e.$implicit,c=e.index;I.Nb(4),I.gd("Placement #",c+1,""),I.Nb(3),I.Dc("ngIf",!n.node.customName),I.Nb(1),I.Dc("ngClass",n.node.customName?"col-12":"col-8"),I.Nb(1),I.Dc("ngIf",!n.node.customName),I.Nb(1),I.Dc("ngIf",n.node.customName),I.Nb(2),I.gd(" ",n.node.stoneSize.name,""),I.Nb(2),I.gd(" Qty: ",n.node.number," ")}}function ji(t,e){if(1&t&&(I.hc(0,"div",1),I.cd(1,wi,15,7,"ng-container",18),I.gc()),2&t){var n=I.wc(3);I.Nb(1),I.Dc("ngForOf",n.data.stones)}}function Ai(t,e){1&t&&(I.hc(0,"div",1),I.cc(1,"loading-ring",35),I.hc(2,"p"),I.ed(3,"Loading stones setting config..."),I.gc(),I.gc())}function xi(t,e){if(1&t&&(I.hc(0,"div",39),I.hc(1,"div",13),I.hc(2,"div",14),I.hc(3,"div",15),I.hc(4,"div",16),I.hc(5,"h5",5),I.ed(6,"Stone Setting"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(7,"div",1),I.hc(8,"div",2),I.cd(9,yi,7,1,"div",40),I.cd(10,ji,2,1,"div",25),I.cd(11,Ai,4,0,"div",25),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(9),I.Dc("ngIf",n.data.job.node.submission.stoneDescription),I.Nb(1),I.Dc("ngIf",n.data.stones.length),I.Nb(1),I.Dc("ngIf",!n.data.stones.length)}}function Di(t,e){if(1&t&&(I.hc(0,"div",49),I.hc(1,"div",13),I.hc(2,"div",14),I.hc(3,"div",15),I.hc(4,"div",16),I.hc(5,"h5",5),I.ed(6,"Chain"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(7,"div",1),I.hc(8,"div",2),I.hc(9,"div",13),I.hc(10,"div",50),I.ed(11,"Chain Type"),I.gc(),I.hc(12,"div",51),I.ed(13),I.xc(14,"titlecase"),I.gc(),I.gc(),I.hc(15,"div",13),I.hc(16,"div",50),I.ed(17,"Chain Length"),I.gc(),I.hc(18,"div",51),I.ed(19),I.xc(20,"titlecase"),I.gc(),I.gc(),I.hc(21,"div",13),I.hc(22,"div",50),I.ed(23,"Chain Plating"),I.gc(),I.hc(24,"div",51),I.ed(25),I.xc(26,"titlecase"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(13),I.fd(I.yc(14,3,n.data.job.node.submission.chainType.name)),I.Nb(6),I.fd(I.yc(20,5,n.data.job.node.submission.chainLength.name)),I.Nb(6),I.fd(I.yc(26,7,n.data.job.node.submission.chainPlating.name))}}function Mi(t,e){if(1&t&&(I.hc(0,"div",52),I.hc(1,"div",13),I.hc(2,"div",14),I.hc(3,"div",15),I.hc(4,"div",16),I.hc(5,"h5",5),I.ed(6,"Engraving"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(7,"div",1),I.hc(8,"div",2),I.hc(9,"div",13),I.hc(10,"div",50),I.ed(11,"Engraving Text"),I.gc(),I.hc(12,"div",51),I.ed(13),I.gc(),I.gc(),I.hc(14,"div",13),I.hc(15,"div",50),I.ed(16,"Font Name"),I.gc(),I.hc(17,"div",51),I.ed(18),I.gc(),I.gc(),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(13),I.fd(n.data.job.node.submission.engravingText),I.Nb(5),I.fd(n.data.job.node.submission.engravingFont)}}function Pi(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"div",55),I.ed(2,"Ring Size (Original)"),I.gc(),I.hc(3,"div",41),I.ed(4),I.xc(5,"titlecase"),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(4),I.fd(I.yc(5,1,n.data.job.node.submission.originalRingSize.name))}}function Ti(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"div",55),I.ed(2,"Ring Size (Measured)"),I.gc(),I.hc(3,"div",41),I.ed(4),I.xc(5,"uppercase"),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(4),I.fd(I.yc(5,1,n.data.job.node.submission.measuredRingSize.name))}}function Bi(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"div",55),I.ed(2,"Target Ring Size"),I.gc(),I.hc(3,"div",41),I.ed(4),I.xc(5,"uppercase"),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(4),I.fd(I.yc(5,1,n.data.job.node.submission.ringSizeCustom.name))}}function ki(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"div",55),I.ed(2,"Jump Ring"),I.gc(),I.hc(3,"div",56),I.cc(4,"i"),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(3),I.Dc("ngClass",n.data.job.node.submission.jumpRing?"text-success":"text-danger"),I.Nb(1),I.Qb("fas ",n.data.job.node.submission.jumpRing?"fa-check":"fa-times","")}}function Oi(t,e){if(1&t&&(I.hc(0,"div",13),I.hc(1,"div",55),I.ed(2,"Placement"),I.gc(),I.hc(3,"div",2),I.ed(4),I.gc(),I.gc()),2&t){var n=I.wc(3);I.Nb(4),I.gd(" ",n.data.job.node.submission.jumpRingPlacement," ")}}function Ei(t,e){if(1&t&&(I.hc(0,"div",53),I.hc(1,"div",13),I.hc(2,"div",14),I.hc(3,"div",15),I.hc(4,"div",24),I.hc(5,"h5",5),I.ed(6,"Submission"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(7,"div",1),I.hc(8,"div",54),I.hc(9,"div",13),I.hc(10,"div",55),I.ed(11,"Jewellery Type"),I.gc(),I.hc(12,"div",41),I.ed(13),I.xc(14,"titlecase"),I.gc(),I.gc(),I.hc(15,"div",13),I.hc(16,"div",55),I.ed(17,"Base Metal"),I.gc(),I.hc(18,"div",41),I.ed(19),I.xc(20,"titlecase"),I.gc(),I.gc(),I.hc(21,"div",13),I.hc(22,"div",55),I.ed(23,"Finish"),I.gc(),I.hc(24,"div",41),I.ed(25),I.xc(26,"titlecase"),I.gc(),I.gc(),I.hc(27,"div",13),I.hc(28,"div",55),I.ed(29,"Wax Weight"),I.gc(),I.hc(30,"div",41),I.ed(31),I.xc(32,"number"),I.gc(),I.gc(),I.hc(33,"div",13),I.hc(34,"div",55),I.ed(35,"Expt Weight"),I.gc(),I.hc(36,"div",41),I.ed(37),I.xc(38,"number"),I.gc(),I.gc(),I.gc(),I.hc(39,"div",54),I.cd(40,Pi,6,3,"div",40),I.cd(41,Ti,6,3,"div",40),I.cd(42,Bi,6,3,"div",40),I.cd(43,ki,5,4,"div",40),I.cd(44,Oi,5,1,"div",40),I.gc(),I.gc(),I.gc()),2&t){var n=I.wc(2);I.Nb(13),I.fd(I.yc(14,10,n.data.job.node.submission.jewelleryType.name)),I.Nb(6),I.fd(I.yc(20,12,n.data.job.node.submission.baseMetal.name)),I.Nb(6),I.fd(I.yc(26,14,n.data.job.node.submission.finish.name)),I.Nb(6),I.gd("",I.zc(32,16,n.data.job.node.submission.waxWeight,"1.3-3"),"g"),I.Nb(6),I.gd("",I.zc(38,19,n.data.job.node.submission.expectedFinishWeight,"1.2-2"),"g"),I.Nb(3),I.Dc("ngIf",n.data.job.node.submission.originalRingSize),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.measuredRingSize),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.ringResize),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.jewelleryType.name===n.jewelleryTypePendant),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.jumpRingPlacement)}}function Ri(t,e){1&t&&(I.hc(0,"div",1),I.hc(1,"div",57),I.cc(2,"loading-ring",35),I.hc(3,"p"),I.ed(4,"Loading photos..."),I.gc(),I.gc(),I.gc())}var Ji=function(){return{addSuffix:!0,unit:"day"}},Fi=function(){return{addSuffix:!1,unit:"day"}};function _i(t,e){if(1&t&&(I.fc(0),I.hc(1,"div",1),I.hc(2,"div",2),I.hc(3,"h4",3),I.ed(4),I.xc(5,"numericId"),I.gc(),I.hc(6,"div",4),I.hc(7,"h6",5),I.ed(8),I.gc(),I.hc(9,"div",6),I.cd(10,gi,2,0,"span",7),I.hc(11,"p",8),I.xc(12,"dfnsIsPast"),I.hc(13,"strong"),I.ed(14),I.xc(15,"dfnsIsFuture"),I.xc(16,"dfnsFormatDistanceToNowStrict"),I.xc(17,"dfnsFormatDistanceToNowStrict"),I.gc(),I.gc(),I.gc(),I.gc(),I.cd(18,hi,3,0,"p",9),I.cd(19,bi,3,0,"p",9),I.cd(20,mi,3,0,"p",9),I.hc(21,"div",10),I.cd(22,pi,3,0,"div",11),I.cd(23,fi,5,3,"div",11),I.gc(),I.gc(),I.gc(),I.hc(24,"div",12),I.hc(25,"div",13),I.hc(26,"div",14),I.hc(27,"div",15),I.hc(28,"div",16),I.hc(29,"h5",5),I.ed(30,"Job Actions"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.hc(31,"div",17),I.cd(32,vi,5,0,"ng-container",0),I.cd(33,Si,3,8,"ng-container",18),I.gc(),I.gc(),I.cd(34,xi,12,3,"div",19),I.cd(35,Di,27,9,"div",20),I.cd(36,Mi,19,2,"div",21),I.cd(37,Ei,45,22,"div",22),I.hc(38,"div",23),I.hc(39,"div",13),I.hc(40,"div",14),I.hc(41,"div",15),I.hc(42,"div",24),I.hc(43,"h5",5),I.ed(44,"Photos"),I.gc(),I.gc(),I.gc(),I.gc(),I.gc(),I.cd(45,Ri,5,0,"div",25),I.cc(46,"submission-view-photos",26),I.gc(),I.ec()),2&t){var n=I.wc();I.Nb(4),I.gd("Job #",I.yc(5,20,n.data.job.node.id),""),I.Nb(4),I.fd(n.data.job.node.submission.customer.fullName),I.Nb(2),I.Dc("ngIf",n.data.job.node.submission.hardDeadline),I.Nb(1),I.Tb("text-danger",I.yc(12,22,n.data.jobDueDate)),I.Nb(3),I.gd(" ",I.yc(15,24,n.data.jobDueDate)?"Due "+I.zc(16,26,n.data.jobDueDate,I.Hc(32,Ji)):I.zc(17,29,n.data.jobDueDate,I.Hc(33,Fi))+" late"," "),I.Nb(4),I.Dc("ngIf",n.data.job.node.onHold),I.Nb(1),I.Dc("ngIf",null==n.data.job.node.submission||null==n.data.job.node.submission.kit?null:n.data.job.node.submission.kit.starred),I.Nb(1),I.Dc("ngIf",n.data.job.node.rush),I.Nb(2),I.Dc("ngIf",n.data.job.node.onHold),I.Nb(1),I.Dc("ngIf",(null==n.data.job.node.submission.customer||null==n.data.job.node.submission.customer.event?null:n.data.job.node.submission.customer.event.eventType.name)===n.eventTypeWedding),I.Nb(9),I.Dc("ngIf",n.data.loadingJobActions),I.Nb(1),I.Dc("ngForOf",n.data.jobActionObj),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.stoneDescription&&n.data.stones.length),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.chainType&&n.data.job.node.submission.chainLength&&n.data.job.node.submission.chainPlating),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission.engravingFont&&n.data.job.node.submission.engravingText),I.Nb(1),I.Dc("ngIf",n.data.job.node.submission),I.Nb(8),I.Dc("ngIf",!n.data.job.node.submission.submissionPhotos),I.Nb(1),I.Dc("photos",n.data.job.node.submission.submissionPhotos.edges)("title",!1)}}var zi=function(){function t(){this.eventTypeWedding=U.a,this.noPlating=ri.b,this.jewelleryTypePendant=S.d,this.now=new Date,this.data=null,this.confirmJobAction=new I.r,this.openSubmission=new I.r}return t.prototype.updateJobAction=function(t){this.confirmJobAction.emit(t)},t.prototype.openSubmissionReq=function(t){this.openSubmission.emit(t)},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=I.Vb({type:t,selectors:[["job-detail-sidebar"]],inputs:{data:"data"},outputs:{confirmJobAction:"confirmJobAction",openSubmission:"openSubmission"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col"],[1,"mb-1"],[1,"d-flex","justify-content-between","mb-4"],[1,"mb-0"],[1,"d-flex","align-items-center"],["class","pill-tag hard-deadline mr-1",4,"ngIf"],[1,"text-warning","text-right","mb-0"],["class","text-muted mb-0",4,"ngIf"],[1,"my-1"],["class","text-muted",4,"ngIf"],["id","job-actions",1,"mt-5","sidebar-section"],[1,"row","mb-2"],[1,"col","px-0"],[1,"section-title"],[1,"d-flex","justify-content-between","align-items-center","flex-md-row"],[1,"row","actions"],[4,"ngFor","ngForOf"],["id","stone-setting","class","mt-5 sidebar-section",4,"ngIf"],["id","chain","class","mt-5 sidebar-section",4,"ngIf"],["id","engraving","class","mt-5 sidebar-section",4,"ngIf"],["id","submission","class","mt-5 sidebar-section",4,"ngIf"],["id","photos",1,"mt-5","sidebar-section"],[1,"d-flex","justify-content-between","flex-md-row","align-items-center"],["class","row",4,"ngIf"],[3,"photos","title"],[1,"pill-tag","hard-deadline","mr-1"],[1,"text-muted","mb-0"],[1,"fas","mr-1","fa-hand-paper","text-danger"],[1,"fas","mr-1","fa-star","text-warning"],[1,"fas","mr-1","fa-shipping-fast","text-danger"],[1,"text-muted"],[1,"pill-tag","on-hold","mr-1"],[1,"pill-tag","wedding","mr-1"],["size","30"],[1,"text-center"],[1,"col-4","col-md-3","action"],[3,"fullFormat","jobAction","loading","onHold","baseMetal","plating","finish","resizeTo","confirmedAction"],["id","stone-setting",1,"mt-5","sidebar-section"],["class","row mb-2",4,"ngIf"],[1,"col-6"],[1,"stone-item"],[1,"row","align-items-center"],["class","col-4",4,"ngIf"],[3,"ngClass"],["class","mb-1",4,"ngIf"],[1,"col-4"],["alt","",1,"w-100",3,"src"],["id","chain",1,"mt-5","sidebar-section"],[1,"col-3","text-muted"],[1,"col-9"],["id","engraving",1,"mt-5","sidebar-section"],["id","submission",1,"mt-5","sidebar-section"],[1,"col-sm-6"],[1,"col-6","text-muted"],[1,"col-6",3,"ngClass"],[1,"col","text-center"]],template:function(t,e){1&t&&I.cd(0,_i,47,34,"ng-container",0),2&t&&I.Dc("ngIf",e.data)},directives:[g.u,g.t,je.a,Vt.a,ii,g.r],pipes:[Je.a,ui.Mb,ui.Lb,ui.Y,ke.a,g.q,g.G,g.g,g.I],encapsulation:2}),t}(),Qi=n("lUu4"),Hi=n("K9Ib"),Li=n("rhck"),$i=n("/wnf"),Wi=n("YbyT"),Gi=n("57tZ"),qi=n("sMau"),Ui=n("xzcs"),Yi=n("D2Fp"),Vi=n("lbMj"),Xi=n("IfPz"),Ki=n("PxxC"),Zi=n("zoH9"),to=n("DWOX"),eo=n("DwNB"),no=n("Cdzh"),co=n("BAfr"),io=n("mhvR"),oo=n("o14v"),ao=n("bvrU"),so=n("iUZM"),lo=n("Lpkd"),ro=n("o973"),uo=n("aX/C"),go=n("R+a7"),ho=n("Xv7A"),bo=n("HEvJ"),mo=n("b44C"),po=n("SGUZ"),fo=n("uYjB"),vo=n("oy+2"),So=n("0UpH"),yo=n("dkTK"),Co=n("QZ6d"),Io=n("9tk/"),No=n("RNmn"),wo=function(){function t(){}return t.\u0275mod=I.Zb({type:t}),t.\u0275inj=I.Yb({factory:function(e){return new(e||t)},imports:[[di.BatchModule,g.c,h.f,Qc,ai.b,Y.g,oi.c,Te.b,b.a,Me.f,Me.j,si.SubmissionModule,li.d,ui.cb,ui.m]]}),t}();I.Uc(Ut,[ue.a,g.r,g.s,g.t,g.u,g.B,g.x,g.y,g.z,g.A,g.v,g.w,h.z,h.p,h.y,h.d,h.q,h.t,h.a,h.v,h.w,h.s,h.k,h.l,h.u,h.h,h.g,h.r,h.b,h.e,h.n,h.o,h.m,m.g,m.c,m.e,m.d,m.h,ai.a,ai.n,ai.d,ai.c,ai.e,ai.f,ai.g,ai.h,ai.i,ai.j,ai.k,ai.l,ai.m,Y.c,Y.d,Y.h,Y.f,Y.e,Y.k,oi.a,oi.g,oi.d,oi.b,oi.e,oi.f,Te.a,Qi.a,Hi.a,Li.a,$i.a,Wi.a,Gi.a,qi.a,Ui.a,Yi.a,Vi.a,Xi.a,Kt.a,Ki.a,Zi.a,Vt.a,to.a,eo.a,Be.a,we.a,Y.m,Yt.a,p.a,no.a,Xt.a,co.a,io.a,oo.a,ao.a,so.a,lo.a,je.a,ro.a,uo.a,go.a,ho.a,bo.a,Pe.a,W.a,mo.a,De.a,po.a,fo.a,Me.b,Me.k,Me.g,Me.e,Me.c,Me.d,Me.i,Me.l,Me.h,li.c,li.b,li.a,Ut,Se,Bc,re,ii,xe,_c,zi],[g.b,g.I,g.q,g.l,g.F,g.g,g.D,g.G,g.d,g.f,g.j,g.k,g.m,vo.a,Ee.a,So.a,Oe.a,Je.a,Re.a,yo.a,Co.a,ke.a,Io.a,No.a,Fe.a,ui.bb,ui.a,ui.b,ui.c,ui.d,ui.e,ui.f,ui.g,ui.h,ui.i,ui.j,ui.k,ui.l,ui.eb,ui.o,ui.q,ui.p,ui.s,ui.r,ui.t,ui.u,ui.v,ui.w,ui.x,ui.y,ui.z,ui.A,ui.B,ui.C,ui.D,ui.E,ui.n,ui.S,ui.U,ui.W,ui.Y,ui.F,ui.G,ui.I,ui.H,ui.J,ui.K,ui.L,ui.M,ui.N,ui.O,ui.P,ui.Q,ui.R,ui.fb,ui.gb,ui.hb,ui.ib,ui.jb,ui.lb,ui.mb,ui.nb,ui.pb,ui.ob,ui.qb,ui.rb,ui.sb,ui.tb,ui.ub,ui.vb,ui.wb,ui.xb,ui.Gb,ui.Ab,ui.yb,ui.Eb,ui.kb,ui.Cb,ui.Tb,ui.Ub,ui.Vb,ui.Wb,ui.Xb,ui.Zb,ui.Sb,ui.ac,ui.bc,ui.fc,ui.hc,ui.ic,ui.jc,ui.kc,ui.lc,ui.mc,ui.nc,ui.oc,ui.pc,ui.qc,ui.uc,ui.vc,ui.gc,ui.sc,ui.wc,ui.xc,ui.yc,ui.zc,ui.Ac,ui.Bc,ui.Cc,ui.Dc,ui.Ec,ui.Fc,ui.Hb,ui.Ib,ui.Jb,ui.Kb,ui.Lb,ui.Mb,ui.Qb,ui.Pb,ui.Rb,ui.Nb,ui.dc,ui.Gc,ui.Ob,ui.db,ui.Hc,ui.T,ui.V,ui.X,ui.Ic,ui.Bb,ui.zb,ui.Fb,ui.Db,ui.rc,ui.tc,ui.Yb,ui.ec,ui.cc,ui.Z,ui.ab])}}]);