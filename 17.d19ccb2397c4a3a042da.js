(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{G81l:function(t,e,n){"use strict";n.r(e),n.d(e,"ManufacturingModule",(function(){return tc}));var i,c,o,a,s,d,l,r,u,g=n("ofXK"),b=n("3Pt+"),f=n("PCNd"),m=n("tyNb"),p=n("HKlZ"),h=n("QVjv"),v=n("EY2u"),C=n("lTCR"),M=n.n(C),S=M()(i||(r=["\n    query jobActionsByJobs(\n        $jobs: [String]!,\n    ) {\n        jobActions(\n            first: 999,\n            job_list: $jobs,\n        ) {\n            edges  {\n                node {\n                    id\n                    job {\n                        id\n                        currentlyWith {\n                            id\n                            company\n                        }\n                    }\n                    action {\n                        id\n                        name\n                    }\n                    supplier {\n                        id\n                        company\n                    }\n                    started\n                    startedAt\n                    completed\n                    completedAt\n                }\n            }\n        }\n    }\n"],u=["\n    query jobActionsByJobs(\n        $jobs: [String]!,\n    ) {\n        jobActions(\n            first: 999,\n            job_list: $jobs,\n        ) {\n            edges  {\n                node {\n                    id\n                    job {\n                        id\n                        currentlyWith {\n                            id\n                            company\n                        }\n                    }\n                    action {\n                        id\n                        name\n                    }\n                    supplier {\n                        id\n                        company\n                    }\n                    started\n                    startedAt\n                    completed\n                    completedAt\n                }\n            }\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(r,"raw",{value:u}):r.raw=u,i=r)),A=M()(c||(c=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation updateJobAction(\n        $id: ID!,\n        $started: Boolean,\n        $startedAt: String,\n        $completed: Boolean,\n        $completedAt: String,\n    ) {\n        updateJobAction(input: {\n            id: $id\n            started: $started,\n            startedAt: $startedAt,\n            completed: $completed,\n            completedAt: $completedAt,\n            clientMutationId: "",\n        }) {\n            id\n            action {\n                id\n                name\n            }\n        }\n    }\n'],['\n    mutation updateJobAction(\n        $id: ID!,\n        $started: Boolean,\n        $startedAt: String,\n        $completed: Boolean,\n        $completedAt: String,\n    ) {\n        updateJobAction(input: {\n            id: $id\n            started: $started,\n            startedAt: $startedAt,\n            completed: $completed,\n            completedAt: $completedAt,\n            clientMutationId: "",\n        }) {\n            id\n            action {\n                id\n                name\n            }\n        }\n    }\n']))),I=M()(o||(o=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation createJobAction(\n        $job: String!,\n        $action: String!,\n        $supplier: String,\n        $started: Boolean,\n        $startedAt: String,\n        $completed: Boolean!,\n        $completedAt: String,\n    ) {\n        createJobAction(input: {\n            clientMutationId: ""\n            job: $job,\n            action: $action,\n            supplier: $supplier,\n            started: $started,\n            startedAt: $startedAt,\n            completed: $completed,\n            completedAt: $completedAt,\n        }) {\n            id\n            action {\n                id\n                name\n            }\n        }\n    }\n'],['\n    mutation createJobAction(\n        $job: String!,\n        $action: String!,\n        $supplier: String,\n        $started: Boolean,\n        $startedAt: String,\n        $completed: Boolean!,\n        $completedAt: String,\n    ) {\n        createJobAction(input: {\n            clientMutationId: ""\n            job: $job,\n            action: $action,\n            supplier: $supplier,\n            started: $started,\n            startedAt: $startedAt,\n            completed: $completed,\n            completedAt: $completedAt,\n        }) {\n            id\n            action {\n                id\n                name\n            }\n        }\n    }\n']))),y=M()(a||(a=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation deleteJobAction($id: ID!) {\n        deleteJobAction (\n            input: {\n                id: $id,\n                clientMutationId: ""\n            }\n        ) {\n            id\n        }\n    }\n'],['\n    mutation deleteJobAction($id: ID!) {\n        deleteJobAction (\n            input: {\n                id: $id,\n                clientMutationId: ""\n            }\n        ) {\n            id\n        }\n    }\n']))),w=n("fXoL"),j=n("/IUn"),P=function(){function t(t){this.apollo=t}return t.prototype.getByJobIds=function(t){return t.length?this.apollo.query({query:S,variables:{jobs:t},fetchPolicy:"network-only"}):v.a},t.prototype.update=function(t){return this.apollo.mutate({mutation:A,variables:t})},t.prototype.create=function(t){return this.apollo.mutate({mutation:I,variables:t})},t.prototype.delete=function(t){return e=this,void 0,i=function(){return function(t,e){var n,i,c,o,a={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(c=2&o[0]?i.return:o[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,o[1])).done)return c;switch(i=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((c=(c=a.trys).length>0&&c[c.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){a.label=o[1];break}if(6===o[0]&&a.label<c[1]){a.label=c[1],c=o;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(o);break}c[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],i=0}finally{n=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){switch(e.label){case 0:return[4,this.apollo.mutate({mutation:y,variables:{id:t}}).toPromise()];case 1:return[2,e.sent()]}}))},new((n=void 0)||(n=Promise))((function(t,c){function o(t){try{s(i.next(t))}catch(e){c(e)}}function a(t){try{s(i.throw(t))}catch(e){c(e)}}function s(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(t){t(i)}))).then(o,a)}s((i=i.apply(e,[])).next())}));var e,n,i},t.\u0275fac=function(e){return new(e||t)(w.oc(j.b))},t.\u0275prov=w.Wb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),x=n("zOkP"),B=M()(s||(s=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"]))),T="Plating",k="Engraving",E="Jump Ring",O="Earring Posts",J="Stone Setting",N="Resizing",$="Repairing",_="Hallmarking",R=function(){function t(t){this.apollo=t}return t.prototype.list=function(){return this.apollo.watchQuery({query:B}).valueChanges},t.\u0275fac=function(e){return new(e||t)(w.oc(j.b))},t.\u0275prov=w.Wb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),F=n("5Ndf"),D=n("BaBC"),H=M()(d||(d=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            id\n        }\n    }\n'],['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            id\n        }\n    }\n']))),G=M()(l||(l=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"],["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"]))),W=function(){function t(t){this.apollo=t}return t.prototype.create=function(t){return this.apollo.mutate({mutation:H,variables:t})},t.prototype.getBySupplierIds=function(t){return t.length?this.apollo.query({query:G,variables:{suppliers:t}}):v.a},t.\u0275fac=function(e){return new(e||t)(w.oc(j.b))},t.\u0275prov=w.Wb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),L=n("1uah"),q=n("CIHE"),z=n("Nlbt"),U=n("uA1o"),Y=n("S6Vu"),Q=n("bCT2"),V=n("KPdS"),X=n("PC64"),K=n("1kSV"),Z=n("5eHb"),tt=n("n4kJ"),et=n("Xv7A"),nt=n("XhFI");function it(t,e){if(1&t&&(w.gc(0,"div",8),w.dd(1),w.fc()),2&t){var n=w.vc(2);w.Mb(1),w.fd(" ",n._jobAction.node.action.name," ")}}function ct(t,e){1&t&&w.bc(0,"span",12)}function ot(t,e){1&t&&(w.gc(0,"div",13),w.bc(1,"i",14),w.fc())}function at(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.rc("click",(function(t){w.Pc(n);var e=w.vc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),w.bd(1,ct,1,0,"span",10),w.bd(2,ot,2,0,"div",11),w.fc()}if(2&t){var i=w.vc(2);w.Mb(1),w.Cc("ngIf",!i.expandedFormat),w.Mb(1),w.Cc("ngIf",i.expandedFormat)}}function st(t,e){if(1&t){var n=w.hc();w.gc(0,"div",15),w.gc(1,"span",16),w.rc("click",(function(t){w.Pc(n);var e=w.vc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Cc("ngbTooltip",i._jobAction.node.action.name+" at "+i._jobAction.node.job.currentlyWith.company)}}function dt(t,e){if(1&t){var n=w.hc();w.gc(0,"div"),w.gc(1,"div",17),w.rc("click",(function(t){return w.Pc(n),w.vc(2).confirmed(t)})),w.gc(2,"span",18),w.dd(3," Confirm "),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(1),w.Sb("awaiting",i.state.confirming)}}function lt(t,e){1&t&&w.bc(0,"span",21)}function rt(t,e){1&t&&(w.gc(0,"div",22),w.bc(1,"i",14),w.fc())}function ut(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.rc("click",(function(t){w.Pc(n);var e=w.vc(2);return e.showConfirmAction(e.jobStateNotStarted,t)})),w.bd(1,lt,1,0,"span",19),w.bd(2,rt,2,0,"div",20),w.fc()}if(2&t){var i=w.vc(2);w.Mb(1),w.Cc("ngIf",!i.expandedFormat),w.Mb(1),w.Cc("ngIf",i.expandedFormat)}}function gt(t,e){if(1&t&&(w.gc(0,"div",23),w.gc(1,"p"),w.dd(2),w.wc(3,"titlecase"),w.fc(),w.fc()),2&t){var n=w.vc(2);w.Mb(2),w.ed(w.xc(3,1,n.description))}}function bt(t,e){if(1&t&&(w.ec(0),w.gc(1,"div",3),w.bd(2,it,2,1,"div",4),w.bd(3,at,3,2,"div",5),w.bd(4,st,2,1,"div",6),w.bd(5,dt,4,2,"div",0),w.bd(6,ut,3,2,"div",5),w.bd(7,gt,4,3,"div",7),w.fc(),w.dc()),2&t){var n=w.vc();w.Mb(1),w.Sb("complete",n._jobAction.node.completed&&!n.state.loading)("expanded",n.expandedFormat),w.Mb(1),w.Cc("ngIf",n.expandedFormat),w.Mb(1),w.Cc("ngIf",!n.state.confirming&&!n._jobAction.node.started&&!n._jobAction.node.completed),w.Mb(1),w.Cc("ngIf",!n.state.confirming&&n._jobAction.node.started&&!n._jobAction.node.completed),w.Mb(1),w.Cc("ngIf",n.state.confirming),w.Mb(1),w.Cc("ngIf",!n.state.confirming&&n._jobAction.node.completed),w.Mb(1),w.Cc("ngIf",n.expandedFormat)}}function ft(t,e){if(1&t&&(w.gc(0,"div",8),w.dd(1),w.fc()),2&t){var n=w.vc(2);w.Mb(1),w.fd(" ",n.placeholder," ")}}function mt(t,e){1&t&&w.bc(0,"div",26)}function pt(t,e){if(1&t&&(w.gc(0,"div",24),w.bd(1,ft,2,1,"div",4),w.bd(2,mt,1,0,"div",25),w.fc()),2&t){var n=w.vc();w.Sb("expanded",n.expandedFormat),w.Mb(1),w.Cc("ngIf",n.expandedFormat),w.Mb(1),w.Cc("ngIf",n.expandedFormat)}}function ht(t,e){if(1&t&&(w.gc(0,"div",3),w.bc(1,"span",27),w.fc()),2&t){var n=w.vc();w.Sb("expanded",n.expandedFormat)}}function vt(t,e){if(1&t&&(w.gc(0,"div",3),w.bc(1,"span",27),w.fc()),2&t){var n=w.vc();w.Sb("expanded",n.expandedFormat)}}var Ct=function(){function t(t){this.toastrService=t,this.jobStateNotStarted="notStarted",this.jobStateCompleted="completed",this.confirmActionTimeout=null,this._allowEdit=!0,this.placeholder=null,this.description=null,this.expandedFormat=null,this._onHold=null,this.state={confirming:!1,fakeLoading:!1,futureJobState:null,loading:!0},this.confirmedAction=new w.q}return Object.defineProperty(t.prototype,"allowEdit",{set:function(t){this._allowEdit=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jobAction",{set:function(t){this._jobAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loading",{set:function(t){this.state.loading=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullFormat",{set:function(t){this.expandedFormat=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderName",{set:function(t){this.placeholder=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descriptor",{set:function(t){this.description=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHold",{set:function(t){this._onHold=t},enumerable:!1,configurable:!0}),t.prototype.confirmed=function(t){var e=this;t.stopPropagation(),clearTimeout(this.confirmActionTimeout),this.confirmActionTimeout=null,this.state.confirming=!1,this.state.fakeLoading=!0,this.state.futureJobState===this.jobStateNotStarted?(this._jobAction.node.started=!1,this._jobAction.node.startedAt=null,this._jobAction.node.completed=!1,this._jobAction.node.completedAt=null):this.state.futureJobState===this.jobStateCompleted&&(this._jobAction.node.completed=!0,this._jobAction.node.completedAt=(new Date).toISOString()),this.state.futureJobState=null,this.confirmedAction.emit(this._jobAction),setTimeout((function(){e.state.fakeLoading=!1}),800)},t.prototype.showConfirmAction=function(t,e){var n=this;this._onHold?this.toastrService.warning(null,"Item is on hold"):this._allowEdit?(e.stopPropagation(),this.state.confirming=!0,this.state.futureJobState=t,this.confirmActionTimeout=setTimeout((function(){n.state.futureJobState=null,n.state.confirming=!1}),3e3)):this.toastrService.warning(null,'Jobs may only be updated from "In Progress" or "Production Complete" tabs')},t.\u0275fac=function(e){return new(e||t)(w.ac(Z.b))},t.\u0275cmp=w.Ub({type:t,selectors:[["toggle-job-action-complete"]],inputs:{allowEdit:"allowEdit",jobAction:"jobAction",loading:"loading",fullFormat:"fullFormat",placeholderName:"placeholderName",descriptor:"descriptor",onHold:"onHold"},outputs:{confirmedAction:"confirmedAction"},decls:4,vars:4,consts:[[4,"ngIf"],["class","action-toggler not-required",3,"expanded",4,"ngIf"],["class","action-toggler",3,"expanded",4,"ngIf"],[1,"action-toggler"],["class","title",4,"ngIf"],[3,"click",4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],["class","description",4,"ngIf"],[1,"title"],[3,"click"],["class","job-incomplete color-muted far fa-circle fa-2x",4,"ngIf"],["class","toggle-button incomplete",4,"ngIf"],[1,"job-incomplete","color-muted","far","fa-circle","fa-2x"],[1,"toggle-button","incomplete"],[1,"fas","fa-check"],[3,"ngbTooltip"],[1,"color-info","far","fa-clock","fa-2x",3,"click"],[1,"double-confirm-container",3,"click"],[1,"confirm-button"],["class","color-success fas fa-check fa-2x",4,"ngIf"],["class","toggle-button complete",4,"ngIf"],[1,"color-success","fas","fa-check","fa-2x"],[1,"toggle-button","complete"],[1,"description"],[1,"action-toggler","not-required"],["class","toggle-button",4,"ngIf"],[1,"toggle-button"],[1,"color-muted","fa","fa-circle-notch","fa-spin","fa-2x"]],template:function(t,e){1&t&&(w.bd(0,bt,8,10,"ng-container",0),w.bd(1,pt,3,4,"div",1),w.bd(2,ht,2,2,"div",2),w.bd(3,vt,2,2,"div",2)),2&t&&(w.Cc("ngIf",e._jobAction&&!e.state.fakeLoading),w.Mb(1),w.Cc("ngIf",!e._jobAction&&!e.state.loading),w.Mb(1),w.Cc("ngIf",e.state.fakeLoading),w.Mb(1),w.Cc("ngIf",e.state.loading))},directives:[g.u,K.m],pipes:[g.G],styles:[".action-toggler[_ngcontent-%COMP%]{text-align:center}.action-toggler[_ngcontent-%COMP%]   .job-incomplete[_ngcontent-%COMP%]{color:#dfe3e6}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]{background:#1c364c;border-radius:4px;color:#fff;padding:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none;text-transform:uppercase;font-weight:700;letter-spacing:.5px;background:linear-gradient(90deg,#1c364c 50%,#315e84 0);background-size:200% 100%;background-position:0 100%;cursor:pointer;font-size:12px}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container.awaiting[_ngcontent-%COMP%]{-webkit-animation:confirming-timeout-wipe 3s linear both;animation:confirming-timeout-wipe 3s linear both}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:6px}.action-toggler.expanded[_ngcontent-%COMP%]{padding:12px 10px 20px;text-align:center;border:2px solid transparent;border-radius:3px;transition:all .3s ease}.action-toggler.expanded[_ngcontent-%COMP%]:focus, .action-toggler.expanded[_ngcontent-%COMP%]:hover{border-color:#ced6d3}.action-toggler.expanded[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{display:none!important}.action-toggler.expanded[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.action-toggler.expanded.complete[_ngcontent-%COMP%]{border-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:4px;margin:0 auto;background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;position:relative;line-height:35px}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]{background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.incomplete[_ngcontent-%COMP%]{background-color:#fff;box-shadow:inset 0 0 0 2px #c2c2c2}.action-toggler.expanded.not-required[_ngcontent-%COMP%], .action-toggler.expanded.not-required[_ngcontent-%COMP%]:focus, .action-toggler.expanded.not-required[_ngcontent-%COMP%]:hover{border:none!important}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{opacity:.5}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{background:#dadada;border:none}@-webkit-keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}@keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}"]}),t}(),Mt=n("r1eF"),St=n("jmmt");function At(t,e){if(1&t&&(w.bc(0,"modal-header",2),w.gc(1,"div",3),w.gc(2,"div",4),w.gc(3,"div",5),w.bc(4,"submission-view-photos",6),w.fc(),w.fc(),w.fc()),2&t){var n=e.$implicit,i=w.vc();w.Cc("modal",n),w.Mb(4),w.Cc("photos",i._photos)}}var It=function(){function t(t,e){this.modalService=t,this.toastr=e}return Object.defineProperty(t.prototype,"photos",{set:function(t){this._photos=t},enumerable:!1,configurable:!0}),t.prototype.openModal=function(t,e){this._photos.length>0?(e.stopPropagation(),this.modalService.open(t,{size:"lg"})):this.toastr.warning("This submission has no photos logged")},t.\u0275fac=function(e){return new(e||t)(w.ac(K.i),w.ac(Z.b))},t.\u0275cmp=w.Ub({type:t,selectors:[["view-submission-photos-modal"]],inputs:{photos:"photos"},decls:3,vars:4,consts:[["type","button",1,"btn","icon-btn-outline","fas","fa-camera",3,"click"],["modalViewPhotos",""],["title","View Submission Photos",3,"modal"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[3,"photos"]],template:function(t,e){if(1&t){var n=w.hc();w.gc(0,"button",0),w.rc("click",(function(t){w.Pc(n);var i=w.Mc(2);return e.openModal(i,t)})),w.fc(),w.bd(1,At,5,2,"ng-template",null,1,w.cd)}2&t&&w.Sb("text-muted",0===e._photos.length)("text-success",e._photos.length>0)},directives:[Mt.a,St.a],encapsulation:2}),t}();function yt(t,e){if(1&t&&(w.gc(0,"p"),w.dd(1),w.fc()),2&t){var n=w.vc(2);w.Mb(1),w.ed(n._submission.customerNotes)}}function wt(t,e){if(1&t&&(w.bc(0,"modal-header",3),w.gc(1,"div",4),w.gc(2,"div",5),w.gc(3,"div",6),w.bd(4,yt,2,1,"p",7),w.fc(),w.fc(),w.fc()),2&t){var n=e.$implicit,i=w.vc();w.Cc("modal",n),w.Mb(4),w.Cc("ngIf",i._submission&&i._submission.customerNotes)}}var jt,Pt,xt,Bt,Tt=function(){function t(t){this.modalService=t,this._isAdmin=!1}return Object.defineProperty(t.prototype,"submission",{set:function(t){this._submission=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAdmin",{set:function(t){this._isAdmin=t},enumerable:!1,configurable:!0}),t.prototype.openModal=function(t,e){e.stopPropagation(),this.modalService.open(t,{size:"lg"})},t.\u0275fac=function(e){return new(e||t)(w.ac(K.i))},t.\u0275cmp=w.Ub({type:t,selectors:[["view-submission-notes-modal"]],inputs:{submission:"submission",isAdmin:"isAdmin"},decls:4,vars:0,consts:[[1,"discreet-button",3,"click"],[1,"far","fa-sticky-note"],["modalViewSubmissionNotes",""],["title","Submission Notes",3,"modal"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[4,"ngIf"]],template:function(t,e){if(1&t){var n=w.hc();w.gc(0,"a",0),w.rc("click",(function(t){w.Pc(n);var i=w.Mc(3);return e.openModal(i,t)})),w.bc(1,"span",1),w.fc(),w.bd(2,wt,5,2,"ng-template",null,2,w.cd)}},directives:[Mt.a,g.u],encapsulation:2}),t}(),kt=n("PxxC"),Et=n("wOBz"),Ot=n("ZOsW"),Jt=n("1QgP"),Nt=n("VdD3"),$t=n("XXSO"),_t=n("G0jp"),Rt=n("9WpQ"),Ft=n("SjCM"),Dt=(jt=function(t,e){return(jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}jt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ht=function(t,e,n,i){return new(n||(n=Promise))((function(c,o){function a(t){try{d(i.next(t))}catch(e){o(e)}}function s(t){try{d(i.throw(t))}catch(e){o(e)}}function d(t){var e;t.done?c(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}d((i=i.apply(t,e||[])).next())}))},Gt=function(t,e){var n,i,c,o,a={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(c=2&o[0]?i.return:o[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,o[1])).done)return c;switch(i=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((c=(c=a.trys).length>0&&c[c.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){a.label=o[1];break}if(6===o[0]&&a.label<c[1]){a.label=c[1],c=o;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(o);break}c[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],i=0}finally{n=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Wt=["searchComponent"];function Lt(t,e){1&t&&(w.gc(0,"button",40),w.dd(1,"Action"),w.fc())}function qt(t,e){if(1&t){var n=w.hc();w.gc(0,"button",42),w.rc("click",(function(){w.Pc(n);var t=w.vc(2),e=w.Mc(69);return t.openModalWithSelected(e)})),w.dd(1," Send to Outworker "),w.fc()}}function zt(t,e){if(1&t){var n=w.hc();w.gc(0,"button",42),w.rc("click",(function(){w.Pc(n);var t=w.vc(2),e=w.Mc(71);return t.openModalWithSelected(e)})),w.dd(1," Complete Action "),w.fc()}}function Ut(t,e){if(1&t){var n=w.hc();w.gc(0,"button",42),w.rc("click",(function(){w.Pc(n);var t=w.vc(2),e=w.Mc(77);return t.openModalWithSelected(e)})),w.dd(1," Put Items on Hold "),w.fc()}}function Yt(t,e){if(1&t){var n=w.hc();w.gc(0,"button",42),w.rc("click",(function(){w.Pc(n);var t=w.vc(2),e=w.Mc(79);return t.openModalWithSelected(e)})),w.dd(1," Take Items off Hold "),w.fc()}}function Qt(t,e){if(1&t){var n=w.hc();w.ec(0),w.gc(1,"button",42),w.rc("click",(function(){w.Pc(n);var t=w.vc(2),e=w.Mc(73);return t.prepareOutgoingBatch(e)})),w.dd(2," Create Outgoing Batch "),w.fc(),w.gc(3,"button",42),w.rc("click",(function(){w.Pc(n);var t=w.vc(2),e=w.Mc(75);return t.modalService.open(e)})),w.dd(4," Add To Outgoing Batch "),w.fc(),w.dc()}}function Vt(t,e){if(1&t&&(w.ec(0),w.bd(1,qt,2,0,"button",41),w.bd(2,zt,2,0,"button",41),w.bd(3,Ut,2,0,"button",41),w.bd(4,Yt,2,0,"button",41),w.bd(5,Qt,5,0,"ng-container",19),w.dc()),2&t){var n=w.vc();w.Mb(1),w.Cc("ngIf",n.availableActions.sendToOutworker),w.Mb(1),w.Cc("ngIf",n.availableActions.completeAction),w.Mb(1),w.Cc("ngIf",n.availableActions.putItemsOnHold),w.Mb(1),w.Cc("ngIf",n.availableActions.takeItemsOffHold),w.Mb(1),w.Cc("ngIf",n.availableActions.addToOutgoingBatch)}}function Xt(t,e){1&t&&(w.gc(0,"button",43),w.dd(1," Loading Actions... "),w.fc())}function Kt(t,e){if(1&t){var n=w.hc();w.gc(0,"div",44),w.gc(1,"input",45),w.rc("click",(function(){return w.Pc(n),w.vc().selectAll()}))("ngModelChange",(function(t){return w.Pc(n),w.vc().state.allSelected=t})),w.fc(),w.bc(2,"label",46),w.fc()}if(2&t){var i=w.vc();w.Mb(1),w.Cc("ngModel",i.state.allSelected)("value",i.state.allSelected)}}function Zt(t,e){if(1&t&&(w.gc(0,"span",84),w.dd(1),w.wc(2,"numericId"),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.ed(w.xc(2,1,n.job.node.outgoingBatch.id))}}function te(t,e){if(1&t&&(w.gc(0,"span",85),w.dd(1),w.wc(2,"uppercase"),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.fd(" Kit - ",w.xc(2,1,n.job.node.submission.castingCode)," ")}}var ee=function(){return[20]};function ne(t,e){if(1&t&&(w.gc(0,"span",85),w.dd(1),w.wc(2,"truncate"),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.fd(" Event - ",w.yc(2,1,n.job.node.submission.customer.event.name,w.Fc(4,ee))," ")}}function ie(t,e){if(1&t&&(w.gc(0,"span",84),w.dd(1),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc(2);w.Mb(1),w.fd(" ","in "+i.getDaysBetween(n.jobDueDate,i.now)+" days"," ")}}function ce(t,e){if(1&t&&(w.gc(0,"span",84),w.dd(1),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc(2);w.Mb(1),w.fd(" ",i.getDaysBetween(i.now,n.jobDueDate)+" days ago"," ")}}function oe(t,e){if(1&t&&w.bc(0,"view-submission-notes-modal",86),2&t){var n=w.vc().$implicit,i=w.vc(2);w.Cc("isAdmin",i.isAdmin)("submission",n.job.node.submission)}}function ae(t,e){1&t&&(w.gc(0,"span"),w.dd(1,"-"),w.fc())}function se(t,e){if(1&t&&(w.gc(0,"div",87),w.bc(1,"div",88),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.Yc("width",100*n.jobActionsCompleted/n.jobActionsNeeded+"%"),w.Sb("complete",n.jobActionsCompleted/n.jobActionsNeeded==1)("halfway",n.jobActionsCompleted/n.jobActionsNeeded>=.5)("started",n.jobActionsCompleted/n.jobActionsNeeded>0)}}function de(t,e){if(1&t&&(w.gc(0,"div",89),w.gc(1,"span"),w.dd(2),w.wc(3,"titlecase"),w.fc(),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(2),w.fd("With ",w.xc(3,1,n.job.node.currentlyWith.company),"")}}function le(t,e){if(1&t&&(w.gc(0,"div",90),w.wc(1,"lowercaseDashes"),w.gc(2,"span"),w.dd(3),w.fc(),w.fc()),2&t){var n=w.vc().$implicit;w.Pb("td fg-2 status status-pill status-",w.xc(1,4,n.job.node.status.name),""),w.Mb(3),w.ed(n.job.node.status.name)}}function re(t,e){if(1&t){var n=w.hc();w.gc(0,"toggle-job-action-complete",91),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(3).updateJobAction(t)})),w.fc()}if(2&t){var i=w.vc().$implicit,c=w.vc(2);w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionJumpRing])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("allowEdit",c.activeTab.allowEdit)}}function ue(t,e){if(1&t){var n=w.hc();w.gc(0,"toggle-job-action-complete",91),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(3).updateJobAction(t)})),w.fc()}if(2&t){var i=w.vc().$implicit,c=w.vc(2);w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionEarringPosts])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("allowEdit",c.activeTab.allowEdit)}}function ge(t,e){1&t&&w.bc(0,"span",95)}function be(t,e){1&t&&(w.gc(0,"div",96),w.gc(1,"div",97),w.dd(2,"Attachments"),w.fc(),w.bc(3,"div",98),w.fc())}function fe(t,e){if(1&t&&(w.gc(0,"div",92),w.bd(1,ge,1,0,"span",93),w.bd(2,be,4,0,"div",94),w.fc()),2&t){var n=w.vc(3);w.Mb(1),w.Cc("ngIf",n.state.loading||n.loadingJobActions),w.Mb(1),w.Cc("ngIf",!n.state.loading&&!n.loadingJobActions)}}function me(t,e){if(1&t){var n=w.hc();w.ec(0,48),w.gc(1,"div",49),w.gc(2,"div",50),w.gc(3,"div",51),w.gc(4,"div",44),w.gc(5,"input",52),w.rc("click",(function(){w.Pc(n);var t=e.$implicit;return w.vc(2).selectRow(t)}))("ngModelChange",(function(t){return w.Pc(n),e.$implicit.selected=t})),w.wc(6,"numericId"),w.fc(),w.bc(7,"label",53),w.wc(8,"numericId"),w.fc(),w.fc(),w.gc(9,"div",54),w.bc(10,"i",55),w.fc(),w.gc(11,"div",56),w.dd(12),w.wc(13,"numericId"),w.fc(),w.gc(14,"div",56),w.bd(15,Zt,3,3,"span",57),w.fc(),w.gc(16,"div",58),w.dd(17),w.bd(18,te,3,3,"span",59),w.bd(19,ne,3,5,"span",59),w.fc(),w.gc(20,"div",60),w.gc(21,"div",61),w.dd(22),w.wc(23,"titlecase"),w.bc(24,"view-submission-modal",62),w.fc(),w.fc(),w.gc(25,"div",63),w.dd(26),w.wc(27,"simpleDate"),w.bc(28,"br"),w.bd(29,ie,2,1,"span",57),w.bd(30,ce,2,1,"span",57),w.fc(),w.gc(31,"div",64),w.gc(32,"toggle-job-action-complete",65),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.gc(33,"span",66),w.dd(34,"in "),w.gc(35,"strong"),w.dd(36),w.wc(37,"titlecase"),w.fc(),w.fc(),w.fc(),w.gc(38,"div",67),w.gc(39,"a",68),w.rc("click",(function(){w.Pc(n);var t=e.$implicit;return w.vc(2).expandJobs(t)})),w.dd(40),w.bc(41,"i",69),w.fc(),w.fc(),w.gc(42,"div",67),w.bd(43,oe,1,2,"view-submission-notes-modal",70),w.bd(44,ae,2,0,"span",19),w.fc(),w.gc(45,"div",58),w.bd(46,se,2,8,"div",71),w.fc(),w.bd(47,de,4,3,"div",72),w.bd(48,le,4,6,"div",73),w.gc(49,"div",67),w.bc(50,"view-submission-photos-modal",74),w.fc(),w.fc(),w.gc(51,"div",75),w.gc(52,"div",67),w.gc(53,"div",76),w.gc(54,"div",77),w.gc(55,"h5"),w.dd(56,"Other Actions"),w.gc(57,"span"),w.dd(58,"Double click to complete an action"),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(59,"div",78),w.gc(60,"div",77),w.gc(61,"toggle-job-action-complete",79),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.wc(62,"titlecase"),w.fc(),w.fc(),w.gc(63,"div",77),w.gc(64,"toggle-job-action-complete",79),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.gc(65,"div",77),w.gc(66,"toggle-job-action-complete",79),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.wc(67,"titlecase"),w.fc(),w.fc(),w.gc(68,"div",77),w.gc(69,"toggle-job-action-complete",80),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.gc(70,"div",77),w.gc(71,"toggle-job-action-complete",80),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.gc(72,"div",77),w.bd(73,re,1,5,"toggle-job-action-complete",81),w.bd(74,ue,1,5,"toggle-job-action-complete",81),w.bd(75,fe,3,2,"div",82),w.fc(),w.gc(76,"div",77),w.gc(77,"toggle-job-action-complete",83),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.gc(78,"div",77),w.gc(79,"toggle-job-action-complete",83),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.gc(80,"div",77),w.gc(81,"toggle-job-action-complete",83),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.gc(82,"div",77),w.gc(83,"toggle-job-action-complete",83),w.rc("confirmedAction",(function(t){return w.Pc(n),w.vc(2).updateJobAction(t)})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.dc()}if(2&t){var i=e.$implicit,c=w.vc(2);w.Mb(1),w.Sb("late",i.job.node.due&&i.jobDueDate<c.now)("on-hold",i.job.node.onHold)("rush",i.job.node.rush),w.Mb(1),w.Sb("expanded",i.expanded)("selected",i.selected),w.Mb(3),w.Ec("id","job-",w.xc(6,104,i.job.node.id),""),w.Cc("ngModel",i.selected)("name","job-"+i.job.node.id),w.Mb(2),w.Ec("for","job-",w.xc(8,106,i.job.node.id),""),w.Mb(3),w.Sb("text-warning",i.job.node.rush)("text-muted",!i.job.node.rush),w.Mb(2),w.ed(w.xc(13,108,i.job.node.id)),w.Mb(3),w.Cc("ngIf",i.job.node.outgoingBatch),w.Mb(2),w.fd(" ",i.job.node.submission.customer.fullName," "),w.Mb(1),w.Cc("ngIf",i.job.node.submission.castingCode),w.Mb(1),w.Cc("ngIf",i.job.node.submission.customer.event),w.Mb(3),w.gd(" ",w.xc(23,110,i.job.node.submission.kitType.name),"",i.job.node.submission.kitType.name===c.kitTypeEarring?"s":""," "),w.Mb(2),w.Cc("isAdmin",c.isAdmin)("loadingStones",c.loadingStones)("stones",i.stones)("submission",i.job.node.submission),w.Mb(2),w.fd(" ",i.job.node.due?w.xc(27,112,i.job.node.due):""," "),w.Mb(3),w.Cc("ngIf",i.job.node.due&&i.jobDueDate>c.now),w.Mb(1),w.Cc("ngIf",i.job.node.due&&i.jobDueDate<c.now),w.Mb(2),w.Cc("jobAction",i.jobActions[c.actionCastAndMount])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("allowEdit",c.activeTab.allowEdit),w.Mb(1),w.Sb("color-success",i.job.node.submission.baseMetal.name!==c.baseMetalSilver)("muted",i.job.node.submission.baseMetal.name===c.baseMetalSilver),w.Mb(3),w.ed(w.xc(37,114,i.job.node.submission.baseMetal.name)),w.Mb(4),w.fd(" ",i.expanded?"Hide":"Show"," "),w.Mb(3),w.Cc("ngIf",i.job.node.submission.customerNotes),w.Mb(1),w.Cc("ngIf",!i.job.node.submission.customerNotes),w.Mb(2),w.Cc("ngIf",!c.loadingJobActions),w.Mb(1),w.Cc("ngIf",i.job.node.currentlyWith),w.Mb(1),w.Cc("ngIf",!i.job.node.currentlyWith),w.Mb(2),w.Cc("photos",i.job.node.submission.submissionPhotos.edges),w.Mb(11),w.Cc("descriptor",w.xc(62,116,"in "+i.job.node.submission.baseMetal.name))("fullFormat",!0)("jobAction",i.jobActions[c.actionCastAndMount])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("placeholderName","Cast")("allowEdit",c.activeTab.allowEdit),w.Mb(3),w.Cc("descriptor",i.job.node.submission.finish.name)("fullFormat",!0)("jobAction",i.jobActions[c.actionFinishing])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("placeholderName","Finishing")("allowEdit",c.activeTab.allowEdit),w.Mb(2),w.Cc("descriptor",w.xc(67,118,i.job.node.submission.plating.name))("fullFormat",!0)("jobAction",i.jobActions[c.actionPlating])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("placeholderName","Plating")("allowEdit",c.activeTab.allowEdit),w.Mb(3),w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionEngraving])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("placeholderName","Engraving")("allowEdit",c.activeTab.allowEdit),w.Mb(2),w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionDuplicate])("loading",c.loadingJobActions)("onHold",i.job.node.onHold)("placeholderName","Duplicate")("allowEdit",c.activeTab.allowEdit),w.Mb(2),w.Cc("ngIf",i.jobActions[c.actionJumpRing]),w.Mb(1),w.Cc("ngIf",i.jobActions[c.actionEarringPosts]),w.Mb(1),w.Cc("ngIf",!i.jobActions[c.actionJumpRing]&&!i.jobActions[c.actionEarringPosts]),w.Mb(2),w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionStoneSetting])("loading",c.loadingJobActions)("placeholderName","Stone Setting")("allowEdit",c.activeTab.allowEdit),w.Mb(2),w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionResizing])("loading",c.loadingJobActions)("placeholderName","Resizing")("allowEdit",c.activeTab.allowEdit),w.Mb(2),w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionRepairing])("loading",c.loadingJobActions)("placeholderName","Repairing")("allowEdit",c.activeTab.allowEdit),w.Mb(2),w.Cc("fullFormat",!0)("jobAction",i.jobActions[c.actionHallmarking])("loading",c.loadingJobActions)("placeholderName","HallMarking")("allowEdit",c.activeTab.allowEdit)}}function pe(t,e){if(1&t&&(w.ec(0),w.bd(1,me,84,120,"ng-container",47),w.dc()),2&t){var n=w.vc();w.Mb(1),w.Cc("ngForOf",n.data.jobsAndJobActions)}}function he(t,e){1&t&&(w.gc(0,"div",49),w.gc(1,"div",100),w.gc(2,"div",51),w.gc(3,"app-loading-shimmer"),w.gc(4,"div",101),w.gc(5,"div",102),w.bc(6,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(7,"div",54),w.gc(8,"app-loading-shimmer"),w.gc(9,"div",101),w.gc(10,"div",102),w.bc(11,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(12,"div",54),w.gc(13,"app-loading-shimmer"),w.gc(14,"div",101),w.gc(15,"div",102),w.bc(16,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(17,"div",54),w.gc(18,"app-loading-shimmer"),w.gc(19,"div",101),w.gc(20,"div",102),w.bc(21,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(22,"div",58),w.gc(23,"app-loading-shimmer"),w.gc(24,"div",101),w.gc(25,"div",102),w.bc(26,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(27,"div",67),w.gc(28,"app-loading-shimmer"),w.gc(29,"div",101),w.gc(30,"div",104),w.bc(31,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(32,"div",58),w.gc(33,"app-loading-shimmer"),w.gc(34,"div",101),w.gc(35,"div",102),w.bc(36,"div",103),w.fc(),w.fc(),w.gc(37,"div",105),w.gc(38,"div",106),w.bc(39,"div",107),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(40,"div",67),w.gc(41,"app-loading-shimmer"),w.gc(42,"div",108),w.gc(43,"div",104),w.bc(44,"div",109),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(45,"div",67),w.gc(46,"app-loading-shimmer"),w.gc(47,"div",101),w.gc(48,"div",110),w.bc(49,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(50,"div",67),w.gc(51,"app-loading-shimmer"),w.gc(52,"div",101),w.gc(53,"div",111),w.bc(54,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(55,"div",58),w.gc(56,"app-loading-shimmer"),w.gc(57,"div",101),w.gc(58,"div",102),w.bc(59,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(60,"div",112),w.gc(61,"app-loading-shimmer"),w.gc(62,"div",101),w.gc(63,"div",102),w.bc(64,"div",103),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(65,"div",67),w.gc(66,"app-loading-shimmer"),w.gc(67,"div",108),w.gc(68,"div",104),w.bc(69,"div",109),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc())}function ve(t,e){1&t&&(w.ec(0,48),w.bd(1,he,70,0,"div",99),w.dc()),2&t&&(w.Mb(1),w.Cc("ngForOf"," ".repeat(3).split("")))}function Ce(t,e){1&t&&(w.gc(0,"div",113),w.gc(1,"div",114),w.bc(2,"loading-ring",115),w.fc(),w.fc()),2&t&&(w.Mb(2),w.Cc("size",60))}function Me(t,e){if(1&t&&(w.gc(0,"ng-option",126),w.dd(1),w.wc(2,"titlecase"),w.fc()),2&t){var n=e.$implicit;w.Cc("value",n),w.Mb(1),w.fd("",w.xc(2,2,n.supplier.node.company)," ")}}function Se(t,e){if(1&t){var n=w.hc();w.gc(0,"div",130),w.gc(1,"label",131),w.gc(2,"input",132),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(3).model.selectedOutworkerAction=t})),w.fc(),w.dd(3),w.fc(),w.fc()}if(2&t){var i=e.$implicit,c=w.vc(3);w.Mb(1),w.Sb("active",c.model.selectedOutworkerAction===i),w.Mb(1),w.Cc("ngModel",c.model.selectedOutworkerAction)("value",i),w.Mb(1),w.fd("",i.node.action.name," ")}}function Ae(t,e){if(1&t&&(w.gc(0,"div",119),w.gc(1,"label",127),w.dd(2,"What Action"),w.fc(),w.gc(3,"div",128),w.bd(4,Se,4,5,"div",129),w.fc(),w.fc()),2&t){var n=w.vc(2);w.Mb(4),w.Cc("ngForOf",n.model.selectedSupplierAndActions.actions)}}function Ie(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",116),w.gc(1,"div",117),w.gc(2,"form",null,118),w.gc(4,"div",119),w.gc(5,"label",120),w.dd(6,"Which Outworker?"),w.fc(),w.gc(7,"ng-select",121,122),w.rc("change",(function(){return w.Pc(n),w.vc().onChangeSelectedOutworker()}))("ngModelChange",(function(t){return w.Pc(n),w.vc().model.selectedSupplierAndActions=t})),w.bd(9,Me,3,4,"ng-option",123),w.fc(),w.fc(),w.bd(10,Ae,5,1,"div",124),w.fc(),w.fc(),w.gc(11,"modal-footer",125),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().sendToOutworker()})),w.fc()}if(2&t){var i=e.$implicit,c=w.Mc(3),o=w.vc();w.Cc("modal",i),w.Mb(7),w.Cc("ngModel",o.model.selectedSupplierAndActions)("searchable",!1),w.Mb(2),w.Cc("ngForOf",o.data.suppliersAndActions),w.Mb(1),w.Cc("ngIf",o.model.selectedSupplierAndActions),w.Mb(1),w.Cc("form",c)("modal",i)("saveButtonName","Send")}}function ye(t,e){if(1&t){var n=w.hc();w.gc(0,"div",130),w.gc(1,"label",131),w.gc(2,"input",135),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.selectedCompleteAction=t})),w.fc(),w.dd(3),w.fc(),w.fc()}if(2&t){var i=e.$implicit,c=w.vc(2);w.Mb(1),w.Sb("active",c.model.selectedCompleteAction===i),w.Mb(1),w.Cc("ngModel",c.model.selectedCompleteAction)("value",i),w.Mb(1),w.fd("",i.node.name," ")}}function we(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",133),w.gc(1,"div",117),w.gc(2,"form",null,134),w.gc(4,"div",119),w.gc(5,"label",127),w.dd(6,"What Action"),w.fc(),w.gc(7,"div",128),w.bd(8,ye,4,5,"div",129),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(9,"modal-footer",125),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().completeActions()})),w.fc()}if(2&t){var i=e.$implicit,c=w.Mc(3),o=w.vc();w.Cc("modal",i),w.Mb(8),w.Cc("ngForOf",o.data.actions),w.Mb(1),w.Cc("form",c)("modal",i)("saveButtonName","Complete")}}function je(t,e){if(1&t&&(w.gc(0,"ng-option",126),w.dd(1),w.wc(2,"titlecase"),w.fc()),2&t){var n=e.$implicit;w.Cc("value",n),w.Mb(1),w.fd("",w.xc(2,2,n.node.company)," ")}}function Pe(t,e){if(1&t){var n=w.hc();w.gc(0,"div",119),w.gc(1,"label",120),w.dd(2,"Which Supplier?"),w.fc(),w.gc(3,"ng-select",141,122),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.selectedManufacturer=t})),w.bd(5,je,3,4,"ng-option",123),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(3),w.Cc("ngModel",i.model.selectedManufacturer)("searchable",!1),w.Mb(2),w.Cc("ngForOf",i.data.manufacturers)}}function xe(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",136),w.gc(1,"div",117),w.gc(2,"form",null,137),w.bd(4,Pe,6,3,"div",124),w.gc(5,"h5"),w.dd(6),w.fc(),w.gc(7,"h5"),w.dd(8),w.fc(),w.gc(9,"h5"),w.dd(10),w.fc(),w.gc(11,"div",138),w.gc(12,"label",139),w.gc(13,"input",140),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc().allItemsPresent=t})),w.fc(),w.dd(14," All Items Are Present "),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(15,"modal-footer",125),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().createOutgoingBatch()})),w.fc()}if(2&t){var i=e.$implicit,c=w.Mc(3),o=w.vc();w.Cc("modal",i),w.Mb(4),w.Cc("ngIf",o.isAdmin),w.Mb(2),w.fd("# Rings: ",o.model.numItemTypes[o.kitTypeRing],""),w.Mb(2),w.fd("# Pendants: ",o.model.numItemTypes[o.kitTypePendant],""),w.Mb(2),w.fd("# Earring Pairs: ",o.model.numItemTypes[o.kitTypeEarring],""),w.Mb(3),w.Cc("ngModel",o.allItemsPresent)("value",!0),w.Mb(2),w.Cc("form",c)("modal",i)("saveButtonName","Create")}}function Be(t,e){if(1&t&&(w.gc(0,"ng-option",126),w.dd(1),w.wc(2,"numericId"),w.fc()),2&t){var n=e.$implicit;w.Cc("value",n.node.id),w.Mb(1),w.fd("Batch #",w.xc(2,2,n.node.id)," ")}}function Te(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",142),w.gc(1,"div",117),w.gc(2,"form",null,143),w.gc(4,"div",119),w.gc(5,"label",120),w.dd(6,"Which Batch?"),w.fc(),w.gc(7,"ng-select",144,122),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc().data.mutationBatchId=t})),w.bd(9,Be,3,4,"ng-option",123),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(10,"modal-footer",125),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().addJobsToBatch()})),w.fc()}if(2&t){var i=e.$implicit,c=w.Mc(3),o=w.vc();w.Cc("modal",i),w.Mb(7),w.Cc("ngModel",o.data.mutationBatchId)("searchable",!1),w.Mb(2),w.Cc("ngForOf",o.data.availableBatches),w.Mb(1),w.Cc("form",c)("modal",i)("saveButtonName","Create")}}function ke(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",145),w.gc(1,"div",117),w.gc(2,"h5"),w.dd(3),w.fc(),w.fc(),w.gc(4,"modal-footer",146),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().putJobsOnHold()})),w.fc()}if(2&t){var i=e.$implicit,c=w.vc();w.Cc("modal",i),w.Mb(3),w.gd("Add a hold to ",c.data.selections.length," item",c.data.selections.length>1?"s":"","?"),w.Mb(1),w.Cc("modal",i)("saveButtonName","Add Hold")}}function Ee(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",147),w.gc(1,"div",117),w.gc(2,"h5"),w.dd(3),w.fc(),w.fc(),w.gc(4,"modal-footer",146),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().takeJobsOffHold()})),w.fc()}if(2&t){var i=e.$implicit,c=w.vc();w.Cc("modal",i),w.Mb(3),w.gd("Remove hold from ",c.data.selections.length," item",c.data.selections.length>1?"s":"","?"),w.Mb(1),w.Cc("modal",i)("saveButtonName","Remove Hold")}}var Oe=function(t,e,n,i,c){return[t,e,n,i,c]},Je="inProgress",Ne="readyToReturn",$e="complete",_e="onHold",Re=function(){return function(){this.currentJobSearch=null,this.reference=null,this.regCode=null,this.source=null}}(),Fe=function(){return function(){this[Pt]=0,this[xt]=0,this[Bt]=0}}();Pt=x.g,xt=x.f,Bt=x.e;var De=function(t){function e(e,n,i,c,o,a,s,d,l,r,u,g,b){var f,m=t.call(this)||this;return m.actionService=e,m.appUserService=n,m.jobActionService=i,m.jobService=c,m.modalService=o,m.route=a,m.router=s,m.stoneSubmissionService=d,m.submissionBatchService=l,m.submissionService=r,m.supplierActionService=u,m.supplierService=g,m.toastrService=b,m.data={actions:[],availableBatches:[],jobsAndJobActions:[],manufacturers:[],mutationBatchId:null,selections:[],suppliersAndActions:[]},m.actionCastAndMount="Cast & Mount",m.actionFinishing="Finishing",m.actionPlating=T,m.actionEngraving=k,m.actionDuplicate="Duplicate",m.actionJumpRing=E,m.actionEarringPosts=O,m.actionStoneSetting=J,m.actionResizing=N,m.actionRepairing=$,m.actionOther="Other",m.actionHallmarking=_,m.kitTypeRing=x.g,m.kitTypePendant=x.f,m.kitTypeEarring=x.e,m.model=new Re,m.tabInProgress=Je,m.tabReadyToReturn=Ne,m.tabComplete=$e,m.tabOnHold=_e,m.tabAll="all",m.tabs=((f={}).inProgress={allowEdit:!0,completed:!1,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:Je,onHold:null},f.readyToReturn={allowEdit:!0,completed:!0,dueOrder:"ASC",incomingBatched:!1,inProduction:!0,name:Ne,onHold:null},f.complete={allowEdit:!1,completed:!0,dueOrder:"ASC",incomingBatched:!0,inProduction:!1,name:$e,onHold:null},f.onHold={allowEdit:!1,completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:_e,onHold:!0},f.all={allowEdit:!1,completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:null,name:"all",onHold:null},f),m.activeTab=m.tabs.inProgress,m.allItemsPresent=!1,m.availableActions={sendToOutworker:!1,completeAction:!1,putItemsOnHold:!1,takeItemsOffHold:!1,addToOutgoingBatch:!1,actionsAvailable:!1},m.isAdmin=!1,m.loadingJobActions=!0,m.loadingStones=!0,m.loadingSupplierActions=!0,m.now=new Date,m.setSearch=null,m.submitting=!1,m.jobId="Job ID",m.submissionId="Submission ID",m.customerName="Customer Name",m.eventName="Event Name",m.castingCode="Casting Code",m.baseMetalSilver=X.m,m.defaultSearch={searchField:m.customerName,searchQuery:null},m}return Dt(e,t),e.prototype.ngOnInit=function(){return Ht(this,void 0,void 0,(function(){var t,e,n=this;return Gt(this,(function(i){switch(i.label){case 0:return this.activeTab=this.tabs[this.route.snapshot.queryParamMap.get("tab")],this.activeTab||(this.activeTab=this.tabs.inProgress),t=this.route.snapshot.queryParamMap.get("searchField"),e=this.route.snapshot.queryParamMap.get("query"),t&&e?(this.setSearch={searchQuery:e,searchField:t},this.search(this.setSearch),[3,3]):[3,1];case 1:return this.setSearch=this.defaultSearch,[4,this.updateTable(null)];case 2:i.sent(),i.label=3;case 3:return this.appUserService.getMe().subscribe((function(t){n.isAdmin=n.appUserService.isAdmin(t.data.appUser.roles)})),this.submissionBatchService.list(null,null,!0,!0,"DESC",null,!1).subscribe((function(t){n.data.availableBatches=t.data.submissionBatches.edges})),this.supplierService.list(null).subscribe((function(t){for(var e=[],i=0,c=t.data.suppliers.edges;i<c.length;i++){var o=c[i];o.node.isManufacturer?n.data.manufacturers.push(o):(e.push(o.node.id.replace(/^\D+/,"")),n.data.suppliersAndActions.push({supplier:o,actions:[]})),1===n.data.manufacturers.length&&(n.model.selectedManufacturer=n.data.manufacturers[0])}n.supplierActionService.getBySupplierIds(e).subscribe((function(t){for(var e=0,i=n.data.suppliersAndActions;e<i.length;e++)for(var c=i[e],o=0,a=t.data.supplierActions.edges;o<a.length;o++){var s=a[o];c.supplier.node.id===s.node.supplier.id&&c.actions.push(s)}n.loadingSupplierActions=!1})),e.length||(n.loadingSupplierActions=!1)})),this.actionService.list().subscribe((function(t){n.data.actions=t.data.actions.edges})),[2]}}))}))},e.prototype.updateTableWithSearch=function(t,e){return Ht(this,void 0,void 0,(function(){var t=this;return Gt(this,(function(n){return this.state.loading=!0,this.loadingJobActions=!0,this.loadingStones=!0,this.model.currentJobSearch&&this.model.currentJobSearch.unsubscribe(),this.model.currentJobSearch=e.subscribe((function(e){var n,i=[],c=[],o=JSON.parse(JSON.stringify(t.data.jobsAndJobActions));t.data.jobsAndJobActions=[];for(var a=0,s=e.data.jobs.edges;a<s.length;a++){var d=s[a];i.push(d.node.id.replace(/^\D+/,"")),c.push(d.node.submission.id.replace(/^\D+/,""));for(var l=!1,r=!1,u=0,g=o;u<g.length;u++){var b=g[u];b.job.node.id===d.node.id&&(l=b.selected,r=b.expanded)}t.data.jobsAndJobActions.push({job:d,jobActions:(n={},n["Cast & Mount"]=null,n.Finishing=null,n.Plating=null,n.Engraving=null,n.Duplicate=null,n["Jump Ring"]=null,n["Earring Posts"]=null,n["Stone Setting"]=null,n.Resizing=null,n.Repairing=null,n.Other=null,n.Hallmarking=null,n),jobDueDate:d.node.due?new Date(d.node.due):null,jobActionsCompleted:0,jobActionsNeeded:0,selected:l,expanded:r,stones:[]})}t.handlePagination(e.data.jobs),t.jobActionService.getByJobIds(i).subscribe((function(e){for(var n=0,i=t.data.jobsAndJobActions;n<i.length;n++)for(var c=i[n],o=0,a=e.data.jobActions.edges;o<a.length;o++){var s=a[o];s.node.job.id===c.job.node.id&&(c.jobActions[s.node.action.name]=s,c.jobActionsNeeded+=1,s.node.completed&&(c.jobActionsCompleted+=1))}t.loadingJobActions=!1})),t.stoneSubmissionService.listBySubmission(c).subscribe((function(e){for(var n=0,i=t.data.jobsAndJobActions;n<i.length;n++)for(var c=i[n],o=0,a=e.data.stoneSubmissions.edges;o<a.length;o++){var s=a[o];c.job.node.submission.id===s.node.submission.id&&c.stones.push(s)}t.loadingStones=!1}))})),[2]}))}))},e.prototype.updateTable=function(t){return Ht(this,void 0,void 0,(function(){return Gt(this,(function(e){return this.updateTableWithSearch(t,this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,t,null,null,null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder)),[2]}))}))},e.prototype.search=function(t){if(!t.searchQuery||!t.searchField)return this.resetSearchQueryParams(),void this.updateTable(null);this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:t.searchField,query:t.searchQuery},queryParamsHandling:"merge"});var e=null;switch(t.searchField){case this.jobId:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,parseInt(t.searchQuery),null,null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.submissionId:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,parseInt(t.searchQuery),null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.customerName:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,null,t.searchQuery,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.eventName:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,null,null,t.searchQuery,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.castingCode:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,null,null,null,t.searchQuery,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder)}this.updateTableWithSearch(null,e)},e.prototype.changeTab=function(t){return Ht(this,void 0,void 0,(function(){return Gt(this,(function(e){switch(e.label){case 0:return this.setSearch=this.defaultSearch,[4,this.resetSearchQueryParams()];case 1:return e.sent(),this.router.navigate([],{relativeTo:this.route,queryParams:{tab:t},queryParamsHandling:"merge"}),this.activeTab=this.tabs[t],this.searchComponent.clearSearch(),this.resetSelections(),this.updateTable(null),[2]}}))}))},e.prototype.selectRow=function(t){if(!this.submitting){if(t.selected){t.selected=!t.selected;var e=this.data.selections.findIndex((function(e){return e.job.node.id===t.job.node.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t);this.getAvailableActions()}},e.prototype.getAvailableActions=function(){var t=this;this.availableActions={sendToOutworker:!0,completeAction:!0,putItemsOnHold:!0,takeItemsOffHold:!0,addToOutgoingBatch:!0,actionsAvailable:!1};for(var e=0,n=this.data.selections;e<n.length;e++){var i=n[e];i.jobActionsNeeded===i.jobActionsCompleted?(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1):this.availableActions.addToOutgoingBatch=!1,i.job.node.status.name!==F.m.name&&(this.availableActions.addToOutgoingBatch=!1),i.job.node.onHold&&(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1,this.availableActions.putItemsOnHold=!1,this.availableActions.addToOutgoingBatch=!1),i.job.node.onHold||(this.availableActions.takeItemsOffHold=!1)}this.availableActions.actionsAvailable=!Object.keys(this.availableActions).every((function(e){return!t.availableActions[e]}))},e.prototype.selectAll=function(){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(c=e[t]).selected=!0,this.selectRow(c);for(var n=0,i=this.data.jobsAndJobActions;n<i.length;n++){var c;(c=i[n]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(c)&&this.data.selections.push(c)}},e.prototype.expandJobs=function(t){this.submitting||(t.expanded=!t.expanded)},e.prototype.expandAll=function(){if(this.state.allExpanded=!this.state.allExpanded,!this.state.allExpanded)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(c=e[t]).expanded=!0,this.expandJobs(c);for(var n=0,i=this.data.jobsAndJobActions;n<i.length;n++){var c;(c=i[n]).expanded=this.state.allExpanded}},e.prototype.updateJobAction=function(t){for(var e=null,n=0,i=this.data.jobsAndJobActions;n<i.length;n++){var c=i[n];if(c.job.node.id===t.node.job.id){e=c;break}}if(e.job.node.onHold)this.onHoldMessage(e.job.node.id);else{this.jobActionService.update({id:t.node.id,started:t.node.started,startedAt:t.node.startedAt,completed:t.node.completed,completedAt:t.node.completedAt}).subscribe();var o=t.node.completed,a=t.node.started&&!t.node.completed;e.jobActionsCompleted=0;for(var s=0,d=Object.keys(e.jobActions);s<d.length;s++){var l=e.jobActions[d[s]];l&&(l.node.completed?e.jobActionsCompleted+=1:(o=!1,l.node.started&&(a=!0)))}a||(e.job.node.currentlyWith=null),e.job.node.status=o?F.m:F.f}},e.prototype.openModalWithSelected=function(t){this.data.selections.length?this.modalService.open(t):this.toastrService.info(null,"Please select job(s) before performing action")},e.prototype.sendToOutworker=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;for(var e=(new Date).toISOString(),n=this.toastrService.success(null,"Sending 0 Jobs to Outworkers",{timeOut:3e4}),i=0,c=0,o=function(o){if(o.job.node.onHold)return a.onHoldMessage(o.job.node.id),"continue";var s=o.jobActions[a.model.selectedOutworkerAction.node.action.name];if(!s||s.node.completed||s.node.started)return a.toastrService.info(null,"Item "+a.getNumericId(o.job.node.id)+" does not need "+a.model.selectedOutworkerAction.node.action.name),"continue";if(o.job.node.currentlyWith&&o.job.node.currentlyWith.id!==a.model.selectedSupplierAndActions.supplier.node.id)return a.toastrService.info(null,"Item "+a.getNumericId(o.job.node.id)+" is currently with a different outworker: "+o.job.node.currentlyWith.company),"continue";var d=" Job"+((c+=1)>1?"s":"")+" to Outworkers";n.toastRef.componentInstance.title="Sending "+c+d,n.toastRef.timeoutReset(),s.node.started=!0,s.node.startedAt=e;for(var l={id:s.node.id,started:!0,startedAt:e,completed:!1,completedAt:null},r=0,u=a.data.jobsAndJobActions;r<u.length;r++){var g=u[r];if(g.job.node.id===s.node.job.id){g.job.node.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;break}}s.node.job.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;var b={id:o.job.node.id,currentlyWith:a.model.selectedSupplierAndActions.supplier.node.id};Object(L.a)(a.jobActionService.update(l),a.jobService.update(b)).subscribe((function(e){(i+=1)===c?(n.toastRef.close(),t.toastrService.success(null,"Sent "+c+d),t.model.selectedOutworkerAction=null,t.model.selectedSupplierAndActions=null,t.submitting=!1):(n.toastRef.componentInstance.title="Sent "+i+"/"+c+d,n.toastRef.timeoutReset())}))},a=this,s=0,d=this.data.selections;s<d.length;s++)o(d[s]);0===c&&(n.toastRef.close(),this.model.selectedOutworkerAction=null,this.model.selectedSupplierAndActions=null,this.submitting=!1)}},e.prototype.completeActions=function(){for(var t,e=this,n=0,i=this.data.selections;n<i.length;n++){var c=i[n];if(c.job.node.onHold)this.onHoldMessage(c.job.node.id);else{var o=new Date,a=c.jobActions[this.model.selectedCompleteAction.node.name];if(a){t=!0;var s={__typename:"JobActionEdge",node:{__typename:"JobAction",id:a.node.id,job:a.node.job,action:a.node.action,supplier:null,started:null,startedAt:null,completed:!0,completedAt:o.toISOString()}};a.node.completed=!0,this.updateJobAction(s)}else this.toastrService.info(null,"Item "+this.getNumericId(c.job.node.id)+" does not need "+this.model.selectedCompleteAction.node.name)}}t&&(this.toastrService.success(null,"Completing "+this.model.selectedCompleteAction.node.name),setTimeout((function(){e.toastrService.success(null,"Completed "+e.model.selectedCompleteAction.node.name),e.model.selectedCompleteAction=null}),3e3))},e.prototype.prepareOutgoingBatch=function(t){var e;this.model.numItemTypes=new Fe;for(var n=0,i=this.data.selections;n<i.length;n++){var c=i[n];c.job.node.onHold?this.onHoldMessage(c.job.node.id):(e=!0,this.model.numItemTypes[c.job.node.submission.kitType.name]+=1)}e&&this.modalService.open(t)},e.prototype.createOutgoingBatch=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;var e=(new Date).toISOString();this.toastrService.success(null,"Creating Batch"),this.submissionBatchService.create({status:F.b.id,createdAt:e,updatedAt:e,supplier:this.model.selectedManufacturer.node.id}).subscribe((function(e){t.data.mutationBatchId=e.data.createSubmissionBatch.id,t.toastrService.success(null,"Batch Created"),t.addJobsToBatch()}))}},e.prototype.addJobsToBatch=function(){for(var t=this,e=0,n=0,i=this.toastrService.success(null,"Adding Items to Batch",{timeOut:3e4}),c=0,o=this.data.selections;c<o.length;c++){var a=o[c];a.job.node.onHold?this.onHoldMessage(a.job.node.id):(n+=1,this.jobService.updateIncomingBatch({id:a.job.node.id,incomingBatch:this.data.mutationBatchId,status:F.b.id}).subscribe((function(c){e+=1;for(var o=0,a=t.data.selections;o<a.length;o++){var s=a[o];if(c.data.updateJob.id===s.job.node.id){s.job.node.status=F.b;break}}e===n?(i.toastRef.close(),t.toastrService.success(null,"Added "+n+" Items to Batch"),t.router.navigate(["manufacturing","batches","view",t.data.mutationBatchId.replace(/\D/g,"")])):(i.toastRef.componentInstance.title="Added "+e+"/"+n+" Items to Batch",i.toastRef.timeoutReset())})))}0===n&&(i.toastRef.close(),this.submitting=!1)},e.prototype.putJobsOnHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!0,"Putting job"+t+" on hold.","Job"+t+" put on hold.")},e.prototype.takeJobsOffHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!1,"Taking job"+t+" off hold.","Job"+t+" back in production.")},e.prototype.updateJob=function(t,e,n){var i=this,c=((new Date).toISOString(),0),o=0;this.toastrService.success(null,e);for(var a=function(e){o+=1;var a={id:e.job.node.id};null!==t&&(a.onHold=t,setTimeout((function(n){e.job.node.onHold=t}),3e3)),s.jobService.update(a).subscribe((function(t){(c+=1)===o&&i.toastrService.success(null,n)}))},s=this,d=0,l=this.data.selections;d<l.length;d++)a(l[d])},e.prototype.resetSelections=function(){this.data.selections=[];for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)e[t].selected=!1;this.availableActions.actionsAvailable=!1},e.prototype.resetSearchQueryParams=function(){return Ht(this,void 0,void 0,(function(){return Gt(this,(function(t){switch(t.label){case 0:return[4,this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:null,query:null},queryParamsHandling:"merge"})];case 1:return t.sent(),[2]}}))}))},e.prototype.onHoldMessage=function(t){this.toastrService.warning(null,"Item "+this.getNumericId(t)+" is on hold")},e.prototype.onChangeSelectedOutworker=function(){this.model.selectedOutworkerAction=null},e.prototype.getDaysBetween=function(t,e){return Q.a.getDaysBetween(t,e)},e.\u0275fac=function(t){return new(t||e)(w.ac(R),w.ac(z.a),w.ac(P),w.ac(h.a),w.ac(K.i),w.ac(m.a),w.ac(m.b),w.ac(q.a),w.ac(U.a),w.ac(Y.a),w.ac(W),w.ac(D.a),w.ac(Z.b))},e.\u0275cmp=w.Ub({type:e,selectors:[["ng-component"]],viewQuery:function(t,e){var n;1&t&&w.jd(Wt,!0),2&t&&w.Lc(n=w.sc())&&(e.searchComponent=n.first)},features:[w.Jb],decls:80,vars:33,consts:[["title","Jobs",3,"subtitle"],[1,"container","form-container"],["novalidate",""],["jobsForm","ngForm"],[1,"row","card","mt-5"],[1,"nav","nav-tabs"],[1,"nav-item"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"row","card","transparent","align-items-end"],[1,"w-100","mb-2","table-toolbar"],["aria-label","Table toolbar","role","toolbar",1,"btn-toolbar"],["role","group",1,"btn-group"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],["aria-label","Search","role","toolbar",1,"btn-toolbar","ml-5"],[3,"setSearch","searchFields","searchEmitter"],["searchComponent",""],["ngbDropdown","",1,"d-inline-block","float-right"],["class","btn btn-outline-primary","id","sortMenu","ngbDropdownToggle","",4,"ngIf"],["aria-labelledby","sortMenu","ngbDropdownMenu",""],[4,"ngIf"],["class","btn btn-outline-primary","ngbDropdownItem","",4,"ngIf"],[1,"row","flex-table-wrapper"],["aria-describedby","jobsForm","role","grid",1,"flex-table","jobs-table"],["role","row",1,"tr","table-header"],["role","columnheader",1,"th","mini-column"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[3,"ngbTooltip"],["role","columnheader",1,"th","fg-2"],["role","columnheader",1,"th"],["role","columnheader",1,"th","tc"],["role","columnheader",1,"th","fg-2","status"],["role","rowgroup",4,"ngIf"],["class","tr",4,"ngIf"],[3,"state","nextPage","previousPage"],["modalSendToOutworker",""],["modalCompleteAction",""],["modalCreateOutgoingBatch",""],["modalAddToOutgoingBatch",""],["modalPutOnHold",""],["modalTakeOffHold",""],["id","sortMenu","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["class","btn btn-outline-primary","ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",1,"btn","btn-outline-primary",3,"click"],["ngbDropdownItem","",1,"btn","btn-outline-primary"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["role","rowgroup",4,"ngFor","ngForOf"],["role","rowgroup"],["role","rowgroup",1,"row-group"],["role","row",1,"tr","table-row","panel-open"],["role","rowheader",1,"th","mini-column"],["type","checkbox",3,"ngModel","name","id","click","ngModelChange"],[3,"for"],["role","gridcell",1,"td","mini-column"],[1,"fas","fa-shipping-fast"],["role","gridcell",1,"th","mini-column"],["class","muted",4,"ngIf"],["role","gridcell",1,"td","fg-2"],["class","muted","style","display: block;",4,"ngIf"],["role","gridcell",1,"td","job-type"],[2,"display","inline"],[3,"isAdmin","loadingStones","stones","submission"],["role","gridcell",1,"td","fg-2","due-back"],["role","gridcell",1,"td","job--cast-mount"],[3,"jobAction","loading","onHold","allowEdit","confirmedAction"],[1,"text-center"],["role","gridcell",1,"td"],[3,"click"],[1,"fas","fa-chevron-down","expanded-toggle"],[3,"isAdmin","submission",4,"ngIf"],["class","progress mb-0",4,"ngIf"],["class","td fg-2 status status-pill status-with-outworker","role","gridcell",4,"ngIf"],["role","gridcell",3,"class",4,"ngIf"],[3,"photos"],["role","row",1,"tr","table-row","panel"],[1,"row","panel-title"],[1,"col"],[1,"row","jobs","mt-3","mb-2"],[3,"descriptor","fullFormat","jobAction","loading","onHold","placeholderName","allowEdit","confirmedAction"],[3,"fullFormat","jobAction","loading","onHold","placeholderName","allowEdit","confirmedAction"],[3,"fullFormat","jobAction","loading","onHold","allowEdit","confirmedAction",4,"ngIf"],["class","action-toggler expanded tc",4,"ngIf"],[3,"fullFormat","jobAction","loading","placeholderName","allowEdit","confirmedAction"],[1,"muted"],[1,"muted",2,"display","block"],[3,"isAdmin","submission"],[1,"progress","mb-0"],["role","progressbar",1,"progress-bar"],["role","gridcell",1,"td","fg-2","status","status-pill","status-with-outworker"],["role","gridcell"],[3,"fullFormat","jobAction","loading","onHold","allowEdit","confirmedAction"],[1,"action-toggler","expanded","tc"],["class","color-muted fa fa-circle-notch fa-spin fa-2x",4,"ngIf"],["class","action-toggler not-required expanded",4,"ngIf"],[1,"color-muted","fa","fa-circle-notch","fa-spin","fa-2x"],[1,"action-toggler","not-required","expanded"],[1,"title"],[1,"toggle-button"],["class","row-group","role","rowgroup",4,"ngFor","ngForOf"],["role","row",1,"tr","table-row"],[1,"row","align-items-center"],[1,"col-10"],[1,"shimmer","py-2"],[1,"col-6"],[1,"row","align-items-center","mt-1"],[1,"col-7"],[1,"shimmer","py-1"],[1,"row","align-items-center","justify-content-center"],[1,"shimmer","py-3"],[1,"col-8"],[1,"col-5"],["role","gridcell",1,"td","fg-2","status"],[1,"tr"],[1,"td","tc"],[3,"size"],["title","Send To Outworker?",3,"modal"],[1,"modal-body"],["sendToOutworkerModalForm","ngForm"],[1,"form-group"],["for","selectSupplier",1,"req"],["appShowErrorInputClass","","id","selectSupplier","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","change","ngModelChange"],["selectSupplier","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[3,"form","modal","saveButtonName","modalSaved"],[3,"value"],[1,"req"],["data-toggle","buttons",1,"btn-group-toggle","row"],["class","btn-group-toggle col-md-4 mb-1",4,"ngFor","ngForOf"],[1,"btn-group-toggle","col-md-4","mb-1"],[1,"btn","btn-primary"],["autocomplete","off","id","selectedSupplierAction","name","selectedSupplierAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Complete Action?",3,"modal"],["completeActionModalForm","ngForm"],["autocomplete","off","id","selectedAction","name","selectedAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Create Outgoing Batch?",3,"modal"],["createOutgoingBatchModalForm","ngForm"],[1,"mt-5","form-group"],["for","allItemsPresent",1,"req","mr-3"],["id","allItemsPresent","name","allItemsPresent","required","","type","checkbox",1,"mr-2",2,"vertical-align","middle",3,"ngModel","value","ngModelChange"],["appShowErrorInputClass","","id","selectSupplierForOutgoingBatch","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add to Outgoing Batch",3,"modal"],["addToOutgoingBatchModalForm","ngForm"],["appShowErrorInputClass","","id","selectBatch","name","selectBatch","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add Hold to Items",3,"modal"],[3,"modal","saveButtonName","modalSaved"],["title","Remove Hold from Items",3,"modal"]],template:function(t,e){1&t&&(w.bc(0,"page-title",0),w.gc(1,"div",1),w.gc(2,"form",2,3),w.gc(4,"div",4),w.gc(5,"ul",5),w.gc(6,"li",6),w.gc(7,"button",7),w.rc("click",(function(){return e.changeTab(e.tabInProgress)})),w.dd(8," In Progress "),w.fc(),w.fc(),w.gc(9,"li",6),w.gc(10,"button",7),w.rc("click",(function(){return e.changeTab(e.tabReadyToReturn)})),w.dd(11," Ready to Return "),w.fc(),w.fc(),w.gc(12,"li",6),w.gc(13,"button",7),w.rc("click",(function(){return e.changeTab(e.tabComplete)})),w.dd(14," Completed "),w.fc(),w.fc(),w.gc(15,"li",6),w.gc(16,"button",7),w.rc("click",(function(){return e.changeTab(e.tabOnHold)})),w.dd(17," On Hold "),w.fc(),w.fc(),w.gc(18,"li",6),w.gc(19,"button",7),w.rc("click",(function(){return e.changeTab(e.tabAll)})),w.dd(20," All "),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(21,"div",8),w.gc(22,"div",9),w.gc(23,"div",10),w.gc(24,"div",11),w.gc(25,"button",12),w.rc("click",(function(){return e.expandAll()})),w.bc(26,"i"),w.fc(),w.fc(),w.fc(),w.gc(27,"div",13),w.gc(28,"search",14,15),w.rc("searchEmitter",(function(t){return e.search(t)})),w.fc(),w.fc(),w.gc(30,"div",16),w.bd(31,Lt,2,0,"button",17),w.gc(32,"div",18),w.bd(33,Vt,6,5,"ng-container",19),w.bd(34,Xt,2,0,"button",20),w.fc(),w.fc(),w.fc(),w.gc(35,"div",21),w.gc(36,"div",22),w.gc(37,"div",23),w.gc(38,"div",24),w.bd(39,Kt,3,2,"div",25),w.fc(),w.bc(40,"div",24),w.gc(41,"div",24),w.gc(42,"div",26),w.dd(43,"ID"),w.fc(),w.fc(),w.gc(44,"div",24),w.gc(45,"div",26),w.dd(46,"BA"),w.fc(),w.fc(),w.gc(47,"div",27),w.gc(48,"div"),w.dd(49,"Customer"),w.fc(),w.fc(),w.gc(50,"div",28),w.dd(51,"Type"),w.fc(),w.gc(52,"div",27),w.dd(53,"Due back"),w.fc(),w.gc(54,"div",29),w.dd(55,"Cast & Mount"),w.fc(),w.gc(56,"div",28),w.dd(57,"Actions"),w.fc(),w.gc(58,"div",28),w.dd(59,"Notes"),w.fc(),w.gc(60,"div",27),w.dd(61,"Progress"),w.fc(),w.bc(62,"div",30),w.bc(63,"div",28),w.fc(),w.bd(64,pe,2,1,"ng-container",19),w.bd(65,ve,2,1,"ng-container",31),w.bd(66,Ce,3,1,"div",32),w.fc(),w.fc(),w.gc(67,"table-controls",33),w.rc("nextPage",(function(){return e.nextPage()}))("previousPage",(function(){return e.previousPage()})),w.fc(),w.fc(),w.fc(),w.fc(),w.bd(68,Ie,12,8,"ng-template",null,34,w.cd),w.bd(70,we,10,5,"ng-template",null,35,w.cd),w.bd(72,xe,16,10,"ng-template",null,36,w.cd),w.bd(74,Te,11,7,"ng-template",null,37,w.cd),w.bd(76,ke,5,5,"ng-template",null,38,w.cd),w.bd(78,Ee,5,5,"ng-template",null,39,w.cd)),2&t&&(w.Cc("subtitle","Jobs"),w.Mb(7),w.Sb("btn-primary",e.activeTab.name===e.tabInProgress),w.Mb(3),w.Sb("btn-primary",e.activeTab.name===e.tabReadyToReturn),w.Mb(3),w.Sb("btn-primary",e.activeTab.name===e.tabComplete),w.Mb(3),w.Sb("btn-primary",e.activeTab.name===e.tabOnHold),w.Mb(3),w.Sb("btn-primary",e.activeTab.name===e.tabAll),w.Mb(6),w.Cc("ngbTooltip",!0===e.state.allExpanded?"Collapse all":"Expand all"),w.Mb(1),w.Pb("fas ",!0===e.state.allExpanded?"fa-compress-alt":"fa-expand-alt",""),w.Mb(2),w.Cc("setSearch",e.setSearch)("searchFields",w.Kc(27,Oe,e.jobId,e.submissionId,e.customerName,e.castingCode,e.eventName)),w.Mb(3),w.Cc("ngIf",e.availableActions.actionsAvailable),w.Mb(2),w.Cc("ngIf",!e.state.loading&&!e.loadingSupplierActions&&!e.loadingJobActions),w.Mb(1),w.Cc("ngIf",e.state.loading||e.loadingSupplierActions||e.loadingJobActions),w.Mb(5),w.Cc("ngIf",!e.state.loading),w.Mb(3),w.Cc("ngbTooltip","Job ID"),w.Mb(3),w.Cc("ngbTooltip","Batch ID"),w.Mb(19),w.Cc("ngIf",!e.state.loading&&!e.state.paginating),w.Mb(1),w.Cc("ngIf",e.state.loading),w.Mb(1),w.Cc("ngIf",e.state.loading),w.Mb(1),w.Cc("state",e.state))},directives:[tt.a,b.z,b.l,b.m,K.m,V.a,K.c,g.u,K.f,et.a,K.h,K.e,b.a,b.k,b.n,g.t,nt.a,Ct,It,Tt,kt.a,Et.a,Mt.a,Ot.a,Jt.a,b.u,Nt.a,Ot.n,b.s,b.d,b.b],pipes:[$t.a,g.G,_t.a,g.I,Rt.a,Ft.a],styles:[""]}),e}(p.a),He=n("ZtzB");function Ge(t,e){1&t&&(w.gc(0,"div",3),w.bc(1,"loading-ring",4),w.fc()),2&t&&(w.Mb(1),w.Cc("size",60))}function We(t,e){if(1&t){var n=w.hc();w.gc(0,"div",12),w.gc(1,"label",24),w.dd(2,"Email"),w.fc(),w.gc(3,"input",27,28),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.email=t})),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(3),w.Cc("ngModel",i.model.email)}}function Le(t,e){if(1&t){var n=w.hc();w.gc(0,"div",12),w.gc(1,"label",29),w.dd(2,"Telephone"),w.fc(),w.gc(3,"input",30,31),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.telephone=t})),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(3),w.Cc("ngModel",i.model.telephone)}}function qe(t,e){if(1&t){var n=w.hc();w.gc(0,"div",12),w.gc(1,"label",32),w.dd(2,"Address"),w.fc(),w.gc(3,"textarea",33,34),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.address=t})),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(3),w.Cc("ngModel",i.model.address)}}function ze(t,e){if(1&t){var n=w.hc();w.gc(0,"div",35),w.gc(1,"label"),w.dd(2,"Supplier Type"),w.fc(),w.gc(3,"div",36),w.gc(4,"div",37),w.gc(5,"div",38),w.gc(6,"input",39),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.isManufacturer=t})),w.fc(),w.gc(7,"label",40),w.dd(8," Manufacturer "),w.fc(),w.fc(),w.fc(),w.gc(9,"div",41),w.gc(10,"div",38),w.gc(11,"input",42),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.isManufacturer=t})),w.fc(),w.gc(12,"label",43),w.dd(13," Outworker "),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(6),w.Cc("value",!0)("ngModel",i.model.isManufacturer),w.Mb(5),w.Cc("value",!1)("ngModel",i.model.isManufacturer)}}function Ue(t,e){if(1&t){var n=w.hc();w.gc(0,"input",52),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).$implicit.cost=t})),w.fc()}if(2&t){var i=w.vc(2).$implicit;w.Cc("ngModel",i.cost)("decimalPlaces",2)("id","cost-"+i.action.node.id)("name","cost-"+i.action.node.id)}}function Ye(t,e){if(1&t&&(w.gc(0,"div",48),w.gc(1,"div",49),w.gc(2,"div",50),w.dd(3,"\xa3"),w.fc(),w.fc(),w.bd(4,Ue,1,4,"input",51),w.fc()),2&t){var n=w.vc(3);w.Mb(4),w.Cc("ngIf",n.state.admin)}}function Qe(t,e){if(1&t){var n=w.hc();w.gc(0,"div",44),w.gc(1,"input",45),w.rc("ngModelChange",(function(t){return w.Pc(n),e.$implicit.selected=t})),w.fc(),w.gc(2,"label",46),w.dd(3),w.fc(),w.bd(4,Ye,5,1,"div",47),w.fc()}if(2&t){var i=e.$implicit,c=w.vc(2);w.Mb(1),w.Cc("ngModel",i.selected)("name","checkbox-"+i.action.node.id)("id","checkbox-"+i.action.node.id)("value",!0),w.Mb(1),w.Cc("for","checkbox-"+i.action.node.id),w.Mb(1),w.ed(i.action.node.name),w.Mb(1),w.Cc("ngIf",i.selected&&c.state.admin)}}function Ve(t,e){1&t&&(w.gc(0,"div",53),w.gc(1,"button",54),w.dd(2,"Create Supplier"),w.fc(),w.fc())}function Xe(t,e){if(1&t){var n=w.hc();w.gc(0,"form",5,6),w.rc("submit",(function(){return w.Pc(n),w.vc().onSubmit()})),w.gc(2,"div",7),w.gc(3,"div",8),w.gc(4,"div",9),w.gc(5,"div",10),w.gc(6,"div",11),w.gc(7,"h5"),w.dd(8,"Essential Details"),w.fc(),w.gc(9,"div",12),w.gc(10,"label",13),w.dd(11,"Company Name"),w.fc(),w.gc(12,"input",14,15),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc().model.company=t})),w.fc(),w.fc(),w.gc(14,"div",12),w.gc(15,"label",16),w.dd(16,"Contact Name"),w.fc(),w.gc(17,"input",17,18),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc().model.contactName=t})),w.fc(),w.fc(),w.bd(19,We,5,1,"div",19),w.bd(20,Le,5,1,"div",19),w.bd(21,qe,5,1,"div",19),w.gc(22,"div",12),w.gc(23,"label",20),w.dd(24,"Notes"),w.fc(),w.gc(25,"textarea",21,22),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc().model.notes=t})),w.fc(),w.fc(),w.bd(27,ze,14,4,"div",23),w.gc(28,"div"),w.gc(29,"label",24),w.gc(30,"b"),w.dd(31,"Actions"),w.fc(),w.fc(),w.gc(32,"div",8),w.bd(33,Qe,5,7,"div",25),w.fc(),w.fc(),w.bd(34,Ve,3,0,"div",26),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.Mc(1),c=w.vc();w.Mb(12),w.Cc("ngModel",c.model.company),w.Mb(5),w.Cc("ngModel",c.model.contactName),w.Mb(2),w.Cc("ngIf",c.state.admin),w.Mb(1),w.Cc("ngIf",c.state.admin),w.Mb(1),w.Cc("ngIf",c.state.admin),w.Mb(4),w.Cc("ngModel",c.model.notes),w.Mb(2),w.Cc("ngIf",c.state.admin),w.Mb(6),w.Cc("ngForOf",c.model.actionCosts),w.Mb(1),w.Cc("ngIf",!c.state.submitting&&i.form.valid)}}var Ke=function(){return function(){this.isManufacturer=!1}}(),Ze=function(){function t(t,e,n,i,c){this.actionService=t,this.appUserService=e,this.supplierActionService=n,this.supplierService=i,this.toastrService=c,this.model=new Ke,this.data={actions:[]},this.state={admin:!1,loading:!0,submitting:!1}}return t.prototype.ngOnInit=function(){var t=this;this.model.actionCosts=[],Object(L.a)(this.actionService.list(),this.appUserService.getMe()).subscribe((function(e){var n=e[1];t.data.actions=e[0].data.actions.edges,t.state.admin=t.appUserService.isAdmin(n.data.appUser.roles);for(var i=0,c=t.data.actions;i<c.length;i++)t.model.actionCosts.push({action:c[i],cost:null,selected:!1});t.state.loading=!1}))},t.prototype.onSubmit=function(){return t=this,void 0,n=function(){var t=this;return function(t,e){var n,i,c,o,a={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(c=2&o[0]?i.return:o[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,o[1])).done)return c;switch(i=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((c=(c=a.trys).length>0&&c[c.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){a.label=o[1];break}if(6===o[0]&&a.label<c[1]){a.label=c[1],c=o;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(o);break}c[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],i=0}finally{n=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){return this.state.submitting=!0,this.toastrService.success(null,"Creating Supplier"),this.supplierService.create({company:this.model.company,contactName:this.model.contactName,email:this.model.email,telephone:this.model.telephone,address:this.model.address,notes:this.model.notes,isManufacturer:this.model.isManufacturer}).subscribe((function(e){for(var n=0,i=0,c=t.toastrService.success(null,"Supplier Created, Adding Actions",{timeOut:3e4}),o=0,a=t.model.actionCosts;o<a.length;o++){var s=a[o];s.selected&&(i+=1,t.supplierActionService.create({supplier:e.data.createSupplier.id,action:s.action.node.id,cost:t.formatCurrency(s.cost)}).subscribe((function(e){(n+=1)===i?(c.toastRef.close(),t.toastrService.success(null,"Added "+i+" Actions to Supplier"),t.state.submitting=!1):(c.toastRef.componentInstance.title="Added "+n+"/"+i+" Actions to Supplier",c.toastRef.timeoutReset())})))}})),[2]}))},new((e=void 0)||(e=Promise))((function(i,c){function o(t){try{s(n.next(t))}catch(e){c(e)}}function a(t){try{s(n.throw(t))}catch(e){c(e)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(o,a)}s((n=n.apply(t,[])).next())}));var t,e,n},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.\u0275fac=function(e){return new(e||t)(w.ac(R),w.ac(z.a),w.ac(W),w.ac(D.a),w.ac(Z.b))},t.\u0275cmp=w.Ub({type:t,selectors:[["ng-component"]],decls:3,vars:2,consts:[["subtitle","I get by with a little help from my friends","title","Create Supplier"],["class","mt-5",4,"ngIf"],["novalidate","",3,"submit",4,"ngIf"],[1,"mt-5"],[3,"size"],["novalidate","",3,"submit"],["createSupplierForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"form-group"],["for","company",1,"req"],["appShowErrorInputClass","","id","company","maxlength","255","name","comapny","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],["for","contactName",1,"req"],["appShowErrorInputClass","","id","contactName","maxlength","255","name","contactName","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["contactName","ngModel"],["class","form-group",4,"ngIf"],["for","notes"],["appShowErrorInputClass","","id","notes","placeholder","These are for your own internal reference, supplier will not see these","maxlength","255","name","notes","type","text",1,"form-control",3,"ngModel","ngModelChange"],["notes","ngModel"],["class","container order-count-selection mb-3 mt-1 form-group",4,"ngIf"],["for","email"],["class","mb-2 col-sm-6",4,"ngFor","ngForOf"],["class","float-right",4,"ngIf"],["appShowErrorInputClass","","id","email","maxlength","255","name","email","type","text",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["for","telephone"],["appShowErrorInputClass","","id","telephone","maxlength","255","name","telephone","type","text",1,"form-control",3,"ngModel","ngModelChange"],["telephone","ngModel"],["for","address"],["appShowErrorInputClass","","id","address","maxlength","255","name","address","type","text",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],[1,"container","order-count-selection","mb-3","mt-1","form-group"],[1,"row","ml-2","inline-options",2,"margin-bottom","0"],[1,"col-sm-3","pl-0"],[1,"option"],["type","radio","name","isManufacturer","id","trueIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","trueIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"col-sm-3","pr-0"],["type","radio","name","isManufacturer","id","falseIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","falseIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"mb-2","col-sm-6"],["type","checkbox",1,"mr-2",3,"ngModel","name","id","value","ngModelChange"],[3,"for"],["class","input-group mb-1",4,"ngIf"],[1,"input-group","mb-1"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","class","form-control","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",3,"ngModel","decimalPlaces","id","name","ngModelChange",4,"ngIf"],["appShowErrorInputClass","","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","id","name","ngModelChange"],[1,"float-right"],["type","submit",1,"btn","btn-primary"]],template:function(t,e){1&t&&(w.bc(0,"page-title",0),w.bd(1,Ge,2,1,"div",1),w.bd(2,Xe,35,9,"form",2)),2&t&&(w.Mb(1),w.Cc("ngIf",e.state.submitting||e.state.loading),w.Mb(1),w.Cc("ngIf",!e.state.loading))},directives:[tt.a,g.u,Et.a,b.z,b.l,b.m,b.d,Jt.a,b.g,b.u,b.k,b.n,g.t,b.s,b.a,b.q,He.a],styles:[""]}),t}(),tn=n("/tv0");function en(t,e){1&t&&w.bc(0,"page-title",6)}function nn(t,e){1&t&&w.bc(0,"page-title",7)}function cn(t,e){1&t&&w.bc(0,"page-title",8)}function on(t,e){1&t&&w.bc(0,"page-title",9)}function an(t,e){if(1&t&&(w.gc(0,"div",10),w.gc(1,"h4",11),w.dd(2),w.fc(),w.bc(3,"batches-table",12),w.fc()),2&t){var n=w.vc();w.Mb(2),w.ed(n.state.isSupplier?"Incoming Batches":"Sent to Suppliers"),w.Mb(1),w.Cc("partnerComplete",!0)("manufacturerComplete",!1)("inProduction",null)("supplierExists",!0)("isAdmin",n.state.isAdmin)("isSupplier",n.state.isSupplier)("isToSupplier",n.state.toSupplier)("isFromSupplier",n.state.fromSupplier)("order","DESC")("deletable",!1)}}function sn(t,e){if(1&t&&(w.gc(0,"div",13),w.gc(1,"h4",11),w.dd(2),w.fc(),w.bc(3,"batches-table",14),w.fc()),2&t){var n=w.vc();w.Mb(2),w.ed(n.state.isSupplier?"Outgoing Batches to CAST":"Incoming from Suppliers"),w.Mb(1),w.Cc("partnerComplete",!0)("manufacturerComplete",!0)("inProduction",!1)("supplierExists",!0)("isAdmin",n.state.isAdmin)("isSupplier",n.state.isSupplier)("inQualityControl",!1)("isToSupplier",n.state.toSupplier)("isFromSupplier",n.state.fromSupplier)("order","DESC")("deletable",!1)}}function dn(t,e){if(1&t&&(w.gc(0,"div",10),w.gc(1,"h4",11),w.dd(2,"Completed"),w.fc(),w.bc(3,"batches-table",15),w.fc()),2&t){var n=w.vc();w.Mb(3),w.Cc("supplierExists",!0)("isAdmin",n.state.isAdmin)("isSupplier",n.state.isSupplier)("inQualityControl",!0)("isToSupplier",n.state.toSupplier)("isFromSupplier",n.state.fromSupplier)("deletable",!1)("order","DESC")}}var ln=function(){function t(t,e){this.appUserService=t,this.router=e,this.state={isAdmin:!1,isSupplier:!1,toSupplier:!1,fromSupplier:!1}}return t.prototype.ngOnInit=function(){var t=this,e=this.router.url;e.includes("incoming")&&(this.state.toSupplier=!0),e.includes("outgoing")&&(this.state.fromSupplier=!0),this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(e.data.appUser.roles)}))},t.\u0275fac=function(e){return new(e||t)(w.ac(z.a),w.ac(m.b))},t.\u0275cmp=w.Ub({type:t,selectors:[["ng-component"]],decls:7,vars:7,consts:[["title","Batches Sent","subtitle","Batches sent from CAST to suppliers",4,"ngIf"],["title","Incoming Batches","subtitle","Batches of jobs from CAST",4,"ngIf"],["title","Incoming Batches","subtitle","Batches returned from suppliers",4,"ngIf"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST",4,"ngIf"],["class","container-fluid mx-0",4,"ngIf"],["class","container-fluid mx-0 mb-4",4,"ngIf"],["title","Batches Sent","subtitle","Batches sent from CAST to suppliers"],["title","Incoming Batches","subtitle","Batches of jobs from CAST"],["title","Incoming Batches","subtitle","Batches returned from suppliers"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST"],[1,"container-fluid","mx-0"],[1,"card-title"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","isToSupplier","isFromSupplier","order","deletable"],[1,"container-fluid","mx-0","mb-4"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","order","deletable"],[3,"supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","deletable","order"]],template:function(t,e){1&t&&(w.bd(0,en,1,0,"page-title",0),w.bd(1,nn,1,0,"page-title",1),w.bd(2,cn,1,0,"page-title",2),w.bd(3,on,1,0,"page-title",3),w.bd(4,an,4,11,"div",4),w.bd(5,sn,4,12,"div",5),w.bd(6,dn,4,8,"div",4)),2&t&&(w.Cc("ngIf",e.state.toSupplier&&e.state.isAdmin),w.Mb(1),w.Cc("ngIf",e.state.toSupplier&&e.state.isSupplier),w.Mb(1),w.Cc("ngIf",e.state.fromSupplier&&e.state.isAdmin),w.Mb(1),w.Cc("ngIf",e.state.fromSupplier&&e.state.isSupplier),w.Mb(1),w.Cc("ngIf",e.state.toSupplier),w.Mb(1),w.Cc("ngIf",e.state.fromSupplier),w.Mb(1),w.Cc("ngIf",e.state.fromSupplier))},directives:[g.u,tt.a,tn.a],styles:[""]}),t}(),rn=n("7ape"),un=n("uzfv"),gn=n("rYPC"),bn=n("cXB8"),fn=n("z17N"),mn=n("6QD7"),pn=n("zVvu"),hn=function(t,e,n,i){return new(n||(n=Promise))((function(c,o){function a(t){try{d(i.next(t))}catch(e){o(e)}}function s(t){try{d(i.throw(t))}catch(e){o(e)}}function d(t){var e;t.done?c(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}d((i=i.apply(t,e||[])).next())}))},vn=function(t,e){var n,i,c,o,a={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(c=2&o[0]?i.return:o[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,o[1])).done)return c;switch(i=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((c=(c=a.trys).length>0&&c[c.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){a.label=o[1];break}if(6===o[0]&&a.label<c[1]){a.label=c[1],c=o;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(o);break}c[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],i=0}finally{n=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Cn(t,e){if(1&t&&w.bc(0,"page-title",7),2&t){var n=w.vc();w.Cc("title",n.data.incomingBatch?"Incoming Batch":"Outgoing Batch")}}function Mn(t,e){if(1&t&&w.bc(0,"page-title",7),2&t){var n=w.vc();w.Cc("title",!0===n.data.incomingBatch?"Batch to CAST":"Incoming Batch")}}function Sn(t,e){if(1&t&&(w.gc(0,"p",19),w.gc(1,"span",20),w.dd(2,"Estimated Cost: "),w.fc(),w.dd(3),w.wc(4,"currency"),w.wc(5,"currency"),w.wc(6,"currency"),w.fc()),2&t){var n=w.vc(2);w.Mb(3),w.hd(" ",w.xc(4,3,n.data.totalEstMetalCost+n.data.totalEstLaborCost)," (L:",w.xc(5,5,n.data.totalEstLaborCost),") (M: ",w.xc(6,7,n.data.totalEstMetalCost),") ")}}function An(t,e){if(1&t&&(w.gc(0,"p",19),w.gc(1,"span",20),w.dd(2,"Sent From: "),w.fc(),w.dd(3),w.wc(4,"titlecase"),w.fc()),2&t){var n=w.vc(2);w.Mb(3),w.fd("",w.xc(4,1,n.data.batch.supplier.company)," ")}}function In(t,e){if(1&t&&(w.gc(0,"p",19),w.dd(1," Live Time: "),w.gc(2,"strong"),w.dd(3),w.fc(),w.fc()),2&t){var n=w.vc(2);w.Mb(3),w.ed(n.liveTime)}}function yn(t,e){if(1&t){var n=w.hc();w.gc(0,"button",23),w.rc("click",(function(){return w.Pc(n),w.vc(2).printAll()})),w.dd(1," Print All "),w.fc()}}function wn(t,e){if(1&t){var n=w.hc();w.gc(0,"button",23),w.rc("click",(function(){return w.Pc(n),w.vc(2).exportAddressData()})),w.dd(1," Export Addresses "),w.fc()}}function jn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",44),w.dd(4,"Silver"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",45),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._silverBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._silverBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Pn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",46),w.dd(4,"9ct Yellow Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",47),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._9ctYellowGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._9ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function xn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",48),w.dd(4,"9ct Rose Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",49),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._9ctRoseGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._9ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Bn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",50),w.dd(4,"9ct White Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",51),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._9ctWhiteGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._9ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Tn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",52),w.dd(4,"14ct Yellow Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",53),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._14ctYellowGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._14ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function kn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",54),w.dd(4,"14ct Rose Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",55),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._14ctRoseGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._14ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function En(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",56),w.dd(4,"14ct White Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",57),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._14ctWhiteGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._14ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function On(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",29),w.gc(3,"label",58),w.dd(4,"18ct Yellow Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",59),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._18ctYellowGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._18ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Jn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",60),w.dd(4,"18ct Rose Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",61),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._18ctRoseGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._18ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Nn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",62),w.dd(4,"18ct White Gold"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",63),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._18ctWhiteGoldBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._18ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function $n(t,e){if(1&t){var n=w.hc();w.gc(0,"div",9),w.gc(1,"div",12),w.gc(2,"div",32),w.gc(3,"label",64),w.dd(4,"Platinum"),w.fc(),w.gc(5,"div",34),w.gc(6,"div",35),w.gc(7,"div",36),w.dd(8,"\xa3"),w.fc(),w.fc(),w.gc(9,"input",65),w.rc("ngModelChange",(function(t){w.Pc(n);var e=w.vc(3);return e.metalsInBatch[e._platinumBaseMetalName].actualCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()}if(2&t){var i=w.vc(3);w.Mb(9),w.Cc("ngModel",i.metalsInBatch[i._platinumBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function _n(t,e){1&t&&(w.gc(0,"span"),w.dd(1,"Save"),w.fc())}function Rn(t,e){1&t&&w.bc(0,"span",66)}function Fn(t,e){if(1&t&&(w.gc(0,"tr"),w.gc(1,"th"),w.dd(2),w.fc(),w.gc(3,"td"),w.dd(4),w.wc(5,"number"),w.fc(),w.gc(6,"td"),w.dd(7),w.wc(8,"number"),w.fc(),w.gc(9,"td"),w.dd(10),w.wc(11,"number"),w.fc(),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc(4);w.Mb(2),w.ed(n),w.Mb(2),w.ed(w.yc(5,8,i.metalsInBatch[n].estimateCost/100,"1.2-2")),w.Mb(3),w.ed(w.yc(8,11,i.metalsInBatch[n].actualCostExisting,"1.2-2")),w.Mb(2),w.Sb("color-danger",i.metalsInBatch[n].estimateCost/100-i.metalsInBatch[n].actualCostExisting<0)("color-success",i.metalsInBatch[n].estimateCost/100-i.metalsInBatch[n].actualCostExisting>=0),w.Mb(1),w.ed(w.yc(11,14,i.metalsInBatch[n].estimateCost/100-i.metalsInBatch[n].actualCostExisting,"1.2-2"))}}function Dn(t,e){if(1&t&&(w.ec(0),w.bd(1,Fn,12,17,"tr",41),w.dc()),2&t){var n=e.$implicit,i=w.vc(4);w.Mb(1),w.Cc("ngIf",i.metalsInBatch[n].present)}}function Hn(t,e){if(1&t&&(w.gc(0,"div",67),w.gc(1,"div",13),w.gc(2,"div",14),w.gc(3,"h6"),w.dd(4,"Cost Analysis"),w.fc(),w.fc(),w.gc(5,"div",15),w.gc(6,"p"),w.gc(7,"strong"),w.dd(8,"Invoice Costs"),w.fc(),w.fc(),w.gc(9,"table",68),w.gc(10,"thead"),w.gc(11,"tr"),w.bc(12,"th"),w.gc(13,"th"),w.dd(14,"EST"),w.fc(),w.gc(15,"th"),w.dd(16,"ACT"),w.fc(),w.gc(17,"th"),w.dd(18,"DIFF"),w.fc(),w.fc(),w.fc(),w.gc(19,"tbody"),w.gc(20,"tr"),w.gc(21,"th"),w.dd(22,"Labour"),w.fc(),w.gc(23,"td"),w.dd(24),w.wc(25,"number"),w.fc(),w.gc(26,"td"),w.dd(27),w.wc(28,"number"),w.fc(),w.gc(29,"td"),w.dd(30),w.wc(31,"number"),w.fc(),w.fc(),w.bd(32,Dn,2,1,"ng-container",4),w.gc(33,"tr"),w.bc(34,"td"),w.gc(35,"td"),w.dd(36),w.wc(37,"number"),w.fc(),w.gc(38,"td"),w.dd(39),w.wc(40,"number"),w.fc(),w.gc(41,"td"),w.dd(42),w.wc(43,"number"),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc()),2&t){var n=w.vc(3);w.Mb(24),w.ed(w.yc(25,15,n.data.totalEstLaborCost/100,"1.2-2")),w.Mb(3),w.ed(w.yc(28,18,n.model.labourCostExisting,"1.2-2")),w.Mb(2),w.Sb("color-danger",n.data.totalEstLaborCost/100-n.model.labourCostExisting<0)("color-success",n.data.totalEstLaborCost/100-n.model.labourCostExisting>=0),w.Mb(1),w.ed(w.yc(31,21,n.data.totalEstLaborCost/100-n.model.labourCostExisting,"1.2-2")),w.Mb(2),w.Cc("ngForOf",n.objectKeys(n.metalsInBatch)),w.Mb(4),w.ed(w.yc(37,24,n.data.totalEstimatedCost/100,"1.2-2")),w.Mb(3),w.ed(w.yc(40,27,n.data.totalActualCost,"1.2-2")),w.Mb(2),w.Sb("color-danger",n.data.totalEstimatedCost/100-n.data.totalActualCost<0)("color-success",n.data.totalEstimatedCost/100-n.data.totalActualCost>=0),w.Mb(1),w.ed(w.yc(43,30,n.data.totalEstimatedCost/100-n.data.totalActualCost,"1.2-2"))}}function Gn(t,e){if(1&t){var n=w.hc();w.gc(0,"div",24),w.gc(1,"div",11),w.gc(2,"div",25),w.gc(3,"div",13),w.gc(4,"div",14),w.gc(5,"h6"),w.dd(6,"Invoicing Details"),w.fc(),w.fc(),w.gc(7,"div",15),w.gc(8,"form",26,27),w.rc("ngSubmit",(function(){return w.Pc(n),w.vc(2).onSubmit()})),w.gc(10,"div",28),w.gc(11,"div",12),w.gc(12,"div",29),w.gc(13,"label",30),w.dd(14,"Invoice / Advice"),w.fc(),w.gc(15,"input",31),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.invoice=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(16,"h6"),w.dd(17,"Invoice Costs"),w.fc(),w.gc(18,"div",9),w.gc(19,"div",12),w.gc(20,"div",32),w.gc(21,"label",33),w.dd(22,"Labour"),w.fc(),w.gc(23,"div",34),w.gc(24,"div",35),w.gc(25,"div",36),w.dd(26,"\xa3"),w.fc(),w.fc(),w.gc(27,"input",37),w.rc("ngModelChange",(function(t){return w.Pc(n),w.vc(2).model.labourCostStaging=t})),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.bd(28,jn,10,2,"div",38),w.bd(29,Pn,10,2,"div",38),w.bd(30,xn,10,2,"div",38),w.bd(31,Bn,10,2,"div",38),w.bd(32,Tn,10,2,"div",38),w.bd(33,kn,10,2,"div",38),w.bd(34,En,10,2,"div",38),w.bd(35,On,10,2,"div",38),w.bd(36,Jn,10,2,"div",38),w.bd(37,Nn,10,2,"div",38),w.bd(38,$n,10,2,"div",38),w.gc(39,"div",39),w.gc(40,"div",12),w.gc(41,"button",40),w.bd(42,_n,2,0,"span",41),w.bd(43,Rn,1,0,"span",42),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.bd(44,Hn,44,33,"div",43),w.fc(),w.fc()}if(2&t){var i=w.Mc(9),c=w.vc(2);w.Mb(15),w.Cc("ngModel",c.model.invoice),w.Mb(12),w.Cc("ngModel",c.model.labourCostStaging)("decimalPlaces",2),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._silverBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._9ctYellowGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._9ctRoseGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._9ctWhiteGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._14ctYellowGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._14ctRoseGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._14ctWhiteGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._18ctYellowGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._18ctRoseGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._18ctWhiteGoldBaseMetalName].present),w.Mb(1),w.Cc("ngIf",c.metalsInBatch[c._platinumBaseMetalName].present),w.Mb(3),w.Cc("disabled",!i.valid||c.state.submitting||i.pristine),w.Mb(1),w.Cc("ngIf",!c.state.submitting),w.Mb(1),w.Cc("ngIf",c.state.submitting),w.Mb(1),w.Cc("ngIf",c.state.isAdmin&&c.data.incomingBatch)}}function Wn(t,e){if(1&t&&(w.gc(0,"div",8),w.gc(1,"div",9),w.gc(2,"div",10),w.gc(3,"div",11),w.gc(4,"div",12),w.gc(5,"div",13),w.gc(6,"div",14),w.gc(7,"h6"),w.dd(8,"Batch Information"),w.fc(),w.fc(),w.gc(9,"div",15),w.gc(10,"h6"),w.dd(11,"Make Up"),w.fc(),w.gc(12,"div",9),w.bc(13,"div",16),w.gc(14,"div",17),w.gc(15,"div",9),w.gc(16,"div",12),w.dd(17),w.bc(18,"br"),w.dd(19),w.bc(20,"br"),w.dd(21),w.bc(22,"br"),w.dd(23),w.fc(),w.fc(),w.bc(24,"hr"),w.gc(25,"div",9),w.gc(26,"div",12),w.bd(27,Sn,7,9,"p",18),w.gc(28,"p",19),w.gc(29,"span",20),w.dd(30,"Date Sent: "),w.fc(),w.dd(31),w.wc(32,"simpleDate"),w.fc(),w.bd(33,An,5,3,"p",18),w.bd(34,In,4,1,"p",18),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.gc(35,"div",11),w.gc(36,"div",12),w.gc(37,"div",13),w.gc(38,"div",14),w.gc(39,"h6"),w.dd(40,"Actions"),w.fc(),w.fc(),w.gc(41,"div",15),w.bd(42,yn,2,0,"button",21),w.bd(43,wn,2,0,"button",21),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.bd(44,Gn,45,18,"div",22),w.fc(),w.fc()),2&t){var n=w.vc();w.Mb(17),w.fd(" Total: ",n.data.jobCount,""),w.Mb(2),w.fd(" Ring: ",n.data.ringCount,""),w.Mb(2),w.fd(" Pendant: ",n.data.pendantCount,""),w.Mb(2),w.fd(" Earring: ",n.data.earringCount," "),w.Mb(4),w.Cc("ngIf",n.state.isAdmin),w.Mb(4),w.fd("",n.data.batch.dateSent?w.xc(32,11,n.data.batch.dateSent):"Not Sent"," "),w.Mb(2),w.Cc("ngIf",n.state.isAdmin),w.Mb(1),w.Cc("ngIf",n.state.isAdmin),w.Mb(8),w.Cc("ngIf",!n.state.loading&&n.state.isAdmin),w.Mb(1),w.Cc("ngIf",!n.state.loading&&n.state.isAdmin),w.Mb(1),w.Cc("ngIf",n.data.incomingBatch)}}function Ln(t,e){if(1&t){var n=w.hc();w.gc(0,"div",82),w.gc(1,"input",83),w.rc("click",(function(){return w.Pc(n),w.vc(3).selectAll()}))("ngModelChange",(function(t){return w.Pc(n),w.vc(3).state.allSelected=t})),w.fc(),w.bc(2,"label",84),w.fc()}if(2&t){var i=w.vc(3);w.Mb(1),w.Cc("ngModel",i.state.allSelected)("value",i.state.allSelected)}}function qn(t,e){if(1&t&&(w.gc(0,"th",80),w.bd(1,Ln,3,2,"div",81),w.fc()),2&t){var n=w.vc(2);w.Mb(1),w.Cc("ngIf",!n.state.loading)}}function zn(t,e){1&t&&(w.gc(0,"th",75),w.dd(1,"Due By"),w.fc())}function Un(t,e){1&t&&(w.gc(0,"th",75),w.dd(1,"Metal Weight"),w.fc())}function Yn(t,e){1&t&&(w.gc(0,"th",75),w.dd(1,"Est Cost (\xa3)"),w.fc())}function Qn(t,e){if(1&t){var n=w.hc();w.gc(0,"th",100),w.gc(1,"div",82),w.gc(2,"input",101),w.rc("click",(function(){w.Pc(n);var t=w.vc().$implicit;return w.vc(2).selectRow(t)}))("ngModelChange",(function(t){return w.Pc(n),w.vc().$implicit.selected=t})),w.fc(),w.bc(3,"label",102),w.fc(),w.fc()}if(2&t){var i=w.vc().$implicit;w.Mb(2),w.Ec("id","sub-cb-",i.submission.id,""),w.Cc("disabled",!i.submission.metalWeight)("ngModel",i.selected)("name","submission"+i.submission.id),w.Mb(1),w.Ec("for","sub-cb-",i.submission.id,"")}}var Vn=function(){return[20]};function Xn(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"truncate"),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.ed(w.yc(2,1,n.submission.customer.event.name,w.Fc(4,Vn)))}}function Kn(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.ed(n.submission.castingCode)}}function Zn(t,e){1&t&&w.bc(0,"span",105),2&t&&w.Cc("ngbTooltip","Rush")}function ti(t,e){1&t&&w.bc(0,"span",106),2&t&&w.Cc("ngbTooltip","Standard")}function ei(t,e){if(1&t&&(w.ec(0),w.bd(1,Zn,1,1,"span",103),w.bd(2,ti,1,1,"span",104),w.dc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.Cc("ngIf",n.job.rush),w.Mb(1),w.Cc("ngIf",!n.job.rush)}}function ni(t,e){1&t&&w.bc(0,"span",107)}function ii(t,e){if(1&t){var n=w.hc();w.gc(0,"td"),w.gc(1,"input",108),w.rc("ngModelChange",(function(){w.Pc(n);var t=w.vc().$implicit;return w.vc(2).updateJob(t)}))("ngModelChange",(function(t){return w.Pc(n),w.vc().$implicit.job.due=t})),w.fc(),w.bc(2,"owl-date-time",109,110),w.fc()}if(2&t){var i=w.Mc(3),c=w.vc().$implicit;w.Mb(1),w.Cc("ngModel",c.job.due)("owlDateTimeTrigger",i)("owlDateTime",i),w.Mb(1),w.Cc("pickerType","calendar")}}function ci(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"simpleDate"),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.fd(" ",n.job.due?w.xc(2,1,n.job.due):""," ")}}function oi(t,e){if(1&t){var n=w.hc();w.gc(0,"td"),w.gc(1,"input",111),w.rc("blur",(function(){w.Pc(n);var t=w.vc().$implicit;return w.vc(2).updateSubmission(t)}))("ngModelChange",(function(t){return w.Pc(n),w.vc().$implicit.submission.metalWeight=t})),w.fc(),w.fc()}if(2&t){var i=w.vc().$implicit;w.Mb(1),w.Cc("ngModel",i.submission.metalWeight)}}function ai(t,e){if(1&t&&(w.gc(0,"span",113),w.dd(1),w.wc(2,"currency"),w.wc(3,"currency"),w.fc()),2&t){var n=w.vc(2).$implicit;w.Mb(1),w.gd(" (",w.xc(2,2,n.jobLabourCostEst)," + ",w.xc(3,4,n.jobMetalCostEst),") ")}}function si(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"currency"),w.bc(3,"br"),w.bd(4,ai,4,6,"span",112),w.fc()),2&t){var n=w.vc().$implicit;w.Mb(1),w.fd(" ",n.jobTotalCostEst?w.xc(2,2,n.jobTotalCostEst):"",""),w.Mb(3),w.Cc("ngIf",n.jobTotalCostEst)}}function di(t,e){if(1&t){var n=w.hc();w.gc(0,"button",114),w.rc("click",(function(){w.Pc(n);var t=w.vc().$implicit,e=w.vc(2),i=w.Mc(7);return e.viewJobActionModal(t,i)})),w.fc()}if(2&t){var i=w.vc(3);w.Cc("disabled",i.state.loadingActions||i.state.loadingJobActions)}}function li(t,e){1&t&&w.bc(0,"span",66)}function ri(t,e){if(1&t){var n=w.hc();w.gc(0,"button",115),w.rc("click",(function(){w.Pc(n);var t=w.vc().$implicit;return w.vc(2).createPdf(t)})),w.bd(1,li,1,0,"span",42),w.fc()}if(2&t){var i=w.vc().$implicit,c=w.vc(2);w.Sb("fa-print",!i.printing),w.Cc("disabled",c.state.loadingStones&&c.state.loadingJobActions||!0===i.printing),w.Mb(1),w.Cc("ngIf",!0===i.printing)}}function ui(t,e){1&t&&w.bc(0,"span",118)}function gi(t,e){if(1&t){var n=w.hc();w.gc(0,"button",116),w.rc("click",(function(){w.Pc(n);var t=w.vc().$implicit;return w.vc(2).toggleSubmissionPhotoTimer(t.submission.id)})),w.bd(1,ui,1,0,"span",117),w.fc()}if(2&t){var i=w.vc().$implicit,c=w.vc(2);w.Sb("fa-camera",!c.data.submissionPhotoTimingMap[i.submission.id]&&!1===c.state.submitting)("fa-stop",c.data.submissionPhotoTimingMap[i.submission.id]&&!1===c.state.submitting)("hover",!c.data.submissionPhotoTimingMap[i.submission.id]),w.Cc("disabled",c.state.submitting),w.Mb(1),w.Cc("ngIf",!0===c.state.submitting)}}function bi(t,e){if(1&t){var n=w.hc();w.gc(0,"button",119),w.rc("click",(function(){w.Pc(n);var t=w.vc().$implicit;return w.vc(2).deleteJob(t)})),w.fc()}}function fi(t,e){if(1&t&&w.bc(0,"view-submission-modal",120),2&t){var n=w.vc().$implicit,i=w.vc(2);w.Cc("buttonStyle",!0)("isAdmin",i.state.isAdmin)("loadingStones",i.state.loadingStones)("photos",n.submission.submissionPhotos.edges)("stones",n.stones)("submission",n.submission)}}function mi(t,e){if(1&t&&(w.gc(0,"span"),w.dd(1),w.wc(2,"date"),w.fc()),2&t){var n=w.vc(3);w.Mb(1),w.fd(" Elapsed: ",w.zc(2,1,1e3*n.timeElapsed,"mm:ss","UTC"),"s \xa0 ")}}function pi(t,e){if(1&t){var n=w.hc();w.ec(0),w.gc(1,"tr"),w.wc(2,"lowercaseDashes"),w.bd(3,Qn,4,5,"th",85),w.gc(4,"th",86),w.bc(5,"view-submission-photos-modal",87),w.fc(),w.gc(6,"td",88),w.dd(7),w.wc(8,"numericId"),w.fc(),w.gc(9,"td",89),w.dd(10),w.wc(11,"numericId"),w.fc(),w.gc(12,"td"),w.dd(13),w.fc(),w.bd(14,Xn,3,5,"td",41),w.bd(15,Kn,2,1,"td",41),w.gc(16,"td",90),w.rc("click",(function(t){w.Pc(n);var i=e.$implicit;return w.vc(2).setRush(i,t)})),w.bd(17,ei,3,2,"ng-container",41),w.bd(18,ni,1,0,"span",91),w.fc(),w.bd(19,ii,4,4,"td",41),w.bd(20,ci,3,3,"td",41),w.gc(21,"td"),w.dd(22),w.wc(23,"titlecase"),w.fc(),w.gc(24,"td"),w.dd(25),w.wc(26,"number"),w.fc(),w.bd(27,oi,2,1,"td",41),w.bd(28,si,5,4,"td",41),w.gc(29,"td",92),w.gc(30,"span"),w.dd(31),w.wc(32,"titlecase"),w.fc(),w.fc(),w.gc(33,"td",93),w.gc(34,"div",94),w.bd(35,di,1,1,"button",95),w.bd(36,ri,2,4,"button",96),w.bd(37,gi,2,8,"button",97),w.bd(38,bi,1,0,"button",98),w.fc(),w.bd(39,fi,1,6,"view-submission-modal",99),w.bd(40,mi,3,5,"span",41),w.fc(),w.fc(),w.dc()}if(2&t){var i=e.$implicit,c=w.vc(2);w.Mb(1),w.Pb("status-",w.xc(2,31,i.submission.status.name)," sm"),w.Sb("row-blocked",!c.data.submissionPhotoTimingMap[i.submission.id]&&!0===c.imageLoggingSessionState),w.Mb(2),w.Cc("ngIf",c.state.isAdmin),w.Mb(2),w.Cc("photos",i.submission.submissionPhotos.edges),w.Mb(2),w.ed(w.xc(8,33,i.job.id)),w.Mb(3),w.ed(w.xc(11,35,i.submission.id)),w.Mb(3),w.ed(i.submission.customer.fullName),w.Mb(1),w.Cc("ngIf",i.submission.customer.event),w.Mb(1),w.Cc("ngIf",i.submission.castingCode),w.Mb(2),w.Cc("ngIf",!i.pendingUpdateJob),w.Mb(1),w.Cc("ngIf",i.pendingUpdateJob),w.Mb(1),w.Cc("ngIf",c.state.isAdmin&&c.data.outgoingBatch),w.Mb(1),w.Cc("ngIf",!c.state.isAdmin&&c.data.outgoingBatch),w.Mb(2),w.ed(w.xc(23,37,i.submission.kitType.name)),w.Mb(3),w.ed(w.yc(26,39,i.submission.waxWeight,"0.2-4")),w.Mb(2),w.Cc("ngIf",c.data.incomingBatch),w.Mb(1),w.Cc("ngIf",c.state.isAdmin),w.Mb(1),w.Sb("notready",0===i.submission.submissionPhotos.edges.length)("ready",i.submission.submissionPhotos.edges.length>0),w.Mb(2),w.ed(w.xc(32,42,i.submission.status.name)),w.Mb(4),w.Cc("ngIf",c.state.isAdmin&&!1===c.imageLoggingSessionState),w.Mb(1),w.Cc("ngIf",!1===c.imageLoggingSessionState),w.Mb(1),w.Cc("ngIf",(!1===c.imageLoggingSessionState||c.data.submissionPhotoTimingMap[i.submission.id])&&c.state.isAdmin),w.Mb(1),w.Cc("ngIf",c.state.isAdmin&&!1===c.imageLoggingSessionState),w.Mb(1),w.Cc("ngIf",!1===c.imageLoggingSessionState),w.Mb(1),w.Cc("ngIf",c.data.submissionPhotoTimingMap[i.submission.id])}}function hi(t,e){if(1&t){var n=w.hc();w.gc(0,"div",121),w.gc(1,"button",122),w.rc("click",(function(){w.Pc(n);var t=w.vc(2);return t.updateStatus(t.statusInProduction)})),w.dd(2),w.fc(),w.fc()}if(2&t){var i=w.vc(2);w.Mb(1),w.Cc("disabled",i.state.nextStatus.manuallyConfirmAll&&i.data.selections.length!==i.data.submissionInfos.length||i.state.submitting),w.Mb(1),w.fd(" ",i.state.nextStatus.buttonText," ")}}function vi(t,e){1&t&&(w.gc(0,"div",123),w.bc(1,"loading-ring",124),w.fc()),2&t&&(w.Mb(1),w.Cc("size",60))}function Ci(t,e){if(1&t&&(w.gc(0,"div",69),w.gc(1,"div",12),w.gc(2,"h5",70),w.dd(3,"Items in Batch"),w.fc(),w.gc(4,"div",71),w.gc(5,"table",72),w.gc(6,"thead"),w.gc(7,"tr"),w.bd(8,qn,2,1,"th",73),w.bc(9,"th",74),w.gc(10,"th",74),w.dd(11,"JID"),w.fc(),w.gc(12,"th",74),w.dd(13,"SID"),w.fc(),w.gc(14,"th",75),w.dd(15,"Customer"),w.fc(),w.gc(16,"th",75),w.dd(17,"Source"),w.fc(),w.bc(18,"th",74),w.bd(19,zn,2,0,"th",76),w.gc(20,"th",75),w.dd(21,"Type"),w.fc(),w.gc(22,"th",75),w.dd(23,"Wax (g)"),w.fc(),w.bd(24,Un,2,0,"th",76),w.bd(25,Yn,2,0,"th",76),w.gc(26,"th",75),w.dd(27,"Status"),w.fc(),w.bc(28,"th",75),w.fc(),w.fc(),w.gc(29,"tbody"),w.bd(30,pi,41,44,"ng-container",4),w.fc(),w.gc(31,"tfoot"),w.gc(32,"tr"),w.bc(33,"th",77),w.fc(),w.fc(),w.fc(),w.bd(34,hi,3,2,"div",78),w.bd(35,vi,2,1,"div",79),w.fc(),w.fc(),w.fc()),2&t){var n=w.vc();w.Mb(8),w.Cc("ngIf",n.state.isAdmin),w.Mb(11),w.Cc("ngIf",n.data.outgoingBatch),w.Mb(5),w.Cc("ngIf",n.data.incomingBatch),w.Mb(1),w.Cc("ngIf",n.state.isAdmin),w.Mb(5),w.Cc("ngForOf",n.data.submissionInfos),w.Mb(4),w.Cc("ngIf",!n.state.loading&&n.state.nextStatus&&n.data.submissionInfos.length&&(!n.state.nextStatus.adminOnly||n.state.isAdmin)),w.Mb(1),w.Cc("ngIf",n.state.loading)}}function Mi(t,e){if(1&t&&(w.gc(0,"td",134),w.dd(1),w.fc()),2&t){var n=w.vc().$implicit;w.Cc("colSpan",100),w.Mb(1),w.fd("Kit - ",n.submission.castingCode,"")}}var Si=function(){return[20,".."]};function Ai(t,e){if(1&t&&(w.gc(0,"td",134),w.dd(1),w.wc(2,"truncate"),w.fc()),2&t){var n=w.vc().$implicit;w.Cc("colSpan",100),w.Mb(1),w.ed(w.yc(2,2,n.submission.customer.event.name,w.Fc(5,Si)))}}function Ii(t,e){1&t&&(w.gc(0,"td",134),w.dd(1," Other "),w.fc()),2&t&&w.Cc("colSpan",100)}function yi(t,e){if(1&t&&(w.ec(0),w.dd(1),w.wc(2,"uppercase"),w.dc()),2&t){var n=w.vc(3).$implicit;w.Mb(1),w.fd(" - ",w.xc(2,1,n.submission.measuredRingSize.name)," ")}}function wi(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"titlecase"),w.bd(3,yi,3,3,"ng-container",41),w.fc()),2&t){var n=w.vc(2).$implicit,i=w.vc();w.Mb(1),w.fd(" ",w.xc(2,2,n.submission.ringSizeCustom.name)," "),w.Mb(2),w.Cc("ngIf",n.submission.measuredRingSize&&n.submission.ringSizeCustom.name===i.ringSizeLeaveAsIs)}}function ji(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"uppercase"),w.fc()),2&t){var n=w.vc(2).$implicit;w.Mb(1),w.ed(w.xc(2,1,n.submission.ringSizeCustom.name))}}var Pi=function(){return[110,"[...]"]};function xi(t,e){if(1&t&&(w.gc(0,"table",133),w.gc(1,"tbody"),w.gc(2,"tr"),w.gc(3,"td"),w.dd(4,"Metal"),w.fc(),w.gc(5,"td"),w.dd(6),w.wc(7,"titlecase"),w.fc(),w.fc(),w.gc(8,"tr"),w.gc(9,"td"),w.dd(10,"Size"),w.fc(),w.bd(11,wi,4,4,"td",41),w.bd(12,ji,3,3,"td",41),w.fc(),w.gc(13,"tr"),w.gc(14,"td"),w.dd(15,"Finish"),w.fc(),w.gc(16,"td"),w.dd(17),w.wc(18,"titlecase"),w.fc(),w.fc(),w.gc(19,"tr"),w.gc(20,"td"),w.dd(21,"Plating"),w.fc(),w.gc(22,"td"),w.dd(23),w.wc(24,"titlecase"),w.fc(),w.fc(),w.gc(25,"tr",142),w.gc(26,"td"),w.dd(27,"Notes"),w.fc(),w.gc(28,"td"),w.dd(29),w.wc(30,"truncate"),w.fc(),w.fc(),w.fc(),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc();w.Mb(2),w.Sb("invert",n.submission.baseMetal.name!==i.baseMetalSilver),w.Mb(4),w.ed(w.xc(7,8,n.submission.baseMetal.name)),w.Mb(5),w.Cc("ngIf",!n.submission.ringResize),w.Mb(1),w.Cc("ngIf",n.submission.ringResize),w.Mb(5),w.ed(w.xc(18,10,n.submission.finish.name)),w.Mb(6),w.ed(w.xc(24,12,n.submission.plating.name)),w.Mb(6),w.ed(n.submission.customerNotes?w.yc(30,14,n.submission.customerNotes,w.Fc(17,Pi)):"-")}}function Bi(t,e){1&t&&(w.gc(0,"td"),w.dd(1,"None"),w.fc())}function Ti(t,e){1&t&&w.bc(0,"br")}function ki(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"titlecase"),w.wc(3,"titlecase"),w.bd(4,Ti,1,0,"br",41),w.dd(5),w.wc(6,"titlecase"),w.fc()),2&t){var n=w.vc(2).$implicit;w.Mb(1),w.gd(" ",w.xc(2,4,n.submission.chainType.name)," - ",w.xc(3,6,n.submission.chainLength.name)," "),w.Mb(3),w.Cc("ngIf",n.submission.chainPlating),w.Mb(1),w.fd(" ",w.xc(6,8,n.submission.chainPlating.name)," ")}}var Ei=function(){return[30,"[...]"]},Oi=function(){return[90,"[...]"]};function Ji(t,e){if(1&t&&(w.gc(0,"table",133),w.gc(1,"tbody"),w.gc(2,"tr"),w.gc(3,"td"),w.dd(4,"Metal"),w.fc(),w.gc(5,"td"),w.dd(6),w.wc(7,"titlecase"),w.fc(),w.fc(),w.gc(8,"tr"),w.gc(9,"td"),w.dd(10,"Finish"),w.fc(),w.gc(11,"td"),w.dd(12),w.wc(13,"titlecase"),w.fc(),w.fc(),w.gc(14,"tr"),w.gc(15,"td"),w.dd(16,"Plating"),w.fc(),w.gc(17,"td"),w.dd(18),w.wc(19,"titlecase"),w.fc(),w.fc(),w.gc(20,"tr"),w.gc(21,"td"),w.dd(22,"Jump Ring"),w.fc(),w.gc(23,"td"),w.dd(24),w.wc(25,"truncate"),w.fc(),w.fc(),w.gc(26,"tr"),w.gc(27,"td"),w.dd(28,"Chain"),w.fc(),w.bd(29,Bi,2,0,"td",41),w.bd(30,ki,7,10,"td",41),w.fc(),w.gc(31,"tr",142),w.gc(32,"td"),w.dd(33,"Notes"),w.fc(),w.gc(34,"td"),w.dd(35),w.wc(36,"truncate"),w.fc(),w.fc(),w.fc(),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc();w.Mb(2),w.Sb("invert",n.submission.baseMetal.name!==i.baseMetalSilver),w.Mb(4),w.ed(w.xc(7,9,n.submission.baseMetal.name)),w.Mb(6),w.ed(w.xc(13,11,n.submission.finish.name)),w.Mb(6),w.ed(w.xc(19,13,n.submission.plating.name)),w.Mb(6),w.ed(n.submission.jumpRing?w.yc(25,15,n.submission.jumpRingPlacement,w.Fc(21,Ei)):"None"),w.Mb(5),w.Cc("ngIf",!n.submission.chainType),w.Mb(1),w.Cc("ngIf",n.submission.chainType&&n.submission.chainLength),w.Mb(5),w.ed(n.submission.customerNotes?w.yc(36,18,n.submission.customerNotes,w.Fc(22,Oi)):"-")}}var Ni=function(t){return[100,t]};function $i(t,e){if(1&t&&(w.gc(0,"table",133),w.gc(1,"tbody"),w.gc(2,"tr"),w.gc(3,"td"),w.dd(4,"Metal"),w.fc(),w.gc(5,"td"),w.dd(6),w.wc(7,"titlecase"),w.fc(),w.fc(),w.gc(8,"tr"),w.gc(9,"td"),w.dd(10,"Config"),w.fc(),w.gc(11,"td"),w.dd(12),w.wc(13,"titlecase"),w.fc(),w.fc(),w.gc(14,"tr"),w.gc(15,"td"),w.dd(16,"Finish"),w.fc(),w.gc(17,"td"),w.dd(18),w.wc(19,"titlecase"),w.fc(),w.fc(),w.gc(20,"tr"),w.gc(21,"td"),w.dd(22,"Plating"),w.fc(),w.gc(23,"td"),w.dd(24),w.fc(),w.fc(),w.gc(25,"tr",142),w.gc(26,"td"),w.dd(27,"Notes"),w.fc(),w.gc(28,"td"),w.dd(29),w.wc(30,"truncate"),w.fc(),w.fc(),w.fc(),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc();w.Mb(2),w.Sb("invert",n.submission.baseMetal.name!==i.baseMetalSilver),w.Mb(4),w.ed(w.xc(7,7,n.submission.baseMetal.name)),w.Mb(6),w.ed(w.xc(13,9,n.submission.earringConfig.name)),w.Mb(6),w.ed(w.xc(19,11,n.submission.finish.name)),w.Mb(6),w.ed(n.submission.plating.name),w.Mb(5),w.ed(n.submission.customerNotes?w.yc(30,13,n.submission.customerNotes,w.Gc(16,Ni,"[...]")):"-")}}function _i(t,e){if(1&t&&(w.ec(0),w.gc(1,"div",125),w.gc(2,"div",126),w.gc(3,"div",127),w.gc(4,"div",128),w.gc(5,"table",129),w.gc(6,"tr",130),w.gc(7,"th"),w.bc(8,"img",131),w.fc(),w.gc(9,"th",132),w.dd(10),w.wc(11,"numericId"),w.fc(),w.fc(),w.fc(),w.gc(12,"table",133),w.gc(13,"tbody"),w.gc(14,"tr"),w.gc(15,"td"),w.dd(16,"Name"),w.fc(),w.gc(17,"td",134),w.dd(18),w.fc(),w.fc(),w.gc(19,"tr"),w.gc(20,"td"),w.dd(21,"Type"),w.fc(),w.gc(22,"td"),w.dd(23),w.wc(24,"titlecase"),w.fc(),w.gc(25,"td"),w.dd(26),w.wc(27,"number"),w.fc(),w.gc(28,"td"),w.dd(29),w.wc(30,"numericId"),w.fc(),w.fc(),w.gc(31,"tr"),w.gc(32,"td"),w.dd(33,"Source"),w.fc(),w.bd(34,Mi,2,2,"td",135),w.bd(35,Ai,3,6,"td",135),w.bd(36,Ii,2,1,"td",135),w.fc(),w.fc(),w.fc(),w.bd(37,xi,31,18,"table",136),w.bd(38,Ji,37,23,"table",136),w.bd(39,$i,31,18,"table",136),w.gc(40,"div",137),w.gc(41,"div",138),w.gc(42,"div"),w.gc(43,"span"),w.dd(44,"BM"),w.fc(),w.fc(),w.fc(),w.gc(45,"div",138),w.gc(46,"div"),w.gc(47,"span"),w.dd(48,"PLA"),w.fc(),w.fc(),w.fc(),w.gc(49,"div",138),w.gc(50,"div"),w.gc(51,"span"),w.dd(52,"ENG"),w.fc(),w.fc(),w.fc(),w.gc(53,"div",138),w.gc(54,"div"),w.gc(55,"span"),w.dd(56,"HALM"),w.fc(),w.fc(),w.fc(),w.gc(57,"div",138),w.gc(58,"div"),w.gc(59,"span"),w.dd(60,"JR"),w.fc(),w.fc(),w.fc(),w.gc(61,"div",138),w.gc(62,"div"),w.gc(63,"span"),w.dd(64,"POST"),w.fc(),w.fc(),w.fc(),w.gc(65,"div",138),w.gc(66,"div"),w.gc(67,"span"),w.dd(68,"STN"),w.fc(),w.fc(),w.fc(),w.gc(69,"div",138),w.gc(70,"div"),w.gc(71,"span"),w.dd(72,"RZE"),w.fc(),w.fc(),w.fc(),w.gc(73,"div",138),w.gc(74,"div"),w.gc(75,"span"),w.dd(76,"RPR"),w.fc(),w.fc(),w.fc(),w.fc(),w.bc(77,"ngx-barcode",139),w.gc(78,"p",140),w.dd(79),w.wc(80,"numericId"),w.fc(),w.fc(),w.fc(),w.fc(),w.fc(),w.bc(81,"iframe",141),w.dc()),2&t){var n=e.$implicit,i=w.vc();w.Mb(1),w.Sb("pdfLabel",!i.state.printAll),w.Cc("hidden",!i.state.printAll&&i.state.showToPrint!=="submission"+n.numericId)("id","submission"+n.numericId),w.Mb(7),w.Cc("width",60),w.Mb(2),w.fd("Batch #",w.xc(11,41,i.data.batch.id),""),w.Mb(7),w.Cc("colSpan",100),w.Mb(1),w.ed(n.submission.customer.fullName),w.Mb(5),w.ed(w.xc(24,43,n.submission.kitType.name)),w.Mb(3),w.fd("",w.yc(27,45,n.submission.waxWeight,"1.2-2"),"g"),w.Mb(3),w.fd("#",w.xc(30,48,n.job.id),""),w.Mb(5),w.Cc("ngIf",n.submission.castingCode),w.Mb(1),w.Cc("ngIf",n.submission.customer.event),w.Mb(1),w.Cc("ngIf",!n.submission.customer.event&&!n.submission.castingCode),w.Mb(1),w.Cc("ngIf",n.submission.kitType.name===i.kitTypeRing),w.Mb(1),w.Cc("ngIf",n.submission.kitType.name===i.kitTypePendant),w.Mb(1),w.Cc("ngIf",n.submission.kitType.name===i.kitTypeEarring),w.Mb(2),w.Sb("off",n.submission.baseMetal.name===i.baseMetalSilver),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionPlating]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionEngraving]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionHallmarking]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionJumpRing]||null===n.jobActions[i.actionEarringPosts]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionEarringPosts]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionStoneSetting]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionResizing]),w.Mb(4),w.Sb("off",null===n.jobActions[i.actionRepairing]),w.Mb(4),w.Cc("bc-display-value",!1)("bc-element-type","svg")("bc-height",140)("bc-value",n.numericId)("bc-width",8),w.Mb(2),w.fd("Submission Ref #",w.xc(80,50,n.submission.id),"")}}function Ri(t,e){if(1&t){var n=w.hc();w.gc(0,"div",149),w.gc(1,"label",150),w.dd(2),w.fc(),w.gc(3,"input",151),w.rc("ngModelChange",(function(t){w.Pc(n);var i=e.$implicit;return w.vc(2).model.jobActions[i.key]=t})),w.fc(),w.fc()}if(2&t){var i=e.$implicit,c=w.vc(2);w.Mb(1),w.Cc("for","jobAction"+i.key),w.Mb(1),w.ed(i.key),w.Mb(1),w.Cc("ngModel",c.model.jobActions[i.key])("id","jobAction"+i.key)("name","jobAction"+i.key)}}function Fi(t,e){if(1&t){var n=w.hc();w.bc(0,"modal-header",143),w.gc(1,"div",144),w.gc(2,"form",145,146),w.gc(4,"div",9),w.bd(5,Ri,4,5,"div",147),w.wc(6,"keyvalue"),w.fc(),w.fc(),w.fc(),w.gc(7,"modal-footer",148),w.rc("modalSaved",(function(){return w.Pc(n),w.vc().addJobActions()})),w.fc()}if(2&t){var i=e.$implicit,c=w.Mc(3),o=w.vc();w.Cc("modal",i),w.Mb(5),w.Cc("ngForOf",w.xc(6,5,o.model.jobActions)),w.Mb(2),w.Cc("form",c)("modal",i)("saveButtonName","Save")}}function Di(t,e){1&t&&w.bc(0,"loading-ring",152)}var Hi=function(){return function(){var t;this.jobActions=((t={})["Cast & Mount"]=!1,t.Finishing=!1,t.Plating=!1,t.Engraving=!1,t["Jump Ring"]=!1,t["Earring Posts"]=!1,t["Stone Setting"]=!1,t.Resizing=!1,t.Repairing=!1,t.Other=!1,t.Hallmarking=!1,t),this.submissionInfo=null}}(),Gi=function(){function t(t,e,n,i,c,o,a,s,d,l,r,u,g,b){var f;this.route=t,this.router=e,this.actionService=n,this.imageLoggingSessionService=i,this.appUserService=c,this.exportToPdfService=o,this.exportDataService=a,this.jobActionService=s,this.jobService=d,this.modalService=l,this.stoneSubmissionService=r,this.submissionBatchService=u,this.submissionService=g,this.toastr=b,this.actionPlating=T,this.actionEngraving=k,this.actionJumpRing=E,this.actionEarringPosts=O,this.actionStoneSetting=J,this.actionResizing=N,this.actionRepairing=$,this.actionHallmarking=_,this.statusInProduction=F.f,this.kitTypeRing=x.g,this.kitTypePendant=x.f,this.kitTypeEarring=x.e,this.baseMetalSilver=X.m,this.ringSizeLeaveAsIs=bn.c,this.model=new Hi,this.data={actions:[],batch:null,nextStatuses:[{currentStatusId:F.g.id,setStatus:F.h,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!1,outgoing:!0},{currentStatusId:F.h.id,setStatus:F.i,buttonText:"Receive Batch",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!1,incoming:!1,outgoing:!0},{currentStatusId:F.b.id,setStatus:F.c,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!0,manuallyConfirmAll:!1,adminOnly:!1,incoming:!0,outgoing:!1},{currentStatusId:F.c.id,setStatus:F.d,buttonText:"Batch Received",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!0,outgoing:!1}],selections:[],submissionInfos:[],totalEstLaborCost:0,totalEstMetalCost:0,createImageLoggingSessionMap:{},submissionPhotoTimingMap:{},incomingBatch:!1,outgoingBatch:!1,jobCount:0,ringCount:0,pendantCount:0,earringCount:0,totalEstimatedCost:0,totalActualCost:0},this.state={allSelected:!1,isAdmin:!1,isSupplier:!1,loading:!0,loadingActions:!1,loadingJobActions:!0,loadingStones:!0,nextStatus:null,showToPrint:null,printAll:!1,submitting:!1,exporting:!1,imageLoggingSessionState:!1},this._silverBaseMetalName=X.l,this._9ctYellowGoldBaseMetalName=X.j,this._9ctRoseGoldBaseMetalName=X.h,this._9ctWhiteGoldBaseMetalName=X.i,this._14ctYellowGoldBaseMetalName=X.d,this._14ctRoseGoldBaseMetalName=X.b,this._14ctWhiteGoldBaseMetalName=X.c,this._18ctYellowGoldBaseMetalName=X.g,this._18ctRoseGoldBaseMetalName=X.e,this._18ctWhiteGoldBaseMetalName=X.f,this._platinumBaseMetalName=X.k,this.metalsInBatch=((f={})[X.l]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.j]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.h]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.i]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.d]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.b]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.c]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.g]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.e]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.f]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f[X.k]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},f),this.imageLoggingSessionState=!1,this.timeElapsed=0}return t.prototype.unloadNotification=function(t){var e=this;this.data.submissionInfos.some((function(t){return e.data.submissionPhotoTimingMap[t.submission.id]}))&&(t.returnValue=!0)},t.prototype.ngOnDestroy=function(){return hn(this,void 0,void 0,(function(){var t,e,n;return vn(this,(function(i){switch(i.label){case 0:t=0,e=this.data.submissionInfos,i.label=1;case 1:return t<e.length?this.data.submissionPhotoTimingMap[(n=e[t]).submission.id]?[4,this.endImageLoggingSession(n.submission)]:[3,3]:[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},t.prototype.ngOnInit=function(){var t=this;this.liveTimeInterval=setInterval((function(){t.liveTimeCreate()}),500),this.route.paramMap.subscribe((function(e){var n=e.get("id");Object(L.a)(t.submissionBatchService.get("submission_batches/"+n),t.jobService.listByOutgoingBatch(n,999),t.jobService.listByIncomingBatch(n,999),t.appUserService.getMe()).subscribe((function(e){var n,i=e[1],c=e[2],o=e[3];t.data.batch=e[0].data.submissionBatch,t.model.invoice=t.data.batch.invoice,t.model.labourCostStaging=t.data.batch.invoiceLabourCost/100,t.model.labourCostExisting=t.data.batch.invoiceLabourCost/100,t.metalsInBatch[X.l].actualCostStaging=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[X.j].actualCostStaging=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[X.h].actualCostStaging=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[X.i].actualCostStaging=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[X.d].actualCostStaging=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[X.b].actualCostStaging=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[X.c].actualCostStaging=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[X.g].actualCostStaging=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[X.e].actualCostStaging=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[X.f].actualCostStaging=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[X.k].actualCostStaging=t.data.batch.invoicePlatinumCost/100,t.metalsInBatch[X.l].actualCostExisting=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[X.j].actualCostExisting=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[X.h].actualCostExisting=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[X.i].actualCostExisting=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[X.d].actualCostExisting=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[X.b].actualCostExisting=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[X.c].actualCostExisting=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[X.g].actualCostExisting=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[X.e].actualCostExisting=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[X.f].actualCostExisting=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[X.k].actualCostExisting=t.data.batch.invoicePlatinumCost/100;for(var a=0,s=t.data.nextStatuses;a<s.length;a++){var d=s[a];d.currentStatusId===t.data.batch.status.id&&(t.state.nextStatus=d)}t.data.batch.status.incomingBatched?t.data.incomingBatch=!0:t.data.outgoingBatch=!0;for(var l=0,r=i.data.jobs.edges.concat(c.data.jobs.edges);l<r.length;l++){for(var u=r[l],g=0,b=0,f=((n={})["Cast & Mount"]=null,n.Finishing=null,n.Plating=null,n.Engraving=null,n["Jump Ring"]=null,n["Earring Posts"]=null,n["Stone Setting"]=null,n.Resizing=null,n.Repairing=null,n.Other=null,n.Hallmarking=null,n),m=0,p=u.node.jobActions.edges;m<p.length;m++){var h=p[m];f[h.node.action.name]=h,g+=h.node.estimatedLaborCost,b+=h.node.estimatedMetalCost}switch(t.metalsInBatch[u.node.submission.baseMetal.name].estimateCost+=b,t.data.totalEstLaborCost+=g,t.data.totalEstMetalCost+=b,t.data.jobCount++,u.node.submission.kitType.name){case x.g:t.data.ringCount++;break;case x.f:t.data.pendantCount++;break;case x.e:t.data.earringCount++}t.metalsInBatch[u.node.submission.baseMetal.name].present=!0,t.data.submissionInfos.push({job:u.node,jobActions:f,jobLabourCostEst:g,jobMetalCostEst:b,jobTotalCostEst:g+b,numericId:t.getNumericId(u.node.submission.id),pendingUpdateJob:!1,selected:!1,stones:[],submission:u.node.submission})}for(var v=0,C=Object.keys(t.metalsInBatch);v<C.length;v++){var M=C[v];t.data.totalActualCost+=t.metalsInBatch[M].actualCostExisting,t.data.totalEstimatedCost+=t.metalsInBatch[M].estimateCost}t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalEstimatedCost+=t.data.totalEstLaborCost,t.state.isAdmin=t.appUserService.isAdmin(o.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(o.data.appUser.roles);for(var S=[],A=0,I=t.data.submissionInfos;A<I.length;A++)S.push(I[A].submission.id);t.state.loadingJobActions=!1,t.state.isAdmin&&(t.state.loadingActions=!0,t.actionService.list().subscribe((function(e){t.data.actions=e.data.actions.edges,t.state.loadingActions=!1}))),t.stoneSubmissionService.listBySubmission(S).subscribe((function(e){for(var n=0,i=t.data.submissionInfos;n<i.length;n++)for(var c=i[n],o=0,a=e.data.stoneSubmissions.edges;o<a.length;o++){var s=a[o];s.node.submission.id===c.submission.id&&c.stones.push(s)}t.state.loadingStones=!1})),t.state.loading=!1}))}))},t.prototype.updateStatus=function(t){return hn(this,void 0,void 0,(function(){var t,e,n=this;return vn(this,(function(i){return this.state.submitting||!this.state.nextStatus||(this.state.submitting=!0,this.toastr.success(null,"Updating Batch"),t=(new Date).toISOString(),e=this.data.batch.dateSent,this.state.nextStatus.currentStatusId===F.g.id&&(e=t),this.submissionBatchService.update({id:this.data.batch.id,status:this.state.nextStatus.setStatus.id,updatedAt:t,dateSent:e}).subscribe((function(t){n.data.batch.status=n.state.nextStatus.setStatus,n.data.batch.dateSent=e,n.data.selections=[];for(var i=0,c=n.data.submissionInfos;i<c.length;i++)c[i].selected=!1;n.state.nextStatus=null;for(var o=0,a=n.data.nextStatuses;o<a.length;o++){var s=a[o];s.currentStatusId===t.data.updateSubmissionBatch.status.id&&(n.state.nextStatus=s)}n.toastr.success(null,"Batch Updated!"),n.state.submitting=!1}))),[2]}))}))},t.prototype.selectRow=function(t){if(!this.state.submitting&&this.state.nextStatus)if(!this.state.nextStatus.takeMetalWeight||t.submission.metalWeight)if(t.selected){t.selected=!t.selected;var e=this.data.selections.findIndex((function(e){return e.submission.id===t.submission.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t);else this.toastr.info("","Please enter a Metal Weight for this item before confirming")},t.prototype.selectAll=function(){if(!this.state.loading){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.submissionInfos;t<e.length;t++)(c=e[t]).selected=!0,this.selectRow(c);for(var n=0,i=this.data.submissionInfos;n<i.length;n++){var c;(c=i[n]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(c)&&this.data.selections.push(c)}}},t.prototype.setRush=function(t,e){this.state.isAdmin&&(e.stopPropagation(),t.pendingUpdateJob?(t.job.rush=!t.job.rush,t.pendingUpdateJob=!1,this.updateJob(t)):(t.pendingUpdateJob=!0,setTimeout((function(){t.pendingUpdateJob=!1}),3e3)))},t.prototype.updateJob=function(t){var e=this;this.toastr.info("","Updating Job"),setTimeout((function(n){e.jobService.update({id:t.job.id,due:Q.a.removeTimezone(new Date(t.job.due)),rush:t.job.rush}).subscribe((function(t){e.toastr.success("","Job Updated")}))}),250)},t.prototype.deleteJob=function(t){this.toastr.warning("Sorry pal, this feature isn't available yet.")},t.prototype.viewJobActionModal=function(t,e){var n=this;this.model.jobActions["Cast & Mount"]=null!==t.jobActions["Cast & Mount"],this.model.jobActions.Finishing=null!==t.jobActions.Finishing,this.model.jobActions.Plating=null!==t.jobActions.Plating,this.model.jobActions.Engraving=null!==t.jobActions.Engraving,this.model.jobActions["Jump Ring"]=null!==t.jobActions["Jump Ring"],this.model.jobActions["Earring Posts"]=null!==t.jobActions["Earring Posts"],this.model.jobActions["Stone Setting"]=null!==t.jobActions["Stone Setting"],this.model.jobActions.Resizing=null!==t.jobActions.Resizing,this.model.jobActions.Repairing=null!==t.jobActions.Repairing,this.model.jobActions.Other=null!==t.jobActions.Other,this.model.jobActions.Hallmarking=null!==t.jobActions.Hallmarking,this.model.submissionInfo=t,this.modalService.open(e).result.then((function(){return hn(n,void 0,void 0,(function(){var e,n,i,c,o=this;return vn(this,(function(a){switch(a.label){case 0:e=function(e){var i;return vn(this,(function(c){switch(c.label){case 0:return n.model.jobActions[e]&&null===t.jobActions[e]?(n.toastr.success("","Adding action: "+e),i=n.data.actions.find((function(t){return t.node.name===e})),n.jobActionService.create({job:t.job.id,action:i.node.id,completed:!1}).subscribe((function(n){t.jobActions[n.data.createJobAction.action.name]=n.data.createJobAction,o.toastr.success("",e+" added!")})),[3,3]):[3,1];case 1:return n.model.jobActions[e]||null===t.jobActions[e]?[3,3]:(n.toastr.success("","Removing action: "+e),[4,n.jobActionService.delete(t.jobActions[e].node.id)]);case 2:c.sent(),t.jobActions[e]=null,n.toastr.success("",e+" removed!"),c.label=3;case 3:return[2]}}))},n=this,i=0,c=Object.keys(this.model.jobActions),a.label=1;case 1:return i<c.length?[5,e(c[i])]:[3,4];case 2:a.sent(),a.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))}),(function(){}))},t.prototype.addJobActions=function(){},t.prototype.createPdf=function(t){return hn(this,void 0,void 0,(function(){var e=this;return vn(this,(function(n){return t.printing=!0,this.state.showToPrint="submission"+t.numericId,setTimeout((function(n){return hn(e,void 0,void 0,(function(){return vn(this,(function(e){switch(e.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(this.state.showToPrint),100)];case 1:return e.sent(),this.state.showToPrint=null,t.printing=null,[2]}}))}))}),0),[2]}))}))},t.prototype.updateSubmission=function(t){return hn(this,void 0,void 0,(function(){return vn(this,(function(e){switch(e.label){case 0:return t.submission.metalWeight?(this.toastr.info("","Updating Submission"),[4,this.submissionService.update({id:t.submission.id,updatedAt:(new Date).toISOString(),metalWeight:t.submission.metalWeight})]):[2];case 1:return e.sent(),this.toastr.success("","Submission Updated"),[2]}}))}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.prototype.printAll=function(){var t=this;this.state.printAll=!0,setTimeout((function(e){return hn(t,void 0,void 0,(function(){return vn(this,(function(t){switch(t.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById("jobLabels"),100)];case 1:return t.sent(),this.state.printAll=!1,[2]}}))}))}),3e4)},t.prototype.exportAddressData=function(){if(this.state.exporting=!0,this.data.selections.length<1)return this.toastr.error("You must select at least one submission."),void(this.state.exporting=!1);for(var t,e=[],n=[],i=0,c=this.data.selections;i<c.length;i++)t=this.exportDataService.flattenObject(c[i],e),n.push(t.data),e=t.headers;this.exportDataService.whiteListColumns(["submission.id","fullName","address1","address2","city","county","postcode","country","email","castingCode"],n),this.exportDataService.renameColumns({"submission.id":"Order Reference"},n),this.exportDataService.addStaticValues({weight:.03,packageSize:"large letter",serviceCode:"BPR1",serviceRegisterCode:"01"},n),this.exportDataService.exportToCsv("submission_export_"+(new Date).toLocaleString(),Object.keys(n[0]),n),this.toastr.success("Exported and downloading file"),this.state.exporting=!1},t.prototype.liveTimeCreate=function(){var t=new Date;this.liveTime=("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},t.prototype.startTimer=function(){var t=this;this.timeElapsed=0,this.interval=setInterval((function(){t.timeElapsed++}),1e3)},t.prototype.endTimer=function(){clearInterval(this.interval)},t.prototype.toggleSubmissionPhotoTimer=function(t){return hn(this,void 0,void 0,(function(){var e,n,i;return vn(this,(function(c){switch(c.label){case 0:this.state.submitting=!0,e=0,n=this.data.submissionInfos,c.label=1;case 1:return e<n.length?(i=n[e]).submission.id!==t?[3,6]:this.data.submissionPhotoTimingMap[i.submission.id]?[3,3]:[4,this.createImageLoggingSession(i.submission)]:[3,9];case 2:return c.sent(),[3,5];case 3:return[4,this.endImageLoggingSession(i.submission)];case 4:c.sent(),c.label=5;case 5:return[3,8];case 6:return this.data.submissionPhotoTimingMap[i.submission.id]?(this.data.submissionPhotoTimingMap[i.submission.id]=!1,[4,this.endImageLoggingSession(i.submission)]):[3,8];case 7:c.sent(),c.label=8;case 8:return e++,[3,1];case 9:return this.state.submitting=!1,[2]}}))}))},t.prototype.createImageLoggingSession=function(t){return hn(this,void 0,void 0,(function(){var e,n,i,c;return vn(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=(new Date).toISOString(),n=this.data.createImageLoggingSessionMap,i=t.id,[4,this.imageLoggingSessionService.create({startTime:e,submission:t.id})];case 1:return n[i]=o.sent(),this.imageLoggingSessionState=!0,this.startTimer(),this.toastr.success("Started photo timing session for submission "+t.kitType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!this.data.submissionPhotoTimingMap[t.id],[3,3];case 2:return c=o.sent(),this.toastr.error("Error starting image logging session!"),console.error(c),[3,3];case 3:return[2]}}))}))},t.prototype.endImageLoggingSession=function(t){return hn(this,void 0,void 0,(function(){var e;return vn(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.imageLoggingSessionService.updateEndTime({id:this.data.createImageLoggingSessionMap[t.id].createImageLoggingSession.id,endTime:(new Date).toISOString()})];case 1:return n.sent(),this.imageLoggingSessionState=!1,this.endTimer(),this.toastr.success("Ended photo timing session for "+t.kitType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!1,[3,3];case 2:return e=n.sent(),this.toastr.error("Error stopping image logging session!"),console.error(e),[3,3];case 3:return[2]}}))}))},t.prototype.onSubmit=function(){var t=this;this.model.invoice?(this.state.submitting=!0,this.submissionBatchService.update({id:this.data.batch.id,updatedAt:(new Date).toISOString(),invoice:this.model.invoice,invoiceLabourCost:this.formatCurrency(this.model.labourCostStaging),invoiceSilverCost:this.formatCurrency(this.metalsInBatch[X.l].actualCostStaging),invoice9ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[X.j].actualCostStaging),invoice9ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[X.h].actualCostStaging),invoice9ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[X.i].actualCostStaging),invoice14ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[X.d].actualCostStaging),invoice14ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[X.b].actualCostStaging),invoice14ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[X.c].actualCostStaging),invoice18ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[X.g].actualCostStaging),invoice18ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[X.e].actualCostStaging),invoice18ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[X.f].actualCostStaging),invoicePlatinumCost:this.formatCurrency(this.metalsInBatch[X.k].actualCostStaging)}).subscribe((function(e){t.model.labourCostExisting=e.data.updateSubmissionBatch.invoiceLabourCost/100,t.metalsInBatch[X.l].actualCostExisting=e.data.updateSubmissionBatch.invoiceSilverCost/100,t.metalsInBatch[X.j].actualCostExisting=e.data.updateSubmissionBatch.invoice9ctYellowGoldCost/100,t.metalsInBatch[X.h].actualCostExisting=e.data.updateSubmissionBatch.invoice9ctRoseGoldCost/100,t.metalsInBatch[X.i].actualCostExisting=e.data.updateSubmissionBatch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[X.d].actualCostExisting=e.data.updateSubmissionBatch.invoice14ctYellowGoldCost/100,t.metalsInBatch[X.b].actualCostExisting=e.data.updateSubmissionBatch.invoice14ctRoseGoldCost/100,t.metalsInBatch[X.c].actualCostExisting=e.data.updateSubmissionBatch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[X.g].actualCostExisting=e.data.updateSubmissionBatch.invoice18ctYellowGoldCost/100,t.metalsInBatch[X.e].actualCostExisting=e.data.updateSubmissionBatch.invoice18ctRoseGoldCost/100,t.metalsInBatch[X.f].actualCostExisting=e.data.updateSubmissionBatch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[X.k].actualCostExisting=e.data.updateSubmissionBatch.invoicePlatinumCost/100,t.data.totalActualCost=0;for(var n=0,i=Object.keys(t.metalsInBatch);n<i.length;n++)t.data.totalActualCost+=t.metalsInBatch[i[n]].actualCostExisting;t.data.totalActualCost+=t.model.labourCostExisting,t.toastr.success("","Batch Updated"),t.state.submitting=!1}))):this.toastr.warning("In order to update batch costs, please add an invoice number","Warning")},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.prototype.objectKeys=function(t){return Object.keys(t)},t.prototype.chartClicked=function(t){},t.prototype.chartHovered=function(t){},t.\u0275fac=function(e){return new(e||t)(w.ac(m.a),w.ac(m.b),w.ac(R),w.ac(gn.a),w.ac(z.a),w.ac(rn.a),w.ac(un.a),w.ac(P),w.ac(h.a),w.ac(K.i),w.ac(q.a),w.ac(U.a),w.ac(Y.a),w.ac(Z.b))},t.\u0275cmp=w.Ub({type:t,selectors:[["ng-component"]],hostBindings:function(t,e){1&t&&w.rc("beforeunload",(function(t){return e.unloadNotification(t)}),!1,w.Oc)},decls:9,vars:6,consts:[[3,"title",4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","batch-table-container row mt-5",4,"ngIf"],["id","jobLabels",1,"pdfLabel"],[4,"ngFor","ngForOf"],["jobActionsModal",""],["size","100",4,"ngIf"],[3,"title"],[1,"container-fluid"],[1,"row"],[1,"col-lg-12","col-xl-5"],[1,"row","mb-4"],[1,"col"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"col-md-6"],[1,"col-auto"],["class","mb-0",4,"ngIf"],[1,"mb-0"],[1,"muted","mr-2"],["class","btn btn-outline-primary mr-2",3,"click",4,"ngIf"],["class","col-lg-12 col-xl-7",4,"ngIf"],[1,"btn","btn-outline-primary","mr-2",3,"click"],[1,"col-lg-12","col-xl-7"],[1,"col-xl-4","col-lg-6","col-md-12","mb-4"],[3,"ngSubmit"],["batchInvoiceDataForm","ngForm"],[1,"row","mb-2"],[1,"form-group"],["for","invoice",1,"req"],["appShowErrorInputClass","","id","invoice","maxlength","50","name","invoice","placeholder","Invoice number","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","mb-2"],["for","labour"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","id","labour","limitDecimalPlaces","","min","0","name","labour","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["class","row",4,"ngIf"],[1,"row","justify-content-end"],["type","submit",1,"btn","btn-lg","btn-primary","float-right","fas",3,"disabled"],[4,"ngIf"],["aria-hidden","true","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["class","col-xl-8 col-lg-6 col-md-12",4,"ngIf"],["for","silver"],["appShowErrorInputClass","","id","silver","limitDecimalPlaces","","min","0","name","silver","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctYellow"],["appShowErrorInputClass","","id","invoice9ctYellow","limitDecimalPlaces","","min","0","name","invoice9ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctRose"],["appShowErrorInputClass","","id","invoice9ctRose","limitDecimalPlaces","","min","0","name","invoice9ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctWhite"],["appShowErrorInputClass","","id","invoice9ctWhite","limitDecimalPlaces","","min","0","name","invoice9ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctYellow"],["appShowErrorInputClass","","id","invoice14ctYellow","limitDecimalPlaces","","min","0","name","invoice14ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctRose"],["appShowErrorInputClass","","id","invoice14ctRose","limitDecimalPlaces","","min","0","name","invoice14ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctWhite"],["appShowErrorInputClass","","id","invoice14ctWhite","limitDecimalPlaces","","min","0","name","invoice14ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctYellow"],["appShowErrorInputClass","","id","invoice18ctYellow","limitDecimalPlaces","","min","0","name","invoice18ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctRose"],["appShowErrorInputClass","","id","invoice18ctRose","limitDecimalPlaces","","min","0","name","invoice18ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctWhite"],["appShowErrorInputClass","","id","invoice18ctWhite","limitDecimalPlaces","","min","0","name","invoice18ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoicePlatinum"],["appShowErrorInputClass","","id","invoicePlatinum","limitDecimalPlaces","","min","0","name","invoicePlatinum","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],[1,"col-xl-8","col-lg-6","col-md-12"],[1,"table","bs-table","table-sm"],[1,"batch-table-container","row","mt-5"],[1,"mb-2"],[1,"table-responsive"],[1,"data-table"],["class","checkbox sm",4,"ngIf"],["scope","col",1,"sm"],["scope","col"],["scope","col",4,"ngIf"],["colspan","72","scope","row"],["class","tc mt-5",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"checkbox","sm"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["class","pr-0 checkbox","scope","row",4,"ngIf"],["scope","row",1,"sm"],[3,"photos"],[1,"sm"],[1,"sm","muted"],[1,"sm",3,"click"],["class","color-warning fas fa-circle",4,"ngIf"],[1,"status","status-pill"],[1,"tr"],[1,"btn-group"],["class","btn hover icon-btn-outline mx-1 fas fa-cogs color-primary","ngbTooltip","Edit Job Actions","type","button",3,"disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas","type","button",3,"fa-print","disabled","click",4,"ngIf"],["class","btn icon-btn-outline mx-1 fas","type","button",3,"fa-camera","fa-stop","hover","disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-trash","type","button",3,"click",4,"ngIf"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission",4,"ngIf"],["scope","row",1,"pr-0","checkbox"],["type","checkbox",3,"disabled","ngModel","name","id","click","ngModelChange"],[3,"for"],["class","fa fa-shipping-fast text-primary",3,"ngbTooltip",4,"ngIf"],["class","fa fa-shipping-fast text-muted",3,"ngbTooltip",4,"ngIf"],[1,"fa","fa-shipping-fast","text-primary",3,"ngbTooltip"],[1,"fa","fa-shipping-fast","text-muted",3,"ngbTooltip"],[1,"color-warning","fas","fa-circle"],["name","dueDate","placeholder","Due Date","required","",3,"ngModel","owlDateTimeTrigger","owlDateTime","ngModelChange"],[3,"pickerType"],["dt2",""],["min","0","name","metalWeight","placeholder","Metal Weight (g)","required","","type","number",3,"ngModel","blur","ngModelChange"],["class","small muted",4,"ngIf"],[1,"small","muted"],["ngbTooltip","Edit Job Actions","type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-cogs","color-primary",3,"disabled","click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas",3,"disabled","click"],["type","button",1,"btn","icon-btn-outline","mx-1","fas",3,"disabled","click"],["aria-hidden","true","class","spinner-border spinner-border-sm",4,"ngIf"],["aria-hidden","true",1,"spinner-border","spinner-border-sm"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-trash",3,"click"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission"],[1,"tc","mt-5"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-center"],[3,"size"],[3,"hidden","id"],[1,"size-label","manufacturing","page"],[1,"label-inner-wrapper"],[1,"tin-size"],["border","0",1,"logoTable","mb-2","w-100"],["valign","middle"],["alt","CAST Logo","src","/assets/img/cast-logo-black.png",3,"width"],[1,"text-right"],[1,"job_details","mb-1"],[3,"colSpan"],[3,"colSpan",4,"ngIf"],["class","job_details mb-1",4,"ngIf"],[1,"row","label-jobs","align-content-start"],[1,"action","col-2"],[3,"bc-display-value","bc-element-type","bc-height","bc-value","bc-width"],[1,"footer"],["id","printPdf","name","printPdf"],["valign","top",1,"notes"],["title","Add/Remove Job Actions",3,"modal"],[1,"modal-body"],["novalidate",""],["updateJobActionsForm","ngForm"],["class","col-sm-4 mb-3 tc",4,"ngFor","ngForOf"],[3,"form","modal","saveButtonName","modalSaved"],[1,"col-sm-4","mb-3","tc"],[1,"tc",3,"for"],["appShowErrorInputClass","","type","checkbox",1,"form-control",3,"ngModel","id","name","ngModelChange"],["size","100"]],template:function(t,e){1&t&&(w.bd(0,Cn,1,1,"page-title",0),w.bd(1,Mn,1,1,"page-title",0),w.bd(2,Wn,45,13,"div",1),w.bd(3,Ci,36,7,"div",2),w.gc(4,"div",3),w.bd(5,_i,82,52,"ng-container",4),w.fc(),w.bd(6,Fi,8,7,"ng-template",null,5,w.cd),w.bd(8,Di,1,0,"loading-ring",6)),2&t&&(w.Cc("ngIf",e.state.isAdmin),w.Mb(1),w.Cc("ngIf",e.state.isSupplier),w.Mb(1),w.Cc("ngIf",!e.state.loading),w.Mb(1),w.Cc("ngIf",!e.state.loading),w.Mb(2),w.Cc("ngForOf",e.data.submissionInfos),w.Mb(3),w.Cc("ngIf",e.state.loading))},directives:[g.u,g.t,tt.a,b.z,b.l,b.m,b.d,Jt.a,b.g,b.u,b.k,b.n,b.q,He.a,b.a,It,K.m,fn.c,fn.e,fn.b,nt.a,Et.a,mn.a,Mt.a,Nt.a],pipes:[_t.a,pn.a,g.G,g.g,Ft.a,$t.a,Rt.a,g.f,g.I,g.m],styles:[""]}),t}();function Wi(t,e){1&t&&(w.gc(0,"th",7),w.dd(1,"Parent"),w.fc())}function Li(t,e){if(1&t&&(w.gc(0,"td"),w.dd(1),w.wc(2,"titlecase"),w.fc()),2&t){var n=w.vc(2).$implicit;w.Sb("muted",!n.node.parent),w.Mb(1),w.fd(" ",n.node.parent?w.xc(2,3,n.node.parent.company):"None"," ")}}function qi(t,e){if(1&t&&(w.gc(0,"tr"),w.gc(1,"th",11),w.dd(2),w.wc(3,"numericId"),w.fc(),w.gc(4,"td"),w.dd(5),w.wc(6,"titlecase"),w.fc(),w.gc(7,"td"),w.dd(8),w.wc(9,"titlecase"),w.fc(),w.bd(10,Li,3,5,"td",12),w.bc(11,"td",13),w.fc()),2&t){var n=w.vc().$implicit,i=w.vc(2);w.Mb(2),w.fd("#",w.xc(3,4,n.node.id),""),w.Mb(3),w.ed(w.xc(6,6,n.node.company)),w.Mb(3),w.ed(n.node.contactName?w.xc(9,8,n.node.contactName):""),w.Mb(2),w.Cc("ngIf",i.state.isAdmin)}}function zi(t,e){if(1&t&&(w.ec(0),w.bd(1,qi,12,10,"tr",10),w.dc()),2&t){var n=e.$implicit,i=w.vc(2);w.Mb(1),w.Cc("ngIf",n.node.parent||i.state.isAdmin)}}function Ui(t,e){if(1&t&&(w.gc(0,"div",5),w.gc(1,"table",6),w.gc(2,"thead"),w.gc(3,"tr"),w.gc(4,"th"),w.dd(5,"ID"),w.fc(),w.gc(6,"th",7),w.dd(7,"Supplier"),w.fc(),w.gc(8,"th",7),w.dd(9,"Contact Name"),w.fc(),w.bd(10,Wi,2,0,"th",8),w.bc(11,"th",7),w.fc(),w.fc(),w.gc(12,"tbody"),w.bd(13,zi,2,1,"ng-container",9),w.fc(),w.fc(),w.fc()),2&t){var n=w.vc();w.Mb(10),w.Cc("ngIf",n.state.isAdmin),w.Mb(3),w.Cc("ngForOf",n.data.suppliers)}}function Yi(t,e){1&t&&w.bc(0,"loading-ring",14),2&t&&w.Cc("size",60)}var Qi=[{path:"incoming-batches",component:ln},{path:"jobs",component:De},{path:"outgoing-batches",component:ln},{path:"create-supplier",component:Ze},{path:"suppliers",component:function(){function t(t,e,n){this.appUserService=t,this.supplierService=e,this.toastrService=n,this.data={suppliers:[]},this.state={isAdmin:!1,loading:!0}}return t.prototype.ngOnInit=function(){var t=this;this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles)})),this.supplierService.list(null).subscribe((function(e){for(var n=0,i=e.data.suppliers.edges;n<i.length;n++)t.data.suppliers.push(i[n]);t.state.loading=!1}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.\u0275fac=function(e){return new(e||t)(w.ac(z.a),w.ac(D.a),w.ac(Z.b))},t.\u0275cmp=w.Ub({type:t,selectors:[["app-supplier-view"]],decls:5,vars:3,consts:[[3,"title"],[1,"batch-table-container","row","mt-5"],[1,"col"],["class","table-responsive",4,"ngIf"],[3,"size",4,"ngIf"],[1,"table-responsive"],[1,"data-table"],["scope","col"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["scope","row"],[3,"muted",4,"ngIf"],[1,"sm"],[3,"size"]],template:function(t,e){1&t&&(w.bc(0,"page-title",0),w.gc(1,"div",1),w.gc(2,"div",2),w.bd(3,Ui,14,2,"div",3),w.bd(4,Yi,1,1,"loading-ring",4),w.fc(),w.fc()),2&t&&(w.Cc("title","Supplier List"),w.Mb(3),w.Cc("ngIf",!e.state.loading),w.Mb(1),w.Cc("ngIf",e.state.loading))},directives:[tt.a,g.u,g.t,Et.a],pipes:[$t.a,g.G],styles:[""]}),t}()},{path:"batches/view/:id",component:Gi}],Vi=function(){function t(){}return t.\u0275mod=w.Yb({type:t}),t.\u0275inj=w.Xb({factory:function(e){return new(e||t)},imports:[[m.f.forChild(Qi)],m.f]}),t}(),Xi=n("kvL/"),Ki=n("c3nT"),Zi=n("1lsF"),tc=function(){function t(){}return t.\u0275mod=w.Yb({type:t}),t.\u0275inj=w.Xb({factory:function(e){return new(e||t)},imports:[[Zi.BatchModule,g.c,b.f,Vi,Ot.b,K.g,Xi.c,mn.b,f.a,fn.d,fn.f,Ki.SubmissionModule]]}),t}()}}]);