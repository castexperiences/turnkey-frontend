(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{G81l:function(t,e,i){"use strict";i.r(e),i.d(e,"ManufacturingModule",(function(){return zn}));var o,n,c,a,s,d,l,r,u,p=i("fXoL"),b=i("ofXK"),g=i("3Pt+"),m=i("PCNd"),f=i("tyNb"),h=i("HKlZ"),v=i("w44T"),C=i("UYTu"),S=Object(C.a)(o||(r=["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],u=["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(r,"raw",{value:u}):r.raw=u,o=r)),y=i("/IUn"),j="Plating",I="Engraving",A="Duplicate",J="Jump Ring",V="Earring Posts",k="Stone Setting",w="Resizing",M="Repairing",x="Hallmarking",P=function(){function t(t){this.apollo=t}return t.prototype.list=function(){return this.apollo.watchQuery({query:S}).valueChanges},t.\u0275fac=function(e){return new(e||t)(p.wc(y.b))},t.\u0275prov=p.fc({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),T=i("5Ndf"),B=i("1uah"),D=i("bCT2"),E=i("KPdS"),O=i("PC64"),N=i("PTlN"),F=i("Nlbt"),R=i("i7jn"),W=i("QVjv"),_=i("1kSV"),q=i("CIHE"),L=i("uA1o"),$=i("S6Vu"),G=Object(C.a)(n||(n=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            supplierAction {\n                id\n            }\n        }\n    }\n'],['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            supplierAction {\n                id\n            }\n        }\n    }\n']))),H=i("EY2u"),z=Object(C.a)(c||(c=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"],["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"]))),Y=function(){function t(t){this.apollo=t}return t.prototype.create=function(t){return this.apollo.mutate({mutation:G,variables:t})},t.prototype.getBySupplierIds=function(t){return t.length?this.apollo.query({query:z,variables:{suppliers:t}}):H.a},t.\u0275fac=function(e){return new(e||t)(p.wc(y.b))},t.\u0275prov=p.fc({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),U=i("BaBC"),Q=i("5eHb"),X=i("Vf4f"),K=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),Z=function(t,e,i,o){return new(i||(i=Promise))((function(n,c){function a(t){try{d(o.next(t))}catch(e){c(e)}}function s(t){try{d(o.throw(t))}catch(e){c(e)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}d((o=o.apply(t,e||[])).next())}))},tt=function(t,e){var i,o,n,c,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){return function(c){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(s){c=[6,s],o=0}finally{i=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},et=["searchComponent"];function it(t,e){1&t&&(p.pc(0,"button",34),p.id(1,"Action"),p.oc())}function ot(t,e){if(1&t){var i=p.qc();p.pc(0,"button",36),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2),e=p.Tc(64);return t.openModalWithSelected(e)})),p.id(1," Send to Outworker "),p.oc()}}function nt(t,e){if(1&t){var i=p.qc();p.pc(0,"button",36),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2),e=p.Tc(66);return t.openModalWithSelected(e)})),p.id(1," Complete Action "),p.oc()}}function ct(t,e){if(1&t){var i=p.qc();p.pc(0,"button",36),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2),e=p.Tc(72);return t.openModalWithSelected(e)})),p.id(1," Put Items on Hold "),p.oc()}}function at(t,e){if(1&t){var i=p.qc();p.pc(0,"button",36),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2),e=p.Tc(74);return t.openModalWithSelected(e)})),p.id(1," Take Items off Hold "),p.oc()}}function st(t,e){if(1&t){var i=p.qc();p.nc(0),p.pc(1,"button",36),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2),e=p.Tc(68);return t.prepareOutgoingBatch(e)})),p.id(2," Create Outgoing Batch "),p.oc(),p.pc(3,"button",36),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2),e=p.Tc(70);return t.modalService.open(e)})),p.id(4," Add To Outgoing Batch "),p.oc(),p.mc()}}function dt(t,e){if(1&t&&(p.nc(0),p.gd(1,ot,2,0,"button",35),p.gd(2,nt,2,0,"button",35),p.gd(3,ct,2,0,"button",35),p.gd(4,at,2,0,"button",35),p.gd(5,st,5,0,"ng-container",13),p.mc()),2&t){var i=p.Cc();p.Vb(1),p.Jc("ngIf",i.availableActions.sendToOutworker),p.Vb(1),p.Jc("ngIf",i.availableActions.completeAction),p.Vb(1),p.Jc("ngIf",i.availableActions.putItemsOnHold),p.Vb(1),p.Jc("ngIf",i.availableActions.takeItemsOffHold),p.Vb(1),p.Jc("ngIf",i.availableActions.addToOutgoingBatch)}}function lt(t,e){1&t&&(p.pc(0,"button",37),p.id(1," Loading Actions... "),p.oc())}function rt(t,e){if(1&t){var i=p.qc();p.pc(0,"div",38),p.pc(1,"input",39),p.yc("click",(function(){return p.Wc(i),p.Cc().selectAll()}))("ngModelChange",(function(t){return p.Wc(i),p.Cc().state.allSelected=t})),p.oc(),p.kc(2,"label",40),p.oc()}if(2&t){var o=p.Cc();p.Vb(1),p.Jc("ngModel",o.state.allSelected)("value",o.state.allSelected)}}function ut(t,e){1&t&&(p.nc(0),p.kc(1,"loading-ring",41),p.pc(2,"p"),p.id(3,"Loading jobs..."),p.oc(),p.mc())}function pt(t,e){if(1&t&&(p.pc(0,"span",64),p.id(1),p.Dc(2,"numericId"),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.jd(p.Ec(2,1,i.job.node.outgoingBatch.id))}}function bt(t,e){1&t&&p.kc(0,"i",65)}function gt(t,e){1&t&&p.kc(0,"i",66)}function mt(t,e){if(1&t&&(p.pc(0,"span",67),p.id(1),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.kd(" Kit - ",i.job.node.submission.castingCode," ")}}var ft=function(){return[20]};function ht(t,e){if(1&t&&(p.pc(0,"span",67),p.id(1),p.Dc(2,"truncate"),p.oc()),2&t){var i=p.Cc().$implicit,o=p.Cc(2);p.Vb(1),p.ld(" ",i.job.node.submission.customer.event.eventType.name===o.eventTypeWedding?"Wedding":"Event"," - ",p.Fc(2,2,i.job.node.submission.customer.event.name,p.Nc(5,ft))," ")}}function vt(t,e){1&t&&(p.pc(0,"span",68),p.id(1," Wedding "),p.oc())}function Ct(t,e){if(1&t&&(p.pc(0,"span",69),p.id(1),p.oc()),2&t){var i=p.Cc().$implicit;p.Lc("ngbTooltip","Original + ",i.job.node.submission.duplicates," duplicates"),p.Vb(1),p.kd(" ",i.job.node.submission.duplicates+1," Items ")}}var St=function(){return{addSuffix:!0,unit:"day"}},yt=function(){return{addSuffix:!1,unit:"day"}};function jt(t,e){if(1&t&&(p.pc(0,"span",70),p.Dc(1,"dfnsIsFuture"),p.Dc(2,"dfnsIsPast"),p.Dc(3,"dfnsIsPast"),p.id(4),p.Dc(5,"dfnsIsFuture"),p.Dc(6,"dfnsFormatDistanceToNowStrict"),p.Dc(7,"dfnsFormatDistanceToNowStrict"),p.oc()),2&t){var i=p.Cc().$implicit;p.bc("text-muted",p.Ec(1,7,i.jobDueDate))("text-danger",p.Ec(2,9,i.jobDueDate))("font-weight-bold",p.Ec(3,11,i.jobDueDate)),p.Vb(4),p.kd(" ",p.Ec(5,13,i.jobDueDate)?"Due "+p.Fc(6,15,i.jobDueDate,p.Nc(21,St)):p.Fc(7,18,i.jobDueDate,p.Nc(22,yt))+" late"," ")}}function It(t,e){1&t&&(p.pc(0,"span",71),p.id(1,"On Hold"),p.oc())}function At(t,e){1&t&&(p.pc(0,"span",74),p.id(1,"HD"),p.oc())}function Jt(t,e){if(1&t&&(p.pc(0,"div",72),p.gd(1,At,2,0,"span",73),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.Jc("ngIf",i.job.node.submission.hardDeadline)}}function Vt(t,e){if(1&t&&(p.nc(0),p.kc(1,"li",77),p.mc()),2&t){var i=e.$implicit;p.Vb(1),p.bc("complete",i.node.completed),p.Jc("ngbTooltip",i.node.action.name)("placement","top")}}function kt(t,e){if(1&t&&(p.pc(0,"ul",75),p.gd(1,Vt,2,4,"ng-container",76),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.Jc("ngForOf",i.jobActionObj)}}function wt(t,e){1&t&&(p.pc(0,"app-loading-shimmer"),p.pc(1,"div",78),p.pc(2,"div",79),p.kc(3,"div",80),p.oc(),p.pc(4,"div",79),p.kc(5,"div",80),p.oc(),p.pc(6,"div",79),p.kc(7,"div",80),p.oc(),p.pc(8,"div",79),p.kc(9,"div",80),p.oc(),p.oc(),p.oc())}function Mt(t,e){if(1&t){var i=p.qc();p.nc(0,43),p.pc(1,"tr"),p.pc(2,"th",44),p.pc(3,"div",38),p.pc(4,"input",45),p.yc("click",(function(){var t=p.Wc(i).$implicit;return p.Cc(2).selectRow(t)}))("ngModelChange",(function(t){return p.Wc(i).$implicit.selected=t})),p.Dc(5,"numericId"),p.oc(),p.kc(6,"label",46),p.Dc(7,"numericId"),p.oc(),p.oc(),p.pc(8,"td",47),p.id(9),p.Dc(10,"numericId"),p.oc(),p.pc(11,"td",47),p.gd(12,pt,3,3,"span",48),p.oc(),p.pc(13,"td",47),p.id(14),p.gd(15,bt,1,0,"i",49),p.gd(16,gt,1,0,"i",50),p.gd(17,mt,2,1,"span",51),p.gd(18,ht,3,6,"span",51),p.oc(),p.pc(19,"td",47),p.id(20),p.Dc(21,"titlecase"),p.oc(),p.pc(22,"td",47),p.gd(23,vt,2,0,"span",52),p.gd(24,Ct,2,2,"span",53),p.oc(),p.pc(25,"td",47),p.pc(26,"div",54),p.pc(27,"div"),p.id(28),p.Dc(29,"simpleDate"),p.gd(30,jt,8,23,"span",55),p.gd(31,It,2,0,"span",56),p.oc(),p.gd(32,Jt,2,1,"div",57),p.oc(),p.oc(),p.pc(33,"td",47),p.pc(34,"span"),p.Dc(35,"lowercaseDashes"),p.id(36),p.Dc(37,"titlecase"),p.oc(),p.oc(),p.pc(38,"td",47),p.gd(39,kt,2,1,"ul",58),p.gd(40,wt,10,0,"app-loading-shimmer",13),p.oc(),p.pc(41,"td",47),p.pc(42,"div",59),p.pc(43,"button",60),p.yc("click",(function(){var t=p.Wc(i).$implicit;return p.Cc(2).openJobSidebar(t)})),p.pc(44,"span"),p.id(45,"Tasks"),p.oc(),p.oc(),p.kc(46,"view-submission-photos-modal",61),p.kc(47,"view-submission-comms-modal",62),p.kc(48,"view-submission-modal",63),p.oc(),p.oc(),p.oc(),p.mc()}if(2&t){var o=e.$implicit,n=p.Cc(2);p.Vb(4),p.Lc("id","job-",p.Ec(5,36,o.job.node.id),""),p.Jc("ngModel",o.selected)("name","job-"+o.job.node.id),p.Vb(2),p.Lc("for","job-",p.Ec(7,38,o.job.node.id),""),p.Vb(3),p.kd(" #",p.Ec(10,40,o.job.node.id)," "),p.Vb(3),p.Jc("ngIf",o.job.node.outgoingBatch),p.Vb(2),p.kd(" ",o.job.node.submission.customer.fullName," "),p.Vb(1),p.Jc("ngIf",null==o.job.node.submission||null==o.job.node.submission.kit?null:o.job.node.submission.kit.starred),p.Vb(1),p.Jc("ngIf",o.job.node.rush),p.Vb(1),p.Jc("ngIf",o.job.node.submission.castingCode),p.Vb(1),p.Jc("ngIf",o.job.node.submission.customer.event),p.Vb(2),p.kd(" ",p.Ec(21,42,null==o.job.node.submission?null:o.job.node.submission.jewelleryType.name)," "),p.Vb(3),p.Jc("ngIf",(null==o.job.node.submission.customer||null==o.job.node.submission.customer.event?null:o.job.node.submission.customer.event.eventType.name)===n.eventTypeWedding),p.Vb(1),p.Jc("ngIf",o.job.node.submission.duplicates),p.Vb(4),p.kd(" ",p.Ec(29,44,o.job.node.due)," "),p.Vb(2),p.Jc("ngIf",!o.job.node.onHold),p.Vb(1),p.Jc("ngIf",o.job.node.onHold),p.Vb(1),p.Jc("ngIf",null==o.job.node.submission?null:o.job.node.submission.hardDeadline),p.Vb(2),p.Yb("metal-color color-",p.Ec(35,46,o.job.node.submission.baseMetal.name),""),p.Vb(2),p.kd(" ",p.Ec(37,48,o.job.node.submission.baseMetal.name)," "),p.Vb(3),p.Jc("ngIf",!o.loadingJobActions),p.Vb(1),p.Jc("ngIf",o.loadingJobActions),p.Vb(6),p.Jc("photos",o.job.node.submission.submissionPhotos.edges),p.Vb(1),p.Jc("customerNote",o.job.node.submission.customerNotes)("isAdmin",n.isAdmin)("hover",!o.job.node.submission.customerNotes&&!o.notes)("loadingNotes",n.loadingNotes)("notes",o.notes)("submissionId",o.job.node.submission.id),p.Vb(1),p.Jc("buttonStyle",!0)("isAdmin",n.isAdmin)("loadingStones",n.loadingStones)("stones",o.stones)("submission",o.job.node.submission)}}function xt(t,e){if(1&t&&(p.nc(0),p.gd(1,Mt,49,50,"ng-container",42),p.mc()),2&t){var i=p.Cc();p.Vb(1),p.Jc("ngForOf",i.data.jobsAndJobActions)}}function Pt(t,e){if(1&t&&(p.pc(0,"ng-option",91),p.id(1),p.Dc(2,"titlecase"),p.oc()),2&t){var i=e.$implicit;p.Jc("value",i),p.Vb(1),p.kd("",p.Ec(2,2,i.supplier.node.company)," ")}}function Tt(t,e){if(1&t){var i=p.qc();p.pc(0,"div",95),p.pc(1,"label",96),p.pc(2,"input",97),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(3).model.selectedOutworkerAction=t})),p.oc(),p.id(3),p.oc(),p.oc()}if(2&t){var o=e.$implicit,n=p.Cc(3);p.Vb(1),p.bc("active",n.model.selectedOutworkerAction===o),p.Vb(1),p.Jc("ngModel",n.model.selectedOutworkerAction)("value",o),p.Vb(1),p.kd("",o.node.action.name," ")}}function Bt(t,e){if(1&t&&(p.pc(0,"div",84),p.pc(1,"label",92),p.id(2,"What Action"),p.oc(),p.pc(3,"div",93),p.gd(4,Tt,4,5,"div",94),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.Jc("ngForOf",i.model.selectedSupplierAndActions.actions)}}function Dt(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",81),p.pc(1,"div",82),p.pc(2,"form",null,83),p.pc(4,"div",84),p.pc(5,"label",85),p.id(6,"Which Outworker?"),p.oc(),p.pc(7,"ng-select",86,87),p.yc("change",(function(){return p.Wc(i),p.Cc().onChangeSelectedOutworker()}))("ngModelChange",(function(t){return p.Wc(i),p.Cc().model.selectedSupplierAndActions=t})),p.gd(9,Pt,3,4,"ng-option",88),p.oc(),p.oc(),p.gd(10,Bt,5,1,"div",89),p.oc(),p.oc(),p.pc(11,"modal-footer",90),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().sendToOutworker()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Tc(3),c=p.Cc();p.Jc("modal",o),p.Vb(7),p.Jc("ngModel",c.model.selectedSupplierAndActions)("searchable",!1),p.Vb(2),p.Jc("ngForOf",c.data.suppliersAndActions),p.Vb(1),p.Jc("ngIf",c.model.selectedSupplierAndActions),p.Vb(1),p.Jc("form",n)("modal",o)("saveButtonName","Send")}}function Et(t,e){if(1&t){var i=p.qc();p.pc(0,"div",95),p.pc(1,"label",96),p.pc(2,"input",100),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.selectedCompleteAction=t})),p.oc(),p.id(3),p.oc(),p.oc()}if(2&t){var o=e.$implicit,n=p.Cc(2);p.Vb(1),p.bc("active",n.model.selectedCompleteAction===o),p.Vb(1),p.Jc("ngModel",n.model.selectedCompleteAction)("value",o),p.Vb(1),p.kd("",o.node.name," ")}}function Ot(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",98),p.pc(1,"div",82),p.pc(2,"form",null,99),p.pc(4,"div",84),p.pc(5,"label",92),p.id(6,"What Action"),p.oc(),p.pc(7,"div",93),p.gd(8,Et,4,5,"div",94),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(9,"modal-footer",90),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().completeActions()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Tc(3),c=p.Cc();p.Jc("modal",o),p.Vb(8),p.Jc("ngForOf",c.data.actions),p.Vb(1),p.Jc("form",n)("modal",o)("saveButtonName","Complete")}}function Nt(t,e){if(1&t&&(p.pc(0,"ng-option",91),p.id(1),p.Dc(2,"titlecase"),p.oc()),2&t){var i=e.$implicit;p.Jc("value",i),p.Vb(1),p.kd("",p.Ec(2,2,i.node.company)," ")}}function Ft(t,e){if(1&t){var i=p.qc();p.pc(0,"div",84),p.pc(1,"label",85),p.id(2,"Which Supplier?"),p.oc(),p.pc(3,"ng-select",106,87),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.selectedManufacturer=t})),p.gd(5,Nt,3,4,"ng-option",88),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(3),p.Jc("ngModel",o.model.selectedManufacturer)("searchable",!1),p.Vb(2),p.Jc("ngForOf",o.data.manufacturers)}}function Rt(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",101),p.pc(1,"div",82),p.pc(2,"form",null,102),p.gd(4,Ft,6,3,"div",89),p.pc(5,"h5"),p.id(6),p.oc(),p.pc(7,"h5"),p.id(8),p.oc(),p.pc(9,"h5"),p.id(10),p.oc(),p.pc(11,"div",103),p.pc(12,"label",104),p.pc(13,"input",105),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc().allItemsPresent=t})),p.oc(),p.id(14," All Items Are Present "),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(15,"modal-footer",90),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().createOutgoingBatch()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Tc(3),c=p.Cc();p.Jc("modal",o),p.Vb(4),p.Jc("ngIf",c.isAdmin),p.Vb(2),p.kd("# Rings: ",c.model.numItemTypes[c.jewelleryTypeRing],""),p.Vb(2),p.kd("# Pendants: ",c.model.numItemTypes[c.jewelleryTypePendant],""),p.Vb(2),p.kd("# Earring Pairs: ",c.model.numItemTypes[c.jewelleryTypeEarring],""),p.Vb(3),p.Jc("ngModel",c.allItemsPresent)("value",!0),p.Vb(2),p.Jc("form",n)("modal",o)("saveButtonName","Create")}}function Wt(t,e){if(1&t&&(p.pc(0,"ng-option",91),p.id(1),p.Dc(2,"numericId"),p.oc()),2&t){var i=e.$implicit;p.Jc("value",i.node.id),p.Vb(1),p.kd("Batch #",p.Ec(2,2,i.node.id)," ")}}function _t(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",107),p.pc(1,"div",82),p.pc(2,"form",null,108),p.pc(4,"div",84),p.pc(5,"label",85),p.id(6,"Which Batch?"),p.oc(),p.pc(7,"ng-select",109,87),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc().data.mutationBatchId=t})),p.gd(9,Wt,3,4,"ng-option",88),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(10,"modal-footer",90),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().addJobsToBatch()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Tc(3),c=p.Cc();p.Jc("modal",o),p.Vb(7),p.Jc("ngModel",c.data.mutationBatchId)("searchable",!1),p.Vb(2),p.Jc("ngForOf",c.data.availableBatches),p.Vb(1),p.Jc("form",n)("modal",o)("saveButtonName","Create")}}function qt(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",110),p.pc(1,"div",82),p.pc(2,"h5"),p.id(3),p.oc(),p.oc(),p.pc(4,"modal-footer",111),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().putJobsOnHold()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Cc();p.Jc("modal",o),p.Vb(3),p.ld("Add a hold to ",n.data.selections.length," item",n.data.selections.length>1?"s":"","?"),p.Vb(1),p.Jc("modal",o)("saveButtonName","Add Hold")}}function Lt(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",112),p.pc(1,"div",82),p.pc(2,"h5"),p.id(3),p.oc(),p.oc(),p.pc(4,"modal-footer",111),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().takeJobsOffHold()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Cc();p.Jc("modal",o),p.Vb(3),p.ld("Remove hold from ",n.data.selections.length," item",n.data.selections.length>1?"s":"","?"),p.Vb(1),p.Jc("modal",o)("saveButtonName","Remove Hold")}}var $t="inProgress",Gt="readyToReturn",Ht="complete",zt="onHold",Yt=function(){return function(){this.currentJobSearch=null,this.reference=null,this.regCode=null,this.searchInfo=null,this.source=null}}(),Ut=function(){return function(){this[s]=0,this[d]=0,this[l]=0}}();s=v.e,d=v.d,l=v.c;var Qt=function(t){function e(e,i,o,n,c,a,s,d,l,r,u,p,b,g){var m,f=t.call(this)||this;return f.actionService=e,f.appUserService=i,f.jobActionService=o,f.jobService=n,f.modalService=c,f.route=a,f.router=s,f.stoneSubmissionService=d,f.submissionBatchService=l,f.submissionService=r,f.supplierActionService=u,f.supplierService=p,f.toastrService=b,f.submissionNoteService=g,f.data={actions:[],availableBatches:[],jobsAndJobActions:[],manufacturers:[],mutationBatchId:null,selections:[],suppliersAndActions:[],jobInFocus:null,jobInFocusIndex:-1},f.actionCastAndMount="Cast & Mount",f.actionFinishing="Finishing",f.actionPlating=j,f.actionEngraving=I,f.actionDuplicate=A,f.actionJumpRing=J,f.actionEarringPosts=V,f.actionStoneSetting=k,f.actionResizing=w,f.actionRepairing=M,f.actionOther="Other",f.actionHallmarking=x,f.jewelleryTypeRing=v.e,f.jewelleryTypePendant=v.d,f.jewelleryTypeEarring=v.c,f.eventTypeWedding=N.a,f.tablePageCollectionSize=50,f.paginationData={totalCount:null,pageInfo:{hasNextPage:null}},f.model=new Yt,f.tabInProgress=$t,f.tabReadyToReturn=Gt,f.tabComplete=Ht,f.tabOnHold=zt,f.tabAll="all",f.tabs=((m={}).inProgress={completed:!1,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:$t,onHold:null},m.readyToReturn={completed:!0,dueOrder:"ASC",incomingBatched:!1,inProduction:!0,name:Gt,onHold:null},m.complete={completed:!0,dueOrder:"ASC",incomingBatched:!0,inProduction:!1,name:Ht,onHold:null},m.onHold={completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:zt,onHold:!0},m.all={completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:null,name:"all",onHold:null},m),f.activeTab=f.tabs.inProgress,f.allItemsPresent=!1,f.availableActions={sendToOutworker:!1,completeAction:!1,putItemsOnHold:!1,takeItemsOffHold:!1,addToOutgoingBatch:!1,actionsAvailable:!1},f.isAdmin=!1,f.loadingJobActions=!0,f.loadingStones=!0,f.loadingNotes=!0,f.loadingSupplierActions=!0,f.now=new Date,f.setSearch=null,f.submitting=!1,f._jobSidebar={isOpen:!1},f._submissionSidebar={isOpen:!1},f.jobId="Job ID",f.submissionId="Submission ID",f.customerName="Customer Name",f.eventName="Event Name",f.castingCode="Casting Code",f.baseMetalSilver=O.m,f.searchFields=[{name:f.jobId,allowedType:E.b.integer,searchPath:"job.node.id"},{name:f.submissionId,allowedType:E.b.integer,searchPath:"job.node.submission.id"},{name:f.customerName,allowedType:E.b.any,searchPath:"job.node.submission.customer.fullName"},{name:f.castingCode,allowedType:E.b.any,searchPath:"job.node.submission.castingCode"},{name:f.eventName,allowedType:E.b.any,searchPath:"job.node.submission.customer.event.name"}],f.defaultSearch={searchField:f.searchFields[2],searchQuery:null},f}return K(e,t),e.prototype.ngOnInit=function(){return Z(this,void 0,void 0,(function(){var t,e,i,o,n,c,a=this;return tt(this,(function(s){switch(s.label){case 0:for(this.activeTab=this.tabs[this.route.snapshot.queryParamMap.get("tab")],this.activeTab||(this.activeTab=this.tabs.inProgress),t=this.route.snapshot.queryParamMap.get("searchField"),e=null,i=0,o=this.searchFields;i<o.length;i++)if((n=o[i]).name===t){e=n;break}return c=this.route.snapshot.queryParamMap.get("query"),e&&c?(this.setSearch={searchQuery:c,searchField:e},this.search(this.setSearch),[3,3]):[3,1];case 1:return this.setSearch=this.defaultSearch,[4,this.updateTable(null)];case 2:s.sent(),s.label=3;case 3:return this.appUserService.getMe().subscribe((function(t){a.isAdmin=a.appUserService.isAdmin(t.data.appUser.roles)})),this.submissionBatchService.list(null,null,!0,!0,"DESC",null,!1).subscribe((function(t){a.data.availableBatches=t.data.submissionBatches.edges})),this.supplierService.list(null).subscribe((function(t){for(var e=[],i=0,o=t.data.suppliers.edges;i<o.length;i++){var n=o[i];n.node.isManufacturer?a.data.manufacturers.push(n):(e.push(n.node.id.replace(/^\D+/,"")),a.data.suppliersAndActions.push({supplier:n,actions:[]})),1===a.data.manufacturers.length&&(a.model.selectedManufacturer=a.data.manufacturers[0])}a.supplierActionService.getBySupplierIds(e).subscribe((function(t){for(var e=0,i=a.data.suppliersAndActions;e<i.length;e++)for(var o=i[e],n=0,c=t.data.supplierActions.edges;n<c.length;n++){var s=c[n];o.supplier.node.id===s.node.supplier.id&&o.actions.push(s)}a.loadingSupplierActions=!1})),e.length||(a.loadingSupplierActions=!1)})),this.actionService.list().subscribe((function(t){a.data.actions=t.data.actions.edges})),[2]}}))}))},e.prototype.updateTableWithSearch=function(t,e){return Z(this,void 0,void 0,(function(){var t,i=this;return tt(this,(function(o){return this.state.loading=!0,this.loadingJobActions=!0,this.loadingStones=!0,this.model.currentJobSearch&&this.model.currentJobSearch.unsubscribe(),t=!(!this.model.searchInfo||!this.model.searchInfo.searchQuery),this.model.currentJobSearch=e.subscribe((function(e){i.paginationData.totalCount=e.data.jobs.totalCount,i.paginationData.pageInfo.hasNextPage=e.data.jobs.pageInfo.hasNextPage,e=JSON.parse(JSON.stringify(e));var o=JSON.parse(JSON.stringify(i.data.jobsAndJobActions));t||(i.data.jobsAndJobActions=[]);for(var n=[],c=[],a=function(t){var e;if(i.data.jobsAndJobActions.some((function(e){return e.job.node.id===t.node.id})))return"continue";n.push(t.node.id.replace(/^\D+/,"")),c.push(t.node.submission.id.replace(/^\D+/,""));for(var a=!1,s=!1,d=0,l=o;d<l.length;d++){var r=l[d];r.job.node.id===t.node.id&&(a=r.selected,s=r.expanded)}t.node.submission.hardDeadline=t.node.submission.hardDeadline?new Date(t.node.submission.hardDeadline):null,i.data.jobsAndJobActions.push({job:t,jobActions:(e={},e["Cast & Mount"]=null,e.Finishing=null,e.Plating=null,e.Engraving=null,e.Duplicate=null,e["Jump Ring"]=null,e["Earring Posts"]=null,e["Stone Setting"]=null,e.Resizing=null,e.Repairing=null,e.Other=null,e.Hallmarking=null,e),jobActionObj:[],jobDueDate:t.node.due?new Date(t.node.due):null,jobActionsCompleted:0,jobActionsNeeded:0,loadingJobActions:!0,selected:a,expanded:s,stones:[],notes:[]})},s=0,d=e.data.jobs.edges;s<d.length;s++)a(d[s]);i.handlePagination(e.data.jobs),i.jobActionService.getByJobIds(n).subscribe((function(t){t=JSON.parse(JSON.stringify(t));for(var e=0,o=i.data.jobsAndJobActions;e<o.length;e++)for(var n=o[e],c=0,a=t.data.jobActions.edges;c<a.length;c++){var s=a[c];s.node.job.id===n.job.node.id&&(n.jobActions[s.node.action.name]=s,n.jobActionObj.push(s),n.jobActionsNeeded+=1,s.node.completed&&(n.jobActionsCompleted+=1),n.loadingJobActions=!1)}i.loadingJobActions=!1})),i.stoneSubmissionService.listBySubmission(c).subscribe((function(t){for(var e=0,o=i.data.jobsAndJobActions;e<o.length;e++)for(var n=o[e],c=0,a=t.data.stoneSubmissions.edges;c<a.length;c++){var s=a[c];n.job.node.submission.id===s.node.submission.id&&n.stones.push(s)}i.loadingStones=!1})),i.submissionNoteService.listBySubmission(c).subscribe((function(t){for(var e=0,o=i.data.jobsAndJobActions;e<o.length;e++)for(var n=o[e],c=0,a=t.data.submissionNotes.edges;c<a.length;c++){var s=a[c];n.job.node.submission.id===s.node.submission.id&&n.notes.push(s)}i.loadingNotes=!1}))})),[2]}))}))},e.prototype.updateTable=function(t){return Z(this,void 0,void 0,(function(){return tt(this,(function(e){return this.updateTableWithSearch(t,this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,t,null,null,null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder,this.tablePageCollectionSize)),[2]}))}))},e.prototype.search=function(t){if(this.model.searchInfo=t,!t.searchQuery||!t.searchField)return this.resetSearchQueryParams(),void this.updateTable(null);this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:t.searchField.name,query:t.searchQuery},queryParamsHandling:"merge"});var e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,t.searchField.name===this.jobId?parseInt(t.searchQuery):null,t.searchField.name===this.submissionId?parseInt(t.searchQuery):null,t.searchField.name===this.customerName?t.searchQuery:null,t.searchField.name===this.eventName?t.searchQuery:null,t.searchField.name===this.castingCode?t.searchQuery:null);this.searchLocally(),this.updateTableWithSearch(null,e)},e.prototype.searchLocally=function(){for(var t=[],e=0,i=this.data.jobsAndJobActions;e<i.length;e++){var o=i[e],n=Object(D.b)(o,this.model.searchInfo.searchField.searchPath);n&&n.toLowerCase().includes(this.model.searchInfo.searchQuery.toLowerCase())&&t.push(o)}this.data.jobsAndJobActions=t},e.prototype.changeTab=function(t){return Z(this,void 0,void 0,(function(){return tt(this,(function(e){switch(e.label){case 0:return this.setSearch=this.defaultSearch,[4,this.resetSearchQueryParams()];case 1:return e.sent(),this.router.navigate([],{relativeTo:this.route,queryParams:{tab:t},queryParamsHandling:"merge"}),this.activeTab=this.tabs[t],this.searchComponent.clearSearch(),this.resetSelections(),this.updateTable(null),[2]}}))}))},e.prototype.selectRow=function(t){if(!this.submitting){if(t.selected){t.selected=!t.selected;var e=this.data.selections.findIndex((function(e){return e.job.node.id===t.job.node.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t);this.getAvailableActions()}},e.prototype.getAvailableActions=function(){var t=this;this.availableActions={sendToOutworker:!0,completeAction:!0,putItemsOnHold:!0,takeItemsOffHold:!0,addToOutgoingBatch:!0,actionsAvailable:!1};for(var e=0,i=this.data.selections;e<i.length;e++){var o=i[e];o.jobActionsNeeded===o.jobActionsCompleted?(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1):this.availableActions.addToOutgoingBatch=!1,o.job.node.status.name!==T.r.name&&(this.availableActions.addToOutgoingBatch=!1),o.job.node.onHold&&(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1,this.availableActions.putItemsOnHold=!1,this.availableActions.addToOutgoingBatch=!1),o.job.node.onHold||(this.availableActions.takeItemsOffHold=!1)}this.availableActions.actionsAvailable=!Object.keys(this.availableActions).every((function(e){return!t.availableActions[e]}))},e.prototype.selectAll=function(){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(n=e[t]).selected=!0,this.selectRow(n);for(var i=0,o=this.data.jobsAndJobActions;i<o.length;i++){var n;(n=o[i]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(n)&&this.data.selections.push(n)}},e.prototype.expandJobs=function(t){this.submitting||(t.expanded=!t.expanded)},e.prototype.expandAll=function(){if(this.state.allExpanded=!this.state.allExpanded,!this.state.allExpanded)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(n=e[t]).expanded=!0,this.expandJobs(n);for(var i=0,o=this.data.jobsAndJobActions;i<o.length;i++){var n;(n=o[i]).expanded=this.state.allExpanded}},e.prototype.updateJobAction=function(t){for(var e=null,i=0,o=this.data.jobsAndJobActions;i<o.length;i++){var n=o[i];if(n.job.node.id===t.node.job.id){e=n;break}}if(e.job.node.onHold)this.onHoldMessage(e.job.node.id);else{this.jobActionService.update({id:t.node.id,started:t.node.started,startedAt:t.node.startedAt,completed:t.node.completed,completedAt:t.node.completedAt}).subscribe();var c=t.node.completed,a=t.node.started&&!t.node.completed;e.jobActionsCompleted=0;for(var s=0,d=Object.keys(e.jobActions);s<d.length;s++){var l=e.jobActions[d[s]];l&&(l.node.completed?e.jobActionsCompleted+=1:(c=!1,l.node.started&&(a=!0)))}a||(e.job.node.currentlyWith=null),e.job.node.status=c?T.r:T.j}},e.prototype.openModalWithSelected=function(t){this.data.selections.length?this.modalService.open(t):this.toastrService.info(null,"Please select job(s) before performing action")},e.prototype.sendToOutworker=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;for(var e=(new Date).toISOString(),i=this.toastrService.success(null,"Sending 0 Jobs to Outworkers",{timeOut:3e4}),o=0,n=0,c=function(c){if(c.job.node.onHold)return a.onHoldMessage(c.job.node.id),"continue";var s=c.jobActions[a.model.selectedOutworkerAction.node.action.name];if(!s||s.node.completed||s.node.started)return a.toastrService.info(null,"Item "+a.getNumericId(c.job.node.id)+" does not need "+a.model.selectedOutworkerAction.node.action.name),"continue";if(c.job.node.currentlyWith&&c.job.node.currentlyWith.id!==a.model.selectedSupplierAndActions.supplier.node.id)return a.toastrService.info(null,"Item "+a.getNumericId(c.job.node.id)+" is currently with a different outworker: "+c.job.node.currentlyWith.company),"continue";var d=" Job"+((n+=1)>1?"s":"")+" to Outworkers";i.toastRef.componentInstance.title="Sending "+n+d,i.toastRef.timeoutReset(),s.node.started=!0,s.node.startedAt=e;for(var l={id:s.node.id,started:!0,startedAt:e,completed:!1,completedAt:null},r=0,u=a.data.jobsAndJobActions;r<u.length;r++){var p=u[r];if(p.job.node.id===s.node.job.id){p.job.node.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;break}}s.node.job.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;var b={id:c.job.node.id,currentlyWith:a.model.selectedSupplierAndActions.supplier.node.id};Object(B.a)(a.jobActionService.update(l),a.jobService.update(b)).subscribe((function(e){(o+=1)===n?(i.toastRef.close(),t.toastrService.success(null,"Sent "+n+d),t.model.selectedOutworkerAction=null,t.model.selectedSupplierAndActions=null,t.submitting=!1):(i.toastRef.componentInstance.title="Sent "+o+"/"+n+d,i.toastRef.timeoutReset())}))},a=this,s=0,d=this.data.selections;s<d.length;s++)c(d[s]);0===n&&(i.toastRef.close(),this.model.selectedOutworkerAction=null,this.model.selectedSupplierAndActions=null,this.submitting=!1)}},e.prototype.completeActions=function(){for(var t,e=this,i=0,o=this.data.selections;i<o.length;i++){var n=o[i];if(n.job.node.onHold)this.onHoldMessage(n.job.node.id);else{var c=new Date,a=n.jobActions[this.model.selectedCompleteAction.node.name];if(a){t=!0;var s={__typename:"JobActionEdge",node:{__typename:"JobAction",id:a.node.id,job:a.node.job,action:a.node.action,supplier:null,started:null,startedAt:null,completed:!0,completedAt:c.toISOString()}};a.node.completed=!0,this.updateJobAction(s)}else this.toastrService.info(null,"Item "+this.getNumericId(n.job.node.id)+" does not need "+this.model.selectedCompleteAction.node.name)}}t&&(this.toastrService.success(null,"Completing "+this.model.selectedCompleteAction.node.name),setTimeout((function(){e.toastrService.success(null,"Completed "+e.model.selectedCompleteAction.node.name),e.model.selectedCompleteAction=null}),3e3))},e.prototype.prepareOutgoingBatch=function(t){var e;this.model.numItemTypes=new Ut;for(var i=0,o=this.data.selections;i<o.length;i++){var n=o[i];n.job.node.onHold?this.onHoldMessage(n.job.node.id):(e=!0,this.model.numItemTypes[n.job.node.submission.jewelleryType.name]+=1)}e&&this.modalService.open(t)},e.prototype.createOutgoingBatch=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;var e=(new Date).toISOString();this.toastrService.success(null,"Creating Batch"),this.submissionBatchService.create({status:T.d.id,createdAt:e,updatedAt:e,supplier:this.model.selectedManufacturer.node.id}).subscribe((function(e){t.data.mutationBatchId=e.data.createSubmissionBatch.submissionBatch.id,t.toastrService.success(null,"Batch Created"),t.addJobsToBatch()}))}},e.prototype.addJobsToBatch=function(){for(var t=this,e=0,i=0,o=this.toastrService.success(null,"Adding Items to Batch",{timeOut:3e4}),n=0,c=this.data.selections;n<c.length;n++){var a=c[n];a.job.node.onHold?this.onHoldMessage(a.job.node.id):(i+=1,this.jobService.updateIncomingBatch({id:a.job.node.id,incomingBatch:this.data.mutationBatchId,status:T.d.id}).subscribe((function(n){e+=1;for(var c=0,a=t.data.selections;c<a.length;c++){var s=a[c];if(n.data.updateJob.job.id===s.job.node.id){s.job.node.status=T.d;break}}e===i?(o.toastRef.close(),t.toastrService.success(null,"Added "+i+" Items to Batch"),t.router.navigate(["manufacturing","batches","view",t.data.mutationBatchId.replace(/\D/g,"")])):(o.toastRef.componentInstance.title="Added "+e+"/"+i+" Items to Batch",o.toastRef.timeoutReset())})))}0===i&&(o.toastRef.close(),this.submitting=!1)},e.prototype.putJobsOnHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!0,"Putting job"+t+" on hold.","Job"+t+" put on hold.")},e.prototype.takeJobsOffHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!1,"Taking job"+t+" off hold.","Job"+t+" back in production.")},e.prototype.updateJob=function(t,e,i){var o=this,n=((new Date).toISOString(),0),c=0;this.toastrService.success(null,e);for(var a=function(e){c+=1;var a={id:e.job.node.id};null!==t&&(a.onHold=t,setTimeout((function(i){e.job.node.onHold=t}),3e3)),s.jobService.update(a).subscribe((function(t){(n+=1)===c&&o.toastrService.success(null,i)}))},s=this,d=0,l=this.data.selections;d<l.length;d++)a(l[d])},e.prototype.resetSelections=function(){this.data.selections=[];for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)e[t].selected=!1;this.availableActions.actionsAvailable=!1},e.prototype.resetSearchQueryParams=function(){return Z(this,void 0,void 0,(function(){return tt(this,(function(t){switch(t.label){case 0:return[4,this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:null,query:null},queryParamsHandling:"merge"})];case 1:return t.sent(),[2]}}))}))},e.prototype.nextPage=function(){this.data.jobsAndJobActions=[],t.prototype.nextPage.call(this)},e.prototype.previousPage=function(){this.data.jobsAndJobActions=[],t.prototype.previousPage.call(this)},e.prototype.onHoldMessage=function(t){this.toastrService.warning(null,"Item "+this.getNumericId(t)+" is on hold")},e.prototype.onChangeSelectedOutworker=function(){this.model.selectedOutworkerAction=null},e.prototype.getDaysBetween=function(t,e){return D.a.getDaysBetween(t,e)},e.prototype.openJobSidebar=function(t){var e=this.data.jobsAndJobActions.findIndex((function(e){return e.job.node.id===t.job.node.id}));this.data.jobInFocusIndex=e||null,this.data.jobInFocus=t,this._jobSidebar.isOpen=!0},e.prototype.openSubmissionSidebar=function(t){this.data.jobInFocus=t,this._submissionSidebar.isOpen=!0},e.prototype.closeSidebar=function(t){this.data.jobInFocusIndex=-1,this.data.jobInFocus=null,t.isOpen=!1},e.prototype.changeFocussedJob=function(t,e){if(-1!=this.data.jobInFocusIndex&&this.data.jobInFocus){var i=t+e;if(!(1===e&&i>this.tablePageCollectionSize-1||-1===e&&i<0))return this.data.jobInFocusIndex=i,this.data.jobInFocus=this.data.jobsAndJobActions[i]}},e.prototype.handleKeyboardEvent=function(t){this.state.loading||this.data.jobInFocus&&("ArrowRight"===t.key&&this.changeFocussedJob(this.data.jobInFocusIndex,1),"ArrowLeft"===t.key&&this.changeFocussedJob(this.data.jobInFocusIndex,-1))},e.\u0275fac=function(t){return new(t||e)(p.jc(P),p.jc(F.a),p.jc(R.a),p.jc(W.a),p.jc(_.i),p.jc(f.a),p.jc(f.b),p.jc(q.a),p.jc(L.a),p.jc($.a),p.jc(Y),p.jc(U.a),p.jc(Q.b),p.jc(X.a))},e.\u0275cmp=p.dc({type:e,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&p.od(et,5),2&t&&p.Sc(i=p.zc())&&(e.searchComponent=i.first)},hostBindings:function(t,e){1&t&&p.yc("keydown",(function(t){return e.handleKeyboardEvent(t)}),!1,p.Uc)},features:[p.Sb],decls:81,vars:30,consts:[[3,"backdropClass"],["ng-sidebar-content",""],[1,"page-padding"],["title","Production Jobs"],[1,"row","justify-content-between","mb-4"],[1,"col"],[1,"search-container","flex-grow-1","align-items-center"],["aria-label","Search","role","toolbar",1,"btn-toolbar"],[3,"setSearch","searchFields","searchEmitter"],["searchComponent",""],["ngbDropdown","",1,"d-inline-block","float-right"],["class","btn btn-outline-primary","id","sortMenu","ngbDropdownToggle","",4,"ngIf"],["aria-labelledby","sortMenu","ngbDropdownMenu",""],[4,"ngIf"],["class","btn btn-outline-primary","ngbDropdownItem","",4,"ngIf"],[1,"row"],[1,"nav","table-navigation"],[1,"nav-item"],[3,"click"],[1,"table-responsive"],["cellpadding","0",1,"table"],["role","columnheader",1,"sticky"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[1,"spacer"],["colspan","100",1,"text-center"],[3,"state","totalCount","pageSize","hasNextPage","currentPage","nextPage","previousPage"],["modalSendToOutworker",""],["modalCompleteAction",""],["modalCreateOutgoingBatch",""],["modalAddToOutgoingBatch",""],["modalPutOnHold",""],["modalTakeOffHold",""],["ng-sidebar","",3,"isOpen","keyCloseOff","closedSidebar"],[3,"data","confirmJobAction","openSubmission"],["id","sortMenu","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["class","btn btn-outline-primary","ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",1,"btn","btn-outline-primary",3,"click"],["ngbDropdownItem","",1,"btn","btn-outline-primary"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["size","30"],["role","rowgroup",4,"ngFor","ngForOf"],["role","rowgroup"],["role","rowheader"],["type","checkbox",3,"ngModel","name","id","click","ngModelChange"],[3,"for"],["role","gridcell"],["class","text-muted",4,"ngIf"],["class","fas fa-star text-warning",4,"ngIf"],["class","fas fa-shipping-fast text-danger",4,"ngIf"],["class","d-block text-muted",4,"ngIf"],["class","pill-tag wedding",4,"ngIf"],["class","pill-tag duplicate",3,"ngbTooltip",4,"ngIf"],[1,"d-flex","align-items-center"],["class","d-block",3,"text-muted","text-danger","font-weight-bold",4,"ngIf"],["class","d-block text-info",4,"ngIf"],["class","pl-1",4,"ngIf"],["class","job-actions tooltip-wrapper",4,"ngIf"],[1,"btn-group","justify-content-end"],["type","button",1,"btn","mx-1","icon-btn-outline","fas","fa-tasks",3,"click"],[3,"photos"],[3,"customerNote","isAdmin","hover","loadingNotes","notes","submissionId"],[3,"buttonStyle","isAdmin","loadingStones","stones","submission"],[1,"text-muted"],[1,"fas","fa-star","text-warning"],[1,"fas","fa-shipping-fast","text-danger"],[1,"d-block","text-muted"],[1,"pill-tag","wedding"],[1,"pill-tag","duplicate",3,"ngbTooltip"],[1,"d-block"],[1,"d-block","text-info"],[1,"pl-1"],["class","pill-tag hard-deadline",4,"ngIf"],[1,"pill-tag","hard-deadline"],[1,"job-actions","tooltip-wrapper"],[4,"ngFor","ngForOf"],[1,"action","tooltip-wrapper",3,"ngbTooltip","placement"],[1,"row","align-items-center"],[1,"col-3","p-0","pr-1"],[1,"shimmer","py-1"],["title","Send To Outworker?",3,"modal"],[1,"modal-body"],["sendToOutworkerModalForm","ngForm"],[1,"form-group"],["for","selectSupplier",1,"req"],["appShowErrorInputClass","","id","selectSupplier","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","change","ngModelChange"],["selectSupplier","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[3,"form","modal","saveButtonName","modalSaved"],[3,"value"],[1,"req"],["data-toggle","buttons",1,"btn-group-toggle","row"],["class","btn-group-toggle col-md-4 mb-1",4,"ngFor","ngForOf"],[1,"btn-group-toggle","col-md-4","mb-1"],[1,"btn","btn-primary"],["autocomplete","off","id","selectedSupplierAction","name","selectedSupplierAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Complete Action?",3,"modal"],["completeActionModalForm","ngForm"],["autocomplete","off","id","selectedAction","name","selectedAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Create Outgoing Batch?",3,"modal"],["createOutgoingBatchModalForm","ngForm"],[1,"mt-5","form-group"],["for","allItemsPresent",1,"req","mr-3"],["id","allItemsPresent","name","allItemsPresent","required","","type","checkbox",1,"mr-2",2,"vertical-align","middle",3,"ngModel","value","ngModelChange"],["appShowErrorInputClass","","id","selectSupplierForOutgoingBatch","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add to Outgoing Batch",3,"modal"],["addToOutgoingBatchModalForm","ngForm"],["appShowErrorInputClass","","id","selectBatch","name","selectBatch","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add Hold to Items",3,"modal"],[3,"modal","saveButtonName","modalSaved"],["title","Remove Hold from Items",3,"modal"]],template:function(t,e){1&t&&(p.pc(0,"ng-sidebar-container",0),p.pc(1,"div",1),p.pc(2,"div",2),p.kc(3,"page-title",3),p.pc(4,"div",4),p.pc(5,"div",5),p.pc(6,"div",6),p.pc(7,"div",7),p.pc(8,"search",8,9),p.yc("searchEmitter",(function(t){return e.search(t)})),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(10,"div",5),p.pc(11,"div",10),p.gd(12,it,2,0,"button",11),p.pc(13,"div",12),p.gd(14,dt,6,5,"ng-container",13),p.gd(15,lt,2,0,"button",14),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(16,"div",15),p.pc(17,"div",5),p.pc(18,"ul",16),p.pc(19,"li",17),p.pc(20,"a",18),p.yc("click",(function(){return e.changeTab(e.tabInProgress)})),p.id(21,"In Progress"),p.oc(),p.oc(),p.pc(22,"li",17),p.pc(23,"a",18),p.yc("click",(function(){return e.changeTab(e.tabReadyToReturn)})),p.id(24,"Ready to Return"),p.oc(),p.oc(),p.pc(25,"li",17),p.pc(26,"a",18),p.yc("click",(function(){return e.changeTab(e.tabComplete)})),p.id(27,"Complete"),p.oc(),p.oc(),p.pc(28,"li",17),p.pc(29,"a",18),p.yc("click",(function(){return e.changeTab(e.tabOnHold)})),p.id(30,"On Hold"),p.oc(),p.oc(),p.pc(31,"li",17),p.pc(32,"a",18),p.yc("click",(function(){return e.changeTab(e.tabAll)})),p.id(33,"All"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(34,"div",15),p.pc(35,"div",19),p.pc(36,"table",20),p.pc(37,"thead"),p.pc(38,"tr"),p.pc(39,"td",21),p.gd(40,rt,3,2,"div",22),p.oc(),p.pc(41,"td",21),p.id(42,"#"),p.oc(),p.pc(43,"td",21),p.id(44,"BA"),p.oc(),p.pc(45,"td",21),p.id(46,"Customer"),p.oc(),p.pc(47,"td",21),p.id(48,"Type"),p.oc(),p.kc(49,"td",21),p.pc(50,"td",21),p.id(51,"Due Back"),p.oc(),p.pc(52,"td",21),p.id(53,"Base Metal"),p.oc(),p.pc(54,"td",21),p.id(55,"Task Progress"),p.oc(),p.kc(56,"td",21),p.oc(),p.oc(),p.pc(57,"tbody"),p.pc(58,"tr",23),p.pc(59,"td",24),p.gd(60,ut,4,0,"ng-container",13),p.oc(),p.oc(),p.gd(61,xt,2,1,"ng-container",13),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(62,"table-controls",25),p.yc("nextPage",(function(){return e.nextPage()}))("previousPage",(function(){return e.previousPage()})),p.oc(),p.oc(),p.gd(63,Dt,12,8,"ng-template",null,26,p.hd),p.gd(65,Ot,10,5,"ng-template",null,27,p.hd),p.gd(67,Rt,16,10,"ng-template",null,28,p.hd),p.gd(69,_t,11,7,"ng-template",null,29,p.hd),p.gd(71,qt,5,5,"ng-template",null,30,p.hd),p.gd(73,Lt,5,5,"ng-template",null,31,p.hd),p.oc(),p.pc(75,"sidebar-content",32),p.yc("closedSidebar",(function(){return e.closeSidebar(e._jobSidebar)})),p.pc(76,"job-detail-sidebar",33),p.yc("confirmJobAction",(function(t){return e.updateJobAction(t)}))("openSubmission",(function(){return e.openSubmissionSidebar(e.data.jobInFocus)})),p.oc(),p.oc(),p.pc(77,"sidebar-content",32),p.yc("closedSidebar",(function(){return e.closeSidebar(e._submissionSidebar)})),p.pc(78,"p"),p.id(79,"Submission details"),p.oc(),p.pc(80,"button",18),p.yc("click",(function(){return e.closeSidebar(e._submissionSidebar)})),p.oc(),p.oc(),p.oc()),2&t&&(p.dd("height","100vh"),p.Jc("backdropClass","sidebar-backdrop"),p.Vb(8),p.Jc("setSearch",e.setSearch)("searchFields",e.searchFields),p.Vb(4),p.Jc("ngIf",e.availableActions.actionsAvailable),p.Vb(2),p.Jc("ngIf",!e.state.loading&&!e.loadingSupplierActions&&!e.loadingJobActions),p.Vb(1),p.Jc("ngIf",e.state.loading||e.loadingSupplierActions||e.loadingJobActions),p.Vb(4),p.bc("active",e.activeTab.name===e.tabInProgress),p.Vb(3),p.bc("active",e.activeTab.name===e.tabReadyToReturn),p.Vb(3),p.bc("active",e.activeTab.name===e.tabComplete),p.Vb(3),p.bc("active",e.activeTab.name===e.tabOnHold),p.Vb(3),p.bc("active",e.activeTab.name===e.tabAll),p.Vb(9),p.Jc("ngIf",!e.state.loading),p.Vb(20),p.Jc("ngIf",e.state.loading),p.Vb(1),p.Jc("ngIf",!e.state.loading||e.data.jobsAndJobActions.length),p.Vb(1),p.Jc("state",e.state)("totalCount",e.paginationData.totalCount)("pageSize",e.tablePageCollectionSize)("hasNextPage",e.paginationData.pageInfo.hasNextPage),p.Vb(13),p.Jc("isOpen",e._jobSidebar.isOpen)("keyCloseOff",e._jobSidebar.isOpen&&e._submissionSidebar.isOpen),p.Vb(1),p.Jc("data",e.data.jobInFocus),p.Vb(1),p.Jc("isOpen",e._submissionSidebar.isOpen)("keyCloseOff",e._jobSidebar.isOpen&&e._submissionSidebar.isOpen))},styles:[""]}),e}(h.a),Xt=i("n4kJ"),Kt=i("wOBz"),Zt=i("1QgP"),te=i("ZtzB");function ee(t,e){1&t&&(p.pc(0,"div",3),p.kc(1,"loading-ring",4),p.oc()),2&t&&(p.Vb(1),p.Jc("size",60))}function ie(t,e){if(1&t){var i=p.qc();p.pc(0,"div",12),p.pc(1,"label",24),p.id(2,"Email"),p.oc(),p.pc(3,"input",27,28),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.email=t})),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(3),p.Jc("ngModel",o.model.email)}}function oe(t,e){if(1&t){var i=p.qc();p.pc(0,"div",12),p.pc(1,"label",29),p.id(2,"Telephone"),p.oc(),p.pc(3,"input",30,31),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.telephone=t})),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(3),p.Jc("ngModel",o.model.telephone)}}function ne(t,e){if(1&t){var i=p.qc();p.pc(0,"div",12),p.pc(1,"label",32),p.id(2,"Address"),p.oc(),p.pc(3,"textarea",33,34),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.address=t})),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(3),p.Jc("ngModel",o.model.address)}}function ce(t,e){if(1&t){var i=p.qc();p.pc(0,"div",35),p.pc(1,"label"),p.id(2,"Supplier Type"),p.oc(),p.pc(3,"div",36),p.pc(4,"div",37),p.pc(5,"div",38),p.pc(6,"input",39),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.isManufacturer=t})),p.oc(),p.pc(7,"label",40),p.id(8," Manufacturer "),p.oc(),p.oc(),p.oc(),p.pc(9,"div",41),p.pc(10,"div",38),p.pc(11,"input",42),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.isManufacturer=t})),p.oc(),p.pc(12,"label",43),p.id(13," Outworker "),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(6),p.Jc("value",!0)("ngModel",o.model.isManufacturer),p.Vb(5),p.Jc("value",!1)("ngModel",o.model.isManufacturer)}}function ae(t,e){if(1&t){var i=p.qc();p.pc(0,"input",52),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).$implicit.cost=t})),p.oc()}if(2&t){var o=p.Cc(2).$implicit;p.Jc("ngModel",o.cost)("decimalPlaces",2)("id","cost-"+o.action.node.id)("name","cost-"+o.action.node.id)}}function se(t,e){if(1&t&&(p.pc(0,"div",48),p.pc(1,"div",49),p.pc(2,"div",50),p.id(3,"\xa3"),p.oc(),p.oc(),p.gd(4,ae,1,4,"input",51),p.oc()),2&t){var i=p.Cc(3);p.Vb(4),p.Jc("ngIf",i.state.admin)}}function de(t,e){if(1&t){var i=p.qc();p.pc(0,"div",44),p.pc(1,"input",45),p.yc("ngModelChange",(function(t){return p.Wc(i).$implicit.selected=t})),p.oc(),p.pc(2,"label",46),p.id(3),p.oc(),p.gd(4,se,5,1,"div",47),p.oc()}if(2&t){var o=e.$implicit,n=p.Cc(2);p.Vb(1),p.Jc("ngModel",o.selected)("name","checkbox-"+o.action.node.id)("id","checkbox-"+o.action.node.id)("value",!0),p.Vb(1),p.Jc("for","checkbox-"+o.action.node.id),p.Vb(1),p.jd(o.action.node.name),p.Vb(1),p.Jc("ngIf",o.selected&&n.state.admin)}}function le(t,e){1&t&&(p.pc(0,"div",53),p.pc(1,"button",54),p.id(2,"Create Supplier"),p.oc(),p.oc())}function re(t,e){if(1&t){var i=p.qc();p.pc(0,"form",5,6),p.yc("submit",(function(){return p.Wc(i),p.Cc().onSubmit()})),p.pc(2,"div",7),p.pc(3,"div",8),p.pc(4,"div",9),p.pc(5,"div",10),p.pc(6,"div",11),p.pc(7,"h5"),p.id(8,"Essential Details"),p.oc(),p.pc(9,"div",12),p.pc(10,"label",13),p.id(11,"Company Name"),p.oc(),p.pc(12,"input",14,15),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc().model.company=t})),p.oc(),p.oc(),p.pc(14,"div",12),p.pc(15,"label",16),p.id(16,"Contact Name"),p.oc(),p.pc(17,"input",17,18),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc().model.contactName=t})),p.oc(),p.oc(),p.gd(19,ie,5,1,"div",19),p.gd(20,oe,5,1,"div",19),p.gd(21,ne,5,1,"div",19),p.pc(22,"div",12),p.pc(23,"label",20),p.id(24,"Notes"),p.oc(),p.pc(25,"textarea",21,22),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc().model.notes=t})),p.oc(),p.oc(),p.gd(27,ce,14,4,"div",23),p.pc(28,"div"),p.pc(29,"label",24),p.pc(30,"b"),p.id(31,"Actions"),p.oc(),p.oc(),p.pc(32,"div",8),p.gd(33,de,5,7,"div",25),p.oc(),p.oc(),p.gd(34,le,3,0,"div",26),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Tc(1),n=p.Cc();p.Vb(12),p.Jc("ngModel",n.model.company),p.Vb(5),p.Jc("ngModel",n.model.contactName),p.Vb(2),p.Jc("ngIf",n.state.admin),p.Vb(1),p.Jc("ngIf",n.state.admin),p.Vb(1),p.Jc("ngIf",n.state.admin),p.Vb(4),p.Jc("ngModel",n.model.notes),p.Vb(2),p.Jc("ngIf",n.state.admin),p.Vb(6),p.Jc("ngForOf",n.model.actionCosts),p.Vb(1),p.Jc("ngIf",!n.state.submitting&&o.form.valid)}}var ue=function(){return function(){this.isManufacturer=!1}}(),pe=function(){function t(t,e,i,o,n){this.actionService=t,this.appUserService=e,this.supplierActionService=i,this.supplierService=o,this.toastrService=n,this.model=new ue,this.data={actions:[]},this.state={admin:!1,loading:!0,submitting:!1}}return t.prototype.ngOnInit=function(){var t=this;this.model.actionCosts=[],Object(B.a)(this.actionService.list(),this.appUserService.getMe()).subscribe((function(e){var i=e[1];t.data.actions=e[0].data.actions.edges,t.state.admin=t.appUserService.isAdmin(i.data.appUser.roles);for(var o=0,n=t.data.actions;o<n.length;o++)t.model.actionCosts.push({action:n[o],cost:null,selected:!1});t.state.loading=!1}))},t.prototype.onSubmit=function(){return t=this,void 0,i=function(){var t=this;return function(t,e){var i,o,n,c,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){return function(c){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(s){c=[6,s],o=0}finally{i=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}(this,(function(e){return this.state.submitting=!0,this.toastrService.success(null,"Creating Supplier"),this.supplierService.create({company:this.model.company,contactName:this.model.contactName,email:this.model.email,telephone:this.model.telephone,address:this.model.address,notes:this.model.notes,isManufacturer:this.model.isManufacturer}).subscribe((function(e){for(var i=0,o=0,n=t.toastrService.success(null,"Supplier Created, Adding Actions",{timeOut:3e4}),c=0,a=t.model.actionCosts;c<a.length;c++){var s=a[c];s.selected&&(o+=1,t.supplierActionService.create({supplier:e.data.createSupplier.supplier.id,action:s.action.node.id,cost:t.formatCurrency(s.cost)}).subscribe((function(e){(i+=1)===o?(n.toastRef.close(),t.toastrService.success(null,"Added "+o+" Actions to Supplier"),t.state.submitting=!1):(n.toastRef.componentInstance.title="Added "+i+"/"+o+" Actions to Supplier",n.toastRef.timeoutReset())})))}})),[2]}))},new((e=void 0)||(e=Promise))((function(o,n){function c(t){try{s(i.next(t))}catch(e){n(e)}}function a(t){try{s(i.throw(t))}catch(e){n(e)}}function s(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(c,a)}s((i=i.apply(t,[])).next())}));var t,e,i},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.\u0275fac=function(e){return new(e||t)(p.jc(P),p.jc(F.a),p.jc(Y),p.jc(U.a),p.jc(Q.b))},t.\u0275cmp=p.dc({type:t,selectors:[["ng-component"]],decls:3,vars:2,consts:[["subtitle","I get by with a little help from my friends","title","Create Supplier"],["class","mt-5",4,"ngIf"],["novalidate","",3,"submit",4,"ngIf"],[1,"mt-5"],[3,"size"],["novalidate","",3,"submit"],["createSupplierForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"form-group"],["for","company",1,"req"],["appShowErrorInputClass","","id","company","maxlength","255","name","comapny","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],["for","contactName",1,"req"],["appShowErrorInputClass","","id","contactName","maxlength","255","name","contactName","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["contactName","ngModel"],["class","form-group",4,"ngIf"],["for","notes"],["appShowErrorInputClass","","id","notes","placeholder","These are for your own internal reference, supplier will not see these","maxlength","255","name","notes","type","text",1,"form-control",3,"ngModel","ngModelChange"],["notes","ngModel"],["class","container order-count-selection mb-3 mt-1 form-group",4,"ngIf"],["for","email"],["class","mb-2 col-sm-6",4,"ngFor","ngForOf"],["class","float-right",4,"ngIf"],["appShowErrorInputClass","","id","email","maxlength","255","name","email","type","text",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["for","telephone"],["appShowErrorInputClass","","id","telephone","maxlength","255","name","telephone","type","text",1,"form-control",3,"ngModel","ngModelChange"],["telephone","ngModel"],["for","address"],["appShowErrorInputClass","","id","address","maxlength","255","name","address","type","text",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],[1,"container","order-count-selection","mb-3","mt-1","form-group"],[1,"row","ml-2","inline-options",2,"margin-bottom","0"],[1,"col-sm-3","pl-0"],[1,"option"],["type","radio","name","isManufacturer","id","trueIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","trueIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"col-sm-3","pr-0"],["type","radio","name","isManufacturer","id","falseIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","falseIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"mb-2","col-sm-6"],["type","checkbox",1,"mr-2",3,"ngModel","name","id","value","ngModelChange"],[3,"for"],["class","input-group mb-1",4,"ngIf"],[1,"input-group","mb-1"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","class","form-control","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",3,"ngModel","decimalPlaces","id","name","ngModelChange",4,"ngIf"],["appShowErrorInputClass","","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","id","name","ngModelChange"],[1,"float-right"],["type","submit",1,"btn","btn-primary"]],template:function(t,e){1&t&&(p.kc(0,"page-title",0),p.gd(1,ee,2,1,"div",1),p.gd(2,re,35,9,"form",2)),2&t&&(p.Vb(1),p.Jc("ngIf",e.state.submitting||e.state.loading),p.Vb(1),p.Jc("ngIf",!e.state.loading))},directives:[Xt.a,b.p,Kt.a,g.x,g.n,g.o,g.d,Zt.a,g.g,g.u,g.m,g.p,b.o,g.t,g.a,g.j,g.r,te.a],styles:[""]}),t}(),be=i("/tv0");function ge(t,e){1&t&&p.kc(0,"page-title",6)}function me(t,e){1&t&&p.kc(0,"page-title",7)}function fe(t,e){1&t&&p.kc(0,"page-title",8)}function he(t,e){1&t&&p.kc(0,"page-title",9)}function ve(t,e){if(1&t&&(p.pc(0,"div",10),p.pc(1,"h4",11),p.id(2),p.oc(),p.kc(3,"batches-table",12),p.oc()),2&t){var i=p.Cc();p.Vb(2),p.jd(i.state.isSupplier?"Incoming Batches":"Sent to Suppliers"),p.Vb(1),p.Jc("partnerComplete",!0)("manufacturerComplete",!1)("inProduction",null)("supplierExists",!0)("isAdmin",i.state.isAdmin)("isSupplier",i.state.isSupplier)("isToSupplier",i.state.toSupplier)("isFromSupplier",i.state.fromSupplier)("order","DESC")("deletable",!1)}}function Ce(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"h4",11),p.id(2),p.oc(),p.kc(3,"batches-table",14),p.oc()),2&t){var i=p.Cc();p.Vb(2),p.jd(i.state.isSupplier?"Outgoing Batches to CAST":"Incoming from Suppliers"),p.Vb(1),p.Jc("partnerComplete",!0)("manufacturerComplete",!0)("inProduction",!1)("supplierExists",!0)("isAdmin",i.state.isAdmin)("isSupplier",i.state.isSupplier)("inQualityControl",!1)("isToSupplier",i.state.toSupplier)("isFromSupplier",i.state.fromSupplier)("order","DESC")("deletable",!1)}}function Se(t,e){if(1&t&&(p.pc(0,"div",10),p.pc(1,"h4",11),p.id(2,"Completed"),p.oc(),p.kc(3,"batches-table",15),p.oc()),2&t){var i=p.Cc();p.Vb(3),p.Jc("supplierExists",!0)("isAdmin",i.state.isAdmin)("isSupplier",i.state.isSupplier)("inQualityControl",!0)("isToSupplier",i.state.toSupplier)("isFromSupplier",i.state.fromSupplier)("deletable",!1)("order","DESC")}}var ye=function(){function t(t,e){this.appUserService=t,this.router=e,this.state={isAdmin:!1,isSupplier:!1,toSupplier:!1,fromSupplier:!1}}return t.prototype.ngOnInit=function(){var t=this,e=this.router.url;e.includes("incoming")&&(this.state.toSupplier=!0),e.includes("outgoing")&&(this.state.fromSupplier=!0),this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(e.data.appUser.roles)}))},t.\u0275fac=function(e){return new(e||t)(p.jc(F.a),p.jc(f.b))},t.\u0275cmp=p.dc({type:t,selectors:[["ng-component"]],decls:7,vars:7,consts:[["title","Batches Sent","subtitle","Batches sent from CAST to suppliers",4,"ngIf"],["title","Incoming Batches","subtitle","Batches of jobs from CAST",4,"ngIf"],["title","Incoming Batches","subtitle","Batches returned from suppliers",4,"ngIf"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST",4,"ngIf"],["class","container-fluid mx-0",4,"ngIf"],["class","container-fluid mx-0 mb-4",4,"ngIf"],["title","Batches Sent","subtitle","Batches sent from CAST to suppliers"],["title","Incoming Batches","subtitle","Batches of jobs from CAST"],["title","Incoming Batches","subtitle","Batches returned from suppliers"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST"],[1,"container-fluid","mx-0"],[1,"card-title"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","isToSupplier","isFromSupplier","order","deletable"],[1,"container-fluid","mx-0","mb-4"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","order","deletable"],[3,"supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","deletable","order"]],template:function(t,e){1&t&&(p.gd(0,ge,1,0,"page-title",0),p.gd(1,me,1,0,"page-title",1),p.gd(2,fe,1,0,"page-title",2),p.gd(3,he,1,0,"page-title",3),p.gd(4,ve,4,11,"div",4),p.gd(5,Ce,4,12,"div",5),p.gd(6,Se,4,8,"div",4)),2&t&&(p.Jc("ngIf",e.state.toSupplier&&e.state.isAdmin),p.Vb(1),p.Jc("ngIf",e.state.toSupplier&&e.state.isSupplier),p.Vb(1),p.Jc("ngIf",e.state.fromSupplier&&e.state.isAdmin),p.Vb(1),p.Jc("ngIf",e.state.fromSupplier&&e.state.isSupplier),p.Vb(1),p.Jc("ngIf",e.state.toSupplier),p.Vb(1),p.Jc("ngIf",e.state.fromSupplier),p.Vb(1),p.Jc("ngIf",e.state.fromSupplier))},directives:[b.p,Xt.a,be.a],styles:[""]}),t}(),je=i("cXB8"),Ie=i("rYPC"),Ae=i("7ape"),Je=i("uzfv"),Ve=i("r1eF"),ke=i("jmmt");function we(t,e){if(1&t&&(p.kc(0,"modal-header",2),p.pc(1,"div",3),p.pc(2,"div",4),p.pc(3,"div",5),p.kc(4,"submission-view-photos",6),p.oc(),p.oc(),p.oc()),2&t){var i=e.$implicit,o=p.Cc();p.Jc("modal",i),p.Vb(4),p.Jc("photos",o._photos)}}var Me=function(){function t(t,e){this.modalService=t,this.toastr=e}return Object.defineProperty(t.prototype,"photos",{set:function(t){this._photos=t},enumerable:!1,configurable:!0}),t.prototype.openModal=function(t,e){this._photos.length>0?(e.stopPropagation(),this.modalService.open(t,{size:"lg"})):this.toastr.warning("This submission has no photos logged")},t.\u0275fac=function(e){return new(e||t)(p.jc(_.i),p.jc(Q.b))},t.\u0275cmp=p.dc({type:t,selectors:[["view-submission-photos-modal"]],inputs:{photos:"photos"},decls:3,vars:4,consts:[["type","button",1,"btn","mx-1","icon-btn-outline","fas","fa-camera",3,"click"],["modalViewPhotos",""],["title","View Submission Photos",3,"modal"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[3,"photos"]],template:function(t,e){if(1&t){var i=p.qc();p.pc(0,"button",0),p.yc("click",(function(t){p.Wc(i);var o=p.Tc(2);return e.openModal(o,t)})),p.oc(),p.gd(1,we,5,2,"ng-template",null,1,p.hd)}2&t&&p.bc("text-muted",0===e._photos.length)("text-success",e._photos.length>0)},directives:[Ve.a,ke.a],encapsulation:2}),t}(),xe=i("JEAg"),Pe=i("z17N"),Te=i("XhFI"),Be=i("6QD7"),De=i("VdD3"),Ee=i("G0jp"),Oe=i("SjCM"),Ne=i("zVvu"),Fe=i("KWY1"),Re=i("XXSO"),We=i("9WpQ"),_e=function(t,e,i,o){return new(i||(i=Promise))((function(n,c){function a(t){try{d(o.next(t))}catch(e){c(e)}}function s(t){try{d(o.throw(t))}catch(e){c(e)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}d((o=o.apply(t,e||[])).next())}))},qe=function(t,e){var i,o,n,c,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){return function(c){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(s){c=[6,s],o=0}finally{i=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Le=["batchInvoiceDataForm"];function $e(t,e){if(1&t&&p.kc(0,"page-title",9),2&t){var i=p.Cc();p.Jc("title",i.data.incomingBatch?"Incoming Batch":"Outgoing Batch")}}function Ge(t,e){if(1&t&&p.kc(0,"page-title",9),2&t){var i=p.Cc();p.Jc("title",!0===i.data.incomingBatch?"Batch to CAST":"Incoming Batch")}}function He(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th",21),p.id(2,"Est Cost:"),p.oc(),p.pc(3,"td"),p.id(4),p.Dc(5,"currency"),p.Dc(6,"currency"),p.Dc(7,"currency"),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.md(" ",p.Ec(5,3,i.data.totalEstMetalCost+i.data.totalEstLaborCost)," (L:",p.Ec(6,5,i.data.totalEstLaborCost),") (M: ",p.Ec(7,7,i.data.totalEstMetalCost),") ")}}function ze(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th",21),p.id(2,"Income:"),p.oc(),p.pc(3,"td"),p.id(4),p.Dc(5,"currency"),p.Dc(6,"currency"),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.ld(" ",p.Ec(5,2,i.data.totalPayments/1.2)," (Net: ",p.Ec(6,4,i.data.totalPayments),") ")}}function Ye(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th"),p.id(2,"P&L"),p.oc(),p.pc(3,"td",26),p.id(4),p.Dc(5,"currency"),p.Dc(6,"percentage"),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.ld(" ",p.Ec(5,2,i.data.totalPayments/1.2-(i.data.totalEstMetalCost+i.data.totalEstLaborCost))," (",p.Ec(6,4,(i.data.totalPayments/1.2-(i.data.totalEstMetalCost+i.data.totalEstLaborCost))/i.data.totalPayments)," ) ")}}function Ue(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th",21),p.id(2,"Date Sent:"),p.oc(),p.pc(3,"td"),p.id(4),p.Dc(5,"simpleDate"),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.kd(" ",p.Ec(5,1,i.data.batch.dateSent)," ")}}function Qe(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th",21),p.id(2,"Sent From:"),p.oc(),p.pc(3,"td"),p.id(4),p.Dc(5,"titlecase"),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.kd(" ",p.Ec(5,1,i.data.batch.supplier.company)," ")}}function Xe(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th",21),p.id(2,"Live time:"),p.oc(),p.pc(3,"td"),p.id(4),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(4),p.kd(" ",i.liveTime," ")}}function Ke(t,e){if(1&t){var i=p.qc();p.pc(0,"button",27),p.yc("click",(function(){return p.Wc(i),p.Cc(2).printAll("jobLabels",100)})),p.id(1," Print Manufacture Labels "),p.oc()}if(2&t){var o=p.Cc(2);p.Jc("disabled",o.state.printAll)}}function Ze(t,e){if(1&t){var i=p.qc();p.pc(0,"button",27),p.yc("click",(function(){return p.Wc(i),p.Cc(2).printAll("idLabels",29)})),p.id(1," Print ID Labels "),p.oc()}if(2&t){var o=p.Cc(2);p.Jc("disabled",o.state.printAll)}}function ti(t,e){if(1&t){var i=p.qc();p.pc(0,"button",28),p.yc("click",(function(){return p.Wc(i),p.Cc(2).exportAddressData()})),p.id(1," Export Addresses "),p.oc()}}function ei(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",53),p.id(4,"Silver"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",54),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._silverBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._silverBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ii(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",55),p.id(4,"9ct Yellow Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",56),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._9ctYellowGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._9ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function oi(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",57),p.id(4,"9ct Rose Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",58),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._9ctRoseGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._9ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ni(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",59),p.id(4,"9ct White Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",60),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._9ctWhiteGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._9ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ci(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",61),p.id(4,"14ct Yellow Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",62),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._14ctYellowGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._14ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ai(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",63),p.id(4,"14ct Rose Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",64),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._14ctRoseGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._14ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function si(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",65),p.id(4,"14ct White Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",66),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._14ctWhiteGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._14ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function di(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",34),p.pc(3,"label",67),p.id(4,"18ct Yellow Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",68),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._18ctYellowGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._18ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function li(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",69),p.id(4,"18ct Rose Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",70),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._18ctRoseGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._18ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ri(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",71),p.id(4,"18ct White Gold"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",72),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._18ctWhiteGoldBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._18ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function ui(t,e){if(1&t){var i=p.qc();p.pc(0,"div",11),p.pc(1,"div",14),p.pc(2,"div",44),p.pc(3,"label",73),p.id(4,"Platinum"),p.oc(),p.pc(5,"div",46),p.pc(6,"div",47),p.pc(7,"div",48),p.id(8,"\xa3"),p.oc(),p.oc(),p.pc(9,"input",74),p.yc("ngModelChange",(function(t){p.Wc(i);var e=p.Cc(4);return e.metalsInBatch[e._platinumBaseMetalName].actualCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(4);p.Vb(9),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.metalsInBatch[o._platinumBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function pi(t,e){if(1&t){var i=p.qc();p.nc(0),p.pc(1,"div",11),p.pc(2,"div",14),p.pc(3,"div",44),p.pc(4,"label",45),p.id(5,"Labour"),p.oc(),p.pc(6,"div",46),p.pc(7,"div",47),p.pc(8,"div",48),p.id(9,"\xa3"),p.oc(),p.oc(),p.pc(10,"input",49),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(3).model.labourCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.gd(11,ei,10,3,"div",50),p.gd(12,ii,10,3,"div",50),p.gd(13,oi,10,3,"div",50),p.gd(14,ni,10,3,"div",50),p.gd(15,ci,10,3,"div",50),p.gd(16,ai,10,3,"div",50),p.gd(17,si,10,3,"div",50),p.gd(18,di,10,3,"div",50),p.gd(19,li,10,3,"div",50),p.gd(20,ri,10,3,"div",50),p.gd(21,ui,10,3,"div",50),p.pc(22,"div",11),p.pc(23,"div",14),p.pc(24,"div",44),p.pc(25,"label",51),p.id(26,"Delivery Cost"),p.oc(),p.pc(27,"div",46),p.pc(28,"div",47),p.pc(29,"div",48),p.id(30,"\xa3"),p.oc(),p.oc(),p.pc(31,"input",52),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(3).model.deliveryCostStaging=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.mc()}if(2&t){var o=p.Cc(3);p.Vb(10),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.model.labourCostStaging)("decimalPlaces",2),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._silverBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._9ctYellowGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._9ctRoseGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._9ctWhiteGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._14ctYellowGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._14ctRoseGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._14ctWhiteGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._18ctYellowGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._18ctRoseGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._18ctWhiteGoldBaseMetalName].present),p.Vb(1),p.Jc("ngIf",o.metalsInBatch[o._platinumBaseMetalName].present),p.Vb(10),p.Jc("disabled",o.data.batch.journalReference)("ngModel",o.model.deliveryCostStaging)("decimalPlaces",2)}}function bi(t,e){1&t&&(p.pc(0,"span"),p.id(1,"Save"),p.oc())}function gi(t,e){1&t&&p.kc(0,"span",75)}function mi(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th"),p.id(2),p.oc(),p.pc(3,"td"),p.id(4),p.Dc(5,"number"),p.oc(),p.pc(6,"td"),p.id(7),p.Dc(8,"number"),p.oc(),p.pc(9,"td"),p.id(10),p.Dc(11,"number"),p.oc(),p.oc()),2&t){var i=p.Cc().$implicit,o=p.Cc(4);p.Vb(2),p.jd(i),p.Vb(2),p.jd(p.Fc(5,8,o.metalsInBatch[i].estimateCost/100,"1.2-2")),p.Vb(3),p.jd(p.Fc(8,11,o.metalsInBatch[i].actualCostExisting,"1.2-2")),p.Vb(2),p.bc("color-danger",o.metalsInBatch[i].estimateCost/100-o.metalsInBatch[i].actualCostExisting<0)("color-success",o.metalsInBatch[i].estimateCost/100-o.metalsInBatch[i].actualCostExisting>=0),p.Vb(1),p.jd(p.Fc(11,14,o.metalsInBatch[i].estimateCost/100-o.metalsInBatch[i].actualCostExisting,"1.2-2"))}}function fi(t,e){if(1&t&&(p.nc(0),p.gd(1,mi,12,17,"tr",20),p.mc()),2&t){var i=e.$implicit,o=p.Cc(4);p.Vb(1),p.Jc("ngIf",o.metalsInBatch[i].present)}}function hi(t,e){1&t&&(p.pc(0,"span"),p.id(1,"Post Journal to Xero"),p.oc())}function vi(t,e){1&t&&p.kc(0,"span",75)}function Ci(t,e){if(1&t){var i=p.qc();p.pc(0,"div",14),p.pc(1,"button",80),p.yc("click",(function(t){return p.Wc(i),p.Cc(4).postJournalToXero(t)})),p.gd(2,hi,2,0,"span",20),p.gd(3,vi,1,0,"span",42),p.oc(),p.oc()}if(2&t){p.Cc(2);var o=p.Tc(9),n=p.Cc(2);p.Vb(1),p.Jc("disabled",!n.data.batch.invoiced||!o.pristine),p.Vb(1),p.Jc("ngIf",!n.state.postingJournal),p.Vb(1),p.Jc("ngIf",n.state.postingJournal)}}function Si(t,e){if(1&t&&(p.pc(0,"div",14),p.pc(1,"p",81),p.id(2),p.Dc(3,"simpleDate"),p.oc(),p.pc(4,"p",81),p.pc(5,"i"),p.id(6,"Reference: "),p.pc(7,"a",82),p.id(8),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(4);p.Vb(2),p.kd(" Journal posted at ",p.Ec(3,3,i.data.batch.journalPostedAt)," "),p.Vb(5),p.Lc("href","https://go.xero.com/Journal/View.aspx?invoiceID=",null==i.data.batch?null:i.data.batch.journalReference,"",p.Zc),p.Vb(1),p.kd(" ",i.data.batch.journalReference?i.data.batch.journalReference:"n/a"," ")}}function yi(t,e){if(1&t&&(p.pc(0,"div",76),p.pc(1,"div",15),p.pc(2,"div",16),p.pc(3,"h6"),p.id(4,"Cost Analysis"),p.oc(),p.oc(),p.pc(5,"div",17),p.pc(6,"p"),p.pc(7,"strong"),p.id(8,"Invoice Costs"),p.oc(),p.oc(),p.pc(9,"table",77),p.pc(10,"thead"),p.pc(11,"tr"),p.kc(12,"th"),p.pc(13,"th"),p.id(14,"EST"),p.oc(),p.pc(15,"th"),p.id(16,"ACT"),p.oc(),p.pc(17,"th"),p.id(18,"DIFF"),p.oc(),p.oc(),p.oc(),p.pc(19,"tbody"),p.pc(20,"tr"),p.pc(21,"th"),p.id(22,"Labour"),p.oc(),p.pc(23,"td"),p.id(24),p.Dc(25,"number"),p.oc(),p.pc(26,"td"),p.id(27),p.Dc(28,"number"),p.oc(),p.pc(29,"td"),p.id(30),p.Dc(31,"number"),p.oc(),p.oc(),p.gd(32,fi,2,1,"ng-container",4),p.pc(33,"tr"),p.kc(34,"td"),p.pc(35,"td"),p.pc(36,"strong"),p.id(37),p.Dc(38,"number"),p.oc(),p.oc(),p.pc(39,"td"),p.pc(40,"strong"),p.id(41),p.Dc(42,"number"),p.oc(),p.oc(),p.pc(43,"td"),p.pc(44,"strong"),p.id(45),p.Dc(46,"number"),p.oc(),p.oc(),p.oc(),p.pc(47,"tr"),p.pc(48,"th"),p.id(49,"Delivery"),p.oc(),p.pc(50,"td"),p.pc(51,"span",78),p.id(52),p.oc(),p.oc(),p.pc(53,"td"),p.id(54),p.Dc(55,"number"),p.oc(),p.pc(56,"td"),p.id(57),p.Dc(58,"number"),p.oc(),p.oc(),p.pc(59,"tr"),p.kc(60,"td"),p.pc(61,"td"),p.pc(62,"strong"),p.id(63),p.Dc(64,"number"),p.oc(),p.oc(),p.pc(65,"td"),p.pc(66,"strong"),p.id(67),p.Dc(68,"number"),p.oc(),p.oc(),p.pc(69,"td"),p.pc(70,"strong"),p.id(71),p.Dc(72,"number"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(73,"div",11),p.gd(74,Ci,4,3,"div",79),p.gd(75,Si,9,5,"div",79),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(24),p.jd(p.Fc(25,27,i.data.totalEstLaborCost/100,"1.2-2")),p.Vb(3),p.jd(p.Fc(28,30,i.model.labourCostExisting,"1.2-2")),p.Vb(2),p.bc("color-danger",i.data.totalEstLaborCost/100-i.model.labourCostExisting<0)("color-success",i.data.totalEstLaborCost/100-i.model.labourCostExisting>=0),p.Vb(1),p.jd(p.Fc(31,33,i.data.totalEstLaborCost/100-i.model.labourCostExisting,"1.2-2")),p.Vb(2),p.Jc("ngForOf",i.objectKeys(i.metalsInBatch)),p.Vb(5),p.jd(p.Fc(38,36,i.data.totalEstimatedCost/100,"1.2-2")),p.Vb(4),p.jd(p.Fc(42,39,i.data.totalActualCost-i.model.deliveryCostExisting,"1.2-2")),p.Vb(2),p.bc("color-danger",i.data.totalEstimatedCost/100-(i.data.totalActualCost-i.model.deliveryCostExisting)<0)("color-success",i.data.totalEstimatedCost/100-(i.data.totalActualCost-i.model.deliveryCostExisting)>=0),p.Vb(2),p.jd(p.Fc(46,42,i.data.totalEstimatedCost/100-(i.data.totalActualCost-i.model.deliveryCostExisting),"1.2-2")),p.Vb(7),p.jd(i.data.anticipatedPostageCost),p.Vb(2),p.jd(p.Fc(55,45,i.model.deliveryCostExisting,"1.2-2")),p.Vb(3),p.jd(p.Fc(58,48,i.data.anticipatedPostageCost-i.model.deliveryCostExisting,"1.2-2")),p.Vb(6),p.jd(p.Fc(64,51,i.data.totalEstimatedCost/100+i.data.anticipatedPostageCost,"1.2-2")),p.Vb(4),p.jd(p.Fc(68,54,i.data.totalActualCost,"1.2-2")),p.Vb(2),p.bc("color-danger",i.data.totalEstimatedCost/100+i.data.anticipatedPostageCost-i.data.totalActualCost<0)("color-success",i.data.totalEstimatedCost/100+i.data.anticipatedPostageCost-i.data.totalActualCost>=0),p.Vb(2),p.jd(p.Fc(72,57,i.data.totalEstimatedCost/100+i.data.anticipatedPostageCost-i.data.totalActualCost,"1.2-2")),p.Vb(3),p.Jc("ngIf",!i.data.batch.journalReference),p.Vb(1),p.Jc("ngIf",i.data.batch.journalReference)}}function ji(t,e){if(1&t){var i=p.qc();p.pc(0,"div",29),p.pc(1,"div",13),p.pc(2,"div",30),p.pc(3,"div",15),p.pc(4,"div",16),p.pc(5,"h6"),p.id(6,"Invoicing Details"),p.oc(),p.oc(),p.pc(7,"div",17),p.pc(8,"form",31,32),p.yc("ngSubmit",(function(){return p.Wc(i),p.Cc(2).onSubmit()})),p.pc(10,"div",33),p.pc(11,"div",14),p.pc(12,"div",34),p.pc(13,"label",35),p.id(14,"Invoice / Advice"),p.oc(),p.pc(15,"input",36),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.invoice=t})),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(16,"h6"),p.id(17,"Invoice Costs"),p.oc(),p.pc(18,"div",11),p.pc(19,"div",14),p.pc(20,"div",37),p.pc(21,"input",38),p.yc("ngModelChange",(function(t){return p.Wc(i),p.Cc(2).model.invoiced=t})),p.oc(),p.pc(22,"label",39),p.id(23,"Invoice Received"),p.oc(),p.oc(),p.oc(),p.oc(),p.gd(24,pi,32,17,"ng-container",20),p.pc(25,"div",40),p.pc(26,"div",14),p.pc(27,"button",41),p.gd(28,bi,2,0,"span",20),p.gd(29,gi,1,0,"span",42),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.gd(30,yi,76,60,"div",43),p.oc(),p.oc()}if(2&t){var o=p.Tc(9),n=p.Cc(2);p.Vb(15),p.Jc("ngModel",n.model.invoice)("disabled",n.data.batch.journalReference),p.Vb(6),p.Jc("disabled",n.data.batch.journalReference)("ngModel",n.model.invoiced),p.Vb(3),p.Jc("ngIf",n.model.invoiced),p.Vb(3),p.Jc("disabled",!o.valid||n.state.submitting||o.pristine||n.data.batch.journalReference),p.Vb(1),p.Jc("ngIf",!n.state.submitting),p.Vb(1),p.Jc("ngIf",n.state.submitting),p.Vb(1),p.Jc("ngIf",n.state.isAdmin&&n.data.incomingBatch)}}function Ii(t,e){if(1&t&&(p.pc(0,"div",10),p.pc(1,"div",11),p.pc(2,"div",12),p.pc(3,"div",13),p.pc(4,"div",14),p.pc(5,"div",15),p.pc(6,"div",16),p.pc(7,"h6"),p.id(8,"Batch Information"),p.oc(),p.oc(),p.pc(9,"div",17),p.pc(10,"h6"),p.id(11,"Make Up"),p.oc(),p.pc(12,"div",11),p.kc(13,"div",18),p.pc(14,"div",19),p.pc(15,"div",11),p.pc(16,"div",14),p.id(17),p.kc(18,"br"),p.id(19),p.kc(20,"br"),p.id(21),p.kc(22,"br"),p.id(23),p.oc(),p.oc(),p.kc(24,"hr"),p.pc(25,"div",11),p.pc(26,"div",14),p.pc(27,"table"),p.pc(28,"tbody"),p.gd(29,He,8,9,"tr",20),p.gd(30,ze,7,6,"tr",20),p.gd(31,Ye,7,6,"tr",20),p.pc(32,"tr"),p.pc(33,"th",21),p.id(34,"Created:"),p.oc(),p.pc(35,"td"),p.id(36),p.Dc(37,"simpleDate"),p.oc(),p.oc(),p.gd(38,Ue,6,3,"tr",20),p.gd(39,Qe,6,3,"tr",20),p.gd(40,Xe,5,1,"tr",20),p.pc(41,"tr",22),p.pc(42,"th",21),p.id(43,"Batch Status"),p.oc(),p.pc(44,"td"),p.Dc(45,"lowercaseDashes"),p.pc(46,"span"),p.id(47),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(48,"div",13),p.pc(49,"div",14),p.pc(50,"div",15),p.pc(51,"div",16),p.pc(52,"h6"),p.id(53,"Actions"),p.oc(),p.oc(),p.pc(54,"div",17),p.gd(55,Ke,2,1,"button",23),p.gd(56,Ze,2,1,"button",23),p.gd(57,ti,2,0,"button",24),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.gd(58,ji,31,9,"div",25),p.oc(),p.oc()),2&t){var i=p.Cc();p.Vb(17),p.kd(" Total: ",i.data.jobCount,""),p.Vb(2),p.kd(" Ring: ",i.data.ringCount,""),p.Vb(2),p.kd(" Pendant: ",i.data.pendantCount,""),p.Vb(2),p.kd(" Earring: ",i.data.earringCount," "),p.Vb(6),p.Jc("ngIf",i.state.isAdmin),p.Vb(1),p.Jc("ngIf",i.state.isAdmin),p.Vb(1),p.Jc("ngIf",i.state.isAdmin),p.Vb(5),p.kd(" ",p.Ec(37,19,i.data.batch.createdAt)," "),p.Vb(2),p.Jc("ngIf",i.data.batch.dateSent),p.Vb(1),p.Jc("ngIf",i.state.isAdmin),p.Vb(1),p.Jc("ngIf",i.state.isAdmin),p.Vb(4),p.Yb("status-pill status-",p.Ec(45,21,i.data.batch.status.name),""),p.Vb(3),p.jd(i.data.batch.status.name),p.Vb(8),p.Jc("ngIf",!i.state.loading&&i.state.isAdmin),p.Vb(1),p.Jc("ngIf",!i.state.loading&&i.state.isAdmin),p.Vb(1),p.Jc("ngIf",!i.state.loading&&i.state.isAdmin),p.Vb(1),p.Jc("ngIf",i.data.incomingBatch)}}function Ai(t,e){if(1&t){var i=p.qc();p.pc(0,"div",97),p.pc(1,"input",98),p.yc("click",(function(){return p.Wc(i),p.Cc(3).selectAll()}))("ngModelChange",(function(t){return p.Wc(i),p.Cc(3).state.allSelected=t})),p.oc(),p.kc(2,"label",99),p.oc()}if(2&t){var o=p.Cc(3);p.Vb(1),p.Jc("ngModel",o.state.allSelected)("value",o.state.allSelected)}}function Ji(t,e){if(1&t&&(p.pc(0,"th",95),p.gd(1,Ai,3,2,"div",96),p.oc()),2&t){var i=p.Cc(2);p.Vb(1),p.Jc("ngIf",!i.state.loading)}}function Vi(t,e){1&t&&(p.pc(0,"th",100),p.id(1,"Due By"),p.oc())}function ki(t,e){1&t&&(p.pc(0,"th",89),p.id(1,"Metal Weight"),p.oc())}function wi(t,e){1&t&&(p.pc(0,"th",89),p.id(1,"Est Cost (\xa3)"),p.oc())}function Mi(t,e){1&t&&(p.pc(0,"th",89),p.id(1,"Paid (\xa3)"),p.oc())}function xi(t,e){if(1&t){var i=p.qc();p.pc(0,"th",117),p.pc(1,"div",97),p.pc(2,"input",118),p.yc("click",(function(){p.Wc(i);var t=p.Cc().$implicit;return p.Cc(2).selectRow(t)}))("ngModelChange",(function(t){return p.Wc(i),p.Cc().$implicit.selected=t})),p.oc(),p.kc(3,"label",119),p.oc(),p.oc()}if(2&t){var o=p.Cc().$implicit;p.Vb(2),p.Lc("id","sub-cb-",o.submission.id,""),p.Jc("ngModel",o.selected)("name","submission"+o.submission.id),p.Vb(1),p.Lc("for","sub-cb-",o.submission.id,"")}}var Pi=function(){return[20]};function Ti(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"truncate"),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.jd(p.Fc(2,1,i.submission.customer.event.name,p.Nc(4,Pi)))}}function Bi(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.jd(i.submission.castingCode)}}function Di(t,e){1&t&&p.kc(0,"span",122),2&t&&p.Jc("ngbTooltip","Rush")}function Ei(t,e){1&t&&p.kc(0,"span",123),2&t&&p.Jc("ngbTooltip","Standard")}function Oi(t,e){if(1&t&&(p.nc(0),p.gd(1,Di,1,1,"span",120),p.gd(2,Ei,1,1,"span",121),p.mc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.Jc("ngIf",i.job.rush),p.Vb(1),p.Jc("ngIf",!i.job.rush)}}function Ni(t,e){1&t&&p.kc(0,"span",124)}function Fi(t,e){if(1&t){var i=p.qc();p.pc(0,"td"),p.pc(1,"input",125),p.yc("ngModelChange",(function(){p.Wc(i);var t=p.Cc().$implicit;return p.Cc(2).updateJob(t)}))("ngModelChange",(function(t){return p.Wc(i),p.Cc().$implicit.job.due=t})),p.oc(),p.kc(2,"owl-date-time",126,127),p.oc()}if(2&t){var o=p.Tc(3),n=p.Cc().$implicit;p.Vb(1),p.bc("is-invalid",n.job.due>(null==n.submission?null:n.submission.specialDate)&&n.job.due>(null==n.submission?null:n.submission.hardDeadline)),p.Jc("ngModel",n.job.due)("owlDateTimeTrigger",o)("owlDateTime",o)("max",null==n.submission?null:n.submission.specialDate),p.Vb(1),p.Jc("pickerType","calendar")}}function Ri(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"simpleDate"),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.kd(" ",i.job.due?p.Ec(2,1,i.job.due):""," ")}}function Wi(t,e){if(1&t){var i=p.qc();p.pc(0,"td"),p.pc(1,"input",128),p.yc("blur",(function(){p.Wc(i);var t=p.Cc().$implicit;return p.Cc(2).updateSubmission(t)}))("ngModelChange",(function(t){return p.Wc(i),p.Cc().$implicit.submission.metalWeight=t})),p.oc(),p.oc()}if(2&t){var o=p.Cc().$implicit;p.Vb(1),p.Jc("ngModel",o.submission.metalWeight)}}function _i(t,e){if(1&t&&(p.pc(0,"span",130),p.id(1),p.Dc(2,"currency"),p.Dc(3,"currency"),p.oc()),2&t){var i=p.Cc(2).$implicit;p.Vb(1),p.ld(" (",p.Ec(2,2,i.jobLabourCostEst)," + ",p.Ec(3,4,i.jobMetalCostEst),") ")}}function qi(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"currency"),p.kc(3,"br"),p.gd(4,_i,4,6,"span",129),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.kd(" ",i.jobTotalCostEst?p.Ec(2,2,i.jobTotalCostEst):"",""),p.Vb(3),p.Jc("ngIf",i.jobTotalCostEst)}}function Li(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"currency"),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.kd(" ",i.jobPayments>0?p.Ec(2,1,i.jobPayments):""," ")}}function $i(t,e){if(1&t){var i=p.qc();p.pc(0,"button",131),p.yc("click",(function(){p.Wc(i);var t=p.Cc().$implicit,e=p.Cc(2),o=p.Tc(9);return e.viewJobActionModal(t,o)})),p.oc()}if(2&t){var o=p.Cc(3);p.Jc("disabled",o.state.loadingActions||o.state.loadingJobActions)}}function Gi(t,e){if(1&t){var i=p.qc();p.pc(0,"button",132),p.yc("click",(function(){p.Wc(i);var t=p.Cc().$implicit,e=p.Cc(2),o=p.Tc(11);return e.viewJobCostsModal(t,o)})),p.oc()}}function Hi(t,e){1&t&&p.kc(0,"span",75)}function zi(t,e){if(1&t){var i=p.qc();p.pc(0,"button",133),p.yc("click",(function(){p.Wc(i);var t=p.Cc().$implicit;return p.Cc(2).createPdf(t)})),p.gd(1,Hi,1,0,"span",42),p.oc()}if(2&t){var o=p.Cc().$implicit,n=p.Cc(2);p.bc("fa-print",!o.printing),p.Jc("disabled",n.state.loadingStones&&n.state.loadingJobActions||o.printing),p.Vb(1),p.Jc("ngIf",o.printing)}}function Yi(t,e){1&t&&p.kc(0,"span",136)}function Ui(t,e){if(1&t){var i=p.qc();p.pc(0,"button",134),p.yc("click",(function(){p.Wc(i);var t=p.Cc().$implicit;return p.Cc(2).toggleSubmissionPhotoTimer(t.submission.id)})),p.gd(1,Yi,1,0,"span",135),p.oc()}if(2&t){var o=p.Cc().$implicit,n=p.Cc(2);p.bc("fa-camera",!n.data.submissionPhotoTimingMap[o.submission.id]&&!1===n.state.submitting)("fa-stop",n.data.submissionPhotoTimingMap[o.submission.id]&&!1===n.state.submitting)("hover",!n.data.submissionPhotoTimingMap[o.submission.id]),p.Jc("disabled",n.state.submitting),p.Vb(1),p.Jc("ngIf",!0===n.state.submitting)}}function Qi(t,e){if(1&t){var i=p.qc();p.pc(0,"button",137),p.yc("click",(function(){p.Wc(i);var t=p.Cc().$implicit;return p.Cc(2).deleteJob(t)})),p.oc()}}function Xi(t,e){if(1&t&&p.kc(0,"view-submission-modal",138),2&t){var i=p.Cc().$implicit,o=p.Cc(2);p.Jc("buttonStyle",!0)("isAdmin",o.state.isAdmin)("loadingStones",o.state.loadingStones)("photos",i.submission.submissionPhotos.edges)("stones",i.stones)("submission",i.submission)}}function Ki(t,e){if(1&t&&(p.pc(0,"span"),p.id(1),p.Dc(2,"date"),p.oc()),2&t){var i=p.Cc(3);p.Vb(1),p.kd(" Elapsed: ",p.Gc(2,1,1e3*i.timeElapsed,"mm:ss","UTC"),"s \xa0 ")}}function Zi(t,e){if(1&t){var i=p.qc();p.nc(0),p.pc(1,"tr"),p.Dc(2,"lowercaseDashes"),p.gd(3,xi,4,4,"th",101),p.pc(4,"th",102),p.kc(5,"view-submission-photos-modal",103),p.oc(),p.pc(6,"td",104),p.id(7),p.Dc(8,"numericId"),p.oc(),p.pc(9,"td",105),p.id(10),p.Dc(11,"numericId"),p.oc(),p.pc(12,"td"),p.id(13),p.oc(),p.gd(14,Ti,3,5,"td",20),p.gd(15,Bi,2,1,"td",20),p.pc(16,"td",106),p.yc("click",(function(t){var e=p.Wc(i).$implicit;return p.Cc(2).setRush(e,t)})),p.gd(17,Oi,3,2,"ng-container",20),p.gd(18,Ni,1,0,"span",107),p.oc(),p.gd(19,Fi,4,7,"td",20),p.gd(20,Ri,3,3,"td",20),p.pc(21,"td"),p.id(22),p.Dc(23,"titlecase"),p.oc(),p.pc(24,"td"),p.id(25),p.Dc(26,"number"),p.oc(),p.gd(27,Wi,2,1,"td",20),p.gd(28,qi,5,4,"td",20),p.gd(29,Li,3,3,"td",20),p.pc(30,"td"),p.Dc(31,"lowercaseDashes"),p.pc(32,"span"),p.id(33),p.Dc(34,"titlecase"),p.oc(),p.oc(),p.pc(35,"td",108),p.pc(36,"div",109),p.gd(37,$i,1,1,"button",110),p.gd(38,Gi,1,0,"button",111),p.gd(39,zi,2,4,"button",112),p.gd(40,Ui,2,8,"button",113),p.gd(41,Qi,1,0,"button",114),p.kc(42,"view-submission-comms-modal",115),p.oc(),p.gd(43,Xi,1,6,"view-submission-modal",116),p.gd(44,Ki,3,5,"span",20),p.oc(),p.oc(),p.mc()}if(2&t){var o=e.$implicit,n=p.Cc(2);p.Vb(1),p.Yb("status-",p.Ec(2,38,o.submission.status.name)," sm"),p.bc("row-blocked",!n.data.submissionPhotoTimingMap[o.submission.id]&&!0===n.imageLoggingSessionState),p.Vb(2),p.Jc("ngIf",n.state.isAdmin),p.Vb(2),p.Jc("photos",o.submission.submissionPhotos.edges),p.Vb(2),p.jd(p.Ec(8,40,o.job.id)),p.Vb(3),p.jd(p.Ec(11,42,o.submission.id)),p.Vb(3),p.jd(o.submission.customer.fullName),p.Vb(1),p.Jc("ngIf",o.submission.customer.event),p.Vb(1),p.Jc("ngIf",o.submission.castingCode),p.Vb(2),p.Jc("ngIf",!o.pendingUpdateJob),p.Vb(1),p.Jc("ngIf",o.pendingUpdateJob),p.Vb(1),p.Jc("ngIf",n.state.isAdmin&&n.data.outgoingBatch),p.Vb(1),p.Jc("ngIf",!n.state.isAdmin&&n.data.outgoingBatch),p.Vb(2),p.jd(p.Ec(23,44,o.submission.jewelleryType.name)),p.Vb(3),p.jd(p.Fc(26,46,o.submission.waxWeight,"0.2-4")),p.Vb(2),p.Jc("ngIf",n.data.incomingBatch),p.Vb(1),p.Jc("ngIf",n.state.isAdmin),p.Vb(1),p.Jc("ngIf",n.state.isAdmin),p.Vb(1),p.Yb("status-",p.Ec(31,49,o.submission.status.name)," status-pill"),p.Vb(3),p.jd(p.Ec(34,51,o.submission.status.name)),p.Vb(4),p.Jc("ngIf",n.state.isAdmin&&!1===n.imageLoggingSessionState),p.Vb(1),p.Jc("ngIf",n.state.isAdmin&&!1===n.imageLoggingSessionState),p.Vb(1),p.Jc("ngIf",!1===n.imageLoggingSessionState),p.Vb(1),p.Jc("ngIf",(!1===n.imageLoggingSessionState||n.data.submissionPhotoTimingMap[o.submission.id])&&n.state.isAdmin),p.Vb(1),p.Jc("ngIf",n.state.isAdmin&&!1===n.imageLoggingSessionState),p.Vb(1),p.Jc("customerNote",o.submission.customerNotes)("hover",!0)("isAdmin",n.state.isAdmin)("loadingNotes",n.state.loadingNotes)("notes",o.notes)("submissionId",o.submission.id),p.Vb(1),p.Jc("ngIf",!1===n.imageLoggingSessionState),p.Vb(1),p.Jc("ngIf",n.data.submissionPhotoTimingMap[o.submission.id])}}function to(t,e){if(1&t){var i=p.qc();p.pc(0,"div",139),p.pc(1,"button",140),p.yc("click",(function(){p.Wc(i);var t=p.Cc(2);return t.updateStatus(t.statusInProduction)})),p.id(2),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(1),p.Jc("disabled",o.state.nextStatus.manuallyConfirmAll&&o.data.selections.length!==o.data.submissionInfos.length||o.state.submitting),p.Vb(1),p.kd(" ",o.state.nextStatus.buttonText," ")}}function eo(t,e){1&t&&(p.pc(0,"div",141),p.kc(1,"loading-ring",142),p.oc()),2&t&&(p.Vb(1),p.Jc("size",60))}function io(t,e){if(1&t&&(p.pc(0,"div",83),p.pc(1,"div",14),p.pc(2,"h5",84),p.id(3,"Items in Batch"),p.oc(),p.pc(4,"div",85),p.pc(5,"table",86),p.pc(6,"thead"),p.pc(7,"tr"),p.gd(8,Ji,2,1,"th",87),p.kc(9,"th",88),p.pc(10,"th",88),p.id(11,"JID"),p.oc(),p.pc(12,"th",88),p.id(13,"SID"),p.oc(),p.pc(14,"th",89),p.id(15,"Customer"),p.oc(),p.pc(16,"th",89),p.id(17,"Source"),p.oc(),p.kc(18,"th",88),p.gd(19,Vi,2,0,"th",90),p.pc(20,"th",89),p.id(21,"Type"),p.oc(),p.pc(22,"th",89),p.id(23,"Wax (g)"),p.oc(),p.gd(24,ki,2,0,"th",91),p.gd(25,wi,2,0,"th",91),p.gd(26,Mi,2,0,"th",91),p.pc(27,"th",89),p.id(28,"Status"),p.oc(),p.kc(29,"th",89),p.oc(),p.oc(),p.pc(30,"tbody"),p.gd(31,Zi,45,53,"ng-container",4),p.oc(),p.pc(32,"tfoot"),p.pc(33,"tr"),p.kc(34,"th",92),p.oc(),p.oc(),p.oc(),p.gd(35,to,3,2,"div",93),p.gd(36,eo,2,1,"div",94),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc();p.Vb(8),p.Jc("ngIf",i.state.isAdmin),p.Vb(11),p.Jc("ngIf",i.data.outgoingBatch),p.Vb(5),p.Jc("ngIf",i.data.incomingBatch),p.Vb(1),p.Jc("ngIf",i.state.isAdmin),p.Vb(1),p.Jc("ngIf",i.state.isAdmin),p.Vb(5),p.Jc("ngForOf",i.data.submissionInfos),p.Vb(4),p.Jc("ngIf",!i.state.loading&&i.state.nextStatus&&i.data.submissionInfos.length&&(!i.state.nextStatus.adminOnly||i.state.isAdmin)),p.Vb(1),p.Jc("ngIf",i.state.loading)}}function oo(t,e){1&t&&p.kc(0,"i",161),2&t&&p.Jc("ngbTooltip","Rush")}function no(t,e){if(1&t&&(p.pc(0,"td",155),p.id(1),p.oc()),2&t){var i=p.Cc(2).$implicit;p.Jc("colSpan",100),p.Vb(1),p.kd("Kit - ",i.submission.castingCode,"")}}var co=function(){return[20,".."]};function ao(t,e){if(1&t&&(p.pc(0,"td",155),p.id(1),p.Dc(2,"truncate"),p.oc()),2&t){var i=p.Cc(2).$implicit,o=p.Cc();p.Jc("colSpan",100),p.Vb(1),p.ld(" ",i.submission.customer.event.eventType.name===o.eventTypeWedding?"WEDDING ":""," ",p.Fc(2,3,i.submission.customer.event.name,p.Nc(6,co))," ")}}function so(t,e){1&t&&(p.pc(0,"td",155),p.id(1," Other "),p.oc()),2&t&&p.Jc("colSpan",100)}function lo(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"td"),p.id(2,"Deadline"),p.oc(),p.pc(3,"td",155),p.id(4),p.Dc(5,"simpleDate"),p.Dc(6,"simpleDate"),p.oc(),p.oc()),2&t){var i=p.Cc(2).$implicit;p.Vb(3),p.Jc("colSpan",100),p.Vb(1),p.kd(" ",i.submission.hardDeadline>i.job.due?p.Ec(5,2,i.job.due):p.Ec(6,4,i.submission.hardDeadline)," ")}}function ro(t,e){if(1&t&&(p.nc(0),p.id(1),p.Dc(2,"uppercase"),p.mc()),2&t){var i=p.Cc(4).$implicit;p.Vb(1),p.kd(" - ",p.Ec(2,1,i.submission.measuredRingSize.name)," ")}}function uo(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"titlecase"),p.gd(3,ro,3,3,"ng-container",20),p.oc()),2&t){var i=p.Cc(3).$implicit,o=p.Cc();p.Vb(1),p.kd(" ",p.Ec(2,2,i.submission.ringSizeCustom.name)," "),p.Vb(2),p.Jc("ngIf",i.submission.measuredRingSize&&i.submission.ringSizeCustom.name===o.ringSizeLeaveAsIs)}}function po(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"uppercase"),p.oc()),2&t){var i=p.Cc(3).$implicit;p.Vb(1),p.jd(p.Ec(2,1,i.submission.ringSizeCustom.name))}}var bo=function(){return[110,"[...]"]};function go(t,e){if(1&t&&(p.pc(0,"table",154),p.pc(1,"tbody"),p.pc(2,"tr"),p.pc(3,"td"),p.id(4,"Metal"),p.oc(),p.pc(5,"td"),p.id(6),p.Dc(7,"titlecase"),p.oc(),p.oc(),p.pc(8,"tr"),p.pc(9,"td"),p.id(10,"Size"),p.oc(),p.gd(11,uo,4,4,"td",20),p.gd(12,po,3,3,"td",20),p.oc(),p.pc(13,"tr"),p.pc(14,"td"),p.id(15,"Finish"),p.oc(),p.pc(16,"td"),p.id(17),p.Dc(18,"titlecase"),p.oc(),p.oc(),p.pc(19,"tr"),p.pc(20,"td"),p.id(21,"Plating"),p.oc(),p.pc(22,"td"),p.id(23),p.Dc(24,"titlecase"),p.oc(),p.oc(),p.pc(25,"tr",162),p.pc(26,"td"),p.id(27,"Notes"),p.oc(),p.pc(28,"td"),p.id(29),p.Dc(30,"truncate"),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2).$implicit,o=p.Cc();p.Vb(2),p.bc("invert",i.submission.baseMetal.name!==o.baseMetalSilver),p.Vb(4),p.jd(p.Ec(7,8,i.submission.baseMetal.name)),p.Vb(5),p.Jc("ngIf",!i.submission.ringResize),p.Vb(1),p.Jc("ngIf",i.submission.ringResize),p.Vb(5),p.jd(p.Ec(18,10,i.submission.finish.name)),p.Vb(6),p.jd(p.Ec(24,12,i.submission.plating.name)),p.Vb(6),p.jd(i.submission.customerNotes?p.Fc(30,14,i.submission.customerNotes,p.Nc(17,bo)):"-")}}function mo(t,e){1&t&&(p.pc(0,"td"),p.id(1,"None"),p.oc())}function fo(t,e){1&t&&p.kc(0,"br")}function ho(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"titlecase"),p.Dc(3,"titlecase"),p.gd(4,fo,1,0,"br",20),p.id(5),p.Dc(6,"titlecase"),p.oc()),2&t){var i=p.Cc(3).$implicit;p.Vb(1),p.ld(" ",p.Ec(2,4,i.submission.chainType.name)," - ",p.Ec(3,6,i.submission.chainLength.name)," "),p.Vb(3),p.Jc("ngIf",i.submission.chainPlating),p.Vb(1),p.kd(" ",p.Ec(6,8,i.submission.chainPlating.name)," ")}}var vo=function(){return[30,"[...]"]},Co=function(){return[90,"[...]"]};function So(t,e){if(1&t&&(p.pc(0,"table",154),p.pc(1,"tbody"),p.pc(2,"tr"),p.pc(3,"td"),p.id(4,"Metal"),p.oc(),p.pc(5,"td"),p.id(6),p.Dc(7,"titlecase"),p.oc(),p.oc(),p.pc(8,"tr"),p.pc(9,"td"),p.id(10,"Finish"),p.oc(),p.pc(11,"td"),p.id(12),p.Dc(13,"titlecase"),p.oc(),p.oc(),p.pc(14,"tr"),p.pc(15,"td"),p.id(16,"Plating"),p.oc(),p.pc(17,"td"),p.id(18),p.Dc(19,"titlecase"),p.oc(),p.oc(),p.pc(20,"tr"),p.pc(21,"td"),p.id(22,"Jump Ring"),p.oc(),p.pc(23,"td"),p.id(24),p.Dc(25,"truncate"),p.oc(),p.oc(),p.pc(26,"tr"),p.pc(27,"td"),p.id(28,"Chain"),p.oc(),p.gd(29,mo,2,0,"td",20),p.gd(30,ho,7,10,"td",20),p.oc(),p.pc(31,"tr",162),p.pc(32,"td"),p.id(33,"Notes"),p.oc(),p.pc(34,"td"),p.id(35),p.Dc(36,"truncate"),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2).$implicit,o=p.Cc();p.Vb(2),p.bc("invert",i.submission.baseMetal.name!==o.baseMetalSilver),p.Vb(4),p.jd(p.Ec(7,9,i.submission.baseMetal.name)),p.Vb(6),p.jd(p.Ec(13,11,i.submission.finish.name)),p.Vb(6),p.jd(p.Ec(19,13,i.submission.plating.name)),p.Vb(6),p.jd(i.submission.jumpRing?p.Fc(25,15,i.submission.jumpRingPlacement,p.Nc(21,vo)):"None"),p.Vb(5),p.Jc("ngIf",!i.submission.chainType),p.Vb(1),p.Jc("ngIf",i.submission.chainType&&i.submission.chainLength),p.Vb(5),p.jd(i.submission.customerNotes?p.Fc(36,18,i.submission.customerNotes,p.Nc(22,Co)):"-")}}var yo=function(t){return[100,t]};function jo(t,e){if(1&t&&(p.pc(0,"table",154),p.pc(1,"tbody"),p.pc(2,"tr"),p.pc(3,"td"),p.id(4,"Metal"),p.oc(),p.pc(5,"td"),p.id(6),p.Dc(7,"titlecase"),p.oc(),p.oc(),p.pc(8,"tr"),p.pc(9,"td"),p.id(10,"Config"),p.oc(),p.pc(11,"td"),p.id(12),p.Dc(13,"titlecase"),p.oc(),p.oc(),p.pc(14,"tr"),p.pc(15,"td"),p.id(16,"Finish"),p.oc(),p.pc(17,"td"),p.id(18),p.Dc(19,"titlecase"),p.oc(),p.oc(),p.pc(20,"tr"),p.pc(21,"td"),p.id(22,"Plating"),p.oc(),p.pc(23,"td"),p.id(24),p.oc(),p.oc(),p.pc(25,"tr",162),p.pc(26,"td"),p.id(27,"Notes"),p.oc(),p.pc(28,"td"),p.id(29),p.Dc(30,"truncate"),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2).$implicit,o=p.Cc();p.Vb(2),p.bc("invert",i.submission.baseMetal.name!==o.baseMetalSilver),p.Vb(4),p.jd(p.Ec(7,7,i.submission.baseMetal.name)),p.Vb(6),p.jd(p.Ec(13,9,i.submission.earringConfig.name)),p.Vb(6),p.jd(p.Ec(19,11,i.submission.finish.name)),p.Vb(6),p.jd(i.submission.plating.name),p.Vb(5),p.jd(i.submission.customerNotes?p.Fc(30,13,i.submission.customerNotes,p.Oc(16,yo,"[...]")):"-")}}function Io(t,e){if(1&t&&(p.nc(0),p.pc(1,"table",154),p.pc(2,"tbody"),p.pc(3,"tr"),p.pc(4,"td"),p.id(5,"Name"),p.oc(),p.pc(6,"td",155),p.gd(7,oo,1,1,"i",156),p.id(8),p.oc(),p.oc(),p.pc(9,"tr"),p.pc(10,"td"),p.id(11,"Type"),p.oc(),p.pc(12,"td"),p.id(13),p.Dc(14,"titlecase"),p.oc(),p.pc(15,"td"),p.id(16),p.Dc(17,"number"),p.oc(),p.pc(18,"td"),p.id(19),p.Dc(20,"numericId"),p.oc(),p.oc(),p.pc(21,"tr"),p.pc(22,"td"),p.id(23,"Source"),p.oc(),p.gd(24,no,2,2,"td",157),p.gd(25,ao,3,7,"td",157),p.gd(26,so,2,1,"td",157),p.oc(),p.gd(27,lo,7,6,"tr",20),p.oc(),p.oc(),p.gd(28,go,31,18,"table",158),p.gd(29,So,37,23,"table",158),p.gd(30,jo,31,18,"table",158),p.pc(31,"div",159),p.pc(32,"div",160),p.pc(33,"div"),p.pc(34,"span"),p.id(35,"BM"),p.oc(),p.oc(),p.oc(),p.pc(36,"div",160),p.pc(37,"div"),p.pc(38,"span"),p.id(39,"PLA"),p.oc(),p.oc(),p.oc(),p.pc(40,"div",160),p.pc(41,"div"),p.pc(42,"span"),p.id(43,"ENG"),p.oc(),p.oc(),p.oc(),p.pc(44,"div",160),p.pc(45,"div"),p.pc(46,"span"),p.id(47,"HALM"),p.oc(),p.oc(),p.oc(),p.pc(48,"div",160),p.pc(49,"div"),p.pc(50,"span"),p.id(51,"DUP"),p.oc(),p.oc(),p.oc(),p.pc(52,"div",160),p.pc(53,"div"),p.pc(54,"span"),p.id(55,"JR"),p.oc(),p.oc(),p.oc(),p.pc(56,"div",160),p.pc(57,"div"),p.pc(58,"span"),p.id(59,"POST"),p.oc(),p.oc(),p.oc(),p.pc(60,"div",160),p.pc(61,"div"),p.pc(62,"span"),p.id(63,"STN"),p.oc(),p.oc(),p.oc(),p.pc(64,"div",160),p.pc(65,"div"),p.pc(66,"span"),p.id(67,"RZE"),p.oc(),p.oc(),p.oc(),p.pc(68,"div",160),p.pc(69,"div"),p.pc(70,"span"),p.id(71,"RPR"),p.oc(),p.oc(),p.oc(),p.oc(),p.mc()),2&t){var i=p.Cc().$implicit,o=p.Cc();p.Vb(6),p.Jc("colSpan",100),p.Vb(1),p.Jc("ngIf",i.job.rush),p.Vb(1),p.kd(" ",i.submission.customer.fullName," "),p.Vb(5),p.jd(p.Ec(14,33,i.submission.jewelleryType.name)),p.Vb(3),p.kd("",p.Fc(17,35,i.submission.waxWeight,"1.2-2"),"g"),p.Vb(3),p.kd("#",p.Ec(20,38,i.job.id),""),p.Vb(5),p.Jc("ngIf",i.submission.castingCode),p.Vb(1),p.Jc("ngIf",i.submission.customer.event),p.Vb(1),p.Jc("ngIf",!i.submission.customer.event&&!i.submission.castingCode),p.Vb(1),p.Jc("ngIf",null==i.submission?null:i.submission.hardDeadline),p.Vb(1),p.Jc("ngIf",i.submission.jewelleryType.name===o.jewelleryTypeRing),p.Vb(1),p.Jc("ngIf",i.submission.jewelleryType.name===o.jewelleryTypePendant),p.Vb(1),p.Jc("ngIf",i.submission.jewelleryType.name===o.jewelleryTypeEarring),p.Vb(2),p.bc("off",i.submission.baseMetal.name===o.baseMetalSilver),p.Vb(4),p.bc("off",null===i.jobActions[o.actionPlating]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionEngraving]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionHallmarking]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionDuplicate]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionJumpRing]||null===i.jobActions[o.actionEarringPosts]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionEarringPosts]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionStoneSetting]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionResizing]),p.Vb(4),p.bc("off",null===i.jobActions[o.actionRepairing])}}function Ao(t,e){if(1&t&&(p.nc(0),p.pc(1,"div",143),p.pc(2,"div",144),p.pc(3,"div",145),p.pc(4,"div",146),p.pc(5,"table",147),p.pc(6,"tr",148),p.pc(7,"th"),p.kc(8,"img",149),p.oc(),p.pc(9,"th",150),p.id(10),p.Dc(11,"numericId"),p.oc(),p.oc(),p.oc(),p.gd(12,Io,72,40,"ng-container",20),p.kc(13,"ngx-barcode",151),p.pc(14,"p",152),p.id(15),p.Dc(16,"numericId"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.kc(17,"iframe",153),p.mc()),2&t){var i=e.$implicit,o=p.Cc();p.Vb(1),p.bc("pdfLabel",!(o.state.printAll||o.state.showToPrint&&o.state.showToPrint==="submission"+i.numericId||!o.state.showToPrint&&i.selected)),p.Jc("hidden",!(o.state.printAll||o.state.showToPrint&&o.state.showToPrint==="submission"+i.numericId||!o.state.showToPrint&&i.selected))("id","submission"+i.numericId),p.Vb(7),p.Jc("width",60),p.Vb(2),p.kd("Batch #",p.Ec(11,13,o.data.batch.id),""),p.Vb(2),p.Jc("ngIf",!o.data.incomingBatch),p.Vb(1),p.Jc("bc-display-value",!1)("bc-element-type","svg")("bc-height",140)("bc-value",i.numericId)("bc-width",8),p.Vb(2),p.kd("Submission Ref #",p.Ec(16,15,i.submission.id),"")}}function Jo(t,e){if(1&t&&(p.nc(0),p.id(1),p.mc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.kd(" ",i.submission.castingCode," - ")}}function Vo(t,e){if(1&t&&(p.nc(0),p.id(1),p.mc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.kd(" ",i.submission.customer.event," - ")}}function ko(t,e){if(1&t&&(p.nc(0),p.pc(1,"div",163),p.pc(2,"div",145),p.pc(3,"div",164),p.pc(4,"table"),p.pc(5,"tbody"),p.pc(6,"tr"),p.pc(7,"td",165),p.kc(8,"ngx-barcode",151),p.oc(),p.pc(9,"td"),p.pc(10,"strong"),p.id(11),p.oc(),p.kc(12,"br"),p.gd(13,Jo,2,1,"ng-container",20),p.gd(14,Vo,2,1,"ng-container",20),p.id(15),p.Dc(16,"numericId"),p.kc(17,"br"),p.pc(18,"strong"),p.id(19),p.oc(),p.id(20),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.kc(21,"iframe",166),p.mc()),2&t){var i=e.$implicit;p.Vb(8),p.Jc("bc-display-value",!1)("bc-element-type","svg")("bc-height",100)("bc-value",i.numericId)("bc-width",2),p.Vb(3),p.jd(i.submission.customer.fullName),p.Vb(2),p.Jc("ngIf",i.submission.castingCode),p.Vb(1),p.Jc("ngIf",i.submission.customer.event),p.Vb(1),p.kd(" #",p.Ec(16,11,i.submission.id),""),p.Vb(4),p.jd(i.submission.customer.postcode),p.Vb(1),p.kd(" - ",i.submission.customer.address1," ")}}function wo(t,e){if(1&t){var i=p.qc();p.pc(0,"div",173),p.pc(1,"label",174),p.id(2),p.oc(),p.pc(3,"input",175),p.yc("ngModelChange",(function(t){var e=p.Wc(i).$implicit;return p.Cc(2).model.jobActions[e.key]=t})),p.oc(),p.oc()}if(2&t){var o=e.$implicit,n=p.Cc(2);p.Vb(1),p.Jc("for","jobAction"+o.key),p.Vb(1),p.jd(o.key),p.Vb(1),p.Jc("ngModel",n.model.jobActions[o.key])("id","jobAction"+o.key)("name","jobAction"+o.key)}}function Mo(t,e){if(1&t){var i=p.qc();p.kc(0,"modal-header",167),p.pc(1,"div",168),p.pc(2,"form",169,170),p.pc(4,"div",11),p.gd(5,wo,4,5,"div",171),p.Dc(6,"keyvalue"),p.oc(),p.oc(),p.oc(),p.pc(7,"modal-footer",172),p.yc("modalSaved",(function(){return p.Wc(i),p.Cc().addJobActions()})),p.oc()}if(2&t){var o=e.$implicit,n=p.Tc(3),c=p.Cc();p.Jc("modal",o),p.Vb(5),p.Jc("ngForOf",p.Ec(6,5,c.model.jobActions)),p.Vb(2),p.Jc("form",n)("modal",o)("saveButtonName","Save")}}function xo(t,e){if(1&t&&(p.nc(0),p.pc(1,"tr"),p.pc(2,"th"),p.id(3),p.oc(),p.pc(4,"td"),p.id(5),p.Dc(6,"currency"),p.oc(),p.pc(7,"td"),p.id(8),p.Dc(9,"currency"),p.oc(),p.pc(10,"td"),p.pc(11,"strong"),p.id(12),p.Dc(13,"currency"),p.oc(),p.oc(),p.oc(),p.mc()),2&t){var i=e.$implicit;p.Vb(3),p.jd(i.node.action.name),p.Vb(2),p.jd(p.Ec(6,4,i.node.estimatedLaborCost)),p.Vb(3),p.jd(p.Ec(9,6,i.node.estimatedMetalCost)),p.Vb(4),p.jd(p.Ec(13,8,i.node.estimatedMetalCost+i.node.estimatedLaborCost))}}function Po(t,e){if(1&t&&(p.kc(0,"modal-header",176),p.Dc(1,"numericId"),p.pc(2,"div",168),p.pc(3,"table",86),p.pc(4,"thead"),p.pc(5,"tr"),p.pc(6,"th"),p.id(7,"Action"),p.oc(),p.pc(8,"th"),p.id(9,"Labour"),p.oc(),p.pc(10,"th"),p.id(11,"Metal"),p.oc(),p.pc(12,"th"),p.id(13,"Total"),p.oc(),p.oc(),p.oc(),p.pc(14,"tbody"),p.gd(15,xo,14,10,"ng-container",4),p.oc(),p.oc(),p.oc()),2&t){var i=e.$implicit,o=p.Cc();p.Lc("title","Job Costs for #",p.Ec(1,3,o.state.viewingJobForCosts.job.id),""),p.Jc("modal",i),p.Vb(15),p.Jc("ngForOf",o.state.viewingJobForCosts.job.jobActions.edges)}}function To(t,e){1&t&&p.kc(0,"loading-ring",177)}var Bo=function(){return function(){var t;this.jobActions=((t={})["Cast & Mount"]=!1,t.Finishing=!1,t.Plating=!1,t.Engraving=!1,t["Jump Ring"]=!1,t["Earring Posts"]=!1,t["Stone Setting"]=!1,t.Resizing=!1,t.Repairing=!1,t.Other=!1,t.Duplicate=!1,t.Hallmarking=!1,t),this.submissionInfo=null}}(),Do=function(){function t(t,e,i,o,n,c,a,s,d,l,r,u,p,b,g){var m;this.route=t,this.router=e,this.actionService=i,this.imageLoggingSessionService=o,this.appUserService=n,this.exportToPdfService=c,this.exportDataService=a,this.jobActionService=s,this.jobService=d,this.modalService=l,this.stoneSubmissionService=r,this.submissionBatchService=u,this.submissionNoteService=p,this.submissionService=b,this.toastr=g,this.actionPlating=j,this.actionEngraving=I,this.actionJumpRing=J,this.actionEarringPosts=V,this.actionStoneSetting=k,this.actionResizing=w,this.actionRepairing=M,this.actionHallmarking=x,this.actionDuplicate=A,this.statusInProduction=T.j,this.jewelleryTypeRing=v.e,this.jewelleryTypePendant=v.d,this.jewelleryTypeEarring=v.c,this.baseMetalSilver=O.m,this.ringSizeLeaveAsIs=je.c,this.eventTypeWedding=N.a,this.model=new Bo,this.data={actions:[],batch:null,nextStatuses:[{currentStatusId:T.k.id,setStatus:T.l,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!1,outgoing:!0},{currentStatusId:T.l.id,setStatus:T.m,buttonText:"Receive Batch",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!1,incoming:!1,outgoing:!0},{currentStatusId:T.d.id,setStatus:T.e,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!0,manuallyConfirmAll:!1,adminOnly:!1,incoming:!0,outgoing:!1},{currentStatusId:T.e.id,setStatus:T.f,buttonText:"Batch Received",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!0,outgoing:!1}],selections:[],submissionInfos:[],totalEstLaborCost:0,totalEstMetalCost:0,createImageLoggingSessionMap:{},submissionPhotoTimingMap:{},incomingBatch:!1,outgoingBatch:!1,jobCount:0,ringCount:0,pendantCount:0,earringCount:0,totalEstimatedCost:0,totalActualCost:0,totalPayments:0,anticipatedPostageCost:9.75},this.state={allSelected:!1,isAdmin:!1,isSupplier:!1,loading:!0,loadingActions:!1,loadingJobActions:!0,loadingStones:!0,loadingNotes:!0,nextStatus:null,showToPrint:null,printAll:!1,submitting:!1,exporting:!1,imageLoggingSessionState:!1,viewingJobForCosts:null,postingJournal:!1},this._silverBaseMetalName=O.l,this._9ctYellowGoldBaseMetalName=O.j,this._9ctRoseGoldBaseMetalName=O.h,this._9ctWhiteGoldBaseMetalName=O.i,this._14ctYellowGoldBaseMetalName=O.d,this._14ctRoseGoldBaseMetalName=O.b,this._14ctWhiteGoldBaseMetalName=O.c,this._18ctYellowGoldBaseMetalName=O.g,this._18ctRoseGoldBaseMetalName=O.e,this._18ctWhiteGoldBaseMetalName=O.f,this._platinumBaseMetalName=O.k,this.metalsInBatch=((m={})[O.l]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.j]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.h]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.i]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.d]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.b]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.c]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.g]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.e]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.f]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m[O.k]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},m),this.imageLoggingSessionState=!1,this.timeElapsed=0}return t.prototype.unloadNotification=function(t){var e=this;this.data.submissionInfos.some((function(t){return e.data.submissionPhotoTimingMap[t.submission.id]}))&&(t.returnValue=!0)},t.prototype.ngOnDestroy=function(){return _e(this,void 0,void 0,(function(){var t,e,i;return qe(this,(function(o){switch(o.label){case 0:t=0,e=this.data.submissionInfos,o.label=1;case 1:return t<e.length?this.data.submissionPhotoTimingMap[(i=e[t]).submission.id]?[4,this.endImageLoggingSession(i.submission)]:[3,3]:[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},t.prototype.ngOnInit=function(){var t=this;this.liveTimeInterval=setInterval((function(){t.liveTimeCreate()}),500),this.route.paramMap.subscribe((function(e){var i=e.get("id");Object(B.a)(t.submissionBatchService.get("submission_batches/"+i),t.jobService.listByOutgoingBatch(i,999),t.jobService.listByIncomingBatch(i,999),t.appUserService.getMe()).subscribe((function(e){var i,o=e[1],n=e[2],c=e[3];t.data.batch=JSON.parse(JSON.stringify(e[0].data.submissionBatch)),t.model.invoice=t.data.batch.invoice,t.model.invoiced=t.data.batch.invoiced,t.model.labourCostStaging=t.data.batch.invoiceLabourCost/100,t.model.labourCostExisting=t.data.batch.invoiceLabourCost/100,t.model.deliveryCostStaging=t.data.batch.invoiceDeliveryCost/100,t.model.deliveryCostExisting=t.data.batch.invoiceDeliveryCost/100,t.metalsInBatch[O.l].actualCostStaging=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[O.j].actualCostStaging=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[O.h].actualCostStaging=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[O.i].actualCostStaging=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[O.d].actualCostStaging=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[O.b].actualCostStaging=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[O.c].actualCostStaging=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[O.g].actualCostStaging=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[O.e].actualCostStaging=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[O.f].actualCostStaging=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[O.k].actualCostStaging=t.data.batch.invoicePlatinumCost/100,t.metalsInBatch[O.l].actualCostExisting=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[O.j].actualCostExisting=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[O.h].actualCostExisting=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[O.i].actualCostExisting=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[O.d].actualCostExisting=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[O.b].actualCostExisting=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[O.c].actualCostExisting=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[O.g].actualCostExisting=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[O.e].actualCostExisting=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[O.f].actualCostExisting=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[O.k].actualCostExisting=t.data.batch.invoicePlatinumCost/100;for(var a=0,s=t.data.nextStatuses;a<s.length;a++){var d=s[a];d.currentStatusId===t.data.batch.status.id&&(t.state.nextStatus=d)}t.data.batch.status.incomingBatched?t.data.incomingBatch=!0:t.data.outgoingBatch=!0;for(var l=0,r=o.data.jobs.edges.concat(n.data.jobs.edges);l<r.length;l++){var u=r[l];u=JSON.parse(JSON.stringify(u));for(var p=0,b=0,g=((i={})["Cast & Mount"]=null,i.Finishing=null,i.Plating=null,i.Engraving=null,i["Jump Ring"]=null,i["Earring Posts"]=null,i["Stone Setting"]=null,i.Resizing=null,i.Repairing=null,i.Duplicate=null,i.Other=null,i.Hallmarking=null,i),m=0,f=u.node.jobActions.edges;m<f.length;m++){var h=f[m];g[h.node.action.name]=h,p+=h.node.estimatedLaborCost,b+=h.node.estimatedMetalCost}t.metalsInBatch[u.node.submission.baseMetal.name].estimateCost+=b,t.data.totalEstLaborCost+=p,t.data.totalEstMetalCost+=b,t.data.jobCount++;var C=0;if(u.node.submission.jobs.edges.length<=1)for(var S=0,y=u.node.submission.payments.edges;S<y.length;S++){var j=y[S];j.node.success&&(C+=j.node.amount)}switch(t.data.totalPayments+=C,u.node.submission.jewelleryType.name){case v.e:t.data.ringCount++;break;case v.d:t.data.pendantCount++;break;case v.c:t.data.earringCount++}t.metalsInBatch[u.node.submission.baseMetal.name].present=!0,t.data.submissionInfos.push({job:u.node,jobActions:g,jobLabourCostEst:p,jobMetalCostEst:b,jobTotalCostEst:p+b,jobActionsFromRequest:u.node.jobActions.edges,numericId:t.getNumericId(u.node.submission.id),pendingUpdateJob:!1,printing:!1,selected:!1,stones:[],notes:[],submission:u.node.submission,jobPayments:C})}for(var I=0,A=Object.keys(t.metalsInBatch);I<A.length;I++){var J=A[I];t.data.totalActualCost+=t.metalsInBatch[J].actualCostExisting,t.data.totalEstimatedCost+=t.metalsInBatch[J].estimateCost}t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalEstimatedCost+=t.data.totalEstLaborCost,t.data.totalActualCost+=t.model.deliveryCostExisting,t.state.isAdmin=t.appUserService.isAdmin(c.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(c.data.appUser.roles);for(var V=[],k=0,w=t.data.submissionInfos;k<w.length;k++)V.push(w[k].submission.id);t.state.loadingJobActions=!1,t.state.isAdmin&&(t.state.loadingActions=!0,t.actionService.list().subscribe((function(e){t.data.actions=e.data.actions.edges,t.state.loadingActions=!1}))),t.stoneSubmissionService.listBySubmission(V).subscribe((function(e){for(var i=0,o=t.data.submissionInfos;i<o.length;i++)for(var n=o[i],c=0,a=e.data.stoneSubmissions.edges;c<a.length;c++){var s=a[c];s.node.submission.id===n.submission.id&&n.stones.push(s)}t.state.loadingStones=!1})),t.state.loading=!1,t.submissionNoteService.listBySubmission(V).subscribe((function(e){for(var i=0,o=t.data.submissionInfos;i<o.length;i++)for(var n=o[i],c=0,a=e.data.submissionNotes.edges;c<a.length;c++){var s=a[c];s.node.submission.id===n.submission.id&&n.notes.push(s)}t.state.loadingNotes=!1}))}))}))},t.prototype.updateStatus=function(t){return _e(this,void 0,void 0,(function(){var t,e,i=this;return qe(this,(function(o){return this.state.submitting||!this.state.nextStatus||(this.state.submitting=!0,this.toastr.success(null,"Updating Batch"),t=(new Date).toISOString(),e=this.data.batch.dateSent,this.state.nextStatus.currentStatusId===T.k.id&&(e=t),this.submissionBatchService.update({id:this.data.batch.id,status:this.state.nextStatus.setStatus.id,updatedAt:t,dateSent:e}).subscribe((function(t){i.data.batch.status=i.state.nextStatus.setStatus,i.data.batch.dateSent=e,i.data.selections=[];for(var o=0,n=i.data.submissionInfos;o<n.length;o++)n[o].selected=!1;i.state.nextStatus=null;for(var c=0,a=i.data.nextStatuses;c<a.length;c++){var s=a[c];s.currentStatusId===t.data.updateSubmissionBatch.submissionBatch.status.id&&(i.state.nextStatus=s)}i.toastr.success(null,"Batch Updated!"),i.state.submitting=!1}))),[2]}))}))},t.prototype.selectRow=function(t){if(!this.state.submitting)if(this.state.nextStatus&&this.state.nextStatus.takeMetalWeight&&!t.submission.metalWeight)this.toastr.info("","Please enter a Metal Weight for this item before confirming");else if(t.selected){t.selected=!1;var e=this.data.selections.findIndex((function(e){return e.submission.id===t.submission.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t)},t.prototype.selectAll=function(){if(!this.state.loading){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.submissionInfos;t<e.length;t++)(n=e[t]).selected=!0,this.selectRow(n);for(var i=0,o=this.data.submissionInfos;i<o.length;i++){var n;(n=o[i]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(n)&&this.data.selections.push(n)}}},t.prototype.setRush=function(t,e){this.state.isAdmin&&(e.stopPropagation(),t.pendingUpdateJob?(t.job.rush=!t.job.rush,t.pendingUpdateJob=!1,this.updateJob(t)):(t.pendingUpdateJob=!0,setTimeout((function(){t.pendingUpdateJob=!1}),3e3)))},t.prototype.updateJob=function(t){var e=this;this.toastr.info("","Updating Job"),setTimeout((function(i){e.jobService.update({id:t.job.id,due:D.a.removeTimezone(new Date(t.job.due)),rush:t.job.rush}).subscribe((function(t){e.toastr.success("","Job Updated")}))}),250)},t.prototype.deleteJob=function(t){this.toastr.warning("Sorry pal, this feature isn't available yet.")},t.prototype.viewJobActionModal=function(t,e){var i=this;this.model.jobActions["Cast & Mount"]=null!==t.jobActions["Cast & Mount"],this.model.jobActions.Finishing=null!==t.jobActions.Finishing,this.model.jobActions.Plating=null!==t.jobActions.Plating,this.model.jobActions.Engraving=null!==t.jobActions.Engraving,this.model.jobActions["Jump Ring"]=null!==t.jobActions["Jump Ring"],this.model.jobActions["Earring Posts"]=null!==t.jobActions["Earring Posts"],this.model.jobActions["Stone Setting"]=null!==t.jobActions["Stone Setting"],this.model.jobActions.Resizing=null!==t.jobActions.Resizing,this.model.jobActions.Repairing=null!==t.jobActions.Repairing,this.model.jobActions.Other=null!==t.jobActions.Other,this.model.jobActions.Duplicate=null!==t.jobActions.Duplicate,this.model.jobActions.Hallmarking=null!==t.jobActions.Hallmarking,this.model.submissionInfo=t,this.modalService.open(e).result.then((function(){return _e(i,void 0,void 0,(function(){var e,i,o,n,c=this;return qe(this,(function(a){switch(a.label){case 0:e=function(e){var o;return qe(this,(function(n){switch(n.label){case 0:return i.model.jobActions[e]&&null===t.jobActions[e]?(i.toastr.success("","Adding action: "+e),o=i.data.actions.find((function(t){return t.node.name===e})),i.jobActionService.create({job:t.job.id,action:o.node.id,completed:!1}).subscribe((function(i){t.jobActions[i.data.createJobAction.jobAction.action.name]={node:i.data.createJobAction.jobAction},c.toastr.success("",e+" added!")})),[3,3]):[3,1];case 1:return i.model.jobActions[e]||null===t.jobActions[e]?[3,3]:(i.toastr.success("","Removing action: "+e),[4,i.jobActionService.delete(t.jobActions[e].node.id)]);case 2:n.sent(),t.jobActions[e]=null,i.toastr.success("",e+" removed!"),n.label=3;case 3:return[2]}}))},i=this,o=0,n=Object.keys(this.model.jobActions),a.label=1;case 1:return o<n.length?[5,e(n[o])]:[3,4];case 2:a.sent(),a.label=3;case 3:return o++,[3,1];case 4:return[2]}}))}))}),(function(){}))},t.prototype.viewJobCostsModal=function(t,e){this.state.viewingJobForCosts=t,this.modalService.open(e)},t.prototype.addJobActions=function(){},t.prototype.createPdf=function(t){return _e(this,void 0,void 0,(function(){var e=this;return qe(this,(function(i){return t.printing=!0,this.state.showToPrint="submission"+t.numericId,setTimeout((function(i){return _e(e,void 0,void 0,(function(){return qe(this,(function(e){switch(e.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(this.state.showToPrint),100)];case 1:return e.sent(),this.state.showToPrint=null,t.printing=!1,[2]}}))}))}),0),[2]}))}))},t.prototype.updateSubmission=function(t){return _e(this,void 0,void 0,(function(){return qe(this,(function(e){switch(e.label){case 0:return t.submission.metalWeight?(this.toastr.info("","Updating Submission"),[4,this.submissionService.update({id:t.submission.id,updatedAt:(new Date).toISOString(),metalWeight:t.submission.metalWeight})]):[2];case 1:return e.sent(),this.toastr.success("","Submission Updated"),[2]}}))}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.prototype.printAll=function(t,e){var i=this;this.data.selections.length||(this.state.printAll=!0),setTimeout((function(o){return _e(i,void 0,void 0,(function(){return qe(this,(function(i){switch(i.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(t),e)];case 1:return i.sent(),this.state.printAll=!1,[2]}}))}))}),10)},t.prototype.exportAddressData=function(){if(this.state.exporting=!0,this.data.selections.length<1)return this.toastr.error("You must select at least one submission."),void(this.state.exporting=!1);for(var t,e=[],i=[],o=0,n=this.data.selections;o<n.length;o++)t=this.exportDataService.flattenObject(n[o],e),i.push(t.data),e=t.headers;this.exportDataService.whiteListColumns(["submission.id","fullName","address1","address2","city","county","postcode","country","email","castingCode"],i),this.exportDataService.renameColumns({"submission.id":"Order Reference"},i),this.exportDataService.addStaticValues({weight:.03,packageSize:"large letter",serviceCode:"BPR1",serviceRegisterCode:"01"},i),this.exportDataService.exportToCsv("submission_export_"+(new Date).toLocaleString(),Object.keys(i[0]),i),this.toastr.success("Exported and downloading file"),this.state.exporting=!1},t.prototype.liveTimeCreate=function(){var t=new Date;this.liveTime=("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},t.prototype.startTimer=function(){var t=this;this.timeElapsed=0,this.interval=setInterval((function(){t.timeElapsed++}),1e3)},t.prototype.endTimer=function(){clearInterval(this.interval)},t.prototype.toggleSubmissionPhotoTimer=function(t){return _e(this,void 0,void 0,(function(){var e,i,o;return qe(this,(function(n){switch(n.label){case 0:this.state.submitting=!0,e=0,i=this.data.submissionInfos,n.label=1;case 1:return e<i.length?(o=i[e]).submission.id!==t?[3,6]:this.data.submissionPhotoTimingMap[o.submission.id]?[3,3]:[4,this.createImageLoggingSession(o.submission)]:[3,9];case 2:return n.sent(),[3,5];case 3:return[4,this.endImageLoggingSession(o.submission)];case 4:n.sent(),n.label=5;case 5:return[3,8];case 6:return this.data.submissionPhotoTimingMap[o.submission.id]?(this.data.submissionPhotoTimingMap[o.submission.id]=!1,[4,this.endImageLoggingSession(o.submission)]):[3,8];case 7:n.sent(),n.label=8;case 8:return e++,[3,1];case 9:return this.state.submitting=!1,[2]}}))}))},t.prototype.createImageLoggingSession=function(t){return _e(this,void 0,void 0,(function(){var e,i,o,n;return qe(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),e=(new Date).toISOString(),i=this.data.createImageLoggingSessionMap,o=t.id,[4,this.imageLoggingSessionService.create({startTime:e,submission:t.id})];case 1:return i[o]=c.sent(),this.imageLoggingSessionState=!0,this.startTimer(),this.toastr.success("Started photo timing session for submission "+t.jewelleryType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!this.data.submissionPhotoTimingMap[t.id],[3,3];case 2:return n=c.sent(),this.toastr.error("Error starting image logging session!"),console.error(n),[3,3];case 3:return[2]}}))}))},t.prototype.endImageLoggingSession=function(t){return _e(this,void 0,void 0,(function(){var e;return qe(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.imageLoggingSessionService.updateEndTime({id:this.data.createImageLoggingSessionMap[t.id].createImageLoggingSession.imageLoggingSession.id,endTime:(new Date).toISOString()})];case 1:return i.sent(),this.imageLoggingSessionState=!1,this.endTimer(),this.toastr.success("Ended photo timing session for "+t.jewelleryType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!1,[3,3];case 2:return e=i.sent(),this.toastr.error("Error stopping image logging session!"),console.error(e),[3,3];case 3:return[2]}}))}))},t.prototype.onSubmit=function(){var t=this;this.data.batch.journalReference?this.toastr.warning("Cannot modify the invoice details until the journal has been deleted"):this.model.invoice?(this.state.submitting=!0,this.submissionBatchService.update({id:this.data.batch.id,updatedAt:(new Date).toISOString(),invoice:this.model.invoice,invoiced:this.model.invoiced,invoiceLabourCost:this.formatCurrency(this.model.labourCostStaging),invoiceDeliveryCost:this.formatCurrency(this.model.deliveryCostStaging),invoiceSilverCost:this.formatCurrency(this.metalsInBatch[O.l].actualCostStaging),invoice9ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[O.j].actualCostStaging),invoice9ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[O.h].actualCostStaging),invoice9ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[O.i].actualCostStaging),invoice14ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[O.d].actualCostStaging),invoice14ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[O.b].actualCostStaging),invoice14ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[O.c].actualCostStaging),invoice18ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[O.g].actualCostStaging),invoice18ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[O.e].actualCostStaging),invoice18ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[O.f].actualCostStaging),invoicePlatinumCost:this.formatCurrency(this.metalsInBatch[O.k].actualCostStaging)}).subscribe((function(e){var i=e.data.updateSubmissionBatch.submissionBatch;t.model.labourCostExisting=i.invoiceLabourCost/100,t.model.deliveryCostExisting=i.invoiceDeliveryCost/100,t.metalsInBatch[O.l].actualCostExisting=i.invoiceSilverCost/100,t.metalsInBatch[O.j].actualCostExisting=i.invoice9ctYellowGoldCost/100,t.metalsInBatch[O.h].actualCostExisting=i.invoice9ctRoseGoldCost/100,t.metalsInBatch[O.i].actualCostExisting=i.invoice9ctWhiteGoldCost/100,t.metalsInBatch[O.d].actualCostExisting=i.invoice14ctYellowGoldCost/100,t.metalsInBatch[O.b].actualCostExisting=i.invoice14ctRoseGoldCost/100,t.metalsInBatch[O.c].actualCostExisting=i.invoice14ctWhiteGoldCost/100,t.metalsInBatch[O.g].actualCostExisting=i.invoice18ctYellowGoldCost/100,t.metalsInBatch[O.e].actualCostExisting=i.invoice18ctRoseGoldCost/100,t.metalsInBatch[O.f].actualCostExisting=i.invoice18ctWhiteGoldCost/100,t.metalsInBatch[O.k].actualCostExisting=i.invoicePlatinumCost/100,t.data.totalActualCost=0;for(var o=0,n=Object.keys(t.metalsInBatch);o<n.length;o++)t.data.totalActualCost+=t.metalsInBatch[n[o]].actualCostExisting;t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalActualCost+=t.model.deliveryCostExisting,t.data.batch.invoiced=t.model.invoiced,t.invoiceDataForm.form.markAsPristine(),t.toastr.success("","Batch Updated"),t.state.submitting=!1}))):this.toastr.warning("In order to update batch costs, please add an invoice number","Warning")},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.prototype.objectKeys=function(t){return Object.keys(t)},t.prototype.chartClicked=function(t){},t.prototype.chartHovered=function(t){},t.prototype.postJournalToXero=function(t){var e=this,i=this.getNumericId(this.data.batch.id);this.state.postingJournal=!0,this.submissionBatchService.postSubmissionBatchJournalToXero(i).subscribe((function(t){if(!t.valid)return e.toastr.error(t.message,"Failed"),void(e.state.postingJournal=!1);e.data.batch.journalReference=t.data.manualJournalID,e.data.batch.journalPostedAt=(new Date).toUTCString(),e.toastr.success(t.message,"Success"),e.state.postingJournal=!1}))},t.\u0275fac=function(e){return new(e||t)(p.jc(f.a),p.jc(f.b),p.jc(P),p.jc(Ie.a),p.jc(F.a),p.jc(Ae.a),p.jc(Je.a),p.jc(R.a),p.jc(W.a),p.jc(_.i),p.jc(q.a),p.jc(L.a),p.jc(X.a),p.jc($.a),p.jc(Q.b))},t.\u0275cmp=p.dc({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&p.od(Le,5),2&t&&p.Sc(i=p.zc())&&(e.invoiceDataForm=i.first)},hostBindings:function(t,e){1&t&&p.yc("beforeunload",(function(t){return e.unloadNotification(t)}),!1,p.Vc)},decls:13,vars:7,consts:[[3,"title",4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","batch-table-container row mt-5",4,"ngIf"],["id","jobLabels",1,"pdfLabel"],[4,"ngFor","ngForOf"],["id","idLabels",1,"pdfLabel"],["jobActionsModal",""],["jobCostsModal",""],["size","100",4,"ngIf"],[3,"title"],[1,"container-fluid"],[1,"row"],[1,"col-lg-12","col-xl-5"],[1,"row","mb-4"],[1,"col"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"col-md-6"],[1,"col-auto"],[4,"ngIf"],[1,"pr-2"],[1,"mt-2"],["class","btn btn-outline-primary mr-2",3,"disabled","click",4,"ngIf"],["class","btn btn-outline-primary mr-2",3,"click",4,"ngIf"],["class","col-lg-12 col-xl-7",4,"ngIf"],[1,"border-top"],[1,"btn","btn-outline-primary","mr-2",3,"disabled","click"],[1,"btn","btn-outline-primary","mr-2",3,"click"],[1,"col-lg-12","col-xl-7"],[1,"col-xl-4","col-lg-6","col-md-12","mb-4"],[3,"ngSubmit"],["batchInvoiceDataForm","ngForm"],[1,"row","mb-2"],[1,"form-group"],["for","invoice",1,"req"],["appShowErrorInputClass","","id","invoice","maxlength","50","name","invoice","placeholder","Invoice number","required","","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"checkbox-wrapper","with-label"],["id","invoicedCheckbox","name","invoicedCheckbox","type","checkbox",3,"disabled","ngModel","ngModelChange"],["for","invoicedCheckbox"],[1,"row","justify-content-end"],["type","submit",1,"btn","btn-lg","btn-primary","float-right","fas",3,"disabled"],["aria-hidden","true","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["class","col-xl-8 col-lg-6 col-md-12",4,"ngIf"],[1,"form-group","mb-2"],["for","labour"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","id","labour","limitDecimalPlaces","","min","0","name","labour","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["class","row",4,"ngIf"],["for","delivery"],["appShowErrorInputClass","","id","delivery","limitDecimalPlaces","","min","0","name","delivery","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","silver"],["appShowErrorInputClass","","id","silver","limitDecimalPlaces","","min","0","name","silver","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctYellow"],["appShowErrorInputClass","","id","invoice9ctYellow","limitDecimalPlaces","","min","0","name","invoice9ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctRose"],["appShowErrorInputClass","","id","invoice9ctRose","limitDecimalPlaces","","min","0","name","invoice9ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctWhite"],["appShowErrorInputClass","","id","invoice9ctWhite","limitDecimalPlaces","","min","0","name","invoice9ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctYellow"],["appShowErrorInputClass","","id","invoice14ctYellow","limitDecimalPlaces","","min","0","name","invoice14ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctRose"],["appShowErrorInputClass","","id","invoice14ctRose","limitDecimalPlaces","","min","0","name","invoice14ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctWhite"],["appShowErrorInputClass","","id","invoice14ctWhite","limitDecimalPlaces","","min","0","name","invoice14ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctYellow"],["appShowErrorInputClass","","id","invoice18ctYellow","limitDecimalPlaces","","min","0","name","invoice18ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctRose"],["appShowErrorInputClass","","id","invoice18ctRose","limitDecimalPlaces","","min","0","name","invoice18ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctWhite"],["appShowErrorInputClass","","id","invoice18ctWhite","limitDecimalPlaces","","min","0","name","invoice18ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["for","invoicePlatinum"],["appShowErrorInputClass","","id","invoicePlatinum","limitDecimalPlaces","","min","0","name","invoicePlatinum","placeholder","","step","0.01","type","number",1,"form-control",3,"disabled","ngModel","decimalPlaces","ngModelChange"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],[1,"col-xl-8","col-lg-6","col-md-12"],[1,"table","bs-table","table-sm"],[1,"text-muted"],["class","col",4,"ngIf"],[1,"btn","btn-secondary","xero","float-right","fas",3,"disabled","click"],[1,"text-muted","text-right","small","mb-0"],["target","_blank",3,"href"],[1,"batch-table-container","row","mt-5"],[1,"mb-2"],[1,"table-responsive"],[1,"data-table"],["class","checkbox sm",4,"ngIf"],["scope","col",1,"sm"],["scope","col"],["scope","col","style","min-width: 120px;",4,"ngIf"],["scope","col",4,"ngIf"],["colspan","72","scope","row"],["class","tc mt-5",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"checkbox","sm"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["scope","col",2,"min-width","120px"],["class","pr-0 checkbox","scope","row",4,"ngIf"],["scope","row",1,"sm"],[3,"photos"],[1,"sm"],[1,"sm","muted"],[1,"sm",3,"click"],["class","color-warning fas fa-circle",4,"ngIf"],[1,"tr"],[1,"btn-group"],["class","btn hover icon-btn-outline mx-1 fas fa-cogs color-primary","ngbTooltip","Edit Job Actions","type","button",3,"disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-pound-sign","type","button",3,"click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas","type","button",3,"fa-print","disabled","click",4,"ngIf"],["class","btn icon-btn-outline mx-1 fas","type","button",3,"fa-camera","fa-stop","hover","disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-trash","type","button",3,"click",4,"ngIf"],[3,"customerNote","hover","isAdmin","loadingNotes","notes","submissionId"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission",4,"ngIf"],["scope","row",1,"pr-0","checkbox"],["type","checkbox",3,"ngModel","name","id","click","ngModelChange"],[3,"for"],["class","fa fa-shipping-fast text-primary",3,"ngbTooltip",4,"ngIf"],["class","fa fa-shipping-fast text-muted",3,"ngbTooltip",4,"ngIf"],[1,"fa","fa-shipping-fast","text-primary",3,"ngbTooltip"],[1,"fa","fa-shipping-fast","text-muted",3,"ngbTooltip"],[1,"color-warning","fas","fa-circle"],["name","dueDate","placeholder","Due Date","required","",1,"form-control",3,"ngModel","owlDateTimeTrigger","owlDateTime","max","ngModelChange"],[3,"pickerType"],["dt2",""],["min","0","name","metalWeight","placeholder","Metal Weight (g)","required","","type","number",3,"ngModel","blur","ngModelChange"],["class","small muted",4,"ngIf"],[1,"small","muted"],["ngbTooltip","Edit Job Actions","type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-cogs","color-primary",3,"disabled","click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-pound-sign",3,"click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas",3,"disabled","click"],["type","button",1,"btn","icon-btn-outline","mx-1","fas",3,"disabled","click"],["aria-hidden","true","class","spinner-border spinner-border-sm",4,"ngIf"],["aria-hidden","true",1,"spinner-border","spinner-border-sm"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-trash",3,"click"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission"],[1,"tc","mt-5"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-center"],[3,"size"],[3,"hidden","id"],[1,"size-label","manufacturing","page"],[1,"label-inner-wrapper"],[1,"tin-size"],["border","0",1,"logoTable","mb-2","w-100"],["valign","middle"],["alt","CAST Logo","src","/assets/img/cast-logo-black.png",3,"width"],[1,"text-right"],[3,"bc-display-value","bc-element-type","bc-height","bc-value","bc-width"],[1,"footer"],["id","printPdf","name","printPdf"],[1,"job_details","mb-1"],[3,"colSpan"],["class","fa fa-shipping-fast mr-2",3,"ngbTooltip",4,"ngIf"],[3,"colSpan",4,"ngIf"],["class","job_details mb-1",4,"ngIf"],[1,"row","label-jobs","align-content-start"],[1,"action","col-2"],[1,"fa","fa-shipping-fast","mr-2",3,"ngbTooltip"],["valign","top",1,"notes"],[1,"size-label","page"],[1,"tin-size",2,"display","table-cell","vertical-align","middle"],[2,"width","100%"],["name","printPdf",1,"printIframeContainer"],["title","Add/Remove Job Actions",3,"modal"],[1,"modal-body"],["novalidate",""],["updateJobActionsForm","ngForm"],["class","col-sm-4 mb-3 tc",4,"ngFor","ngForOf"],[3,"form","modal","saveButtonName","modalSaved"],[1,"col-sm-4","mb-3","tc"],[1,"tc",3,"for"],["appShowErrorInputClass","","type","checkbox",1,"form-control",3,"ngModel","id","name","ngModelChange"],[3,"modal","title"],["size","100"]],template:function(t,e){1&t&&(p.gd(0,$e,1,1,"page-title",0),p.gd(1,Ge,1,1,"page-title",0),p.gd(2,Ii,59,23,"div",1),p.gd(3,io,37,8,"div",2),p.pc(4,"div",3),p.gd(5,Ao,18,17,"ng-container",4),p.pc(6,"div",5),p.gd(7,ko,22,13,"ng-container",4),p.oc(),p.oc(),p.gd(8,Mo,8,7,"ng-template",null,6,p.hd),p.gd(10,Po,16,5,"ng-template",null,7,p.hd),p.gd(12,To,1,0,"loading-ring",8)),2&t&&(p.Jc("ngIf",e.state.isAdmin),p.Vb(1),p.Jc("ngIf",e.state.isSupplier),p.Vb(1),p.Jc("ngIf",!e.state.loading),p.Vb(1),p.Jc("ngIf",!e.state.loading),p.Vb(2),p.Jc("ngForOf",e.data.submissionInfos),p.Vb(2),p.Jc("ngForOf",e.data.selections),p.Vb(5),p.Jc("ngIf",e.state.loading))},directives:[b.p,b.o,Xt.a,g.x,g.n,g.o,g.d,Zt.a,g.g,g.u,g.m,g.p,g.a,g.j,g.r,te.a,Me,xe.a,_.l,Pe.c,Pe.e,Pe.b,Te.a,Kt.a,Be.a,Ve.a,De.a],pipes:[Ee.a,Oe.a,Ne.a,Fe.a,b.y,b.f,Re.a,We.a,b.e,b.A,b.i],styles:[""]}),t}();function Eo(t,e){1&t&&(p.pc(0,"th",7),p.id(1,"Parent"),p.oc())}function Oo(t,e){if(1&t&&(p.pc(0,"td"),p.id(1),p.Dc(2,"titlecase"),p.oc()),2&t){var i=p.Cc(2).$implicit;p.bc("muted",!i.node.parent),p.Vb(1),p.kd(" ",i.node.parent?p.Ec(2,3,i.node.parent.company):"None"," ")}}function No(t,e){if(1&t&&(p.pc(0,"tr"),p.pc(1,"th",11),p.id(2),p.Dc(3,"numericId"),p.oc(),p.pc(4,"td"),p.id(5),p.Dc(6,"titlecase"),p.oc(),p.pc(7,"td"),p.id(8),p.Dc(9,"titlecase"),p.oc(),p.gd(10,Oo,3,5,"td",12),p.kc(11,"td",13),p.oc()),2&t){var i=p.Cc().$implicit,o=p.Cc(2);p.Vb(2),p.kd("#",p.Ec(3,4,i.node.id),""),p.Vb(3),p.jd(p.Ec(6,6,i.node.company)),p.Vb(3),p.jd(i.node.contactName?p.Ec(9,8,i.node.contactName):""),p.Vb(2),p.Jc("ngIf",o.state.isAdmin)}}function Fo(t,e){if(1&t&&(p.nc(0),p.gd(1,No,12,10,"tr",10),p.mc()),2&t){var i=e.$implicit,o=p.Cc(2);p.Vb(1),p.Jc("ngIf",i.node.parent||o.state.isAdmin)}}function Ro(t,e){if(1&t&&(p.pc(0,"div",5),p.pc(1,"table",6),p.pc(2,"thead"),p.pc(3,"tr"),p.pc(4,"th"),p.id(5,"ID"),p.oc(),p.pc(6,"th",7),p.id(7,"Supplier"),p.oc(),p.pc(8,"th",7),p.id(9,"Contact Name"),p.oc(),p.gd(10,Eo,2,0,"th",8),p.kc(11,"th",7),p.oc(),p.oc(),p.pc(12,"tbody"),p.gd(13,Fo,2,1,"ng-container",9),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc();p.Vb(10),p.Jc("ngIf",i.state.isAdmin),p.Vb(3),p.Jc("ngForOf",i.data.suppliers)}}function Wo(t,e){1&t&&p.kc(0,"loading-ring",14),2&t&&p.Jc("size",60)}var _o=[{path:"incoming-batches",component:ye},{path:"jobs",component:Qt},{path:"outgoing-batches",component:ye},{path:"create-supplier",component:pe},{path:"suppliers",component:function(){function t(t,e,i){this.appUserService=t,this.supplierService=e,this.toastrService=i,this.data={suppliers:[]},this.state={isAdmin:!1,loading:!0}}return t.prototype.ngOnInit=function(){var t=this;this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles)})),this.supplierService.list(null).subscribe((function(e){for(var i=0,o=e.data.suppliers.edges;i<o.length;i++)t.data.suppliers.push(o[i]);t.state.loading=!1}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.\u0275fac=function(e){return new(e||t)(p.jc(F.a),p.jc(U.a),p.jc(Q.b))},t.\u0275cmp=p.dc({type:t,selectors:[["app-supplier-view"]],decls:5,vars:3,consts:[[3,"title"],[1,"batch-table-container","row","mt-5"],[1,"col"],["class","table-responsive",4,"ngIf"],[3,"size",4,"ngIf"],[1,"table-responsive"],[1,"data-table"],["scope","col"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["scope","row"],[3,"muted",4,"ngIf"],[1,"sm"],[3,"size"]],template:function(t,e){1&t&&(p.kc(0,"page-title",0),p.pc(1,"div",1),p.pc(2,"div",2),p.gd(3,Ro,14,2,"div",3),p.gd(4,Wo,1,1,"loading-ring",4),p.oc(),p.oc()),2&t&&(p.Jc("title","Supplier List"),p.Vb(3),p.Jc("ngIf",!e.state.loading),p.Vb(1),p.Jc("ngIf",e.state.loading))},directives:[Xt.a,b.p,b.o,Kt.a],pipes:[Re.a,b.y],styles:[""]}),t}()},{path:"batches/view/:id",component:Do}],qo=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.hc({type:t}),t.\u0275inj=p.gc({imports:[[f.f.forChild(_o)],f.f]}),t}();function Lo(t,e){if(1&t&&(p.pc(0,"div",7),p.pc(1,"strong"),p.id(2),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(2),p.jd(i._jobAction.node.action.name)}}function $o(t,e){1&t&&p.kc(0,"span",11)}function Go(t,e){1&t&&(p.pc(0,"div",12),p.kc(1,"i",13),p.oc())}function Ho(t,e){if(1&t){var i=p.qc();p.pc(0,"div",8),p.yc("click",(function(t){p.Wc(i);var e=p.Cc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),p.gd(1,$o,1,0,"span",9),p.gd(2,Go,2,0,"div",10),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(1),p.Jc("ngIf",!o.expandedFormat),p.Vb(1),p.Jc("ngIf",o.expandedFormat)}}function zo(t,e){if(1&t){var i=p.qc();p.pc(0,"div",14),p.pc(1,"span",15),p.yc("click",(function(t){p.Wc(i);var e=p.Cc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Jc("ngbTooltip",o._jobAction.node.action.name+" at "+o._jobAction.node.job.currentlyWith.company)}}function Yo(t,e){if(1&t){var i=p.qc();p.pc(0,"div"),p.pc(1,"div",16),p.yc("click",(function(t){return p.Wc(i),p.Cc(2).confirmed(t)})),p.pc(2,"span",17),p.id(3," Confirm "),p.oc(),p.oc(),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(1),p.bc("awaiting",o.state.confirming)}}function Uo(t,e){1&t&&p.kc(0,"span",20)}function Qo(t,e){1&t&&(p.pc(0,"div",21),p.kc(1,"i",13),p.oc())}function Xo(t,e){if(1&t){var i=p.qc();p.pc(0,"div",8),p.yc("click",(function(t){p.Wc(i);var e=p.Cc(2);return e.showConfirmAction(e.jobStateNotStarted,t)})),p.gd(1,Uo,1,0,"span",18),p.gd(2,Qo,2,0,"div",19),p.oc()}if(2&t){var o=p.Cc(2);p.Vb(1),p.Jc("ngIf",!o.expandedFormat),p.Vb(1),p.Jc("ngIf",o.expandedFormat)}}function Ko(t,e){if(1&t&&(p.pc(0,"div"),p.pc(1,"p",22),p.id(2),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(2),p.jd(i.descriptions[i._jobAction.node.action.name])}}function Zo(t,e){if(1&t&&(p.nc(0),p.pc(1,"div",3),p.gd(2,Lo,3,1,"div",4),p.gd(3,Ho,3,2,"div",5),p.gd(4,zo,2,1,"div",6),p.gd(5,Yo,4,2,"div",0),p.gd(6,Xo,3,2,"div",5),p.gd(7,Ko,3,1,"div",0),p.oc(),p.mc()),2&t){var i=p.Cc();p.Vb(1),p.bc("complete",i._jobAction.node.completed&&!i.state.loading)("expanded",i.expandedFormat),p.Vb(1),p.Jc("ngIf",i.expandedFormat),p.Vb(1),p.Jc("ngIf",!i.state.confirming&&!i._jobAction.node.started&&!i._jobAction.node.completed),p.Vb(1),p.Jc("ngIf",!i.state.confirming&&i._jobAction.node.started&&!i._jobAction.node.completed),p.Vb(1),p.Jc("ngIf",i.state.confirming),p.Vb(1),p.Jc("ngIf",!i.state.confirming&&i._jobAction.node.completed),p.Vb(1),p.Jc("ngIf",i.expandedFormat&&i.descriptions[i._jobAction.node.action.name])}}function tn(t,e){if(1&t&&(p.pc(0,"div",7),p.id(1),p.oc()),2&t){var i=p.Cc(2);p.Vb(1),p.kd(" ",i.placeholder," ")}}function en(t,e){1&t&&p.kc(0,"div",25)}function on(t,e){if(1&t&&(p.pc(0,"div",23),p.gd(1,tn,2,1,"div",4),p.gd(2,en,1,0,"div",24),p.oc()),2&t){var i=p.Cc();p.bc("expanded",i.expandedFormat),p.Vb(1),p.Jc("ngIf",i.expandedFormat),p.Vb(1),p.Jc("ngIf",i.expandedFormat)}}function nn(t,e){if(1&t&&(p.pc(0,"div",3),p.kc(1,"span",26),p.oc()),2&t){var i=p.Cc();p.bc("expanded",i.expandedFormat)}}function cn(t,e){if(1&t&&(p.pc(0,"div",3),p.kc(1,"span",26),p.oc()),2&t){var i=p.Cc();p.bc("expanded",i.expandedFormat)}}var an=function(){function t(t){this.toastrService=t,this.jobStateNotStarted="notStarted",this.jobStateCompleted="completed",this.confirmActionTimeout=null,this.placeholder=null,this.description=null,this.expandedFormat=null,this._onHold=null,this.state={confirming:!1,fakeLoading:!1,futureJobState:null,loading:!0},this.descriptions={},this.baseMetal=null,this.plating=null,this.finish=null,this.resizeTo=null,this.duplicates=null,this.confirmedAction=new p.u}return Object.defineProperty(t.prototype,"jobAction",{set:function(t){this._jobAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loading",{set:function(t){this.state.loading=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullFormat",{set:function(t){this.expandedFormat=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderName",{set:function(t){this.placeholder=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descriptor",{set:function(t){this.description=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHold",{set:function(t){this._onHold=t},enumerable:!1,configurable:!0}),t.prototype.confirmed=function(t){var e=this;t.stopPropagation(),clearTimeout(this.confirmActionTimeout),this.confirmActionTimeout=null,this.state.confirming=!1,this.state.fakeLoading=!0,this.state.futureJobState===this.jobStateNotStarted?(this._jobAction.node.started=!1,this._jobAction.node.startedAt=null,this._jobAction.node.completed=!1,this._jobAction.node.completedAt=null):this.state.futureJobState===this.jobStateCompleted&&(this._jobAction.node.completed=!0,this._jobAction.node.completedAt=(new Date).toISOString()),this.state.futureJobState=null,this.confirmedAction.emit(this._jobAction),setTimeout((function(){e.state.fakeLoading=!1}),800)},t.prototype.showConfirmAction=function(t,e){var i=this;this._onHold?this.toastrService.warning(null,"Item is on hold"):(e.stopPropagation(),this.state.confirming=!0,this.state.futureJobState=t,this.confirmActionTimeout=setTimeout((function(){i.state.futureJobState=null,i.state.confirming=!1}),3e3))},t.prototype.ngOnChanges=function(t){this._jobAction&&(this.baseMetal&&(this.descriptions["Cast & Mount"]="in "+this.baseMetal),this.plating&&(this.descriptions.Plating="in "+this.plating),this.finish&&(this.descriptions.Finishing=this.finish),this.resizeTo&&(this.descriptions.Resizing="to size "+this.resizeTo.toUpperCase()),this.duplicates&&(this.descriptions.Duplicate="Original + "+this.duplicates+" Duplicates"))},t.\u0275fac=function(e){return new(e||t)(p.jc(Q.b))},t.\u0275cmp=p.dc({type:t,selectors:[["toggle-job-action-complete"]],inputs:{jobAction:"jobAction",loading:"loading",fullFormat:"fullFormat",placeholderName:"placeholderName",descriptor:"descriptor",onHold:"onHold",baseMetal:"baseMetal",plating:"plating",finish:"finish",resizeTo:"resizeTo",duplicates:"duplicates"},outputs:{confirmedAction:"confirmedAction"},features:[p.Tb],decls:4,vars:4,consts:[[4,"ngIf"],["class","action-toggler not-required",3,"expanded",4,"ngIf"],["class","action-toggler",3,"expanded",4,"ngIf"],[1,"action-toggler"],["class","title",4,"ngIf"],[3,"click",4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],[1,"title"],[3,"click"],["class","job-incomplete color-muted far fa-circle fa-2x",4,"ngIf"],["class","toggle-button incomplete",4,"ngIf"],[1,"job-incomplete","color-muted","far","fa-circle","fa-2x"],[1,"toggle-button","incomplete"],[1,"fas","fa-check"],[3,"ngbTooltip"],[1,"color-info","far","fa-clock","fa-2x",3,"click"],[1,"double-confirm-container",3,"click"],[1,"confirm-button"],["class","color-success fas fa-check fa-2x",4,"ngIf"],["class","toggle-button complete",4,"ngIf"],[1,"color-success","fas","fa-check","fa-2x"],[1,"toggle-button","complete"],[1,"mb-0","pt-2","text-muted","small",2,"line-height","1.1"],[1,"action-toggler","not-required"],["class","toggle-button",4,"ngIf"],[1,"toggle-button"],[1,"color-muted","fa","fa-circle-notch","fa-spin","fa-2x"]],template:function(t,e){1&t&&(p.gd(0,Zo,8,10,"ng-container",0),p.gd(1,on,3,4,"div",1),p.gd(2,nn,2,2,"div",2),p.gd(3,cn,2,2,"div",2)),2&t&&(p.Jc("ngIf",e._jobAction&&!e.state.fakeLoading),p.Vb(1),p.Jc("ngIf",!e._jobAction&&!e.state.loading),p.Vb(1),p.Jc("ngIf",e.state.fakeLoading),p.Vb(1),p.Jc("ngIf",e.state.loading))},directives:[b.p,_.l],styles:[".action-toggler[_ngcontent-%COMP%]{text-align:center}.action-toggler[_ngcontent-%COMP%]   .job-incomplete[_ngcontent-%COMP%]{color:#dfe3e6}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]{background:#1c364c;border-radius:4px;color:#fff;padding:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none;text-transform:uppercase;font-weight:700;letter-spacing:.5px;background:linear-gradient(90deg,#1c364c 50%,#315e84 0);background-size:200% 100%;background-position:0 100%;cursor:pointer;font-size:12px}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container.awaiting[_ngcontent-%COMP%]{-webkit-animation:confirming-timeout-wipe 3s linear both;animation:confirming-timeout-wipe 3s linear both}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:6px}.action-toggler.expanded[_ngcontent-%COMP%]{padding:12px 10px 20px;text-align:center;border:2px solid #e1dcdc;border-radius:9px;transition:all .3s ease;height:100%;display:flex;flex-flow:column;justify-content:flex-start}.action-toggler.expanded[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{display:none!important}.action-toggler.expanded[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.action-toggler.expanded.complete[_ngcontent-%COMP%]{border-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:4px;margin:0 auto;background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;position:relative;line-height:35px}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]:hover{cursor:pointer}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]{background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.incomplete[_ngcontent-%COMP%]{background-color:#fff;box-shadow:inset 0 0 0 2px #c2c2c2}.action-toggler.expanded.not-required[_ngcontent-%COMP%], .action-toggler.expanded.not-required[_ngcontent-%COMP%]:focus, .action-toggler.expanded.not-required[_ngcontent-%COMP%]:hover{border:none!important}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{opacity:.5}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{background:#dadada;border:none}@-webkit-keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}@keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}"]}),t}(),sn=i("kvL/"),dn=i("ZOsW"),ln=i("c3nT"),rn=i("1lsF"),un=i("k4pO"),pn=i("UYcP"),bn=i("kIIl");function gn(t,e){1&t&&(p.pc(0,"span",27),p.id(1,"HD"),p.oc())}function mn(t,e){1&t&&(p.pc(0,"p",28),p.kc(1,"i",29),p.id(2," This job is ON HOLD "),p.oc())}function fn(t,e){1&t&&(p.pc(0,"p",28),p.kc(1,"i",30),p.id(2," This item is important. Extra care required. "),p.oc())}function hn(t,e){1&t&&(p.pc(0,"p",28),p.kc(1,"i",31),p.id(2," This job needs rushing through and completing ASAP! "),p.oc())}function vn(t,e){1&t&&(p.pc(0,"div",32),p.pc(1,"span",33),p.id(2,"On Hold"),p.oc(),p.oc())}function Cn(t,e){if(1&t&&(p.pc(0,"div",32),p.pc(1,"span",34),p.id(2,"Wedding"),p.oc(),p.id(3),p.Dc(4,"simpleDate"),p.oc()),2&t){var i=p.Cc(2);p.Vb(3),p.kd(" ",i.data.job.node.submission.specialDate?"Special date is "+p.Ec(4,1,i.data.job.node.submission.specialDate):""," ")}}function Sn(t,e){1&t&&(p.nc(0),p.pc(1,"div",2),p.kc(2,"loading-ring",35),p.pc(3,"p",36),p.id(4,"Loading job actions..."),p.oc(),p.oc(),p.mc())}function yn(t,e){if(1&t){var i=p.qc();p.nc(0),p.pc(1,"div",37),p.pc(2,"toggle-job-action-complete",38),p.yc("confirmedAction",(function(t){return p.Wc(i),p.Cc(2).updateJobAction(t)})),p.oc(),p.oc(),p.mc()}if(2&t){var o=e.$implicit,n=p.Cc(2);p.Vb(2),p.Jc("fullFormat",!0)("jobAction",o)("loading",n.data.loadingJobActions)("onHold",n.data.job.node.onHold)("baseMetal",n.data.job.node.submission.baseMetal.name)("plating",(null==n.data.job.node.submission?null:n.data.job.node.submission.plating.name)!==n.noPlating?n.data.job.node.submission.plating.name:null)("finish",n.data.job.node.submission.finish.name)("resizeTo",n.data.job.node.submission.ringResize?n.data.job.node.submission.ringSizeCustom.name:null)("duplicates",n.data.job.node.submission.duplicates)}}function jn(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",2),p.pc(2,"p",3),p.pc(3,"strong"),p.id(4,"Description"),p.oc(),p.oc(),p.pc(5,"p"),p.id(6),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(6),p.jd(i.data.job.node.submission.stoneDescription)}}function In(t,e){if(1&t&&(p.pc(0,"div",47),p.kc(1,"img",48),p.Dc(2,"lowercase"),p.Dc(3,"lowercase"),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(1),p.Mc("src","/assets/img/stones/",p.Ec(2,2,i.node.stoneType.name),"/",p.Ec(3,4,i.node.stoneType.name),"_side.png",p.Zc)}}function An(t,e){if(1&t&&(p.pc(0,"p",3),p.pc(1,"strong"),p.id(2),p.Dc(3,"titlecase"),p.oc(),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(2),p.jd(p.Ec(3,1,i.node.stoneType.name))}}function Jn(t,e){if(1&t&&(p.pc(0,"p",3),p.pc(1,"strong"),p.id(2),p.Dc(3,"titlecase"),p.oc(),p.oc()),2&t){var i=p.Cc().$implicit;p.Vb(2),p.kd("Custom: ",p.Ec(3,1,i.node.customName),"")}}function Vn(t,e){if(1&t&&(p.nc(0),p.pc(1,"div",41),p.pc(2,"p",3),p.pc(3,"strong"),p.id(4),p.oc(),p.oc(),p.pc(5,"div",42),p.pc(6,"div",43),p.gd(7,In,4,6,"div",44),p.pc(8,"div",45),p.gd(9,An,4,3,"p",46),p.gd(10,Jn,4,3,"p",46),p.pc(11,"p",5),p.id(12),p.kc(13,"br"),p.id(14),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.mc()),2&t){var i=e.$implicit,o=e.index;p.Vb(4),p.kd("Placement #",o+1,""),p.Vb(3),p.Jc("ngIf",!i.node.customName),p.Vb(1),p.Jc("ngClass",i.node.customName?"col-12":"col-8"),p.Vb(1),p.Jc("ngIf",!i.node.customName),p.Vb(1),p.Jc("ngIf",i.node.customName),p.Vb(2),p.kd(" ",i.node.stoneSize.name,""),p.Vb(2),p.kd(" Qty: ",i.node.number," ")}}function kn(t,e){if(1&t&&(p.pc(0,"div",1),p.gd(1,Vn,15,7,"ng-container",18),p.oc()),2&t){var i=p.Cc(3);p.Vb(1),p.Jc("ngForOf",i.data.stones)}}function wn(t,e){1&t&&(p.pc(0,"div",1),p.kc(1,"loading-ring",35),p.pc(2,"p"),p.id(3,"Loading stones setting config..."),p.oc(),p.oc())}function Mn(t,e){if(1&t&&(p.pc(0,"div",39),p.pc(1,"div",13),p.pc(2,"div",14),p.pc(3,"div",15),p.pc(4,"div",16),p.pc(5,"h5",5),p.id(6,"Stone Setting"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(7,"div",1),p.pc(8,"div",2),p.gd(9,jn,7,1,"div",40),p.gd(10,kn,2,1,"div",25),p.gd(11,wn,4,0,"div",25),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(9),p.Jc("ngIf",i.data.job.node.submission.stoneDescription),p.Vb(1),p.Jc("ngIf",i.data.stones.length),p.Vb(1),p.Jc("ngIf",!i.data.stones.length)}}function xn(t,e){if(1&t&&(p.pc(0,"div",49),p.pc(1,"div",13),p.pc(2,"div",14),p.pc(3,"div",15),p.pc(4,"div",16),p.pc(5,"h5",5),p.id(6,"Chain"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(7,"div",1),p.pc(8,"div",2),p.pc(9,"div",13),p.pc(10,"div",50),p.id(11,"Chain Type"),p.oc(),p.pc(12,"div",51),p.id(13),p.Dc(14,"titlecase"),p.oc(),p.oc(),p.pc(15,"div",13),p.pc(16,"div",50),p.id(17,"Chain Length"),p.oc(),p.pc(18,"div",51),p.id(19),p.Dc(20,"titlecase"),p.oc(),p.oc(),p.pc(21,"div",13),p.pc(22,"div",50),p.id(23,"Chain Plating"),p.oc(),p.pc(24,"div",51),p.id(25),p.Dc(26,"titlecase"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(13),p.jd(p.Ec(14,3,i.data.job.node.submission.chainType.name)),p.Vb(6),p.jd(p.Ec(20,5,i.data.job.node.submission.chainLength.name)),p.Vb(6),p.jd(p.Ec(26,7,i.data.job.node.submission.chainPlating.name))}}function Pn(t,e){if(1&t&&(p.pc(0,"div",52),p.pc(1,"div",13),p.pc(2,"div",14),p.pc(3,"div",15),p.pc(4,"div",16),p.pc(5,"h5",5),p.id(6,"Engraving"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(7,"div",1),p.pc(8,"div",2),p.pc(9,"div",13),p.pc(10,"div",50),p.id(11,"Engraving Text"),p.oc(),p.pc(12,"div",51),p.id(13),p.oc(),p.oc(),p.pc(14,"div",13),p.pc(15,"div",50),p.id(16,"Font Name"),p.oc(),p.pc(17,"div",51),p.id(18),p.oc(),p.oc(),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(13),p.jd(i.data.job.node.submission.engravingText),p.Vb(5),p.jd(i.data.job.node.submission.engravingFont)}}function Tn(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",55),p.id(2,"Duplicate"),p.oc(),p.pc(3,"div",41),p.id(4),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(4),p.kd("Original + ",i.data.job.node.submission.duplicates," Copies")}}function Bn(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",55),p.id(2,"Ring Size (Original)"),p.oc(),p.pc(3,"div",41),p.id(4),p.Dc(5,"titlecase"),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(4),p.jd(p.Ec(5,1,i.data.job.node.submission.originalRingSize.name))}}function Dn(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",55),p.id(2,"Ring Size (Measured)"),p.oc(),p.pc(3,"div",41),p.id(4),p.Dc(5,"uppercase"),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(4),p.jd(p.Ec(5,1,i.data.job.node.submission.measuredRingSize.name))}}function En(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",55),p.id(2,"Target Ring Size"),p.oc(),p.pc(3,"div",41),p.id(4),p.Dc(5,"uppercase"),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(4),p.jd(p.Ec(5,1,i.data.job.node.submission.ringSizeCustom.name))}}function On(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",55),p.id(2,"Jump Ring"),p.oc(),p.pc(3,"div",56),p.kc(4,"i"),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(3),p.Jc("ngClass",i.data.job.node.submission.jumpRing?"text-success":"text-danger"),p.Vb(1),p.Yb("fas ",i.data.job.node.submission.jumpRing?"fa-check":"fa-times","")}}function Nn(t,e){if(1&t&&(p.pc(0,"div",13),p.pc(1,"div",55),p.id(2,"Placement"),p.oc(),p.pc(3,"div",2),p.id(4),p.oc(),p.oc()),2&t){var i=p.Cc(3);p.Vb(4),p.kd(" ",i.data.job.node.submission.jumpRingPlacement," ")}}function Fn(t,e){if(1&t&&(p.pc(0,"div",53),p.pc(1,"div",13),p.pc(2,"div",14),p.pc(3,"div",15),p.pc(4,"div",24),p.pc(5,"h5",5),p.id(6,"Submission"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(7,"div",1),p.pc(8,"div",54),p.pc(9,"div",13),p.pc(10,"div",55),p.id(11,"Jewellery Type"),p.oc(),p.pc(12,"div",41),p.id(13),p.Dc(14,"titlecase"),p.oc(),p.oc(),p.pc(15,"div",13),p.pc(16,"div",55),p.id(17,"Base Metal"),p.oc(),p.pc(18,"div",41),p.id(19),p.Dc(20,"titlecase"),p.oc(),p.oc(),p.pc(21,"div",13),p.pc(22,"div",55),p.id(23,"Finish"),p.oc(),p.pc(24,"div",41),p.id(25),p.Dc(26,"titlecase"),p.oc(),p.oc(),p.pc(27,"div",13),p.pc(28,"div",55),p.id(29,"Wax Weight"),p.oc(),p.pc(30,"div",41),p.id(31),p.Dc(32,"number"),p.oc(),p.oc(),p.pc(33,"div",13),p.pc(34,"div",55),p.id(35,"Expt Weight"),p.oc(),p.pc(36,"div",41),p.id(37),p.Dc(38,"number"),p.oc(),p.oc(),p.oc(),p.pc(39,"div",54),p.gd(40,Tn,5,1,"div",40),p.gd(41,Bn,6,3,"div",40),p.gd(42,Dn,6,3,"div",40),p.gd(43,En,6,3,"div",40),p.gd(44,On,5,4,"div",40),p.gd(45,Nn,5,1,"div",40),p.oc(),p.oc(),p.oc()),2&t){var i=p.Cc(2);p.Vb(13),p.jd(p.Ec(14,11,i.data.job.node.submission.jewelleryType.name)),p.Vb(6),p.jd(p.Ec(20,13,i.data.job.node.submission.baseMetal.name)),p.Vb(6),p.jd(p.Ec(26,15,i.data.job.node.submission.finish.name)),p.Vb(6),p.kd("",p.Fc(32,17,i.data.job.node.submission.waxWeight,"1.3-3"),"g"),p.Vb(6),p.kd("",p.Fc(38,20,i.data.job.node.submission.expectedFinishWeight,"1.2-2"),"g"),p.Vb(3),p.Jc("ngIf",i.data.job.node.submission.duplicates),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.originalRingSize),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.measuredRingSize),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.ringResize),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.jewelleryType.name===i.jewelleryTypePendant),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.jumpRingPlacement)}}function Rn(t,e){1&t&&(p.pc(0,"div",1),p.pc(1,"div",57),p.kc(2,"loading-ring",35),p.pc(3,"p"),p.id(4,"Loading photos..."),p.oc(),p.oc(),p.oc())}var Wn=function(){return{addSuffix:!0,unit:"day"}},_n=function(){return{addSuffix:!1,unit:"day"}};function qn(t,e){if(1&t&&(p.nc(0),p.pc(1,"div",1),p.pc(2,"div",2),p.pc(3,"h4",3),p.id(4),p.Dc(5,"numericId"),p.oc(),p.pc(6,"div",4),p.pc(7,"h6",5),p.id(8),p.oc(),p.pc(9,"div",6),p.gd(10,gn,2,0,"span",7),p.pc(11,"p",8),p.Dc(12,"dfnsIsPast"),p.pc(13,"strong"),p.id(14),p.Dc(15,"dfnsIsFuture"),p.Dc(16,"dfnsFormatDistanceToNowStrict"),p.Dc(17,"dfnsFormatDistanceToNowStrict"),p.oc(),p.oc(),p.oc(),p.oc(),p.gd(18,mn,3,0,"p",9),p.gd(19,fn,3,0,"p",9),p.gd(20,hn,3,0,"p",9),p.pc(21,"div",10),p.gd(22,vn,3,0,"div",11),p.gd(23,Cn,5,3,"div",11),p.oc(),p.oc(),p.oc(),p.pc(24,"div",12),p.pc(25,"div",13),p.pc(26,"div",14),p.pc(27,"div",15),p.pc(28,"div",16),p.pc(29,"h5",5),p.id(30,"Job Actions"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.pc(31,"div",17),p.gd(32,Sn,5,0,"ng-container",0),p.gd(33,yn,3,9,"ng-container",18),p.oc(),p.oc(),p.gd(34,Mn,12,3,"div",19),p.gd(35,xn,27,9,"div",20),p.gd(36,Pn,19,2,"div",21),p.gd(37,Fn,46,23,"div",22),p.pc(38,"div",23),p.pc(39,"div",13),p.pc(40,"div",14),p.pc(41,"div",15),p.pc(42,"div",24),p.pc(43,"h5",5),p.id(44,"Photos"),p.oc(),p.oc(),p.oc(),p.oc(),p.oc(),p.gd(45,Rn,5,0,"div",25),p.kc(46,"submission-view-photos",26),p.oc(),p.mc()),2&t){var i=p.Cc();p.Vb(4),p.kd("Job #",p.Ec(5,20,i.data.job.node.id),""),p.Vb(4),p.jd(i.data.job.node.submission.customer.fullName),p.Vb(2),p.Jc("ngIf",i.data.job.node.submission.hardDeadline),p.Vb(1),p.bc("text-danger",p.Ec(12,22,i.data.jobDueDate)),p.Vb(3),p.kd(" ",p.Ec(15,24,i.data.jobDueDate)?"Due "+p.Fc(16,26,i.data.jobDueDate,p.Nc(32,Wn)):p.Fc(17,29,i.data.jobDueDate,p.Nc(33,_n))+" late"," "),p.Vb(4),p.Jc("ngIf",i.data.job.node.onHold),p.Vb(1),p.Jc("ngIf",null==i.data.job.node.submission||null==i.data.job.node.submission.kit?null:i.data.job.node.submission.kit.starred),p.Vb(1),p.Jc("ngIf",i.data.job.node.rush),p.Vb(2),p.Jc("ngIf",i.data.job.node.onHold),p.Vb(1),p.Jc("ngIf",(null==i.data.job.node.submission.customer||null==i.data.job.node.submission.customer.event?null:i.data.job.node.submission.customer.event.eventType.name)===i.eventTypeWedding),p.Vb(9),p.Jc("ngIf",i.data.loadingJobActions),p.Vb(1),p.Jc("ngForOf",i.data.jobActionObj),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.stoneDescription&&i.data.stones.length),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.chainType&&i.data.job.node.submission.chainLength&&i.data.job.node.submission.chainPlating),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission.engravingFont&&i.data.job.node.submission.engravingText),p.Vb(1),p.Jc("ngIf",i.data.job.node.submission),p.Vb(8),p.Jc("ngIf",!i.data.job.node.submission.submissionPhotos),p.Vb(1),p.Jc("photos",i.data.job.node.submission.submissionPhotos.edges)("title",!1)}}var Ln=function(){function t(){this.eventTypeWedding=N.a,this.noPlating=pn.b,this.jewelleryTypePendant=v.d,this.now=new Date,this.data=null,this.confirmJobAction=new p.u,this.openSubmission=new p.u}return t.prototype.updateJobAction=function(t){this.confirmJobAction.emit(t)},t.prototype.openSubmissionReq=function(t){this.openSubmission.emit(t)},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.dc({type:t,selectors:[["job-detail-sidebar"]],inputs:{data:"data"},outputs:{confirmJobAction:"confirmJobAction",openSubmission:"openSubmission"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col"],[1,"mb-1"],[1,"d-flex","justify-content-between","mb-4"],[1,"mb-0"],[1,"d-flex","align-items-center"],["class","pill-tag hard-deadline mr-1",4,"ngIf"],[1,"text-warning","text-right","mb-0"],["class","text-muted mb-0",4,"ngIf"],[1,"my-1"],["class","text-muted",4,"ngIf"],["id","job-actions",1,"mt-5","sidebar-section"],[1,"row","mb-2"],[1,"col","px-0"],[1,"section-title"],[1,"d-flex","justify-content-between","align-items-center","flex-md-row"],[1,"row","actions"],[4,"ngFor","ngForOf"],["id","stone-setting","class","mt-5 sidebar-section",4,"ngIf"],["id","chain","class","mt-5 sidebar-section",4,"ngIf"],["id","engraving","class","mt-5 sidebar-section",4,"ngIf"],["id","submission","class","mt-5 sidebar-section",4,"ngIf"],["id","photos",1,"mt-5","sidebar-section"],[1,"d-flex","justify-content-between","flex-md-row","align-items-center"],["class","row",4,"ngIf"],[3,"photos","title"],[1,"pill-tag","hard-deadline","mr-1"],[1,"text-muted","mb-0"],[1,"fas","mr-1","fa-hand-paper","text-danger"],[1,"fas","mr-1","fa-star","text-warning"],[1,"fas","mr-1","fa-shipping-fast","text-danger"],[1,"text-muted"],[1,"pill-tag","on-hold","mr-1"],[1,"pill-tag","wedding","mr-1"],["size","30"],[1,"text-center"],[1,"col-4","col-md-3","action"],[3,"fullFormat","jobAction","loading","onHold","baseMetal","plating","finish","resizeTo","duplicates","confirmedAction"],["id","stone-setting",1,"mt-5","sidebar-section"],["class","row mb-2",4,"ngIf"],[1,"col-6"],[1,"stone-item"],[1,"row","align-items-center"],["class","col-4",4,"ngIf"],[3,"ngClass"],["class","mb-1",4,"ngIf"],[1,"col-4"],["alt","",1,"w-100",3,"src"],["id","chain",1,"mt-5","sidebar-section"],[1,"col-3","text-muted"],[1,"col-9"],["id","engraving",1,"mt-5","sidebar-section"],["id","submission",1,"mt-5","sidebar-section"],[1,"col-sm-6"],[1,"col-6","text-muted"],[1,"col-6",3,"ngClass"],[1,"col","text-center"]],template:function(t,e){1&t&&p.gd(0,qn,47,34,"ng-container",0),2&t&&p.Jc("ngIf",e.data)},directives:[b.p,b.o,ke.a,Kt.a,an,b.n],pipes:[Re.a,bn.e,bn.d,bn.b,Ee.a,b.m,b.y,b.f,b.A],encapsulation:2}),t}(),$n=i("PxxC"),Gn=i("Xv7A"),Hn=i("uYjB"),zn=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.hc({type:t}),t.\u0275inj=p.gc({imports:[[rn.BatchModule,b.c,g.f,qo,dn.b,_.g,sn.b,Be.b,m.a,Pe.d,Pe.f,ln.SubmissionModule,un.d,bn.c,bn.a]]}),t}();p.ad(Qt,[un.c,Xt.a,E.a,_.c,b.p,_.h,_.f,_.e,g.a,g.m,g.p,Kt.a,b.o,_.l,$n.a,Me,xe.a,Te.a,Gn.a,Ve.a,g.x,g.n,g.o,dn.a,Zt.a,g.u,dn.e,g.t,g.d,De.a,g.b,Hn.a,Ln],[Re.a,We.a,b.y,Ee.a,bn.d,bn.e,bn.b,Oe.a])}}]);