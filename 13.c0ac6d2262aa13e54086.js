(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{G81l:function(t,e,c){"use strict";c.r(e),c.d(e,"ManufacturingModule",(function(){return Kn}));var n,i,o,a,s,l=c("ofXK"),d=c("3Pt+"),r=c("PCNd"),u=c("tyNb"),g=c("HKlZ"),f=c("QVjv"),b=c("i7jn"),m=c("zOkP"),p=c("ALmS"),h=Object(p.gql)(n||(a=["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],s=["\n    query actionList {\n        actions {\n            edges  {\n                node {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(a,"raw",{value:s}):a.raw=s,n=a)),v=c("fXoL"),C=c("/IUn"),M="Plating",S="Engraving",A="Jump Ring",y="Earring Posts",I="Stone Setting",w="Resizing",j="Repairing",x="Hallmarking",O=function(){function t(t){this.apollo=t}return t.prototype.list=function(){return this.apollo.watchQuery({query:h}).valueChanges},t.\u0275fac=function(e){return new(e||t)(v.oc(C.b))},t.\u0275prov=v.Wb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),B=c("5Ndf"),P=c("BaBC"),T=Object(p.gql)(i||(i=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            id\n        }\n    }\n'],['\n    mutation createSupplierAction(\n        $supplier: String!\n        $action: String!\n        $cost: Int\n    ) {\n        createSupplierAction(input: {\n            clientMutationId: ""\n            supplier: $supplier\n            action: $action\n            cost: $cost\n        }) {\n            id\n        }\n    }\n']))),k=c("EY2u"),E=Object(p.gql)(o||(o=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}(["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"],["\n    query supplierActionsBySuppliers(\n        $suppliers: [String]!,\n    ) {\n        supplierActions(\n            supplier_list: $suppliers,\n        ) {\n            edges  {\n                node {\n                    id\n                    supplier {\n                        id\n                    }\n                    action {\n                        id\n                        name\n                    }\n                }\n            }\n        }\n    }\n"]))),N=function(){function t(t){this.apollo=t}return t.prototype.create=function(t){return this.apollo.mutate({mutation:T,variables:t})},t.prototype.getBySupplierIds=function(t){return t.length?this.apollo.query({query:E,variables:{suppliers:t}}):k.a},t.\u0275fac=function(e){return new(e||t)(v.oc(C.b))},t.\u0275prov=v.Wb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),J=c("1uah"),R=c("CIHE"),_=c("Nlbt"),D=c("uA1o"),F=c("S6Vu"),H=c("bCT2"),L=c("KPdS"),$=c("PC64"),G=c("Vf4f"),W=c("1kSV"),q=c("5eHb"),z=c("n4kJ"),U=c("Xv7A");function Y(t,e){if(1&t&&(v.gc(0,"div",8),v.cd(1),v.fc()),2&t){var c=v.vc(2);v.Mb(1),v.ed(" ",c._jobAction.node.action.name," ")}}function Q(t,e){1&t&&v.bc(0,"span",12)}function V(t,e){1&t&&(v.gc(0,"div",13),v.bc(1,"i",14),v.fc())}function X(t,e){if(1&t){var c=v.hc();v.gc(0,"div",9),v.rc("click",(function(t){v.Oc(c);var e=v.vc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),v.ad(1,Q,1,0,"span",10),v.ad(2,V,2,0,"div",11),v.fc()}if(2&t){var n=v.vc(2);v.Mb(1),v.Cc("ngIf",!n.expandedFormat),v.Mb(1),v.Cc("ngIf",n.expandedFormat)}}function K(t,e){if(1&t){var c=v.hc();v.gc(0,"div",15),v.gc(1,"span",16),v.rc("click",(function(t){v.Oc(c);var e=v.vc(2);return e.showConfirmAction(e.jobStateCompleted,t)})),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Cc("ngbTooltip",n._jobAction.node.action.name+" at "+n._jobAction.node.job.currentlyWith.company)}}function Z(t,e){if(1&t){var c=v.hc();v.gc(0,"div"),v.gc(1,"div",17),v.rc("click",(function(t){return v.Oc(c),v.vc(2).confirmed(t)})),v.gc(2,"span",18),v.cd(3," Confirm "),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(1),v.Sb("awaiting",n.state.confirming)}}function tt(t,e){1&t&&v.bc(0,"span",21)}function et(t,e){1&t&&(v.gc(0,"div",22),v.bc(1,"i",14),v.fc())}function ct(t,e){if(1&t){var c=v.hc();v.gc(0,"div",9),v.rc("click",(function(t){v.Oc(c);var e=v.vc(2);return e.showConfirmAction(e.jobStateNotStarted,t)})),v.ad(1,tt,1,0,"span",19),v.ad(2,et,2,0,"div",20),v.fc()}if(2&t){var n=v.vc(2);v.Mb(1),v.Cc("ngIf",!n.expandedFormat),v.Mb(1),v.Cc("ngIf",n.expandedFormat)}}function nt(t,e){if(1&t&&(v.gc(0,"div",23),v.gc(1,"p"),v.cd(2),v.wc(3,"titlecase"),v.fc(),v.fc()),2&t){var c=v.vc(2);v.Mb(2),v.dd(v.xc(3,1,c.description))}}function it(t,e){if(1&t&&(v.ec(0),v.gc(1,"div",3),v.ad(2,Y,2,1,"div",4),v.ad(3,X,3,2,"div",5),v.ad(4,K,2,1,"div",6),v.ad(5,Z,4,2,"div",0),v.ad(6,ct,3,2,"div",5),v.ad(7,nt,4,3,"div",7),v.fc(),v.dc()),2&t){var c=v.vc();v.Mb(1),v.Sb("complete",c._jobAction.node.completed&&!c.state.loading)("expanded",c.expandedFormat),v.Mb(1),v.Cc("ngIf",c.expandedFormat),v.Mb(1),v.Cc("ngIf",!c.state.confirming&&!c._jobAction.node.started&&!c._jobAction.node.completed),v.Mb(1),v.Cc("ngIf",!c.state.confirming&&c._jobAction.node.started&&!c._jobAction.node.completed),v.Mb(1),v.Cc("ngIf",c.state.confirming),v.Mb(1),v.Cc("ngIf",!c.state.confirming&&c._jobAction.node.completed),v.Mb(1),v.Cc("ngIf",c.expandedFormat)}}function ot(t,e){if(1&t&&(v.gc(0,"div",8),v.cd(1),v.fc()),2&t){var c=v.vc(2);v.Mb(1),v.ed(" ",c.placeholder," ")}}function at(t,e){1&t&&v.bc(0,"div",26)}function st(t,e){if(1&t&&(v.gc(0,"div",24),v.ad(1,ot,2,1,"div",4),v.ad(2,at,1,0,"div",25),v.fc()),2&t){var c=v.vc();v.Sb("expanded",c.expandedFormat),v.Mb(1),v.Cc("ngIf",c.expandedFormat),v.Mb(1),v.Cc("ngIf",c.expandedFormat)}}function lt(t,e){if(1&t&&(v.gc(0,"div",3),v.bc(1,"span",27),v.fc()),2&t){var c=v.vc();v.Sb("expanded",c.expandedFormat)}}function dt(t,e){if(1&t&&(v.gc(0,"div",3),v.bc(1,"span",27),v.fc()),2&t){var c=v.vc();v.Sb("expanded",c.expandedFormat)}}var rt=function(){function t(t){this.toastrService=t,this.jobStateNotStarted="notStarted",this.jobStateCompleted="completed",this.confirmActionTimeout=null,this._allowEdit=!0,this.placeholder=null,this.description=null,this.expandedFormat=null,this._onHold=null,this.state={confirming:!1,fakeLoading:!1,futureJobState:null,loading:!0},this.confirmedAction=new v.q}return Object.defineProperty(t.prototype,"allowEdit",{set:function(t){this._allowEdit=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jobAction",{set:function(t){this._jobAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loading",{set:function(t){this.state.loading=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullFormat",{set:function(t){this.expandedFormat=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderName",{set:function(t){this.placeholder=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descriptor",{set:function(t){this.description=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHold",{set:function(t){this._onHold=t},enumerable:!1,configurable:!0}),t.prototype.confirmed=function(t){var e=this;t.stopPropagation(),clearTimeout(this.confirmActionTimeout),this.confirmActionTimeout=null,this.state.confirming=!1,this.state.fakeLoading=!0,this.state.futureJobState===this.jobStateNotStarted?(this._jobAction.node.started=!1,this._jobAction.node.startedAt=null,this._jobAction.node.completed=!1,this._jobAction.node.completedAt=null):this.state.futureJobState===this.jobStateCompleted&&(this._jobAction.node.completed=!0,this._jobAction.node.completedAt=(new Date).toISOString()),this.state.futureJobState=null,this.confirmedAction.emit(this._jobAction),setTimeout((function(){e.state.fakeLoading=!1}),800)},t.prototype.showConfirmAction=function(t,e){var c=this;this._onHold?this.toastrService.warning(null,"Item is on hold"):this._allowEdit?(e.stopPropagation(),this.state.confirming=!0,this.state.futureJobState=t,this.confirmActionTimeout=setTimeout((function(){c.state.futureJobState=null,c.state.confirming=!1}),3e3)):this.toastrService.warning(null,'Jobs may only be updated from "In Progress" or "Production Complete" tabs')},t.\u0275fac=function(e){return new(e||t)(v.ac(q.b))},t.\u0275cmp=v.Ub({type:t,selectors:[["toggle-job-action-complete"]],inputs:{allowEdit:"allowEdit",jobAction:"jobAction",loading:"loading",fullFormat:"fullFormat",placeholderName:"placeholderName",descriptor:"descriptor",onHold:"onHold"},outputs:{confirmedAction:"confirmedAction"},decls:4,vars:4,consts:[[4,"ngIf"],["class","action-toggler not-required",3,"expanded",4,"ngIf"],["class","action-toggler",3,"expanded",4,"ngIf"],[1,"action-toggler"],["class","title",4,"ngIf"],[3,"click",4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],["class","description",4,"ngIf"],[1,"title"],[3,"click"],["class","job-incomplete color-muted far fa-circle fa-2x",4,"ngIf"],["class","toggle-button incomplete",4,"ngIf"],[1,"job-incomplete","color-muted","far","fa-circle","fa-2x"],[1,"toggle-button","incomplete"],[1,"fas","fa-check"],[3,"ngbTooltip"],[1,"color-info","far","fa-clock","fa-2x",3,"click"],[1,"double-confirm-container",3,"click"],[1,"confirm-button"],["class","color-success fas fa-check fa-2x",4,"ngIf"],["class","toggle-button complete",4,"ngIf"],[1,"color-success","fas","fa-check","fa-2x"],[1,"toggle-button","complete"],[1,"description"],[1,"action-toggler","not-required"],["class","toggle-button",4,"ngIf"],[1,"toggle-button"],[1,"color-muted","fa","fa-circle-notch","fa-spin","fa-2x"]],template:function(t,e){1&t&&(v.ad(0,it,8,10,"ng-container",0),v.ad(1,st,3,4,"div",1),v.ad(2,lt,2,2,"div",2),v.ad(3,dt,2,2,"div",2)),2&t&&(v.Cc("ngIf",e._jobAction&&!e.state.fakeLoading),v.Mb(1),v.Cc("ngIf",!e._jobAction&&!e.state.loading),v.Mb(1),v.Cc("ngIf",e.state.fakeLoading),v.Mb(1),v.Cc("ngIf",e.state.loading))},directives:[l.u,W.m],pipes:[l.G],styles:[".action-toggler[_ngcontent-%COMP%]{text-align:center}.action-toggler[_ngcontent-%COMP%]   .job-incomplete[_ngcontent-%COMP%]{color:#dfe3e6}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]{background:#1c364c;border-radius:4px;color:#fff;padding:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none;text-transform:uppercase;font-weight:700;letter-spacing:.5px;background:linear-gradient(90deg,#1c364c 50%,#315e84 0);background-size:200% 100%;background-position:0 100%;cursor:pointer;font-size:12px}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container.awaiting[_ngcontent-%COMP%]{-webkit-animation:confirming-timeout-wipe 3s linear both;animation:confirming-timeout-wipe 3s linear both}.action-toggler[_ngcontent-%COMP%]   .double-confirm-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.action-toggler[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:6px}.action-toggler.expanded[_ngcontent-%COMP%]{padding:12px 10px 20px;text-align:center;border:2px solid transparent;border-radius:3px;transition:all .3s ease}.action-toggler.expanded[_ngcontent-%COMP%]:focus, .action-toggler.expanded[_ngcontent-%COMP%]:hover{border-color:#ced6d3}.action-toggler.expanded[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{display:none!important}.action-toggler.expanded[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}.action-toggler.expanded.complete[_ngcontent-%COMP%]{border-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:4px;margin:0 auto;background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;position:relative;line-height:35px}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]{background-color:#00d68f}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.complete[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.action-toggler.expanded[_ngcontent-%COMP%]   .toggle-button.incomplete[_ngcontent-%COMP%]{background-color:#fff;box-shadow:inset 0 0 0 2px #c2c2c2}.action-toggler.expanded.not-required[_ngcontent-%COMP%], .action-toggler.expanded.not-required[_ngcontent-%COMP%]:focus, .action-toggler.expanded.not-required[_ngcontent-%COMP%]:hover{border:none!important}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{opacity:.5}.action-toggler.expanded.not-required[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{background:#dadada;border:none}@-webkit-keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}@keyframes confirming-timeout-wipe{0%{background-position:0 100%}to{background-position:100% 100%}}"]}),t}(),ut=c("r1eF"),gt=c("jmmt");function ft(t,e){if(1&t&&(v.bc(0,"modal-header",2),v.gc(1,"div",3),v.gc(2,"div",4),v.gc(3,"div",5),v.bc(4,"submission-view-photos",6),v.fc(),v.fc(),v.fc()),2&t){var c=e.$implicit,n=v.vc();v.Cc("modal",c),v.Mb(4),v.Cc("photos",n._photos)}}var bt,mt,pt,ht,vt=function(){function t(t,e){this.modalService=t,this.toastr=e}return Object.defineProperty(t.prototype,"photos",{set:function(t){this._photos=t},enumerable:!1,configurable:!0}),t.prototype.openModal=function(t,e){this._photos.length>0?(e.stopPropagation(),this.modalService.open(t,{size:"lg"})):this.toastr.warning("This submission has no photos logged")},t.\u0275fac=function(e){return new(e||t)(v.ac(W.i),v.ac(q.b))},t.\u0275cmp=v.Ub({type:t,selectors:[["view-submission-photos-modal"]],inputs:{photos:"photos"},decls:3,vars:4,consts:[["type","button",1,"btn","mx-1","icon-btn-outline","fas","fa-camera",3,"click"],["modalViewPhotos",""],["title","View Submission Photos",3,"modal"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[3,"photos"]],template:function(t,e){if(1&t){var c=v.hc();v.gc(0,"button",0),v.rc("click",(function(t){v.Oc(c);var n=v.Lc(2);return e.openModal(n,t)})),v.fc(),v.ad(1,ft,5,2,"ng-template",null,1,v.bd)}2&t&&v.Sb("text-muted",0===e._photos.length)("text-success",e._photos.length>0)},directives:[ut.a,gt.a],encapsulation:2}),t}(),Ct=c("JEAg"),Mt=c("XhFI"),St=c("PxxC"),At=c("wOBz"),yt=c("ZOsW"),It=c("1QgP"),wt=c("VdD3"),jt=c("XXSO"),xt=c("G0jp"),Ot=c("9WpQ"),Bt=c("SjCM"),Pt=(bt=function(t,e){return(bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])})(t,e)},function(t,e){function c(){this.constructor=t}bt(t,e),t.prototype=null===e?Object.create(e):(c.prototype=e.prototype,new c)}),Tt=function(t,e,c,n){return new(c||(c=Promise))((function(i,o){function a(t){try{l(n.next(t))}catch(e){o(e)}}function s(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof c?e:new c((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},kt=function(t,e){var c,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(c)throw new TypeError("Generator is already executing.");for(;a;)try{if(c=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],n=0}finally{c=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Et=["searchComponent"];function Nt(t,e){1&t&&(v.gc(0,"button",40),v.cd(1,"Action"),v.fc())}function Jt(t,e){if(1&t){var c=v.hc();v.gc(0,"button",42),v.rc("click",(function(){v.Oc(c);var t=v.vc(2),e=v.Lc(67);return t.openModalWithSelected(e)})),v.cd(1," Send to Outworker "),v.fc()}}function Rt(t,e){if(1&t){var c=v.hc();v.gc(0,"button",42),v.rc("click",(function(){v.Oc(c);var t=v.vc(2),e=v.Lc(69);return t.openModalWithSelected(e)})),v.cd(1," Complete Action "),v.fc()}}function _t(t,e){if(1&t){var c=v.hc();v.gc(0,"button",42),v.rc("click",(function(){v.Oc(c);var t=v.vc(2),e=v.Lc(75);return t.openModalWithSelected(e)})),v.cd(1," Put Items on Hold "),v.fc()}}function Dt(t,e){if(1&t){var c=v.hc();v.gc(0,"button",42),v.rc("click",(function(){v.Oc(c);var t=v.vc(2),e=v.Lc(77);return t.openModalWithSelected(e)})),v.cd(1," Take Items off Hold "),v.fc()}}function Ft(t,e){if(1&t){var c=v.hc();v.ec(0),v.gc(1,"button",42),v.rc("click",(function(){v.Oc(c);var t=v.vc(2),e=v.Lc(71);return t.prepareOutgoingBatch(e)})),v.cd(2," Create Outgoing Batch "),v.fc(),v.gc(3,"button",42),v.rc("click",(function(){v.Oc(c);var t=v.vc(2),e=v.Lc(73);return t.modalService.open(e)})),v.cd(4," Add To Outgoing Batch "),v.fc(),v.dc()}}function Ht(t,e){if(1&t&&(v.ec(0),v.ad(1,Jt,2,0,"button",41),v.ad(2,Rt,2,0,"button",41),v.ad(3,_t,2,0,"button",41),v.ad(4,Dt,2,0,"button",41),v.ad(5,Ft,5,0,"ng-container",19),v.dc()),2&t){var c=v.vc();v.Mb(1),v.Cc("ngIf",c.availableActions.sendToOutworker),v.Mb(1),v.Cc("ngIf",c.availableActions.completeAction),v.Mb(1),v.Cc("ngIf",c.availableActions.putItemsOnHold),v.Mb(1),v.Cc("ngIf",c.availableActions.takeItemsOffHold),v.Mb(1),v.Cc("ngIf",c.availableActions.addToOutgoingBatch)}}function Lt(t,e){1&t&&(v.gc(0,"button",43),v.cd(1," Loading Actions... "),v.fc())}function $t(t,e){if(1&t){var c=v.hc();v.gc(0,"div",44),v.gc(1,"input",45),v.rc("click",(function(){return v.Oc(c),v.vc().selectAll()}))("ngModelChange",(function(t){return v.Oc(c),v.vc().state.allSelected=t})),v.fc(),v.bc(2,"label",46),v.fc()}if(2&t){var n=v.vc();v.Mb(1),v.Cc("ngModel",n.state.allSelected)("value",n.state.allSelected)}}function Gt(t,e){if(1&t&&(v.gc(0,"span",86),v.cd(1),v.wc(2,"numericId"),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.dd(v.xc(2,1,c.job.node.outgoingBatch.id))}}function Wt(t,e){if(1&t&&(v.gc(0,"span",87),v.cd(1),v.wc(2,"uppercase"),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.ed(" Kit - ",v.xc(2,1,c.job.node.submission.castingCode)," ")}}var qt=function(){return[20]};function zt(t,e){if(1&t&&(v.gc(0,"span",87),v.cd(1),v.wc(2,"truncate"),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.ed(" Event - ",v.yc(2,1,c.job.node.submission.customer.event.name,v.Fc(4,qt))," ")}}function Ut(t,e){if(1&t&&(v.gc(0,"span",86),v.cd(1),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc(2);v.Mb(1),v.ed(" ","in "+n.getDaysBetween(c.jobDueDate,n.now)+" days"," ")}}function Yt(t,e){if(1&t&&(v.gc(0,"span",86),v.cd(1),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc(2);v.Mb(1),v.ed(" ",n.getDaysBetween(n.now,c.jobDueDate)+" days ago"," ")}}function Qt(t,e){if(1&t&&(v.gc(0,"span",86),v.cd(1),v.fc()),2&t){var c=v.vc(2).$implicit,n=v.vc(2);v.Mb(1),v.ed(" ","in "+n.getDaysBetween(c.job.node.submission.hardDeadline,n.now)+" days"," ")}}function Vt(t,e){if(1&t&&(v.gc(0,"span",86),v.cd(1),v.fc()),2&t){var c=v.vc(2).$implicit,n=v.vc(2);v.Mb(1),v.ed(" ",n.getDaysBetween(n.now,c.job.node.submission.hardDeadline)+" days ago"," ")}}function Xt(t,e){if(1&t&&(v.gc(0,"div",88),v.gc(1,"b"),v.cd(2,"HARD DEADLINE:"),v.fc(),v.cd(3),v.wc(4,"simpleDate"),v.bc(5,"br"),v.ad(6,Qt,2,1,"span",57),v.ad(7,Vt,2,1,"span",57),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc(2);v.Mb(3),v.ed(" ",v.xc(4,3,c.job.node.submission.hardDeadline)," "),v.Mb(3),v.Cc("ngIf",c.job.node.submission.hardDeadline>n.now),v.Mb(1),v.Cc("ngIf",c.job.node.submission.hardDeadline<n.now)}}function Kt(t,e){if(1&t&&(v.gc(0,"div",89),v.bc(1,"div",90),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.Xc("width",100*c.jobActionsCompleted/c.jobActionsNeeded+"%"),v.Sb("complete",c.jobActionsCompleted/c.jobActionsNeeded==1)("halfway",c.jobActionsCompleted/c.jobActionsNeeded>=.5)("started",c.jobActionsCompleted/c.jobActionsNeeded>0)}}function Zt(t,e){if(1&t&&(v.gc(0,"div",91),v.gc(1,"span"),v.cd(2),v.wc(3,"titlecase"),v.fc(),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(2),v.ed("With ",v.xc(3,1,c.job.node.currentlyWith.company),"")}}function te(t,e){if(1&t&&(v.gc(0,"div",92),v.wc(1,"lowercaseDashes"),v.gc(2,"span"),v.cd(3),v.fc(),v.fc()),2&t){var c=v.vc().$implicit;v.Pb("td fg-2 status status-pill status-",v.xc(1,4,c.job.node.status.name),""),v.Mb(3),v.dd(c.job.node.status.name)}}function ee(t,e){if(1&t){var c=v.hc();v.gc(0,"toggle-job-action-complete",93),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(3).updateJobAction(t)})),v.fc()}if(2&t){var n=v.vc().$implicit,i=v.vc(2);v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionJumpRing])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)}}function ce(t,e){if(1&t){var c=v.hc();v.gc(0,"toggle-job-action-complete",93),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(3).updateJobAction(t)})),v.fc()}if(2&t){var n=v.vc().$implicit,i=v.vc(2);v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionEarringPosts])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)}}function ne(t,e){1&t&&v.bc(0,"span",97)}function ie(t,e){1&t&&(v.gc(0,"div",98),v.gc(1,"div",99),v.cd(2,"Attachments"),v.fc(),v.bc(3,"div",100),v.fc())}function oe(t,e){if(1&t&&(v.gc(0,"div",94),v.ad(1,ne,1,0,"span",95),v.ad(2,ie,4,0,"div",96),v.fc()),2&t){var c=v.vc(3);v.Mb(1),v.Cc("ngIf",c.state.loading||c.loadingJobActions),v.Mb(1),v.Cc("ngIf",!c.state.loading&&!c.loadingJobActions)}}function ae(t,e){if(1&t){var c=v.hc();v.ec(0,48),v.gc(1,"div",49),v.gc(2,"div",50),v.gc(3,"div",51),v.gc(4,"div",44),v.gc(5,"input",52),v.rc("click",(function(){v.Oc(c);var t=e.$implicit;return v.vc(2).selectRow(t)}))("ngModelChange",(function(t){return v.Oc(c),e.$implicit.selected=t})),v.wc(6,"numericId"),v.fc(),v.bc(7,"label",53),v.wc(8,"numericId"),v.fc(),v.fc(),v.gc(9,"div",54),v.bc(10,"i",55),v.fc(),v.gc(11,"div",56),v.cd(12),v.wc(13,"numericId"),v.fc(),v.gc(14,"div",56),v.ad(15,Gt,3,3,"span",57),v.fc(),v.gc(16,"div",58),v.cd(17),v.ad(18,Wt,3,3,"span",59),v.ad(19,zt,3,5,"span",59),v.fc(),v.gc(20,"div",60),v.gc(21,"div",61),v.cd(22),v.wc(23,"titlecase"),v.fc(),v.fc(),v.gc(24,"div",62),v.cd(25),v.wc(26,"simpleDate"),v.bc(27,"br"),v.ad(28,Ut,2,1,"span",57),v.ad(29,Yt,2,1,"span",57),v.ad(30,Xt,8,5,"div",63),v.fc(),v.gc(31,"div",64),v.gc(32,"toggle-job-action-complete",65),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.gc(33,"span",66),v.cd(34,"in "),v.gc(35,"strong"),v.cd(36),v.wc(37,"titlecase"),v.fc(),v.fc(),v.fc(),v.gc(38,"div",67),v.gc(39,"a",68),v.rc("click",(function(){v.Oc(c);var t=e.$implicit;return v.vc(2).expandJobs(t)})),v.cd(40),v.bc(41,"i",69),v.fc(),v.fc(),v.gc(42,"div",58),v.ad(43,Kt,2,8,"div",70),v.fc(),v.ad(44,Zt,4,3,"div",71),v.ad(45,te,4,6,"div",72),v.gc(46,"div",58),v.gc(47,"div",73),v.bc(48,"view-submission-photos-modal",74),v.bc(49,"view-submission-comms-modal",75),v.bc(50,"view-submission-modal",76),v.fc(),v.fc(),v.fc(),v.gc(51,"div",77),v.gc(52,"div",67),v.gc(53,"div",78),v.gc(54,"div",79),v.gc(55,"h5"),v.cd(56,"Other Actions"),v.gc(57,"span"),v.cd(58,"Double click to complete an action"),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(59,"div",80),v.gc(60,"div",79),v.gc(61,"toggle-job-action-complete",81),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.wc(62,"titlecase"),v.fc(),v.fc(),v.gc(63,"div",79),v.gc(64,"toggle-job-action-complete",81),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.gc(65,"div",79),v.gc(66,"toggle-job-action-complete",81),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.wc(67,"titlecase"),v.fc(),v.fc(),v.gc(68,"div",79),v.gc(69,"toggle-job-action-complete",82),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.gc(70,"div",79),v.gc(71,"toggle-job-action-complete",82),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.gc(72,"div",79),v.ad(73,ee,1,5,"toggle-job-action-complete",83),v.ad(74,ce,1,5,"toggle-job-action-complete",83),v.ad(75,oe,3,2,"div",84),v.fc(),v.gc(76,"div",79),v.gc(77,"toggle-job-action-complete",85),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.gc(78,"div",79),v.gc(79,"toggle-job-action-complete",85),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.gc(80,"div",79),v.gc(81,"toggle-job-action-complete",85),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.gc(82,"div",79),v.gc(83,"toggle-job-action-complete",85),v.rc("confirmedAction",(function(t){return v.Oc(c),v.vc(2).updateJobAction(t)})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.dc()}if(2&t){var n=e.$implicit,i=v.vc(2);v.Mb(1),v.Sb("late",n.job.node.due&&n.jobDueDate<i.now)("on-hold",n.job.node.onHold)("rush",n.job.node.rush),v.Mb(1),v.Sb("expanded",n.expanded)("selected",n.selected),v.Mb(3),v.Ec("id","job-",v.xc(6,110,n.job.node.id),""),v.Cc("ngModel",n.selected)("name","job-"+n.job.node.id),v.Mb(2),v.Ec("for","job-",v.xc(8,112,n.job.node.id),""),v.Mb(3),v.Sb("text-muted",!n.job.node.rush)("text-warning",n.job.node.rush),v.Mb(2),v.dd(v.xc(13,114,n.job.node.id)),v.Mb(3),v.Cc("ngIf",n.job.node.outgoingBatch),v.Mb(2),v.ed(" ",n.job.node.submission.customer.fullName," "),v.Mb(1),v.Cc("ngIf",n.job.node.submission.castingCode),v.Mb(1),v.Cc("ngIf",n.job.node.submission.customer.event),v.Mb(3),v.fd(" ",v.xc(23,116,n.job.node.submission.kitType.name),"",n.job.node.submission.kitType.name===i.kitTypeEarring?"s":""," "),v.Mb(3),v.ed(" ",n.job.node.due?v.xc(26,118,n.job.node.due):""," "),v.Mb(3),v.Cc("ngIf",n.job.node.due&&n.jobDueDate>i.now),v.Mb(1),v.Cc("ngIf",n.job.node.due&&n.jobDueDate<i.now),v.Mb(1),v.Cc("ngIf",n.job.node.submission.hardDeadline),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("jobAction",n.jobActions[i.actionCastAndMount])("loading",i.loadingJobActions)("onHold",n.job.node.onHold),v.Mb(1),v.Sb("color-success",n.job.node.submission.baseMetal.name!==i.baseMetalSilver)("muted",n.job.node.submission.baseMetal.name===i.baseMetalSilver),v.Mb(3),v.dd(v.xc(37,120,n.job.node.submission.baseMetal.name)),v.Mb(4),v.ed(" ",n.expanded?"Hide":"Show"," "),v.Mb(3),v.Cc("ngIf",!i.loadingJobActions),v.Mb(1),v.Cc("ngIf",n.job.node.currentlyWith),v.Mb(1),v.Cc("ngIf",!n.job.node.currentlyWith),v.Mb(3),v.Cc("photos",n.job.node.submission.submissionPhotos.edges),v.Mb(1),v.Cc("customerNote",n.job.node.submission.customerNotes)("isAdmin",i.isAdmin)("hover",!n.job.node.submission.customerNotes&&!n.notes)("loadingNotes",i.loadingNotes)("notes",n.notes)("submissionId",n.job.node.submission.id),v.Mb(1),v.Cc("buttonStyle",!0)("isAdmin",i.isAdmin)("loadingStones",i.loadingStones)("stones",n.stones)("submission",n.job.node.submission),v.Mb(11),v.Cc("allowEdit",i.activeTab.allowEdit)("descriptor",v.xc(62,122,"in "+n.job.node.submission.baseMetal.name))("fullFormat",!0)("jobAction",n.jobActions[i.actionCastAndMount])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)("placeholderName","Cast"),v.Mb(3),v.Cc("allowEdit",i.activeTab.allowEdit)("descriptor",n.job.node.submission.finish.name)("fullFormat",!0)("jobAction",n.jobActions[i.actionFinishing])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)("placeholderName","Finishing"),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("descriptor",v.xc(67,124,n.job.node.submission.plating.name))("fullFormat",!0)("jobAction",n.jobActions[i.actionPlating])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)("placeholderName","Plating"),v.Mb(3),v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionEngraving])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)("placeholderName","Engraving"),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionDuplicate])("loading",i.loadingJobActions)("onHold",n.job.node.onHold)("placeholderName","Duplicate"),v.Mb(2),v.Cc("ngIf",n.jobActions[i.actionJumpRing]),v.Mb(1),v.Cc("ngIf",n.jobActions[i.actionEarringPosts]),v.Mb(1),v.Cc("ngIf",!n.jobActions[i.actionJumpRing]&&!n.jobActions[i.actionEarringPosts]),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionStoneSetting])("loading",i.loadingJobActions)("placeholderName","Stone Setting"),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionResizing])("loading",i.loadingJobActions)("placeholderName","Resizing"),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionRepairing])("loading",i.loadingJobActions)("placeholderName","Repairing"),v.Mb(2),v.Cc("allowEdit",i.activeTab.allowEdit)("fullFormat",!0)("jobAction",n.jobActions[i.actionHallmarking])("loading",i.loadingJobActions)("placeholderName","HallMarking")}}function se(t,e){if(1&t&&(v.ec(0),v.ad(1,ae,84,126,"ng-container",47),v.dc()),2&t){var c=v.vc();v.Mb(1),v.Cc("ngForOf",c.data.jobsAndJobActions)}}function le(t,e){1&t&&(v.gc(0,"div",49),v.gc(1,"div",102),v.gc(2,"div",51),v.gc(3,"app-loading-shimmer"),v.gc(4,"div",103),v.gc(5,"div",104),v.bc(6,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(7,"div",54),v.gc(8,"app-loading-shimmer"),v.gc(9,"div",103),v.gc(10,"div",104),v.bc(11,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(12,"div",54),v.gc(13,"app-loading-shimmer"),v.gc(14,"div",103),v.gc(15,"div",104),v.bc(16,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(17,"div",54),v.gc(18,"app-loading-shimmer"),v.gc(19,"div",103),v.gc(20,"div",104),v.bc(21,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(22,"div",58),v.gc(23,"app-loading-shimmer"),v.gc(24,"div",103),v.gc(25,"div",104),v.bc(26,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(27,"div",67),v.gc(28,"app-loading-shimmer"),v.gc(29,"div",103),v.gc(30,"div",106),v.bc(31,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(32,"div",58),v.gc(33,"app-loading-shimmer"),v.gc(34,"div",103),v.gc(35,"div",104),v.bc(36,"div",105),v.fc(),v.fc(),v.gc(37,"div",107),v.gc(38,"div",108),v.bc(39,"div",109),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(40,"div",67),v.gc(41,"app-loading-shimmer"),v.gc(42,"div",110),v.gc(43,"div",106),v.bc(44,"div",111),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(45,"div",67),v.gc(46,"app-loading-shimmer"),v.gc(47,"div",103),v.gc(48,"div",112),v.bc(49,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(50,"div",67),v.gc(51,"app-loading-shimmer"),v.gc(52,"div",103),v.gc(53,"div",113),v.bc(54,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(55,"div",58),v.gc(56,"app-loading-shimmer"),v.gc(57,"div",103),v.gc(58,"div",104),v.bc(59,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(60,"div",114),v.gc(61,"app-loading-shimmer"),v.gc(62,"div",103),v.gc(63,"div",104),v.bc(64,"div",105),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(65,"div",67),v.gc(66,"app-loading-shimmer"),v.gc(67,"div",110),v.gc(68,"div",106),v.bc(69,"div",111),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc())}function de(t,e){1&t&&(v.ec(0,48),v.ad(1,le,70,0,"div",101),v.dc()),2&t&&(v.Mb(1),v.Cc("ngForOf"," ".repeat(3).split("")))}function re(t,e){1&t&&(v.gc(0,"div",115),v.gc(1,"div",116),v.bc(2,"loading-ring",117),v.fc(),v.fc()),2&t&&(v.Mb(2),v.Cc("size",60))}function ue(t,e){if(1&t&&(v.gc(0,"ng-option",128),v.cd(1),v.wc(2,"titlecase"),v.fc()),2&t){var c=e.$implicit;v.Cc("value",c),v.Mb(1),v.ed("",v.xc(2,2,c.supplier.node.company)," ")}}function ge(t,e){if(1&t){var c=v.hc();v.gc(0,"div",132),v.gc(1,"label",133),v.gc(2,"input",134),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(3).model.selectedOutworkerAction=t})),v.fc(),v.cd(3),v.fc(),v.fc()}if(2&t){var n=e.$implicit,i=v.vc(3);v.Mb(1),v.Sb("active",i.model.selectedOutworkerAction===n),v.Mb(1),v.Cc("ngModel",i.model.selectedOutworkerAction)("value",n),v.Mb(1),v.ed("",n.node.action.name," ")}}function fe(t,e){if(1&t&&(v.gc(0,"div",121),v.gc(1,"label",129),v.cd(2,"What Action"),v.fc(),v.gc(3,"div",130),v.ad(4,ge,4,5,"div",131),v.fc(),v.fc()),2&t){var c=v.vc(2);v.Mb(4),v.Cc("ngForOf",c.model.selectedSupplierAndActions.actions)}}function be(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",118),v.gc(1,"div",119),v.gc(2,"form",null,120),v.gc(4,"div",121),v.gc(5,"label",122),v.cd(6,"Which Outworker?"),v.fc(),v.gc(7,"ng-select",123,124),v.rc("change",(function(){return v.Oc(c),v.vc().onChangeSelectedOutworker()}))("ngModelChange",(function(t){return v.Oc(c),v.vc().model.selectedSupplierAndActions=t})),v.ad(9,ue,3,4,"ng-option",125),v.fc(),v.fc(),v.ad(10,fe,5,1,"div",126),v.fc(),v.fc(),v.gc(11,"modal-footer",127),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().sendToOutworker()})),v.fc()}if(2&t){var n=e.$implicit,i=v.Lc(3),o=v.vc();v.Cc("modal",n),v.Mb(7),v.Cc("ngModel",o.model.selectedSupplierAndActions)("searchable",!1),v.Mb(2),v.Cc("ngForOf",o.data.suppliersAndActions),v.Mb(1),v.Cc("ngIf",o.model.selectedSupplierAndActions),v.Mb(1),v.Cc("form",i)("modal",n)("saveButtonName","Send")}}function me(t,e){if(1&t){var c=v.hc();v.gc(0,"div",132),v.gc(1,"label",133),v.gc(2,"input",137),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.selectedCompleteAction=t})),v.fc(),v.cd(3),v.fc(),v.fc()}if(2&t){var n=e.$implicit,i=v.vc(2);v.Mb(1),v.Sb("active",i.model.selectedCompleteAction===n),v.Mb(1),v.Cc("ngModel",i.model.selectedCompleteAction)("value",n),v.Mb(1),v.ed("",n.node.name," ")}}function pe(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",135),v.gc(1,"div",119),v.gc(2,"form",null,136),v.gc(4,"div",121),v.gc(5,"label",129),v.cd(6,"What Action"),v.fc(),v.gc(7,"div",130),v.ad(8,me,4,5,"div",131),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(9,"modal-footer",127),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().completeActions()})),v.fc()}if(2&t){var n=e.$implicit,i=v.Lc(3),o=v.vc();v.Cc("modal",n),v.Mb(8),v.Cc("ngForOf",o.data.actions),v.Mb(1),v.Cc("form",i)("modal",n)("saveButtonName","Complete")}}function he(t,e){if(1&t&&(v.gc(0,"ng-option",128),v.cd(1),v.wc(2,"titlecase"),v.fc()),2&t){var c=e.$implicit;v.Cc("value",c),v.Mb(1),v.ed("",v.xc(2,2,c.node.company)," ")}}function ve(t,e){if(1&t){var c=v.hc();v.gc(0,"div",121),v.gc(1,"label",122),v.cd(2,"Which Supplier?"),v.fc(),v.gc(3,"ng-select",143,124),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.selectedManufacturer=t})),v.ad(5,he,3,4,"ng-option",125),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(3),v.Cc("ngModel",n.model.selectedManufacturer)("searchable",!1),v.Mb(2),v.Cc("ngForOf",n.data.manufacturers)}}function Ce(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",138),v.gc(1,"div",119),v.gc(2,"form",null,139),v.ad(4,ve,6,3,"div",126),v.gc(5,"h5"),v.cd(6),v.fc(),v.gc(7,"h5"),v.cd(8),v.fc(),v.gc(9,"h5"),v.cd(10),v.fc(),v.gc(11,"div",140),v.gc(12,"label",141),v.gc(13,"input",142),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc().allItemsPresent=t})),v.fc(),v.cd(14," All Items Are Present "),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(15,"modal-footer",127),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().createOutgoingBatch()})),v.fc()}if(2&t){var n=e.$implicit,i=v.Lc(3),o=v.vc();v.Cc("modal",n),v.Mb(4),v.Cc("ngIf",o.isAdmin),v.Mb(2),v.ed("# Rings: ",o.model.numItemTypes[o.kitTypeRing],""),v.Mb(2),v.ed("# Pendants: ",o.model.numItemTypes[o.kitTypePendant],""),v.Mb(2),v.ed("# Earring Pairs: ",o.model.numItemTypes[o.kitTypeEarring],""),v.Mb(3),v.Cc("ngModel",o.allItemsPresent)("value",!0),v.Mb(2),v.Cc("form",i)("modal",n)("saveButtonName","Create")}}function Me(t,e){if(1&t&&(v.gc(0,"ng-option",128),v.cd(1),v.wc(2,"numericId"),v.fc()),2&t){var c=e.$implicit;v.Cc("value",c.node.id),v.Mb(1),v.ed("Batch #",v.xc(2,2,c.node.id)," ")}}function Se(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",144),v.gc(1,"div",119),v.gc(2,"form",null,145),v.gc(4,"div",121),v.gc(5,"label",122),v.cd(6,"Which Batch?"),v.fc(),v.gc(7,"ng-select",146,124),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc().data.mutationBatchId=t})),v.ad(9,Me,3,4,"ng-option",125),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(10,"modal-footer",127),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().addJobsToBatch()})),v.fc()}if(2&t){var n=e.$implicit,i=v.Lc(3),o=v.vc();v.Cc("modal",n),v.Mb(7),v.Cc("ngModel",o.data.mutationBatchId)("searchable",!1),v.Mb(2),v.Cc("ngForOf",o.data.availableBatches),v.Mb(1),v.Cc("form",i)("modal",n)("saveButtonName","Create")}}function Ae(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",147),v.gc(1,"div",119),v.gc(2,"h5"),v.cd(3),v.fc(),v.fc(),v.gc(4,"modal-footer",148),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().putJobsOnHold()})),v.fc()}if(2&t){var n=e.$implicit,i=v.vc();v.Cc("modal",n),v.Mb(3),v.fd("Add a hold to ",i.data.selections.length," item",i.data.selections.length>1?"s":"","?"),v.Mb(1),v.Cc("modal",n)("saveButtonName","Add Hold")}}function ye(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",149),v.gc(1,"div",119),v.gc(2,"h5"),v.cd(3),v.fc(),v.fc(),v.gc(4,"modal-footer",148),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().takeJobsOffHold()})),v.fc()}if(2&t){var n=e.$implicit,i=v.vc();v.Cc("modal",n),v.Mb(3),v.fd("Remove hold from ",i.data.selections.length," item",i.data.selections.length>1?"s":"","?"),v.Mb(1),v.Cc("modal",n)("saveButtonName","Remove Hold")}}var Ie="inProgress",we="readyToReturn",je="complete",xe="onHold",Oe=function(){return function(){this.currentJobSearch=null,this.reference=null,this.regCode=null,this.source=null}}(),Be=function(){return function(){this[mt]=0,this[pt]=0,this[ht]=0}}();mt=m.e,pt=m.d,ht=m.c;var Pe=function(t){function e(e,c,n,i,o,a,s,l,d,r,u,g,f,b){var p,h=t.call(this)||this;return h.actionService=e,h.appUserService=c,h.jobActionService=n,h.jobService=i,h.modalService=o,h.route=a,h.router=s,h.stoneSubmissionService=l,h.submissionBatchService=d,h.submissionService=r,h.supplierActionService=u,h.supplierService=g,h.toastrService=f,h.submissionNoteService=b,h.data={actions:[],availableBatches:[],jobsAndJobActions:[],manufacturers:[],mutationBatchId:null,selections:[],suppliersAndActions:[]},h.actionCastAndMount="Cast & Mount",h.actionFinishing="Finishing",h.actionPlating=M,h.actionEngraving=S,h.actionDuplicate="Duplicate",h.actionJumpRing=A,h.actionEarringPosts=y,h.actionStoneSetting=I,h.actionResizing=w,h.actionRepairing=j,h.actionOther="Other",h.actionHallmarking=x,h.kitTypeRing=m.e,h.kitTypePendant=m.d,h.kitTypeEarring=m.c,h.model=new Oe,h.tabInProgress=Ie,h.tabReadyToReturn=we,h.tabComplete=je,h.tabOnHold=xe,h.tabAll="all",h.tabs=((p={}).inProgress={allowEdit:!0,completed:!1,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:Ie,onHold:null},p.readyToReturn={allowEdit:!0,completed:!0,dueOrder:"ASC",incomingBatched:!1,inProduction:!0,name:we,onHold:null},p.complete={allowEdit:!1,completed:!0,dueOrder:"ASC",incomingBatched:!0,inProduction:!1,name:je,onHold:null},p.onHold={allowEdit:!1,completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:!0,name:xe,onHold:!0},p.all={allowEdit:!1,completed:null,dueOrder:"ASC",incomingBatched:null,inProduction:null,name:"all",onHold:null},p),h.activeTab=h.tabs.inProgress,h.allItemsPresent=!1,h.availableActions={sendToOutworker:!1,completeAction:!1,putItemsOnHold:!1,takeItemsOffHold:!1,addToOutgoingBatch:!1,actionsAvailable:!1},h.isAdmin=!1,h.loadingJobActions=!0,h.loadingStones=!0,h.loadingNotes=!0,h.loadingSupplierActions=!0,h.now=new Date,h.setSearch=null,h.submitting=!1,h.jobId="Job ID",h.submissionId="Submission ID",h.customerName="Customer Name",h.eventName="Event Name",h.castingCode="Casting Code",h.baseMetalSilver=$.m,h.searchFields=[{name:h.jobId,allowedType:L.b.integer},{name:h.submissionId,allowedType:L.b.integer},{name:h.customerName,allowedType:L.b.any},{name:h.castingCode,allowedType:L.b.any},{name:h.eventName,allowedType:L.b.any}],h.defaultSearch={searchField:h.searchFields[2],searchQuery:null},h}return Pt(e,t),e.prototype.ngOnInit=function(){return Tt(this,void 0,void 0,(function(){var t,e,c,n,i,o,a=this;return kt(this,(function(s){switch(s.label){case 0:for(this.activeTab=this.tabs[this.route.snapshot.queryParamMap.get("tab")],this.activeTab||(this.activeTab=this.tabs.inProgress),t=this.route.snapshot.queryParamMap.get("searchField"),e=null,c=0,n=this.searchFields;c<n.length;c++)if((i=n[c]).name===t){e=i;break}return o=this.route.snapshot.queryParamMap.get("query"),e&&o?(this.setSearch={searchQuery:o,searchField:e},this.search(this.setSearch),[3,3]):[3,1];case 1:return this.setSearch=this.defaultSearch,[4,this.updateTable(null)];case 2:s.sent(),s.label=3;case 3:return this.appUserService.getMe().subscribe((function(t){a.isAdmin=a.appUserService.isAdmin(t.data.appUser.roles)})),this.submissionBatchService.list(null,null,!0,!0,"DESC",null,!1).subscribe((function(t){a.data.availableBatches=t.data.submissionBatches.edges})),this.supplierService.list(null).subscribe((function(t){for(var e=[],c=0,n=t.data.suppliers.edges;c<n.length;c++){var i=n[c];i.node.isManufacturer?a.data.manufacturers.push(i):(e.push(i.node.id.replace(/^\D+/,"")),a.data.suppliersAndActions.push({supplier:i,actions:[]})),1===a.data.manufacturers.length&&(a.model.selectedManufacturer=a.data.manufacturers[0])}a.supplierActionService.getBySupplierIds(e).subscribe((function(t){for(var e=0,c=a.data.suppliersAndActions;e<c.length;e++)for(var n=c[e],i=0,o=t.data.supplierActions.edges;i<o.length;i++){var s=o[i];n.supplier.node.id===s.node.supplier.id&&n.actions.push(s)}a.loadingSupplierActions=!1})),e.length||(a.loadingSupplierActions=!1)})),this.actionService.list().subscribe((function(t){a.data.actions=t.data.actions.edges})),[2]}}))}))},e.prototype.updateTableWithSearch=function(t,e){return Tt(this,void 0,void 0,(function(){var t=this;return kt(this,(function(c){return this.state.loading=!0,this.loadingJobActions=!0,this.loadingStones=!0,this.model.currentJobSearch&&this.model.currentJobSearch.unsubscribe(),this.model.currentJobSearch=e.subscribe((function(e){var c;e=JSON.parse(JSON.stringify(e));var n=[],i=[],o=JSON.parse(JSON.stringify(t.data.jobsAndJobActions));t.data.jobsAndJobActions=[];for(var a=0,s=e.data.jobs.edges;a<s.length;a++){var l=s[a];n.push(l.node.id.replace(/^\D+/,"")),i.push(l.node.submission.id.replace(/^\D+/,""));for(var d=!1,r=!1,u=0,g=o;u<g.length;u++){var f=g[u];f.job.node.id===l.node.id&&(d=f.selected,r=f.expanded)}l.node.submission.hardDeadline=l.node.submission.hardDeadline?new Date(l.node.submission.hardDeadline):null,t.data.jobsAndJobActions.push({job:l,jobActions:(c={},c["Cast & Mount"]=null,c.Finishing=null,c.Plating=null,c.Engraving=null,c.Duplicate=null,c["Jump Ring"]=null,c["Earring Posts"]=null,c["Stone Setting"]=null,c.Resizing=null,c.Repairing=null,c.Other=null,c.Hallmarking=null,c),jobDueDate:l.node.due?new Date(l.node.due):null,jobActionsCompleted:0,jobActionsNeeded:0,selected:d,expanded:r,stones:[],notes:[]})}t.handlePagination(e.data.jobs),t.jobActionService.getByJobIds(n).subscribe((function(e){e=JSON.parse(JSON.stringify(e));for(var c=0,n=t.data.jobsAndJobActions;c<n.length;c++)for(var i=n[c],o=0,a=e.data.jobActions.edges;o<a.length;o++){var s=a[o];s.node.job.id===i.job.node.id&&(i.jobActions[s.node.action.name]=s,i.jobActionsNeeded+=1,s.node.completed&&(i.jobActionsCompleted+=1))}t.loadingJobActions=!1})),t.stoneSubmissionService.listBySubmission(i).subscribe((function(e){for(var c=0,n=t.data.jobsAndJobActions;c<n.length;c++)for(var i=n[c],o=0,a=e.data.stoneSubmissions.edges;o<a.length;o++){var s=a[o];i.job.node.submission.id===s.node.submission.id&&i.stones.push(s)}t.loadingStones=!1})),t.submissionNoteService.listBySubmission(i).subscribe((function(e){for(var c=0,n=t.data.jobsAndJobActions;c<n.length;c++)for(var i=n[c],o=0,a=e.data.submissionNotes.edges;o<a.length;o++){var s=a[o];i.job.node.submission.id===s.node.submission.id&&i.notes.push(s)}t.loadingNotes=!1}))})),[2]}))}))},e.prototype.updateTable=function(t){return Tt(this,void 0,void 0,(function(){return kt(this,(function(e){return this.updateTableWithSearch(t,this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,t,null,null,null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder)),[2]}))}))},e.prototype.search=function(t){if(!t.searchQuery||!t.searchField)return this.resetSearchQueryParams(),void this.updateTable(null);this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:t.searchField.name,query:t.searchQuery},queryParamsHandling:"merge"});var e=null;switch(t.searchField.name){case this.jobId:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,parseInt(t.searchQuery),null,null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.submissionId:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,parseInt(t.searchQuery),null,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.customerName:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,null,t.searchQuery,null,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.eventName:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,null,null,t.searchQuery,null,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder);break;case this.castingCode:e=this.jobService.list(this.activeTab.completed,this.activeTab.inProduction,null,null,null,null,null,t.searchQuery,null,null,this.activeTab.incomingBatched,this.activeTab.onHold,this.activeTab.dueOrder)}this.updateTableWithSearch(null,e)},e.prototype.changeTab=function(t){return Tt(this,void 0,void 0,(function(){return kt(this,(function(e){switch(e.label){case 0:return this.setSearch=this.defaultSearch,[4,this.resetSearchQueryParams()];case 1:return e.sent(),this.router.navigate([],{relativeTo:this.route,queryParams:{tab:t},queryParamsHandling:"merge"}),this.activeTab=this.tabs[t],this.searchComponent.clearSearch(),this.resetSelections(),this.updateTable(null),[2]}}))}))},e.prototype.selectRow=function(t){if(!this.submitting){if(t.selected){t.selected=!t.selected;var e=this.data.selections.findIndex((function(e){return e.job.node.id===t.job.node.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t);this.getAvailableActions()}},e.prototype.getAvailableActions=function(){var t=this;this.availableActions={sendToOutworker:!0,completeAction:!0,putItemsOnHold:!0,takeItemsOffHold:!0,addToOutgoingBatch:!0,actionsAvailable:!1};for(var e=0,c=this.data.selections;e<c.length;e++){var n=c[e];n.jobActionsNeeded===n.jobActionsCompleted?(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1):this.availableActions.addToOutgoingBatch=!1,n.job.node.status.name!==B.m.name&&(this.availableActions.addToOutgoingBatch=!1),n.job.node.onHold&&(this.availableActions.sendToOutworker=!1,this.availableActions.completeAction=!1,this.availableActions.putItemsOnHold=!1,this.availableActions.addToOutgoingBatch=!1),n.job.node.onHold||(this.availableActions.takeItemsOffHold=!1)}this.availableActions.actionsAvailable=!Object.keys(this.availableActions).every((function(e){return!t.availableActions[e]}))},e.prototype.selectAll=function(){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(i=e[t]).selected=!0,this.selectRow(i);for(var c=0,n=this.data.jobsAndJobActions;c<n.length;c++){var i;(i=n[c]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(i)&&this.data.selections.push(i)}},e.prototype.expandJobs=function(t){this.submitting||(t.expanded=!t.expanded)},e.prototype.expandAll=function(){if(this.state.allExpanded=!this.state.allExpanded,!this.state.allExpanded)for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)(i=e[t]).expanded=!0,this.expandJobs(i);for(var c=0,n=this.data.jobsAndJobActions;c<n.length;c++){var i;(i=n[c]).expanded=this.state.allExpanded}},e.prototype.updateJobAction=function(t){for(var e=null,c=0,n=this.data.jobsAndJobActions;c<n.length;c++){var i=n[c];if(i.job.node.id===t.node.job.id){e=i;break}}if(e.job.node.onHold)this.onHoldMessage(e.job.node.id);else{this.jobActionService.update({id:t.node.id,started:t.node.started,startedAt:t.node.startedAt,completed:t.node.completed,completedAt:t.node.completedAt}).subscribe();var o=t.node.completed,a=t.node.started&&!t.node.completed;e.jobActionsCompleted=0;for(var s=0,l=Object.keys(e.jobActions);s<l.length;s++){var d=e.jobActions[l[s]];d&&(d.node.completed?e.jobActionsCompleted+=1:(o=!1,d.node.started&&(a=!0)))}a||(e.job.node.currentlyWith=null),e.job.node.status=o?B.m:B.f}},e.prototype.openModalWithSelected=function(t){this.data.selections.length?this.modalService.open(t):this.toastrService.info(null,"Please select job(s) before performing action")},e.prototype.sendToOutworker=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;for(var e=(new Date).toISOString(),c=this.toastrService.success(null,"Sending 0 Jobs to Outworkers",{timeOut:3e4}),n=0,i=0,o=function(o){if(o.job.node.onHold)return a.onHoldMessage(o.job.node.id),"continue";var s=o.jobActions[a.model.selectedOutworkerAction.node.action.name];if(!s||s.node.completed||s.node.started)return a.toastrService.info(null,"Item "+a.getNumericId(o.job.node.id)+" does not need "+a.model.selectedOutworkerAction.node.action.name),"continue";if(o.job.node.currentlyWith&&o.job.node.currentlyWith.id!==a.model.selectedSupplierAndActions.supplier.node.id)return a.toastrService.info(null,"Item "+a.getNumericId(o.job.node.id)+" is currently with a different outworker: "+o.job.node.currentlyWith.company),"continue";var l=" Job"+((i+=1)>1?"s":"")+" to Outworkers";c.toastRef.componentInstance.title="Sending "+i+l,c.toastRef.timeoutReset(),s.node.started=!0,s.node.startedAt=e;for(var d={id:s.node.id,started:!0,startedAt:e,completed:!1,completedAt:null},r=0,u=a.data.jobsAndJobActions;r<u.length;r++){var g=u[r];if(g.job.node.id===s.node.job.id){g.job.node.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;break}}s.node.job.currentlyWith=a.model.selectedSupplierAndActions.supplier.node;var f={id:o.job.node.id,currentlyWith:a.model.selectedSupplierAndActions.supplier.node.id};Object(J.a)(a.jobActionService.update(d),a.jobService.update(f)).subscribe((function(e){(n+=1)===i?(c.toastRef.close(),t.toastrService.success(null,"Sent "+i+l),t.model.selectedOutworkerAction=null,t.model.selectedSupplierAndActions=null,t.submitting=!1):(c.toastRef.componentInstance.title="Sent "+n+"/"+i+l,c.toastRef.timeoutReset())}))},a=this,s=0,l=this.data.selections;s<l.length;s++)o(l[s]);0===i&&(c.toastRef.close(),this.model.selectedOutworkerAction=null,this.model.selectedSupplierAndActions=null,this.submitting=!1)}},e.prototype.completeActions=function(){for(var t,e=this,c=0,n=this.data.selections;c<n.length;c++){var i=n[c];if(i.job.node.onHold)this.onHoldMessage(i.job.node.id);else{var o=new Date,a=i.jobActions[this.model.selectedCompleteAction.node.name];if(a){t=!0;var s={__typename:"JobActionEdge",node:{__typename:"JobAction",id:a.node.id,job:a.node.job,action:a.node.action,supplier:null,started:null,startedAt:null,completed:!0,completedAt:o.toISOString()}};a.node.completed=!0,this.updateJobAction(s)}else this.toastrService.info(null,"Item "+this.getNumericId(i.job.node.id)+" does not need "+this.model.selectedCompleteAction.node.name)}}t&&(this.toastrService.success(null,"Completing "+this.model.selectedCompleteAction.node.name),setTimeout((function(){e.toastrService.success(null,"Completed "+e.model.selectedCompleteAction.node.name),e.model.selectedCompleteAction=null}),3e3))},e.prototype.prepareOutgoingBatch=function(t){var e;this.model.numItemTypes=new Be;for(var c=0,n=this.data.selections;c<n.length;c++){var i=n[c];i.job.node.onHold?this.onHoldMessage(i.job.node.id):(e=!0,this.model.numItemTypes[i.job.node.submission.kitType.name]+=1)}e&&this.modalService.open(t)},e.prototype.createOutgoingBatch=function(){var t=this;if(!this.submitting&&this.data.selections.length){this.submitting=!0;var e=(new Date).toISOString();this.toastrService.success(null,"Creating Batch"),this.submissionBatchService.create({status:B.b.id,createdAt:e,updatedAt:e,supplier:this.model.selectedManufacturer.node.id}).subscribe((function(e){t.data.mutationBatchId=e.data.createSubmissionBatch.id,t.toastrService.success(null,"Batch Created"),t.addJobsToBatch()}))}},e.prototype.addJobsToBatch=function(){for(var t=this,e=0,c=0,n=this.toastrService.success(null,"Adding Items to Batch",{timeOut:3e4}),i=0,o=this.data.selections;i<o.length;i++){var a=o[i];a.job.node.onHold?this.onHoldMessage(a.job.node.id):(c+=1,this.jobService.updateIncomingBatch({id:a.job.node.id,incomingBatch:this.data.mutationBatchId,status:B.b.id}).subscribe((function(i){e+=1;for(var o=0,a=t.data.selections;o<a.length;o++){var s=a[o];if(i.data.updateJob.id===s.job.node.id){s.job.node.status=B.b;break}}e===c?(n.toastRef.close(),t.toastrService.success(null,"Added "+c+" Items to Batch"),t.router.navigate(["manufacturing","batches","view",t.data.mutationBatchId.replace(/\D/g,"")])):(n.toastRef.componentInstance.title="Added "+e+"/"+c+" Items to Batch",n.toastRef.timeoutReset())})))}0===c&&(n.toastRef.close(),this.submitting=!1)},e.prototype.putJobsOnHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!0,"Putting job"+t+" on hold.","Job"+t+" put on hold.")},e.prototype.takeJobsOffHold=function(){var t=this.data.selections.length>1?"s":"";this.updateJob(!1,"Taking job"+t+" off hold.","Job"+t+" back in production.")},e.prototype.updateJob=function(t,e,c){var n=this,i=((new Date).toISOString(),0),o=0;this.toastrService.success(null,e);for(var a=function(e){o+=1;var a={id:e.job.node.id};null!==t&&(a.onHold=t,setTimeout((function(c){e.job.node.onHold=t}),3e3)),s.jobService.update(a).subscribe((function(t){(i+=1)===o&&n.toastrService.success(null,c)}))},s=this,l=0,d=this.data.selections;l<d.length;l++)a(d[l])},e.prototype.resetSelections=function(){this.data.selections=[];for(var t=0,e=this.data.jobsAndJobActions;t<e.length;t++)e[t].selected=!1;this.availableActions.actionsAvailable=!1},e.prototype.resetSearchQueryParams=function(){return Tt(this,void 0,void 0,(function(){return kt(this,(function(t){switch(t.label){case 0:return[4,this.router.navigate([],{relativeTo:this.route,queryParams:{searchField:null,query:null},queryParamsHandling:"merge"})];case 1:return t.sent(),[2]}}))}))},e.prototype.onHoldMessage=function(t){this.toastrService.warning(null,"Item "+this.getNumericId(t)+" is on hold")},e.prototype.onChangeSelectedOutworker=function(){this.model.selectedOutworkerAction=null},e.prototype.getDaysBetween=function(t,e){return H.a.getDaysBetween(t,e)},e.\u0275fac=function(t){return new(t||e)(v.ac(O),v.ac(_.a),v.ac(b.a),v.ac(f.a),v.ac(W.i),v.ac(u.a),v.ac(u.b),v.ac(R.a),v.ac(D.a),v.ac(F.a),v.ac(N),v.ac(P.a),v.ac(q.b),v.ac(G.a))},e.\u0275cmp=v.Ub({type:e,selectors:[["ng-component"]],viewQuery:function(t,e){var c;1&t&&v.id(Et,!0),2&t&&v.Kc(c=v.sc())&&(e.searchComponent=c.first)},features:[v.Jb],decls:78,vars:27,consts:[["title","Jobs",3,"subtitle"],[1,"container","form-container"],["novalidate",""],["jobsForm","ngForm"],[1,"row","mt-5","mb-4"],[1,"nav","nav-tabs"],[1,"nav-item"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"row","transparent","align-items-end"],[1,"w-100","mb-2","table-toolbar"],["aria-label","Table toolbar","role","toolbar",1,"btn-toolbar"],["role","group",1,"btn-group"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],["aria-label","Search","role","toolbar",1,"btn-toolbar","ml-5"],[3,"setSearch","searchFields","searchEmitter"],["searchComponent",""],["ngbDropdown","",1,"d-inline-block","float-right"],["class","btn btn-outline-primary","id","sortMenu","ngbDropdownToggle","",4,"ngIf"],["aria-labelledby","sortMenu","ngbDropdownMenu",""],[4,"ngIf"],["class","btn btn-outline-primary","ngbDropdownItem","",4,"ngIf"],[1,"row","flex-table-wrapper"],["aria-describedby","jobsForm","role","grid",1,"flex-table","jobs-table"],["role","row",1,"tr","table-header"],["role","columnheader",1,"th","mini-column"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[3,"ngbTooltip"],["role","columnheader",1,"th","fg-2"],["role","columnheader",1,"th"],["role","columnheader",1,"th","tc"],["role","columnheader",1,"th","fg-2","status"],["role","rowgroup",4,"ngIf"],["class","tr",4,"ngIf"],[3,"state","nextPage","previousPage"],["modalSendToOutworker",""],["modalCompleteAction",""],["modalCreateOutgoingBatch",""],["modalAddToOutgoingBatch",""],["modalPutOnHold",""],["modalTakeOffHold",""],["id","sortMenu","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["class","btn btn-outline-primary","ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",1,"btn","btn-outline-primary",3,"click"],["ngbDropdownItem","",1,"btn","btn-outline-primary"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["role","rowgroup",4,"ngFor","ngForOf"],["role","rowgroup"],["role","rowgroup",1,"row-group"],["role","row",1,"tr","table-row","panel-open"],["role","rowheader",1,"th","mini-column"],["type","checkbox",3,"ngModel","name","id","click","ngModelChange"],[3,"for"],["role","gridcell",1,"td","mini-column"],[1,"fas","fa-shipping-fast"],["role","gridcell",1,"th","mini-column"],["class","muted",4,"ngIf"],["role","gridcell",1,"td","fg-2"],["class","muted","style","display: block;",4,"ngIf"],["role","gridcell",1,"td","job-type"],[2,"display","inline"],["role","gridcell",1,"td","due-back"],["class","mt-3",4,"ngIf"],["role","gridcell",1,"td","job--cast-mount"],[3,"allowEdit","jobAction","loading","onHold","confirmedAction"],[1,"text-center"],["role","gridcell",1,"td"],[3,"click"],[1,"fas","fa-chevron-down","expanded-toggle"],["class","progress mb-0",4,"ngIf"],["class","td fg-2 status status-pill status-with-outworker","role","gridcell",4,"ngIf"],["role","gridcell",3,"class",4,"ngIf"],[1,"btn-group","justify-content-end"],[3,"photos"],[3,"customerNote","isAdmin","hover","loadingNotes","notes","submissionId"],[3,"buttonStyle","isAdmin","loadingStones","stones","submission"],["role","row",1,"tr","table-row","panel"],[1,"row","panel-title"],[1,"col"],[1,"row","jobs","mt-3","mb-2"],[3,"allowEdit","descriptor","fullFormat","jobAction","loading","onHold","placeholderName","confirmedAction"],[3,"allowEdit","fullFormat","jobAction","loading","onHold","placeholderName","confirmedAction"],[3,"allowEdit","fullFormat","jobAction","loading","onHold","confirmedAction",4,"ngIf"],["class","action-toggler expanded tc",4,"ngIf"],[3,"allowEdit","fullFormat","jobAction","loading","placeholderName","confirmedAction"],[1,"muted"],[1,"muted",2,"display","block"],[1,"mt-3"],[1,"progress","mb-0"],["role","progressbar",1,"progress-bar"],["role","gridcell",1,"td","fg-2","status","status-pill","status-with-outworker"],["role","gridcell"],[3,"allowEdit","fullFormat","jobAction","loading","onHold","confirmedAction"],[1,"action-toggler","expanded","tc"],["class","color-muted fa fa-circle-notch fa-spin fa-2x",4,"ngIf"],["class","action-toggler not-required expanded",4,"ngIf"],[1,"color-muted","fa","fa-circle-notch","fa-spin","fa-2x"],[1,"action-toggler","not-required","expanded"],[1,"title"],[1,"toggle-button"],["class","row-group","role","rowgroup",4,"ngFor","ngForOf"],["role","row",1,"tr","table-row"],[1,"row","align-items-center"],[1,"col-10"],[1,"shimmer","py-2"],[1,"col-6"],[1,"row","align-items-center","mt-1"],[1,"col-7"],[1,"shimmer","py-1"],[1,"row","align-items-center","justify-content-center"],[1,"shimmer","py-3"],[1,"col-8"],[1,"col-5"],["role","gridcell",1,"td","fg-2","status"],[1,"tr"],[1,"td","tc"],[3,"size"],["title","Send To Outworker?",3,"modal"],[1,"modal-body"],["sendToOutworkerModalForm","ngForm"],[1,"form-group"],["for","selectSupplier",1,"req"],["appShowErrorInputClass","","id","selectSupplier","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","change","ngModelChange"],["selectSupplier","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[3,"form","modal","saveButtonName","modalSaved"],[3,"value"],[1,"req"],["data-toggle","buttons",1,"btn-group-toggle","row"],["class","btn-group-toggle col-md-4 mb-1",4,"ngFor","ngForOf"],[1,"btn-group-toggle","col-md-4","mb-1"],[1,"btn","btn-primary"],["autocomplete","off","id","selectedSupplierAction","name","selectedSupplierAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Complete Action?",3,"modal"],["completeActionModalForm","ngForm"],["autocomplete","off","id","selectedAction","name","selectedAction","required","","type","radio",3,"ngModel","value","ngModelChange"],["title","Create Outgoing Batch?",3,"modal"],["createOutgoingBatchModalForm","ngForm"],[1,"mt-5","form-group"],["for","allItemsPresent",1,"req","mr-3"],["id","allItemsPresent","name","allItemsPresent","required","","type","checkbox",1,"mr-2",2,"vertical-align","middle",3,"ngModel","value","ngModelChange"],["appShowErrorInputClass","","id","selectSupplierForOutgoingBatch","name","selectSupplier","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add to Outgoing Batch",3,"modal"],["addToOutgoingBatchModalForm","ngForm"],["appShowErrorInputClass","","id","selectBatch","name","selectBatch","placeholder","-- Please Select --","required","",3,"ngModel","searchable","ngModelChange"],["title","Add Hold to Items",3,"modal"],[3,"modal","saveButtonName","modalSaved"],["title","Remove Hold from Items",3,"modal"]],template:function(t,e){1&t&&(v.bc(0,"page-title",0),v.gc(1,"div",1),v.gc(2,"form",2,3),v.gc(4,"div",4),v.gc(5,"ul",5),v.gc(6,"li",6),v.gc(7,"button",7),v.rc("click",(function(){return e.changeTab(e.tabInProgress)})),v.cd(8," In Progress "),v.fc(),v.fc(),v.gc(9,"li",6),v.gc(10,"button",7),v.rc("click",(function(){return e.changeTab(e.tabReadyToReturn)})),v.cd(11," Ready to Return "),v.fc(),v.fc(),v.gc(12,"li",6),v.gc(13,"button",7),v.rc("click",(function(){return e.changeTab(e.tabComplete)})),v.cd(14," Completed "),v.fc(),v.fc(),v.gc(15,"li",6),v.gc(16,"button",7),v.rc("click",(function(){return e.changeTab(e.tabOnHold)})),v.cd(17," On Hold "),v.fc(),v.fc(),v.gc(18,"li",6),v.gc(19,"button",7),v.rc("click",(function(){return e.changeTab(e.tabAll)})),v.cd(20," All "),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(21,"div",8),v.gc(22,"div",9),v.gc(23,"div",10),v.gc(24,"div",11),v.gc(25,"button",12),v.rc("click",(function(){return e.expandAll()})),v.bc(26,"i"),v.fc(),v.fc(),v.fc(),v.gc(27,"div",13),v.gc(28,"search",14,15),v.rc("searchEmitter",(function(t){return e.search(t)})),v.fc(),v.fc(),v.gc(30,"div",16),v.ad(31,Nt,2,0,"button",17),v.gc(32,"div",18),v.ad(33,Ht,6,5,"ng-container",19),v.ad(34,Lt,2,0,"button",20),v.fc(),v.fc(),v.fc(),v.gc(35,"div",21),v.gc(36,"div",22),v.gc(37,"div",23),v.gc(38,"div",24),v.ad(39,$t,3,2,"div",25),v.fc(),v.bc(40,"div",24),v.gc(41,"div",24),v.gc(42,"div",26),v.cd(43,"ID"),v.fc(),v.fc(),v.gc(44,"div",24),v.gc(45,"div",26),v.cd(46,"BA"),v.fc(),v.fc(),v.gc(47,"div",27),v.gc(48,"div"),v.cd(49,"Customer"),v.fc(),v.fc(),v.gc(50,"div",28),v.cd(51,"Type"),v.fc(),v.gc(52,"div",28),v.cd(53,"Due back"),v.fc(),v.gc(54,"div",29),v.cd(55,"Cast & Mount"),v.fc(),v.gc(56,"div",28),v.cd(57,"Actions"),v.fc(),v.gc(58,"div",27),v.cd(59,"Progress"),v.fc(),v.bc(60,"div",30),v.bc(61,"div",27),v.fc(),v.ad(62,se,2,1,"ng-container",19),v.ad(63,de,2,1,"ng-container",31),v.ad(64,re,3,1,"div",32),v.fc(),v.fc(),v.gc(65,"table-controls",33),v.rc("nextPage",(function(){return e.nextPage()}))("previousPage",(function(){return e.previousPage()})),v.fc(),v.fc(),v.fc(),v.fc(),v.ad(66,be,12,8,"ng-template",null,34,v.bd),v.ad(68,pe,10,5,"ng-template",null,35,v.bd),v.ad(70,Ce,16,10,"ng-template",null,36,v.bd),v.ad(72,Se,11,7,"ng-template",null,37,v.bd),v.ad(74,Ae,5,5,"ng-template",null,38,v.bd),v.ad(76,ye,5,5,"ng-template",null,39,v.bd)),2&t&&(v.Cc("subtitle","Jobs"),v.Mb(7),v.Sb("btn-primary",e.activeTab.name===e.tabInProgress),v.Mb(3),v.Sb("btn-primary",e.activeTab.name===e.tabReadyToReturn),v.Mb(3),v.Sb("btn-primary",e.activeTab.name===e.tabComplete),v.Mb(3),v.Sb("btn-primary",e.activeTab.name===e.tabOnHold),v.Mb(3),v.Sb("btn-primary",e.activeTab.name===e.tabAll),v.Mb(6),v.Cc("ngbTooltip",!0===e.state.allExpanded?"Collapse all":"Expand all"),v.Mb(1),v.Pb("fas ",!0===e.state.allExpanded?"fa-compress-alt":"fa-expand-alt",""),v.Mb(2),v.Cc("setSearch",e.setSearch)("searchFields",e.searchFields),v.Mb(3),v.Cc("ngIf",e.availableActions.actionsAvailable),v.Mb(2),v.Cc("ngIf",!e.state.loading&&!e.loadingSupplierActions&&!e.loadingJobActions),v.Mb(1),v.Cc("ngIf",e.state.loading||e.loadingSupplierActions||e.loadingJobActions),v.Mb(5),v.Cc("ngIf",!e.state.loading),v.Mb(3),v.Cc("ngbTooltip","Job ID"),v.Mb(3),v.Cc("ngbTooltip","Batch ID"),v.Mb(17),v.Cc("ngIf",!e.state.loading&&!e.state.paginating),v.Mb(1),v.Cc("ngIf",e.state.loading),v.Mb(1),v.Cc("ngIf",e.state.loading),v.Mb(1),v.Cc("state",e.state))},directives:[z.a,d.z,d.l,d.m,W.m,L.a,W.c,l.u,W.f,U.a,W.h,W.e,d.a,d.k,d.n,l.t,rt,vt,Ct.a,Mt.a,St.a,At.a,ut.a,yt.a,It.a,d.u,wt.a,yt.n,d.s,d.d,d.b],pipes:[jt.a,l.G,xt.a,l.I,Ot.a,Bt.a],styles:[""]}),e}(g.a),Te=c("ZtzB");function ke(t,e){1&t&&(v.gc(0,"div",3),v.bc(1,"loading-ring",4),v.fc()),2&t&&(v.Mb(1),v.Cc("size",60))}function Ee(t,e){if(1&t){var c=v.hc();v.gc(0,"div",12),v.gc(1,"label",24),v.cd(2,"Email"),v.fc(),v.gc(3,"input",27,28),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.email=t})),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(3),v.Cc("ngModel",n.model.email)}}function Ne(t,e){if(1&t){var c=v.hc();v.gc(0,"div",12),v.gc(1,"label",29),v.cd(2,"Telephone"),v.fc(),v.gc(3,"input",30,31),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.telephone=t})),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(3),v.Cc("ngModel",n.model.telephone)}}function Je(t,e){if(1&t){var c=v.hc();v.gc(0,"div",12),v.gc(1,"label",32),v.cd(2,"Address"),v.fc(),v.gc(3,"textarea",33,34),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.address=t})),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(3),v.Cc("ngModel",n.model.address)}}function Re(t,e){if(1&t){var c=v.hc();v.gc(0,"div",35),v.gc(1,"label"),v.cd(2,"Supplier Type"),v.fc(),v.gc(3,"div",36),v.gc(4,"div",37),v.gc(5,"div",38),v.gc(6,"input",39),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.isManufacturer=t})),v.fc(),v.gc(7,"label",40),v.cd(8," Manufacturer "),v.fc(),v.fc(),v.fc(),v.gc(9,"div",41),v.gc(10,"div",38),v.gc(11,"input",42),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.isManufacturer=t})),v.fc(),v.gc(12,"label",43),v.cd(13," Outworker "),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(6),v.Cc("value",!0)("ngModel",n.model.isManufacturer),v.Mb(5),v.Cc("value",!1)("ngModel",n.model.isManufacturer)}}function _e(t,e){if(1&t){var c=v.hc();v.gc(0,"input",52),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).$implicit.cost=t})),v.fc()}if(2&t){var n=v.vc(2).$implicit;v.Cc("ngModel",n.cost)("decimalPlaces",2)("id","cost-"+n.action.node.id)("name","cost-"+n.action.node.id)}}function De(t,e){if(1&t&&(v.gc(0,"div",48),v.gc(1,"div",49),v.gc(2,"div",50),v.cd(3,"\xa3"),v.fc(),v.fc(),v.ad(4,_e,1,4,"input",51),v.fc()),2&t){var c=v.vc(3);v.Mb(4),v.Cc("ngIf",c.state.admin)}}function Fe(t,e){if(1&t){var c=v.hc();v.gc(0,"div",44),v.gc(1,"input",45),v.rc("ngModelChange",(function(t){return v.Oc(c),e.$implicit.selected=t})),v.fc(),v.gc(2,"label",46),v.cd(3),v.fc(),v.ad(4,De,5,1,"div",47),v.fc()}if(2&t){var n=e.$implicit,i=v.vc(2);v.Mb(1),v.Cc("ngModel",n.selected)("name","checkbox-"+n.action.node.id)("id","checkbox-"+n.action.node.id)("value",!0),v.Mb(1),v.Cc("for","checkbox-"+n.action.node.id),v.Mb(1),v.dd(n.action.node.name),v.Mb(1),v.Cc("ngIf",n.selected&&i.state.admin)}}function He(t,e){1&t&&(v.gc(0,"div",53),v.gc(1,"button",54),v.cd(2,"Create Supplier"),v.fc(),v.fc())}function Le(t,e){if(1&t){var c=v.hc();v.gc(0,"form",5,6),v.rc("submit",(function(){return v.Oc(c),v.vc().onSubmit()})),v.gc(2,"div",7),v.gc(3,"div",8),v.gc(4,"div",9),v.gc(5,"div",10),v.gc(6,"div",11),v.gc(7,"h5"),v.cd(8,"Essential Details"),v.fc(),v.gc(9,"div",12),v.gc(10,"label",13),v.cd(11,"Company Name"),v.fc(),v.gc(12,"input",14,15),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc().model.company=t})),v.fc(),v.fc(),v.gc(14,"div",12),v.gc(15,"label",16),v.cd(16,"Contact Name"),v.fc(),v.gc(17,"input",17,18),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc().model.contactName=t})),v.fc(),v.fc(),v.ad(19,Ee,5,1,"div",19),v.ad(20,Ne,5,1,"div",19),v.ad(21,Je,5,1,"div",19),v.gc(22,"div",12),v.gc(23,"label",20),v.cd(24,"Notes"),v.fc(),v.gc(25,"textarea",21,22),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc().model.notes=t})),v.fc(),v.fc(),v.ad(27,Re,14,4,"div",23),v.gc(28,"div"),v.gc(29,"label",24),v.gc(30,"b"),v.cd(31,"Actions"),v.fc(),v.fc(),v.gc(32,"div",8),v.ad(33,Fe,5,7,"div",25),v.fc(),v.fc(),v.ad(34,He,3,0,"div",26),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.Lc(1),i=v.vc();v.Mb(12),v.Cc("ngModel",i.model.company),v.Mb(5),v.Cc("ngModel",i.model.contactName),v.Mb(2),v.Cc("ngIf",i.state.admin),v.Mb(1),v.Cc("ngIf",i.state.admin),v.Mb(1),v.Cc("ngIf",i.state.admin),v.Mb(4),v.Cc("ngModel",i.model.notes),v.Mb(2),v.Cc("ngIf",i.state.admin),v.Mb(6),v.Cc("ngForOf",i.model.actionCosts),v.Mb(1),v.Cc("ngIf",!i.state.submitting&&n.form.valid)}}var $e=function(){return function(){this.isManufacturer=!1}}(),Ge=function(){function t(t,e,c,n,i){this.actionService=t,this.appUserService=e,this.supplierActionService=c,this.supplierService=n,this.toastrService=i,this.model=new $e,this.data={actions:[]},this.state={admin:!1,loading:!0,submitting:!1}}return t.prototype.ngOnInit=function(){var t=this;this.model.actionCosts=[],Object(J.a)(this.actionService.list(),this.appUserService.getMe()).subscribe((function(e){var c=e[1];t.data.actions=e[0].data.actions.edges,t.state.admin=t.appUserService.isAdmin(c.data.appUser.roles);for(var n=0,i=t.data.actions;n<i.length;n++)t.model.actionCosts.push({action:i[n],cost:null,selected:!1});t.state.loading=!1}))},t.prototype.onSubmit=function(){return t=this,void 0,c=function(){var t=this;return function(t,e){var c,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(c)throw new TypeError("Generator is already executing.");for(;a;)try{if(c=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],n=0}finally{c=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){return this.state.submitting=!0,this.toastrService.success(null,"Creating Supplier"),this.supplierService.create({company:this.model.company,contactName:this.model.contactName,email:this.model.email,telephone:this.model.telephone,address:this.model.address,notes:this.model.notes,isManufacturer:this.model.isManufacturer}).subscribe((function(e){for(var c=0,n=0,i=t.toastrService.success(null,"Supplier Created, Adding Actions",{timeOut:3e4}),o=0,a=t.model.actionCosts;o<a.length;o++){var s=a[o];s.selected&&(n+=1,t.supplierActionService.create({supplier:e.data.createSupplier.id,action:s.action.node.id,cost:t.formatCurrency(s.cost)}).subscribe((function(e){(c+=1)===n?(i.toastRef.close(),t.toastrService.success(null,"Added "+n+" Actions to Supplier"),t.state.submitting=!1):(i.toastRef.componentInstance.title="Added "+c+"/"+n+" Actions to Supplier",i.toastRef.timeoutReset())})))}})),[2]}))},new((e=void 0)||(e=Promise))((function(n,i){function o(t){try{s(c.next(t))}catch(e){i(e)}}function a(t){try{s(c.throw(t))}catch(e){i(e)}}function s(t){var c;t.done?n(t.value):(c=t.value,c instanceof e?c:new e((function(t){t(c)}))).then(o,a)}s((c=c.apply(t,[])).next())}));var t,e,c},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.\u0275fac=function(e){return new(e||t)(v.ac(O),v.ac(_.a),v.ac(N),v.ac(P.a),v.ac(q.b))},t.\u0275cmp=v.Ub({type:t,selectors:[["ng-component"]],decls:3,vars:2,consts:[["subtitle","I get by with a little help from my friends","title","Create Supplier"],["class","mt-5",4,"ngIf"],["novalidate","",3,"submit",4,"ngIf"],[1,"mt-5"],[3,"size"],["novalidate","",3,"submit"],["createSupplierForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"form-group"],["for","company",1,"req"],["appShowErrorInputClass","","id","company","maxlength","255","name","comapny","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["company","ngModel"],["for","contactName",1,"req"],["appShowErrorInputClass","","id","contactName","maxlength","255","name","contactName","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["contactName","ngModel"],["class","form-group",4,"ngIf"],["for","notes"],["appShowErrorInputClass","","id","notes","placeholder","These are for your own internal reference, supplier will not see these","maxlength","255","name","notes","type","text",1,"form-control",3,"ngModel","ngModelChange"],["notes","ngModel"],["class","container order-count-selection mb-3 mt-1 form-group",4,"ngIf"],["for","email"],["class","mb-2 col-sm-6",4,"ngFor","ngForOf"],["class","float-right",4,"ngIf"],["appShowErrorInputClass","","id","email","maxlength","255","name","email","type","text",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["for","telephone"],["appShowErrorInputClass","","id","telephone","maxlength","255","name","telephone","type","text",1,"form-control",3,"ngModel","ngModelChange"],["telephone","ngModel"],["for","address"],["appShowErrorInputClass","","id","address","maxlength","255","name","address","type","text",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],[1,"container","order-count-selection","mb-3","mt-1","form-group"],[1,"row","ml-2","inline-options",2,"margin-bottom","0"],[1,"col-sm-3","pl-0"],[1,"option"],["type","radio","name","isManufacturer","id","trueIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","trueIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"col-sm-3","pr-0"],["type","radio","name","isManufacturer","id","falseIsManufacturer","required","",3,"value","ngModel","ngModelChange"],["for","falseIsManufacturer",1,"btn","btn-secondary","btn-sm"],[1,"mb-2","col-sm-6"],["type","checkbox",1,"mr-2",3,"ngModel","name","id","value","ngModelChange"],[3,"for"],["class","input-group mb-1",4,"ngIf"],[1,"input-group","mb-1"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","class","form-control","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",3,"ngModel","decimalPlaces","id","name","ngModelChange",4,"ngIf"],["appShowErrorInputClass","","limitDecimalPlaces","","placeholder","Optional cost","min","0","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","id","name","ngModelChange"],[1,"float-right"],["type","submit",1,"btn","btn-primary"]],template:function(t,e){1&t&&(v.bc(0,"page-title",0),v.ad(1,ke,2,1,"div",1),v.ad(2,Le,35,9,"form",2)),2&t&&(v.Mb(1),v.Cc("ngIf",e.state.submitting||e.state.loading),v.Mb(1),v.Cc("ngIf",!e.state.loading))},directives:[z.a,l.u,At.a,d.z,d.l,d.m,d.d,It.a,d.g,d.u,d.k,d.n,l.t,d.s,d.a,d.q,Te.a],styles:[""]}),t}(),We=c("/tv0");function qe(t,e){1&t&&v.bc(0,"page-title",6)}function ze(t,e){1&t&&v.bc(0,"page-title",7)}function Ue(t,e){1&t&&v.bc(0,"page-title",8)}function Ye(t,e){1&t&&v.bc(0,"page-title",9)}function Qe(t,e){if(1&t&&(v.gc(0,"div",10),v.gc(1,"h4",11),v.cd(2),v.fc(),v.bc(3,"batches-table",12),v.fc()),2&t){var c=v.vc();v.Mb(2),v.dd(c.state.isSupplier?"Incoming Batches":"Sent to Suppliers"),v.Mb(1),v.Cc("partnerComplete",!0)("manufacturerComplete",!1)("inProduction",null)("supplierExists",!0)("isAdmin",c.state.isAdmin)("isSupplier",c.state.isSupplier)("isToSupplier",c.state.toSupplier)("isFromSupplier",c.state.fromSupplier)("order","DESC")("deletable",!1)}}function Ve(t,e){if(1&t&&(v.gc(0,"div",13),v.gc(1,"h4",11),v.cd(2),v.fc(),v.bc(3,"batches-table",14),v.fc()),2&t){var c=v.vc();v.Mb(2),v.dd(c.state.isSupplier?"Outgoing Batches to CAST":"Incoming from Suppliers"),v.Mb(1),v.Cc("partnerComplete",!0)("manufacturerComplete",!0)("inProduction",!1)("supplierExists",!0)("isAdmin",c.state.isAdmin)("isSupplier",c.state.isSupplier)("inQualityControl",!1)("isToSupplier",c.state.toSupplier)("isFromSupplier",c.state.fromSupplier)("order","DESC")("deletable",!1)}}function Xe(t,e){if(1&t&&(v.gc(0,"div",10),v.gc(1,"h4",11),v.cd(2,"Completed"),v.fc(),v.bc(3,"batches-table",15),v.fc()),2&t){var c=v.vc();v.Mb(3),v.Cc("supplierExists",!0)("isAdmin",c.state.isAdmin)("isSupplier",c.state.isSupplier)("inQualityControl",!0)("isToSupplier",c.state.toSupplier)("isFromSupplier",c.state.fromSupplier)("deletable",!1)("order","DESC")}}var Ke=function(){function t(t,e){this.appUserService=t,this.router=e,this.state={isAdmin:!1,isSupplier:!1,toSupplier:!1,fromSupplier:!1}}return t.prototype.ngOnInit=function(){var t=this,e=this.router.url;e.includes("incoming")&&(this.state.toSupplier=!0),e.includes("outgoing")&&(this.state.fromSupplier=!0),this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(e.data.appUser.roles)}))},t.\u0275fac=function(e){return new(e||t)(v.ac(_.a),v.ac(u.b))},t.\u0275cmp=v.Ub({type:t,selectors:[["ng-component"]],decls:7,vars:7,consts:[["title","Batches Sent","subtitle","Batches sent from CAST to suppliers",4,"ngIf"],["title","Incoming Batches","subtitle","Batches of jobs from CAST",4,"ngIf"],["title","Incoming Batches","subtitle","Batches returned from suppliers",4,"ngIf"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST",4,"ngIf"],["class","container-fluid mx-0",4,"ngIf"],["class","container-fluid mx-0 mb-4",4,"ngIf"],["title","Batches Sent","subtitle","Batches sent from CAST to suppliers"],["title","Incoming Batches","subtitle","Batches of jobs from CAST"],["title","Incoming Batches","subtitle","Batches returned from suppliers"],["title","Returned to CAST","subtitle","Batches of jobs returned to CAST"],[1,"container-fluid","mx-0"],[1,"card-title"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","isToSupplier","isFromSupplier","order","deletable"],[1,"container-fluid","mx-0","mb-4"],[3,"partnerComplete","manufacturerComplete","inProduction","supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","order","deletable"],[3,"supplierExists","isAdmin","isSupplier","inQualityControl","isToSupplier","isFromSupplier","deletable","order"]],template:function(t,e){1&t&&(v.ad(0,qe,1,0,"page-title",0),v.ad(1,ze,1,0,"page-title",1),v.ad(2,Ue,1,0,"page-title",2),v.ad(3,Ye,1,0,"page-title",3),v.ad(4,Qe,4,11,"div",4),v.ad(5,Ve,4,12,"div",5),v.ad(6,Xe,4,8,"div",4)),2&t&&(v.Cc("ngIf",e.state.toSupplier&&e.state.isAdmin),v.Mb(1),v.Cc("ngIf",e.state.toSupplier&&e.state.isSupplier),v.Mb(1),v.Cc("ngIf",e.state.fromSupplier&&e.state.isAdmin),v.Mb(1),v.Cc("ngIf",e.state.fromSupplier&&e.state.isSupplier),v.Mb(1),v.Cc("ngIf",e.state.toSupplier),v.Mb(1),v.Cc("ngIf",e.state.fromSupplier),v.Mb(1),v.Cc("ngIf",e.state.fromSupplier))},directives:[l.u,z.a,We.a],styles:[""]}),t}(),Ze=c("7ape"),tc=c("uzfv"),ec=c("rYPC"),cc=c("cXB8"),nc=c("z17N"),ic=c("6QD7"),oc=c("zVvu"),ac=function(t,e,c,n){return new(c||(c=Promise))((function(i,o){function a(t){try{l(n.next(t))}catch(e){o(e)}}function s(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof c?e:new c((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},sc=function(t,e){var c,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(c)throw new TypeError("Generator is already executing.");for(;a;)try{if(c=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],n=0}finally{c=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function lc(t,e){if(1&t&&v.bc(0,"page-title",9),2&t){var c=v.vc();v.Cc("title",c.data.incomingBatch?"Incoming Batch":"Outgoing Batch")}}function dc(t,e){if(1&t&&v.bc(0,"page-title",9),2&t){var c=v.vc();v.Cc("title",!0===c.data.incomingBatch?"Batch to CAST":"Incoming Batch")}}function rc(t,e){if(1&t&&(v.gc(0,"p",21),v.gc(1,"span",22),v.cd(2,"Estimated Cost: "),v.fc(),v.cd(3),v.wc(4,"currency"),v.wc(5,"currency"),v.wc(6,"currency"),v.fc()),2&t){var c=v.vc(2);v.Mb(3),v.gd(" ",v.xc(4,3,c.data.totalEstMetalCost+c.data.totalEstLaborCost)," (L:",v.xc(5,5,c.data.totalEstLaborCost),") (M: ",v.xc(6,7,c.data.totalEstMetalCost),") ")}}function uc(t,e){if(1&t&&(v.gc(0,"p",21),v.gc(1,"span",22),v.cd(2,"Sent From: "),v.fc(),v.cd(3),v.wc(4,"titlecase"),v.fc()),2&t){var c=v.vc(2);v.Mb(3),v.ed("",v.xc(4,1,c.data.batch.supplier.company)," ")}}function gc(t,e){if(1&t&&(v.gc(0,"p",21),v.cd(1," Live Time: "),v.gc(2,"strong"),v.cd(3),v.fc(),v.fc()),2&t){var c=v.vc(2);v.Mb(3),v.dd(c.liveTime)}}function fc(t,e){if(1&t){var c=v.hc();v.gc(0,"button",26),v.rc("click",(function(){return v.Oc(c),v.vc(2).printAll("jobLabels",100)})),v.cd(1," Print Manufacture Labels "),v.fc()}if(2&t){var n=v.vc(2);v.Cc("disabled",n.state.printAll)}}function bc(t,e){if(1&t){var c=v.hc();v.gc(0,"button",26),v.rc("click",(function(){return v.Oc(c),v.vc(2).printAll("idLabels",29)})),v.cd(1," Print ID Labels "),v.fc()}if(2&t){var n=v.vc(2);v.Cc("disabled",n.state.printAll)}}function mc(t,e){if(1&t){var c=v.hc();v.gc(0,"button",27),v.rc("click",(function(){return v.Oc(c),v.vc(2).exportAddressData()})),v.cd(1," Export Addresses "),v.fc()}}function pc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",53),v.cd(4,"Silver"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",54),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._silverBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._silverBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function hc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",55),v.cd(4,"9ct Yellow Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",56),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._9ctYellowGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._9ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function vc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",57),v.cd(4,"9ct Rose Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",58),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._9ctRoseGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._9ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Cc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",59),v.cd(4,"9ct White Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",60),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._9ctWhiteGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._9ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Mc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",61),v.cd(4,"14ct Yellow Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",62),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._14ctYellowGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._14ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Sc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",63),v.cd(4,"14ct Rose Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",64),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._14ctRoseGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._14ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Ac(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",65),v.cd(4,"14ct White Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",66),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._14ctWhiteGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._14ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function yc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",33),v.gc(3,"label",67),v.cd(4,"18ct Yellow Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",68),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._18ctYellowGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._18ctYellowGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function Ic(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",69),v.cd(4,"18ct Rose Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",70),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._18ctRoseGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._18ctRoseGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function wc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",71),v.cd(4,"18ct White Gold"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",72),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._18ctWhiteGoldBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._18ctWhiteGoldBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function jc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",11),v.gc(1,"div",14),v.gc(2,"div",44),v.gc(3,"label",73),v.cd(4,"Platinum"),v.fc(),v.gc(5,"div",46),v.gc(6,"div",47),v.gc(7,"div",48),v.cd(8,"\xa3"),v.fc(),v.fc(),v.gc(9,"input",74),v.rc("ngModelChange",(function(t){v.Oc(c);var e=v.vc(4);return e.metalsInBatch[e._platinumBaseMetalName].actualCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()}if(2&t){var n=v.vc(4);v.Mb(9),v.Cc("ngModel",n.metalsInBatch[n._platinumBaseMetalName].actualCostStaging)("decimalPlaces",2)}}function xc(t,e){if(1&t){var c=v.hc();v.ec(0),v.gc(1,"div",11),v.gc(2,"div",14),v.gc(3,"div",44),v.gc(4,"label",45),v.cd(5,"Labour"),v.fc(),v.gc(6,"div",46),v.gc(7,"div",47),v.gc(8,"div",48),v.cd(9,"\xa3"),v.fc(),v.fc(),v.gc(10,"input",49),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(3).model.labourCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.ad(11,pc,10,2,"div",50),v.ad(12,hc,10,2,"div",50),v.ad(13,vc,10,2,"div",50),v.ad(14,Cc,10,2,"div",50),v.ad(15,Mc,10,2,"div",50),v.ad(16,Sc,10,2,"div",50),v.ad(17,Ac,10,2,"div",50),v.ad(18,yc,10,2,"div",50),v.ad(19,Ic,10,2,"div",50),v.ad(20,wc,10,2,"div",50),v.ad(21,jc,10,2,"div",50),v.gc(22,"div",11),v.gc(23,"div",14),v.gc(24,"div",44),v.gc(25,"label",51),v.cd(26,"Delivery Cost"),v.fc(),v.gc(27,"div",46),v.gc(28,"div",47),v.gc(29,"div",48),v.cd(30,"\xa3"),v.fc(),v.fc(),v.gc(31,"input",52),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(3).model.deliveryCostStaging=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.dc()}if(2&t){var n=v.vc(3);v.Mb(10),v.Cc("ngModel",n.model.labourCostStaging)("decimalPlaces",2),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._silverBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._9ctYellowGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._9ctRoseGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._9ctWhiteGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._14ctYellowGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._14ctRoseGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._14ctWhiteGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._18ctYellowGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._18ctRoseGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._18ctWhiteGoldBaseMetalName].present),v.Mb(1),v.Cc("ngIf",n.metalsInBatch[n._platinumBaseMetalName].present),v.Mb(10),v.Cc("ngModel",n.model.deliveryCostStaging)("decimalPlaces",2)}}function Oc(t,e){1&t&&(v.gc(0,"span"),v.cd(1,"Save"),v.fc())}function Bc(t,e){1&t&&v.bc(0,"span",75)}function Pc(t,e){if(1&t&&(v.gc(0,"tr"),v.gc(1,"th"),v.cd(2),v.fc(),v.gc(3,"td"),v.cd(4),v.wc(5,"number"),v.fc(),v.gc(6,"td"),v.cd(7),v.wc(8,"number"),v.fc(),v.gc(9,"td"),v.cd(10),v.wc(11,"number"),v.fc(),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc(4);v.Mb(2),v.dd(c),v.Mb(2),v.dd(v.yc(5,8,n.metalsInBatch[c].estimateCost/100,"1.2-2")),v.Mb(3),v.dd(v.yc(8,11,n.metalsInBatch[c].actualCostExisting,"1.2-2")),v.Mb(2),v.Sb("color-danger",n.metalsInBatch[c].estimateCost/100-n.metalsInBatch[c].actualCostExisting<0)("color-success",n.metalsInBatch[c].estimateCost/100-n.metalsInBatch[c].actualCostExisting>=0),v.Mb(1),v.dd(v.yc(11,14,n.metalsInBatch[c].estimateCost/100-n.metalsInBatch[c].actualCostExisting,"1.2-2"))}}function Tc(t,e){if(1&t&&(v.ec(0),v.ad(1,Pc,12,17,"tr",39),v.dc()),2&t){var c=e.$implicit,n=v.vc(4);v.Mb(1),v.Cc("ngIf",n.metalsInBatch[c].present)}}function kc(t,e){if(1&t&&(v.gc(0,"div",76),v.gc(1,"div",15),v.gc(2,"div",16),v.gc(3,"h6"),v.cd(4,"Cost Analysis"),v.fc(),v.fc(),v.gc(5,"div",17),v.gc(6,"p"),v.gc(7,"strong"),v.cd(8,"Invoice Costs"),v.fc(),v.fc(),v.gc(9,"table",77),v.gc(10,"thead"),v.gc(11,"tr"),v.bc(12,"th"),v.gc(13,"th"),v.cd(14,"EST"),v.fc(),v.gc(15,"th"),v.cd(16,"ACT"),v.fc(),v.gc(17,"th"),v.cd(18,"DIFF"),v.fc(),v.fc(),v.fc(),v.gc(19,"tbody"),v.gc(20,"tr"),v.gc(21,"th"),v.cd(22,"Labour"),v.fc(),v.gc(23,"td"),v.cd(24),v.wc(25,"number"),v.fc(),v.gc(26,"td"),v.cd(27),v.wc(28,"number"),v.fc(),v.gc(29,"td"),v.cd(30),v.wc(31,"number"),v.fc(),v.fc(),v.ad(32,Tc,2,1,"ng-container",4),v.gc(33,"tr"),v.bc(34,"td"),v.gc(35,"td"),v.gc(36,"strong"),v.cd(37),v.wc(38,"number"),v.fc(),v.fc(),v.gc(39,"td"),v.gc(40,"strong"),v.cd(41),v.wc(42,"number"),v.fc(),v.fc(),v.gc(43,"td"),v.gc(44,"strong"),v.cd(45),v.wc(46,"number"),v.fc(),v.fc(),v.fc(),v.gc(47,"tr"),v.gc(48,"th"),v.cd(49,"Delivery"),v.fc(),v.gc(50,"td"),v.cd(51,"-"),v.fc(),v.gc(52,"td"),v.cd(53),v.wc(54,"number"),v.fc(),v.gc(55,"td"),v.cd(56,"-"),v.fc(),v.fc(),v.gc(57,"tr"),v.bc(58,"td"),v.gc(59,"td"),v.gc(60,"strong"),v.cd(61),v.wc(62,"number"),v.fc(),v.fc(),v.gc(63,"td"),v.gc(64,"strong"),v.cd(65),v.wc(66,"number"),v.fc(),v.fc(),v.gc(67,"td"),v.gc(68,"strong"),v.cd(69),v.wc(70,"number"),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()),2&t){var c=v.vc(3);v.Mb(24),v.dd(v.yc(25,23,c.data.totalEstLaborCost/100,"1.2-2")),v.Mb(3),v.dd(v.yc(28,26,c.model.labourCostExisting,"1.2-2")),v.Mb(2),v.Sb("color-danger",c.data.totalEstLaborCost/100-c.model.labourCostExisting<0)("color-success",c.data.totalEstLaborCost/100-c.model.labourCostExisting>=0),v.Mb(1),v.dd(v.yc(31,29,c.data.totalEstLaborCost/100-c.model.labourCostExisting,"1.2-2")),v.Mb(2),v.Cc("ngForOf",c.objectKeys(c.metalsInBatch)),v.Mb(5),v.dd(v.yc(38,32,c.data.totalEstimatedCost/100,"1.2-2")),v.Mb(4),v.dd(v.yc(42,35,c.data.totalActualCost-c.model.deliveryCostExisting,"1.2-2")),v.Mb(2),v.Sb("color-danger",c.data.totalEstimatedCost/100-(c.data.totalActualCost-c.model.deliveryCostExisting)<0)("color-success",c.data.totalEstimatedCost/100-(c.data.totalActualCost-c.model.deliveryCostExisting)>=0),v.Mb(2),v.dd(v.yc(46,38,c.data.totalEstimatedCost/100-(c.data.totalActualCost-c.model.deliveryCostExisting),"1.2-2")),v.Mb(8),v.dd(v.yc(54,41,c.model.deliveryCostExisting,"1.2-2")),v.Mb(8),v.dd(v.yc(62,44,c.data.totalEstimatedCost/100,"1.2-2")),v.Mb(4),v.dd(v.yc(66,47,c.data.totalActualCost,"1.2-2")),v.Mb(2),v.Sb("color-danger",c.data.totalEstimatedCost/100-c.data.totalActualCost<0)("color-success",c.data.totalEstimatedCost/100-c.data.totalActualCost>=0),v.Mb(2),v.dd(v.yc(70,50,c.data.totalEstimatedCost/100-c.data.totalActualCost,"1.2-2"))}}function Ec(t,e){if(1&t){var c=v.hc();v.gc(0,"div",28),v.gc(1,"div",13),v.gc(2,"div",29),v.gc(3,"div",15),v.gc(4,"div",16),v.gc(5,"h6"),v.cd(6,"Invoicing Details"),v.fc(),v.fc(),v.gc(7,"div",17),v.gc(8,"form",30,31),v.rc("ngSubmit",(function(){return v.Oc(c),v.vc(2).onSubmit()})),v.gc(10,"div",32),v.gc(11,"div",14),v.gc(12,"div",33),v.gc(13,"label",34),v.cd(14,"Invoice / Advice"),v.fc(),v.gc(15,"input",35),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.invoice=t})),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(16,"h6"),v.cd(17,"Invoice Costs"),v.fc(),v.gc(18,"div",11),v.gc(19,"div",14),v.gc(20,"div",36),v.gc(21,"input",37),v.rc("ngModelChange",(function(t){return v.Oc(c),v.vc(2).model.invoiced=t})),v.fc(),v.gc(22,"label",38),v.cd(23,"Invoice Received"),v.fc(),v.fc(),v.fc(),v.fc(),v.ad(24,xc,32,15,"ng-container",39),v.gc(25,"div",40),v.gc(26,"div",14),v.gc(27,"button",41),v.ad(28,Oc,2,0,"span",39),v.ad(29,Bc,1,0,"span",42),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.ad(30,kc,71,53,"div",43),v.fc(),v.fc()}if(2&t){var n=v.Lc(9),i=v.vc(2);v.Mb(15),v.Cc("ngModel",i.model.invoice),v.Mb(6),v.Cc("ngModel",i.model.invoiced),v.Mb(3),v.Cc("ngIf",i.model.invoiced),v.Mb(3),v.Cc("disabled",!n.valid||i.state.submitting||n.pristine),v.Mb(1),v.Cc("ngIf",!i.state.submitting),v.Mb(1),v.Cc("ngIf",i.state.submitting),v.Mb(1),v.Cc("ngIf",i.state.isAdmin&&i.data.incomingBatch)}}function Nc(t,e){if(1&t&&(v.gc(0,"div",10),v.gc(1,"div",11),v.gc(2,"div",12),v.gc(3,"div",13),v.gc(4,"div",14),v.gc(5,"div",15),v.gc(6,"div",16),v.gc(7,"h6"),v.cd(8,"Batch Information"),v.fc(),v.fc(),v.gc(9,"div",17),v.gc(10,"h6"),v.cd(11,"Make Up"),v.fc(),v.gc(12,"div",11),v.bc(13,"div",18),v.gc(14,"div",19),v.gc(15,"div",11),v.gc(16,"div",14),v.cd(17),v.bc(18,"br"),v.cd(19),v.bc(20,"br"),v.cd(21),v.bc(22,"br"),v.cd(23),v.fc(),v.fc(),v.bc(24,"hr"),v.gc(25,"div",11),v.gc(26,"div",14),v.ad(27,rc,7,9,"p",20),v.gc(28,"p",21),v.gc(29,"span",22),v.cd(30,"Date Sent: "),v.fc(),v.cd(31),v.wc(32,"simpleDate"),v.fc(),v.ad(33,uc,5,3,"p",20),v.ad(34,gc,4,1,"p",20),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(35,"div",13),v.gc(36,"div",14),v.gc(37,"div",15),v.gc(38,"div",16),v.gc(39,"h6"),v.cd(40,"Actions"),v.fc(),v.fc(),v.gc(41,"div",17),v.ad(42,fc,2,1,"button",23),v.ad(43,bc,2,1,"button",23),v.ad(44,mc,2,0,"button",24),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.ad(45,Ec,31,7,"div",25),v.fc(),v.fc()),2&t){var c=v.vc();v.Mb(17),v.ed(" Total: ",c.data.jobCount,""),v.Mb(2),v.ed(" Ring: ",c.data.ringCount,""),v.Mb(2),v.ed(" Pendant: ",c.data.pendantCount,""),v.Mb(2),v.ed(" Earring: ",c.data.earringCount," "),v.Mb(4),v.Cc("ngIf",c.state.isAdmin),v.Mb(4),v.ed("",c.data.batch.dateSent?v.xc(32,12,c.data.batch.dateSent):"Not Sent"," "),v.Mb(2),v.Cc("ngIf",c.state.isAdmin),v.Mb(1),v.Cc("ngIf",c.state.isAdmin),v.Mb(8),v.Cc("ngIf",!c.state.loading&&c.state.isAdmin),v.Mb(1),v.Cc("ngIf",!c.state.loading&&c.state.isAdmin),v.Mb(1),v.Cc("ngIf",!c.state.loading&&c.state.isAdmin),v.Mb(1),v.Cc("ngIf",c.data.incomingBatch)}}function Jc(t,e){if(1&t){var c=v.hc();v.gc(0,"div",91),v.gc(1,"input",92),v.rc("click",(function(){return v.Oc(c),v.vc(3).selectAll()}))("ngModelChange",(function(t){return v.Oc(c),v.vc(3).state.allSelected=t})),v.fc(),v.bc(2,"label",93),v.fc()}if(2&t){var n=v.vc(3);v.Mb(1),v.Cc("ngModel",n.state.allSelected)("value",n.state.allSelected)}}function Rc(t,e){if(1&t&&(v.gc(0,"th",89),v.ad(1,Jc,3,2,"div",90),v.fc()),2&t){var c=v.vc(2);v.Mb(1),v.Cc("ngIf",!c.state.loading)}}function _c(t,e){1&t&&(v.gc(0,"th",84),v.cd(1,"Due By"),v.fc())}function Dc(t,e){1&t&&(v.gc(0,"th",84),v.cd(1,"Metal Weight"),v.fc())}function Fc(t,e){1&t&&(v.gc(0,"th",84),v.cd(1,"Est Cost (\xa3)"),v.fc())}function Hc(t,e){if(1&t){var c=v.hc();v.gc(0,"th",111),v.gc(1,"div",91),v.gc(2,"input",112),v.rc("click",(function(){v.Oc(c);var t=v.vc().$implicit;return v.vc(2).selectRow(t)}))("ngModelChange",(function(t){return v.Oc(c),v.vc().$implicit.selected=t})),v.fc(),v.bc(3,"label",113),v.fc(),v.fc()}if(2&t){var n=v.vc().$implicit;v.Mb(2),v.Ec("id","sub-cb-",n.submission.id,""),v.Cc("ngModel",n.selected)("disabled",!n.submission.metalWeight)("name","submission"+n.submission.id),v.Mb(1),v.Ec("for","sub-cb-",n.submission.id,"")}}var Lc=function(){return[20]};function $c(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"truncate"),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.dd(v.yc(2,1,c.submission.customer.event.name,v.Fc(4,Lc)))}}function Gc(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.dd(c.submission.castingCode)}}function Wc(t,e){1&t&&v.bc(0,"span",116),2&t&&v.Cc("ngbTooltip","Rush")}function qc(t,e){1&t&&v.bc(0,"span",117),2&t&&v.Cc("ngbTooltip","Standard")}function zc(t,e){if(1&t&&(v.ec(0),v.ad(1,Wc,1,1,"span",114),v.ad(2,qc,1,1,"span",115),v.dc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.Cc("ngIf",c.job.rush),v.Mb(1),v.Cc("ngIf",!c.job.rush)}}function Uc(t,e){1&t&&v.bc(0,"span",118)}function Yc(t,e){if(1&t){var c=v.hc();v.gc(0,"td"),v.gc(1,"input",119),v.rc("ngModelChange",(function(){v.Oc(c);var t=v.vc().$implicit;return v.vc(2).updateJob(t)}))("ngModelChange",(function(t){return v.Oc(c),v.vc().$implicit.job.due=t})),v.fc(),v.bc(2,"owl-date-time",120,121),v.fc()}if(2&t){var n=v.Lc(3),i=v.vc().$implicit;v.Mb(1),v.Cc("ngModel",i.job.due)("owlDateTimeTrigger",n)("owlDateTime",n),v.Mb(1),v.Cc("pickerType","calendar")}}function Qc(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"simpleDate"),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.ed(" ",c.job.due?v.xc(2,1,c.job.due):""," ")}}function Vc(t,e){if(1&t){var c=v.hc();v.gc(0,"td"),v.gc(1,"input",122),v.rc("blur",(function(){v.Oc(c);var t=v.vc().$implicit;return v.vc(2).updateSubmission(t)}))("ngModelChange",(function(t){return v.Oc(c),v.vc().$implicit.submission.metalWeight=t})),v.fc(),v.fc()}if(2&t){var n=v.vc().$implicit;v.Mb(1),v.Cc("ngModel",n.submission.metalWeight)}}function Xc(t,e){if(1&t&&(v.gc(0,"span",124),v.cd(1),v.wc(2,"currency"),v.wc(3,"currency"),v.fc()),2&t){var c=v.vc(2).$implicit;v.Mb(1),v.fd(" (",v.xc(2,2,c.jobLabourCostEst)," + ",v.xc(3,4,c.jobMetalCostEst),") ")}}function Kc(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"currency"),v.bc(3,"br"),v.ad(4,Xc,4,6,"span",123),v.fc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.ed(" ",c.jobTotalCostEst?v.xc(2,2,c.jobTotalCostEst):"",""),v.Mb(3),v.Cc("ngIf",c.jobTotalCostEst)}}function Zc(t,e){if(1&t){var c=v.hc();v.gc(0,"button",125),v.rc("click",(function(){v.Oc(c);var t=v.vc().$implicit,e=v.vc(2),n=v.Lc(9);return e.viewJobActionModal(t,n)})),v.fc()}if(2&t){var n=v.vc(3);v.Cc("disabled",n.state.loadingActions||n.state.loadingJobActions)}}function tn(t,e){if(1&t){var c=v.hc();v.gc(0,"button",126),v.rc("click",(function(){v.Oc(c);var t=v.vc().$implicit,e=v.vc(2),n=v.Lc(11);return e.viewJobCostsModal(t,n)})),v.fc()}}function en(t,e){1&t&&v.bc(0,"span",75)}function cn(t,e){if(1&t){var c=v.hc();v.gc(0,"button",127),v.rc("click",(function(){v.Oc(c);var t=v.vc().$implicit;return v.vc(2).createPdf(t)})),v.ad(1,en,1,0,"span",42),v.fc()}if(2&t){var n=v.vc().$implicit,i=v.vc(2);v.Sb("fa-print",!n.printing),v.Cc("disabled",i.state.loadingStones&&i.state.loadingJobActions||n.printing),v.Mb(1),v.Cc("ngIf",n.printing)}}function nn(t,e){1&t&&v.bc(0,"span",130)}function on(t,e){if(1&t){var c=v.hc();v.gc(0,"button",128),v.rc("click",(function(){v.Oc(c);var t=v.vc().$implicit;return v.vc(2).toggleSubmissionPhotoTimer(t.submission.id)})),v.ad(1,nn,1,0,"span",129),v.fc()}if(2&t){var n=v.vc().$implicit,i=v.vc(2);v.Sb("fa-camera",!i.data.submissionPhotoTimingMap[n.submission.id]&&!1===i.state.submitting)("fa-stop",i.data.submissionPhotoTimingMap[n.submission.id]&&!1===i.state.submitting)("hover",!i.data.submissionPhotoTimingMap[n.submission.id]),v.Cc("disabled",i.state.submitting),v.Mb(1),v.Cc("ngIf",!0===i.state.submitting)}}function an(t,e){if(1&t){var c=v.hc();v.gc(0,"button",131),v.rc("click",(function(){v.Oc(c);var t=v.vc().$implicit;return v.vc(2).deleteJob(t)})),v.fc()}}function sn(t,e){if(1&t&&v.bc(0,"view-submission-modal",132),2&t){var c=v.vc().$implicit,n=v.vc(2);v.Cc("buttonStyle",!0)("isAdmin",n.state.isAdmin)("loadingStones",n.state.loadingStones)("photos",c.submission.submissionPhotos.edges)("stones",c.stones)("submission",c.submission)}}function ln(t,e){if(1&t&&(v.gc(0,"span"),v.cd(1),v.wc(2,"date"),v.fc()),2&t){var c=v.vc(3);v.Mb(1),v.ed(" Elapsed: ",v.zc(2,1,1e3*c.timeElapsed,"mm:ss","UTC"),"s \xa0 ")}}function dn(t,e){if(1&t){var c=v.hc();v.ec(0),v.gc(1,"tr"),v.wc(2,"lowercaseDashes"),v.ad(3,Hc,4,5,"th",94),v.gc(4,"th",95),v.bc(5,"view-submission-photos-modal",96),v.fc(),v.gc(6,"td",97),v.cd(7),v.wc(8,"numericId"),v.fc(),v.gc(9,"td",98),v.cd(10),v.wc(11,"numericId"),v.fc(),v.gc(12,"td"),v.cd(13),v.fc(),v.ad(14,$c,3,5,"td",39),v.ad(15,Gc,2,1,"td",39),v.gc(16,"td",99),v.rc("click",(function(t){v.Oc(c);var n=e.$implicit;return v.vc(2).setRush(n,t)})),v.ad(17,zc,3,2,"ng-container",39),v.ad(18,Uc,1,0,"span",100),v.fc(),v.ad(19,Yc,4,4,"td",39),v.ad(20,Qc,3,3,"td",39),v.gc(21,"td"),v.cd(22),v.wc(23,"titlecase"),v.fc(),v.gc(24,"td"),v.cd(25),v.wc(26,"number"),v.fc(),v.ad(27,Vc,2,1,"td",39),v.ad(28,Kc,5,4,"td",39),v.gc(29,"td",101),v.gc(30,"span"),v.cd(31),v.wc(32,"titlecase"),v.fc(),v.fc(),v.gc(33,"td",102),v.gc(34,"div",103),v.ad(35,Zc,1,1,"button",104),v.ad(36,tn,1,0,"button",105),v.ad(37,cn,2,4,"button",106),v.ad(38,on,2,8,"button",107),v.ad(39,an,1,0,"button",108),v.bc(40,"view-submission-comms-modal",109),v.fc(),v.ad(41,sn,1,6,"view-submission-modal",110),v.ad(42,ln,3,5,"span",39),v.fc(),v.fc(),v.dc()}if(2&t){var n=e.$implicit,i=v.vc(2);v.Mb(1),v.Pb("status-",v.xc(2,38,n.submission.status.name)," sm"),v.Sb("row-blocked",!i.data.submissionPhotoTimingMap[n.submission.id]&&!0===i.imageLoggingSessionState),v.Mb(2),v.Cc("ngIf",i.state.isAdmin),v.Mb(2),v.Cc("photos",n.submission.submissionPhotos.edges),v.Mb(2),v.dd(v.xc(8,40,n.job.id)),v.Mb(3),v.dd(v.xc(11,42,n.submission.id)),v.Mb(3),v.dd(n.submission.customer.fullName),v.Mb(1),v.Cc("ngIf",n.submission.customer.event),v.Mb(1),v.Cc("ngIf",n.submission.castingCode),v.Mb(2),v.Cc("ngIf",!n.pendingUpdateJob),v.Mb(1),v.Cc("ngIf",n.pendingUpdateJob),v.Mb(1),v.Cc("ngIf",i.state.isAdmin&&i.data.outgoingBatch),v.Mb(1),v.Cc("ngIf",!i.state.isAdmin&&i.data.outgoingBatch),v.Mb(2),v.dd(v.xc(23,44,n.submission.kitType.name)),v.Mb(3),v.dd(v.yc(26,46,n.submission.waxWeight,"0.2-4")),v.Mb(2),v.Cc("ngIf",i.data.incomingBatch),v.Mb(1),v.Cc("ngIf",i.state.isAdmin),v.Mb(1),v.Sb("notready",0===n.submission.submissionPhotos.edges.length)("ready",n.submission.submissionPhotos.edges.length>0),v.Mb(2),v.dd(v.xc(32,49,n.submission.status.name)),v.Mb(4),v.Cc("ngIf",i.state.isAdmin&&!1===i.imageLoggingSessionState),v.Mb(1),v.Cc("ngIf",i.state.isAdmin&&!1===i.imageLoggingSessionState),v.Mb(1),v.Cc("ngIf",!1===i.imageLoggingSessionState),v.Mb(1),v.Cc("ngIf",(!1===i.imageLoggingSessionState||i.data.submissionPhotoTimingMap[n.submission.id])&&i.state.isAdmin),v.Mb(1),v.Cc("ngIf",i.state.isAdmin&&!1===i.imageLoggingSessionState),v.Mb(1),v.Cc("customerNote",n.submission.customerNotes)("hover",!0)("isAdmin",i.state.isAdmin)("loadingNotes",i.state.loadingNotes)("notes",n.notes)("submissionId",n.submission.id),v.Mb(1),v.Cc("ngIf",!1===i.imageLoggingSessionState),v.Mb(1),v.Cc("ngIf",i.data.submissionPhotoTimingMap[n.submission.id])}}function rn(t,e){if(1&t){var c=v.hc();v.gc(0,"div",133),v.gc(1,"button",134),v.rc("click",(function(){v.Oc(c);var t=v.vc(2);return t.updateStatus(t.statusInProduction)})),v.cd(2),v.fc(),v.fc()}if(2&t){var n=v.vc(2);v.Mb(1),v.Cc("disabled",n.state.nextStatus.manuallyConfirmAll&&n.data.selections.length!==n.data.submissionInfos.length||n.state.submitting),v.Mb(1),v.ed(" ",n.state.nextStatus.buttonText," ")}}function un(t,e){1&t&&(v.gc(0,"div",135),v.bc(1,"loading-ring",136),v.fc()),2&t&&(v.Mb(1),v.Cc("size",60))}function gn(t,e){if(1&t&&(v.gc(0,"div",78),v.gc(1,"div",14),v.gc(2,"h5",79),v.cd(3,"Items in Batch"),v.fc(),v.gc(4,"div",80),v.gc(5,"table",81),v.gc(6,"thead"),v.gc(7,"tr"),v.ad(8,Rc,2,1,"th",82),v.bc(9,"th",83),v.gc(10,"th",83),v.cd(11,"JID"),v.fc(),v.gc(12,"th",83),v.cd(13,"SID"),v.fc(),v.gc(14,"th",84),v.cd(15,"Customer"),v.fc(),v.gc(16,"th",84),v.cd(17,"Source"),v.fc(),v.bc(18,"th",83),v.ad(19,_c,2,0,"th",85),v.gc(20,"th",84),v.cd(21,"Type"),v.fc(),v.gc(22,"th",84),v.cd(23,"Wax (g)"),v.fc(),v.ad(24,Dc,2,0,"th",85),v.ad(25,Fc,2,0,"th",85),v.gc(26,"th",84),v.cd(27,"Status"),v.fc(),v.bc(28,"th",84),v.fc(),v.fc(),v.gc(29,"tbody"),v.ad(30,dn,43,51,"ng-container",4),v.fc(),v.gc(31,"tfoot"),v.gc(32,"tr"),v.bc(33,"th",86),v.fc(),v.fc(),v.fc(),v.ad(34,rn,3,2,"div",87),v.ad(35,un,2,1,"div",88),v.fc(),v.fc(),v.fc()),2&t){var c=v.vc();v.Mb(8),v.Cc("ngIf",c.state.isAdmin),v.Mb(11),v.Cc("ngIf",c.data.outgoingBatch),v.Mb(5),v.Cc("ngIf",c.data.incomingBatch),v.Mb(1),v.Cc("ngIf",c.state.isAdmin),v.Mb(5),v.Cc("ngForOf",c.data.submissionInfos),v.Mb(4),v.Cc("ngIf",!c.state.loading&&c.state.nextStatus&&c.data.submissionInfos.length&&(!c.state.nextStatus.adminOnly||c.state.isAdmin)),v.Mb(1),v.Cc("ngIf",c.state.loading)}}function fn(t,e){if(1&t&&(v.gc(0,"td",146),v.cd(1),v.fc()),2&t){var c=v.vc().$implicit;v.Cc("colSpan",100),v.Mb(1),v.ed("Kit - ",c.submission.castingCode,"")}}var bn=function(){return[20,".."]};function mn(t,e){if(1&t&&(v.gc(0,"td",146),v.cd(1),v.wc(2,"truncate"),v.fc()),2&t){var c=v.vc().$implicit;v.Cc("colSpan",100),v.Mb(1),v.dd(v.yc(2,2,c.submission.customer.event.name,v.Fc(5,bn)))}}function pn(t,e){1&t&&(v.gc(0,"td",146),v.cd(1," Other "),v.fc()),2&t&&v.Cc("colSpan",100)}function hn(t,e){if(1&t&&(v.ec(0),v.cd(1),v.wc(2,"uppercase"),v.dc()),2&t){var c=v.vc(3).$implicit;v.Mb(1),v.ed(" - ",v.xc(2,1,c.submission.measuredRingSize.name)," ")}}function vn(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"titlecase"),v.ad(3,hn,3,3,"ng-container",39),v.fc()),2&t){var c=v.vc(2).$implicit,n=v.vc();v.Mb(1),v.ed(" ",v.xc(2,2,c.submission.ringSizeCustom.name)," "),v.Mb(2),v.Cc("ngIf",c.submission.measuredRingSize&&c.submission.ringSizeCustom.name===n.ringSizeLeaveAsIs)}}function Cn(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"uppercase"),v.fc()),2&t){var c=v.vc(2).$implicit;v.Mb(1),v.dd(v.xc(2,1,c.submission.ringSizeCustom.name))}}var Mn=function(){return[110,"[...]"]};function Sn(t,e){if(1&t&&(v.gc(0,"table",145),v.gc(1,"tbody"),v.gc(2,"tr"),v.gc(3,"td"),v.cd(4,"Metal"),v.fc(),v.gc(5,"td"),v.cd(6),v.wc(7,"titlecase"),v.fc(),v.fc(),v.gc(8,"tr"),v.gc(9,"td"),v.cd(10,"Size"),v.fc(),v.ad(11,vn,4,4,"td",39),v.ad(12,Cn,3,3,"td",39),v.fc(),v.gc(13,"tr"),v.gc(14,"td"),v.cd(15,"Finish"),v.fc(),v.gc(16,"td"),v.cd(17),v.wc(18,"titlecase"),v.fc(),v.fc(),v.gc(19,"tr"),v.gc(20,"td"),v.cd(21,"Plating"),v.fc(),v.gc(22,"td"),v.cd(23),v.wc(24,"titlecase"),v.fc(),v.fc(),v.gc(25,"tr",154),v.gc(26,"td"),v.cd(27,"Notes"),v.fc(),v.gc(28,"td"),v.cd(29),v.wc(30,"truncate"),v.fc(),v.fc(),v.fc(),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc();v.Mb(2),v.Sb("invert",c.submission.baseMetal.name!==n.baseMetalSilver),v.Mb(4),v.dd(v.xc(7,8,c.submission.baseMetal.name)),v.Mb(5),v.Cc("ngIf",!c.submission.ringResize),v.Mb(1),v.Cc("ngIf",c.submission.ringResize),v.Mb(5),v.dd(v.xc(18,10,c.submission.finish.name)),v.Mb(6),v.dd(v.xc(24,12,c.submission.plating.name)),v.Mb(6),v.dd(c.submission.customerNotes?v.yc(30,14,c.submission.customerNotes,v.Fc(17,Mn)):"-")}}function An(t,e){1&t&&(v.gc(0,"td"),v.cd(1,"None"),v.fc())}function yn(t,e){1&t&&v.bc(0,"br")}function In(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"titlecase"),v.wc(3,"titlecase"),v.ad(4,yn,1,0,"br",39),v.cd(5),v.wc(6,"titlecase"),v.fc()),2&t){var c=v.vc(2).$implicit;v.Mb(1),v.fd(" ",v.xc(2,4,c.submission.chainType.name)," - ",v.xc(3,6,c.submission.chainLength.name)," "),v.Mb(3),v.Cc("ngIf",c.submission.chainPlating),v.Mb(1),v.ed(" ",v.xc(6,8,c.submission.chainPlating.name)," ")}}var wn=function(){return[30,"[...]"]},jn=function(){return[90,"[...]"]};function xn(t,e){if(1&t&&(v.gc(0,"table",145),v.gc(1,"tbody"),v.gc(2,"tr"),v.gc(3,"td"),v.cd(4,"Metal"),v.fc(),v.gc(5,"td"),v.cd(6),v.wc(7,"titlecase"),v.fc(),v.fc(),v.gc(8,"tr"),v.gc(9,"td"),v.cd(10,"Finish"),v.fc(),v.gc(11,"td"),v.cd(12),v.wc(13,"titlecase"),v.fc(),v.fc(),v.gc(14,"tr"),v.gc(15,"td"),v.cd(16,"Plating"),v.fc(),v.gc(17,"td"),v.cd(18),v.wc(19,"titlecase"),v.fc(),v.fc(),v.gc(20,"tr"),v.gc(21,"td"),v.cd(22,"Jump Ring"),v.fc(),v.gc(23,"td"),v.cd(24),v.wc(25,"truncate"),v.fc(),v.fc(),v.gc(26,"tr"),v.gc(27,"td"),v.cd(28,"Chain"),v.fc(),v.ad(29,An,2,0,"td",39),v.ad(30,In,7,10,"td",39),v.fc(),v.gc(31,"tr",154),v.gc(32,"td"),v.cd(33,"Notes"),v.fc(),v.gc(34,"td"),v.cd(35),v.wc(36,"truncate"),v.fc(),v.fc(),v.fc(),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc();v.Mb(2),v.Sb("invert",c.submission.baseMetal.name!==n.baseMetalSilver),v.Mb(4),v.dd(v.xc(7,9,c.submission.baseMetal.name)),v.Mb(6),v.dd(v.xc(13,11,c.submission.finish.name)),v.Mb(6),v.dd(v.xc(19,13,c.submission.plating.name)),v.Mb(6),v.dd(c.submission.jumpRing?v.yc(25,15,c.submission.jumpRingPlacement,v.Fc(21,wn)):"None"),v.Mb(5),v.Cc("ngIf",!c.submission.chainType),v.Mb(1),v.Cc("ngIf",c.submission.chainType&&c.submission.chainLength),v.Mb(5),v.dd(c.submission.customerNotes?v.yc(36,18,c.submission.customerNotes,v.Fc(22,jn)):"-")}}var On=function(t){return[100,t]};function Bn(t,e){if(1&t&&(v.gc(0,"table",145),v.gc(1,"tbody"),v.gc(2,"tr"),v.gc(3,"td"),v.cd(4,"Metal"),v.fc(),v.gc(5,"td"),v.cd(6),v.wc(7,"titlecase"),v.fc(),v.fc(),v.gc(8,"tr"),v.gc(9,"td"),v.cd(10,"Config"),v.fc(),v.gc(11,"td"),v.cd(12),v.wc(13,"titlecase"),v.fc(),v.fc(),v.gc(14,"tr"),v.gc(15,"td"),v.cd(16,"Finish"),v.fc(),v.gc(17,"td"),v.cd(18),v.wc(19,"titlecase"),v.fc(),v.fc(),v.gc(20,"tr"),v.gc(21,"td"),v.cd(22,"Plating"),v.fc(),v.gc(23,"td"),v.cd(24),v.fc(),v.fc(),v.gc(25,"tr",154),v.gc(26,"td"),v.cd(27,"Notes"),v.fc(),v.gc(28,"td"),v.cd(29),v.wc(30,"truncate"),v.fc(),v.fc(),v.fc(),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc();v.Mb(2),v.Sb("invert",c.submission.baseMetal.name!==n.baseMetalSilver),v.Mb(4),v.dd(v.xc(7,7,c.submission.baseMetal.name)),v.Mb(6),v.dd(v.xc(13,9,c.submission.earringConfig.name)),v.Mb(6),v.dd(v.xc(19,11,c.submission.finish.name)),v.Mb(6),v.dd(c.submission.plating.name),v.Mb(5),v.dd(c.submission.customerNotes?v.yc(30,13,c.submission.customerNotes,v.Gc(16,On,"[...]")):"-")}}function Pn(t,e){if(1&t&&(v.ec(0),v.gc(1,"div",137),v.gc(2,"div",138),v.gc(3,"div",139),v.gc(4,"div",140),v.gc(5,"table",141),v.gc(6,"tr",142),v.gc(7,"th"),v.bc(8,"img",143),v.fc(),v.gc(9,"th",144),v.cd(10),v.wc(11,"numericId"),v.fc(),v.fc(),v.fc(),v.gc(12,"table",145),v.gc(13,"tbody"),v.gc(14,"tr"),v.gc(15,"td"),v.cd(16,"Name"),v.fc(),v.gc(17,"td",146),v.cd(18),v.fc(),v.fc(),v.gc(19,"tr"),v.gc(20,"td"),v.cd(21,"Type"),v.fc(),v.gc(22,"td"),v.cd(23),v.wc(24,"titlecase"),v.fc(),v.gc(25,"td"),v.cd(26),v.wc(27,"number"),v.fc(),v.gc(28,"td"),v.cd(29),v.wc(30,"numericId"),v.fc(),v.fc(),v.gc(31,"tr"),v.gc(32,"td"),v.cd(33,"Source"),v.fc(),v.ad(34,fn,2,2,"td",147),v.ad(35,mn,3,6,"td",147),v.ad(36,pn,2,1,"td",147),v.fc(),v.fc(),v.fc(),v.ad(37,Sn,31,18,"table",148),v.ad(38,xn,37,23,"table",148),v.ad(39,Bn,31,18,"table",148),v.gc(40,"div",149),v.gc(41,"div",150),v.gc(42,"div"),v.gc(43,"span"),v.cd(44,"BM"),v.fc(),v.fc(),v.fc(),v.gc(45,"div",150),v.gc(46,"div"),v.gc(47,"span"),v.cd(48,"PLA"),v.fc(),v.fc(),v.fc(),v.gc(49,"div",150),v.gc(50,"div"),v.gc(51,"span"),v.cd(52,"ENG"),v.fc(),v.fc(),v.fc(),v.gc(53,"div",150),v.gc(54,"div"),v.gc(55,"span"),v.cd(56,"HALM"),v.fc(),v.fc(),v.fc(),v.gc(57,"div",150),v.gc(58,"div"),v.gc(59,"span"),v.cd(60,"JR"),v.fc(),v.fc(),v.fc(),v.gc(61,"div",150),v.gc(62,"div"),v.gc(63,"span"),v.cd(64,"POST"),v.fc(),v.fc(),v.fc(),v.gc(65,"div",150),v.gc(66,"div"),v.gc(67,"span"),v.cd(68,"STN"),v.fc(),v.fc(),v.fc(),v.gc(69,"div",150),v.gc(70,"div"),v.gc(71,"span"),v.cd(72,"RZE"),v.fc(),v.fc(),v.fc(),v.gc(73,"div",150),v.gc(74,"div"),v.gc(75,"span"),v.cd(76,"RPR"),v.fc(),v.fc(),v.fc(),v.fc(),v.bc(77,"ngx-barcode",151),v.gc(78,"p",152),v.cd(79),v.wc(80,"numericId"),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.bc(81,"iframe",153),v.dc()),2&t){var c=e.$implicit,n=v.vc();v.Mb(1),v.Sb("pdfLabel",!n.state.printAll),v.Cc("hidden",!n.state.printAll&&n.state.showToPrint!=="submission"+c.numericId)("id","submission"+c.numericId),v.Mb(7),v.Cc("width",60),v.Mb(2),v.ed("Batch #",v.xc(11,41,n.data.batch.id),""),v.Mb(7),v.Cc("colSpan",100),v.Mb(1),v.dd(c.submission.customer.fullName),v.Mb(5),v.dd(v.xc(24,43,c.submission.kitType.name)),v.Mb(3),v.ed("",v.yc(27,45,c.submission.waxWeight,"1.2-2"),"g"),v.Mb(3),v.ed("#",v.xc(30,48,c.job.id),""),v.Mb(5),v.Cc("ngIf",c.submission.castingCode),v.Mb(1),v.Cc("ngIf",c.submission.customer.event),v.Mb(1),v.Cc("ngIf",!c.submission.customer.event&&!c.submission.castingCode),v.Mb(1),v.Cc("ngIf",c.submission.kitType.name===n.kitTypeRing),v.Mb(1),v.Cc("ngIf",c.submission.kitType.name===n.kitTypePendant),v.Mb(1),v.Cc("ngIf",c.submission.kitType.name===n.kitTypeEarring),v.Mb(2),v.Sb("off",c.submission.baseMetal.name===n.baseMetalSilver),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionPlating]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionEngraving]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionHallmarking]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionJumpRing]||null===c.jobActions[n.actionEarringPosts]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionEarringPosts]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionStoneSetting]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionResizing]),v.Mb(4),v.Sb("off",null===c.jobActions[n.actionRepairing]),v.Mb(4),v.Cc("bc-display-value",!1)("bc-element-type","svg")("bc-height",140)("bc-value",c.numericId)("bc-width",8),v.Mb(2),v.ed("Submission Ref #",v.xc(80,50,c.submission.id),"")}}function Tn(t,e){if(1&t&&(v.ec(0),v.cd(1),v.dc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.ed(" ",c.submission.castingCode," - ")}}function kn(t,e){if(1&t&&(v.ec(0),v.cd(1),v.dc()),2&t){var c=v.vc().$implicit;v.Mb(1),v.ed(" ",c.submission.customer.event," - ")}}function En(t,e){if(1&t&&(v.ec(0),v.gc(1,"div",155),v.gc(2,"div",139),v.gc(3,"div",156),v.gc(4,"table"),v.gc(5,"tbody"),v.gc(6,"tr"),v.gc(7,"td",157),v.bc(8,"ngx-barcode",151),v.fc(),v.gc(9,"td"),v.gc(10,"strong"),v.cd(11),v.fc(),v.bc(12,"br"),v.ad(13,Tn,2,1,"ng-container",39),v.ad(14,kn,2,1,"ng-container",39),v.cd(15),v.wc(16,"numericId"),v.bc(17,"br"),v.gc(18,"strong"),v.cd(19),v.fc(),v.cd(20),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.bc(21,"iframe",158),v.dc()),2&t){var c=e.$implicit;v.Mb(8),v.Cc("bc-display-value",!1)("bc-element-type","svg")("bc-height",100)("bc-value",c.numericId)("bc-width",2),v.Mb(3),v.dd(c.submission.customer.fullName),v.Mb(2),v.Cc("ngIf",c.submission.castingCode),v.Mb(1),v.Cc("ngIf",c.submission.customer.event),v.Mb(1),v.ed(" #",v.xc(16,11,c.submission.id),""),v.Mb(4),v.dd(c.submission.customer.postcode),v.Mb(1),v.ed(" - ",c.submission.customer.address1," ")}}function Nn(t,e){if(1&t){var c=v.hc();v.gc(0,"div",165),v.gc(1,"label",166),v.cd(2),v.fc(),v.gc(3,"input",167),v.rc("ngModelChange",(function(t){v.Oc(c);var n=e.$implicit;return v.vc(2).model.jobActions[n.key]=t})),v.fc(),v.fc()}if(2&t){var n=e.$implicit,i=v.vc(2);v.Mb(1),v.Cc("for","jobAction"+n.key),v.Mb(1),v.dd(n.key),v.Mb(1),v.Cc("ngModel",i.model.jobActions[n.key])("id","jobAction"+n.key)("name","jobAction"+n.key)}}function Jn(t,e){if(1&t){var c=v.hc();v.bc(0,"modal-header",159),v.gc(1,"div",160),v.gc(2,"form",161,162),v.gc(4,"div",11),v.ad(5,Nn,4,5,"div",163),v.wc(6,"keyvalue"),v.fc(),v.fc(),v.fc(),v.gc(7,"modal-footer",164),v.rc("modalSaved",(function(){return v.Oc(c),v.vc().addJobActions()})),v.fc()}if(2&t){var n=e.$implicit,i=v.Lc(3),o=v.vc();v.Cc("modal",n),v.Mb(5),v.Cc("ngForOf",v.xc(6,5,o.model.jobActions)),v.Mb(2),v.Cc("form",i)("modal",n)("saveButtonName","Save")}}function Rn(t,e){if(1&t&&(v.ec(0),v.gc(1,"tr"),v.gc(2,"th"),v.cd(3),v.fc(),v.gc(4,"td"),v.cd(5),v.wc(6,"currency"),v.fc(),v.gc(7,"td"),v.cd(8),v.wc(9,"currency"),v.fc(),v.gc(10,"td"),v.gc(11,"strong"),v.cd(12),v.wc(13,"currency"),v.fc(),v.fc(),v.fc(),v.dc()),2&t){var c=e.$implicit;v.Mb(3),v.dd(c.node.action.name),v.Mb(2),v.dd(v.xc(6,4,c.node.estimatedLaborCost)),v.Mb(3),v.dd(v.xc(9,6,c.node.estimatedMetalCost)),v.Mb(4),v.dd(v.xc(13,8,c.node.estimatedMetalCost+c.node.estimatedLaborCost))}}function _n(t,e){if(1&t&&(v.bc(0,"modal-header",168),v.wc(1,"numericId"),v.gc(2,"div",160),v.gc(3,"table",81),v.gc(4,"thead"),v.gc(5,"tr"),v.gc(6,"th"),v.cd(7,"Action"),v.fc(),v.gc(8,"th"),v.cd(9,"Labour"),v.fc(),v.gc(10,"th"),v.cd(11,"Metal"),v.fc(),v.gc(12,"th"),v.cd(13,"Total"),v.fc(),v.fc(),v.fc(),v.gc(14,"tbody"),v.ad(15,Rn,14,10,"ng-container",4),v.fc(),v.fc(),v.fc()),2&t){var c=e.$implicit,n=v.vc();v.Ec("title","Job Costs for #",v.xc(1,3,n.state.viewingJobForCosts.job.id),""),v.Cc("modal",c),v.Mb(15),v.Cc("ngForOf",n.state.viewingJobForCosts.job.jobActions.edges)}}function Dn(t,e){1&t&&v.bc(0,"loading-ring",169)}var Fn=function(){return function(){var t;this.jobActions=((t={})["Cast & Mount"]=!1,t.Finishing=!1,t.Plating=!1,t.Engraving=!1,t["Jump Ring"]=!1,t["Earring Posts"]=!1,t["Stone Setting"]=!1,t.Resizing=!1,t.Repairing=!1,t.Other=!1,t.Hallmarking=!1,t),this.submissionInfo=null}}(),Hn=function(){function t(t,e,c,n,i,o,a,s,l,d,r,u,g,f,b){var p;this.route=t,this.router=e,this.actionService=c,this.imageLoggingSessionService=n,this.appUserService=i,this.exportToPdfService=o,this.exportDataService=a,this.jobActionService=s,this.jobService=l,this.modalService=d,this.stoneSubmissionService=r,this.submissionBatchService=u,this.submissionNoteService=g,this.submissionService=f,this.toastr=b,this.actionPlating=M,this.actionEngraving=S,this.actionJumpRing=A,this.actionEarringPosts=y,this.actionStoneSetting=I,this.actionResizing=w,this.actionRepairing=j,this.actionHallmarking=x,this.statusInProduction=B.f,this.kitTypeRing=m.e,this.kitTypePendant=m.d,this.kitTypeEarring=m.c,this.baseMetalSilver=$.m,this.ringSizeLeaveAsIs=cc.c,this.model=new Fn,this.data={actions:[],batch:null,nextStatuses:[{currentStatusId:B.g.id,setStatus:B.h,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!1,outgoing:!0},{currentStatusId:B.h.id,setStatus:B.i,buttonText:"Receive Batch",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!1,incoming:!1,outgoing:!0},{currentStatusId:B.b.id,setStatus:B.c,buttonText:"Batch Has Shipped",tableText:"Confirm",takeMetalWeight:!0,manuallyConfirmAll:!1,adminOnly:!1,incoming:!0,outgoing:!1},{currentStatusId:B.c.id,setStatus:B.d,buttonText:"Batch Received",tableText:"Confirm Received",takeMetalWeight:!1,manuallyConfirmAll:!1,adminOnly:!0,incoming:!0,outgoing:!1}],selections:[],submissionInfos:[],totalEstLaborCost:0,totalEstMetalCost:0,createImageLoggingSessionMap:{},submissionPhotoTimingMap:{},incomingBatch:!1,outgoingBatch:!1,jobCount:0,ringCount:0,pendantCount:0,earringCount:0,totalEstimatedCost:0,totalActualCost:0},this.state={allSelected:!1,isAdmin:!1,isSupplier:!1,loading:!0,loadingActions:!1,loadingJobActions:!0,loadingStones:!0,loadingNotes:!0,nextStatus:null,showToPrint:null,printAll:!1,submitting:!1,exporting:!1,imageLoggingSessionState:!1,viewingJobForCosts:null},this._silverBaseMetalName=$.l,this._9ctYellowGoldBaseMetalName=$.j,this._9ctRoseGoldBaseMetalName=$.h,this._9ctWhiteGoldBaseMetalName=$.i,this._14ctYellowGoldBaseMetalName=$.d,this._14ctRoseGoldBaseMetalName=$.b,this._14ctWhiteGoldBaseMetalName=$.c,this._18ctYellowGoldBaseMetalName=$.g,this._18ctRoseGoldBaseMetalName=$.e,this._18ctWhiteGoldBaseMetalName=$.f,this._platinumBaseMetalName=$.k,this.metalsInBatch=((p={})[$.l]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.j]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.h]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.i]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.d]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.b]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.c]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.g]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.e]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.f]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p[$.k]={present:!1,actualCostStaging:0,actualCostExisting:0,estimateCost:0},p),this.imageLoggingSessionState=!1,this.timeElapsed=0}return t.prototype.unloadNotification=function(t){var e=this;this.data.submissionInfos.some((function(t){return e.data.submissionPhotoTimingMap[t.submission.id]}))&&(t.returnValue=!0)},t.prototype.ngOnDestroy=function(){return ac(this,void 0,void 0,(function(){var t,e,c;return sc(this,(function(n){switch(n.label){case 0:t=0,e=this.data.submissionInfos,n.label=1;case 1:return t<e.length?this.data.submissionPhotoTimingMap[(c=e[t]).submission.id]?[4,this.endImageLoggingSession(c.submission)]:[3,3]:[3,4];case 2:n.sent(),n.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},t.prototype.ngOnInit=function(){var t=this;this.liveTimeInterval=setInterval((function(){t.liveTimeCreate()}),500),this.route.paramMap.subscribe((function(e){var c=e.get("id");Object(J.a)(t.submissionBatchService.get("submission_batches/"+c),t.jobService.listByOutgoingBatch(c,999),t.jobService.listByIncomingBatch(c,999),t.appUserService.getMe()).subscribe((function(e){var c,n=e[1],i=e[2],o=e[3];t.data.batch=JSON.parse(JSON.stringify(e[0].data.submissionBatch)),t.model.invoice=t.data.batch.invoice,t.model.invoiced=t.data.batch.invoiced,t.model.labourCostStaging=t.data.batch.invoiceLabourCost/100,t.model.labourCostExisting=t.data.batch.invoiceLabourCost/100,t.model.deliveryCostStaging=t.data.batch.invoiceDeliveryCost/100,t.model.deliveryCostExisting=t.data.batch.invoiceDeliveryCost/100,t.metalsInBatch[$.l].actualCostStaging=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[$.j].actualCostStaging=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[$.h].actualCostStaging=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[$.i].actualCostStaging=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[$.d].actualCostStaging=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[$.b].actualCostStaging=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[$.c].actualCostStaging=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[$.g].actualCostStaging=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[$.e].actualCostStaging=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[$.f].actualCostStaging=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[$.k].actualCostStaging=t.data.batch.invoicePlatinumCost/100,t.metalsInBatch[$.l].actualCostExisting=t.data.batch.invoiceSilverCost/100,t.metalsInBatch[$.j].actualCostExisting=t.data.batch.invoice9ctYellowGoldCost/100,t.metalsInBatch[$.h].actualCostExisting=t.data.batch.invoice9ctRoseGoldCost/100,t.metalsInBatch[$.i].actualCostExisting=t.data.batch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[$.d].actualCostExisting=t.data.batch.invoice14ctYellowGoldCost/100,t.metalsInBatch[$.b].actualCostExisting=t.data.batch.invoice14ctRoseGoldCost/100,t.metalsInBatch[$.c].actualCostExisting=t.data.batch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[$.g].actualCostExisting=t.data.batch.invoice18ctYellowGoldCost/100,t.metalsInBatch[$.e].actualCostExisting=t.data.batch.invoice18ctRoseGoldCost/100,t.metalsInBatch[$.f].actualCostExisting=t.data.batch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[$.k].actualCostExisting=t.data.batch.invoicePlatinumCost/100;for(var a=0,s=t.data.nextStatuses;a<s.length;a++){var l=s[a];l.currentStatusId===t.data.batch.status.id&&(t.state.nextStatus=l)}t.data.batch.status.incomingBatched?t.data.incomingBatch=!0:t.data.outgoingBatch=!0;for(var d=0,r=n.data.jobs.edges.concat(i.data.jobs.edges);d<r.length;d++){var u=r[d];u=JSON.parse(JSON.stringify(u));for(var g=0,f=0,b=((c={})["Cast & Mount"]=null,c.Finishing=null,c.Plating=null,c.Engraving=null,c["Jump Ring"]=null,c["Earring Posts"]=null,c["Stone Setting"]=null,c.Resizing=null,c.Repairing=null,c.Other=null,c.Hallmarking=null,c),p=0,h=u.node.jobActions.edges;p<h.length;p++){var v=h[p];b[v.node.action.name]=v,g+=v.node.estimatedLaborCost,f+=v.node.estimatedMetalCost}switch(t.metalsInBatch[u.node.submission.baseMetal.name].estimateCost+=f,t.data.totalEstLaborCost+=g,t.data.totalEstMetalCost+=f,t.data.jobCount++,u.node.submission.kitType.name){case m.e:t.data.ringCount++;break;case m.d:t.data.pendantCount++;break;case m.c:t.data.earringCount++}t.metalsInBatch[u.node.submission.baseMetal.name].present=!0,t.data.submissionInfos.push({job:u.node,jobActions:b,jobLabourCostEst:g,jobMetalCostEst:f,jobTotalCostEst:g+f,jobActionsFromRequest:u.node.jobActions.edges,numericId:t.getNumericId(u.node.submission.id),pendingUpdateJob:!1,printing:!1,selected:!1,stones:[],notes:[],submission:u.node.submission})}for(var C=0,M=Object.keys(t.metalsInBatch);C<M.length;C++){var S=M[C];t.data.totalActualCost+=t.metalsInBatch[S].actualCostExisting,t.data.totalEstimatedCost+=t.metalsInBatch[S].estimateCost}t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalEstimatedCost+=t.data.totalEstLaborCost,t.data.totalActualCost+=t.model.deliveryCostExisting,t.state.isAdmin=t.appUserService.isAdmin(o.data.appUser.roles),t.state.isSupplier=t.appUserService.isSupplier(o.data.appUser.roles);for(var A=[],y=0,I=t.data.submissionInfos;y<I.length;y++)A.push(I[y].submission.id);t.state.loadingJobActions=!1,t.state.isAdmin&&(t.state.loadingActions=!0,t.actionService.list().subscribe((function(e){t.data.actions=e.data.actions.edges,t.state.loadingActions=!1}))),t.stoneSubmissionService.listBySubmission(A).subscribe((function(e){for(var c=0,n=t.data.submissionInfos;c<n.length;c++)for(var i=n[c],o=0,a=e.data.stoneSubmissions.edges;o<a.length;o++){var s=a[o];s.node.submission.id===i.submission.id&&i.stones.push(s)}t.state.loadingStones=!1})),t.state.loading=!1,t.submissionNoteService.listBySubmission(A).subscribe((function(e){for(var c=0,n=t.data.submissionInfos;c<n.length;c++)for(var i=n[c],o=0,a=e.data.submissionNotes.edges;o<a.length;o++){var s=a[o];s.node.submission.id===i.submission.id&&i.notes.push(s)}t.state.loadingNotes=!1}))}))}))},t.prototype.updateStatus=function(t){return ac(this,void 0,void 0,(function(){var t,e,c=this;return sc(this,(function(n){return this.state.submitting||!this.state.nextStatus||(this.state.submitting=!0,this.toastr.success(null,"Updating Batch"),t=(new Date).toISOString(),e=this.data.batch.dateSent,this.state.nextStatus.currentStatusId===B.g.id&&(e=t),this.submissionBatchService.update({id:this.data.batch.id,status:this.state.nextStatus.setStatus.id,updatedAt:t,dateSent:e}).subscribe((function(t){c.data.batch.status=c.state.nextStatus.setStatus,c.data.batch.dateSent=e,c.data.selections=[];for(var n=0,i=c.data.submissionInfos;n<i.length;n++)i[n].selected=!1;c.state.nextStatus=null;for(var o=0,a=c.data.nextStatuses;o<a.length;o++){var s=a[o];s.currentStatusId===t.data.updateSubmissionBatch.status.id&&(c.state.nextStatus=s)}c.toastr.success(null,"Batch Updated!"),c.state.submitting=!1}))),[2]}))}))},t.prototype.selectRow=function(t){if(!this.state.submitting&&this.state.nextStatus)if(!this.state.nextStatus.takeMetalWeight||t.submission.metalWeight)if(t.selected){t.selected=!t.selected;var e=this.data.selections.findIndex((function(e){return e.submission.id===t.submission.id}));this.data.selections.splice(e,1)}else t.selected=!0,this.data.selections.push(t);else this.toastr.info("","Please enter a Metal Weight for this item before confirming")},t.prototype.selectAll=function(){if(!this.state.loading){if(this.state.allSelected=!this.state.allSelected,!this.state.allSelected)for(var t=0,e=this.data.submissionInfos;t<e.length;t++)(i=e[t]).selected=!0,this.selectRow(i);for(var c=0,n=this.data.submissionInfos;c<n.length;c++){var i;(i=n[c]).selected=this.state.allSelected,this.state.allSelected&&-1===this.data.selections.indexOf(i)&&this.data.selections.push(i)}}},t.prototype.setRush=function(t,e){this.state.isAdmin&&(e.stopPropagation(),t.pendingUpdateJob?(t.job.rush=!t.job.rush,t.pendingUpdateJob=!1,this.updateJob(t)):(t.pendingUpdateJob=!0,setTimeout((function(){t.pendingUpdateJob=!1}),3e3)))},t.prototype.updateJob=function(t){var e=this;this.toastr.info("","Updating Job"),setTimeout((function(c){e.jobService.update({id:t.job.id,due:H.a.removeTimezone(new Date(t.job.due)),rush:t.job.rush}).subscribe((function(t){e.toastr.success("","Job Updated")}))}),250)},t.prototype.deleteJob=function(t){this.toastr.warning("Sorry pal, this feature isn't available yet.")},t.prototype.viewJobActionModal=function(t,e){var c=this;this.model.jobActions["Cast & Mount"]=null!==t.jobActions["Cast & Mount"],this.model.jobActions.Finishing=null!==t.jobActions.Finishing,this.model.jobActions.Plating=null!==t.jobActions.Plating,this.model.jobActions.Engraving=null!==t.jobActions.Engraving,this.model.jobActions["Jump Ring"]=null!==t.jobActions["Jump Ring"],this.model.jobActions["Earring Posts"]=null!==t.jobActions["Earring Posts"],this.model.jobActions["Stone Setting"]=null!==t.jobActions["Stone Setting"],this.model.jobActions.Resizing=null!==t.jobActions.Resizing,this.model.jobActions.Repairing=null!==t.jobActions.Repairing,this.model.jobActions.Other=null!==t.jobActions.Other,this.model.jobActions.Hallmarking=null!==t.jobActions.Hallmarking,this.model.submissionInfo=t,this.modalService.open(e).result.then((function(){return ac(c,void 0,void 0,(function(){var e,c,n,i,o=this;return sc(this,(function(a){switch(a.label){case 0:e=function(e){var n;return sc(this,(function(i){switch(i.label){case 0:return c.model.jobActions[e]&&null===t.jobActions[e]?(c.toastr.success("","Adding action: "+e),n=c.data.actions.find((function(t){return t.node.name===e})),c.jobActionService.create({job:t.job.id,action:n.node.id,completed:!1}).subscribe((function(c){t.jobActions[c.data.createJobAction.action.name]=c.data.createJobAction,o.toastr.success("",e+" added!")})),[3,3]):[3,1];case 1:return c.model.jobActions[e]||null===t.jobActions[e]?[3,3]:(c.toastr.success("","Removing action: "+e),[4,c.jobActionService.delete(t.jobActions[e].node.id)]);case 2:i.sent(),t.jobActions[e]=null,c.toastr.success("",e+" removed!"),i.label=3;case 3:return[2]}}))},c=this,n=0,i=Object.keys(this.model.jobActions),a.label=1;case 1:return n<i.length?[5,e(i[n])]:[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}),(function(){}))},t.prototype.viewJobCostsModal=function(t,e){this.state.viewingJobForCosts=t,this.modalService.open(e)},t.prototype.addJobActions=function(){},t.prototype.createPdf=function(t){return ac(this,void 0,void 0,(function(){var e=this;return sc(this,(function(c){return t.printing=!0,this.state.showToPrint="submission"+t.numericId,setTimeout((function(c){return ac(e,void 0,void 0,(function(){return sc(this,(function(e){switch(e.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(this.state.showToPrint),100)];case 1:return e.sent(),this.state.showToPrint=null,t.printing=!1,[2]}}))}))}),0),[2]}))}))},t.prototype.updateSubmission=function(t){return ac(this,void 0,void 0,(function(){return sc(this,(function(e){switch(e.label){case 0:return t.submission.metalWeight?(this.toastr.info("","Updating Submission"),[4,this.submissionService.update({id:t.submission.id,updatedAt:(new Date).toISOString(),metalWeight:t.submission.metalWeight})]):[2];case 1:return e.sent(),this.toastr.success("","Submission Updated"),[2]}}))}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.prototype.printAll=function(t,e){var c=this;this.data.selections.length?(this.state.printAll=!0,setTimeout((function(n){return ac(c,void 0,void 0,(function(){return sc(this,(function(c){switch(c.label){case 0:return[4,this.exportToPdfService.makeLabel(document.getElementById(t),e)];case 1:return c.sent(),this.state.printAll=!1,[2]}}))}))}),10)):this.toastr.warning("You must have at least one submission selected","No submissions selected")},t.prototype.exportAddressData=function(){if(this.state.exporting=!0,this.data.selections.length<1)return this.toastr.error("You must select at least one submission."),void(this.state.exporting=!1);for(var t,e=[],c=[],n=0,i=this.data.selections;n<i.length;n++)t=this.exportDataService.flattenObject(i[n],e),c.push(t.data),e=t.headers;this.exportDataService.whiteListColumns(["submission.id","fullName","address1","address2","city","county","postcode","country","email","castingCode"],c),this.exportDataService.renameColumns({"submission.id":"Order Reference"},c),this.exportDataService.addStaticValues({weight:.03,packageSize:"large letter",serviceCode:"BPR1",serviceRegisterCode:"01"},c),this.exportDataService.exportToCsv("submission_export_"+(new Date).toLocaleString(),Object.keys(c[0]),c),this.toastr.success("Exported and downloading file"),this.state.exporting=!1},t.prototype.liveTimeCreate=function(){var t=new Date;this.liveTime=("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},t.prototype.startTimer=function(){var t=this;this.timeElapsed=0,this.interval=setInterval((function(){t.timeElapsed++}),1e3)},t.prototype.endTimer=function(){clearInterval(this.interval)},t.prototype.toggleSubmissionPhotoTimer=function(t){return ac(this,void 0,void 0,(function(){var e,c,n;return sc(this,(function(i){switch(i.label){case 0:this.state.submitting=!0,e=0,c=this.data.submissionInfos,i.label=1;case 1:return e<c.length?(n=c[e]).submission.id!==t?[3,6]:this.data.submissionPhotoTimingMap[n.submission.id]?[3,3]:[4,this.createImageLoggingSession(n.submission)]:[3,9];case 2:return i.sent(),[3,5];case 3:return[4,this.endImageLoggingSession(n.submission)];case 4:i.sent(),i.label=5;case 5:return[3,8];case 6:return this.data.submissionPhotoTimingMap[n.submission.id]?(this.data.submissionPhotoTimingMap[n.submission.id]=!1,[4,this.endImageLoggingSession(n.submission)]):[3,8];case 7:i.sent(),i.label=8;case 8:return e++,[3,1];case 9:return this.state.submitting=!1,[2]}}))}))},t.prototype.createImageLoggingSession=function(t){return ac(this,void 0,void 0,(function(){var e,c,n,i;return sc(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=(new Date).toISOString(),c=this.data.createImageLoggingSessionMap,n=t.id,[4,this.imageLoggingSessionService.create({startTime:e,submission:t.id})];case 1:return c[n]=o.sent(),this.imageLoggingSessionState=!0,this.startTimer(),this.toastr.success("Started photo timing session for submission "+t.kitType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!this.data.submissionPhotoTimingMap[t.id],[3,3];case 2:return i=o.sent(),this.toastr.error("Error starting image logging session!"),console.error(i),[3,3];case 3:return[2]}}))}))},t.prototype.endImageLoggingSession=function(t){return ac(this,void 0,void 0,(function(){var e;return sc(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.imageLoggingSessionService.updateEndTime({id:this.data.createImageLoggingSessionMap[t.id].createImageLoggingSession.id,endTime:(new Date).toISOString()})];case 1:return c.sent(),this.imageLoggingSessionState=!1,this.endTimer(),this.toastr.success("Ended photo timing session for "+t.kitType.name+" ("+t.customer.fullName+")"),this.data.submissionPhotoTimingMap[t.id]=!1,[3,3];case 2:return e=c.sent(),this.toastr.error("Error stopping image logging session!"),console.error(e),[3,3];case 3:return[2]}}))}))},t.prototype.onSubmit=function(){var t=this;this.model.invoice?(this.state.submitting=!0,this.submissionBatchService.update({id:this.data.batch.id,updatedAt:(new Date).toISOString(),invoice:this.model.invoice,invoiced:this.model.invoiced,invoiceLabourCost:this.formatCurrency(this.model.labourCostStaging),invoiceDeliveryCost:this.formatCurrency(this.model.deliveryCostStaging),invoiceSilverCost:this.formatCurrency(this.metalsInBatch[$.l].actualCostStaging),invoice9ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[$.j].actualCostStaging),invoice9ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[$.h].actualCostStaging),invoice9ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[$.i].actualCostStaging),invoice14ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[$.d].actualCostStaging),invoice14ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[$.b].actualCostStaging),invoice14ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[$.c].actualCostStaging),invoice18ctYellowGoldCost:this.formatCurrency(this.metalsInBatch[$.g].actualCostStaging),invoice18ctRoseGoldCost:this.formatCurrency(this.metalsInBatch[$.e].actualCostStaging),invoice18ctWhiteGoldCost:this.formatCurrency(this.metalsInBatch[$.f].actualCostStaging),invoicePlatinumCost:this.formatCurrency(this.metalsInBatch[$.k].actualCostStaging)}).subscribe((function(e){t.model.labourCostExisting=e.data.updateSubmissionBatch.invoiceLabourCost/100,t.model.deliveryCostExisting=e.data.updateSubmissionBatch.invoiceDeliveryCost/100,t.metalsInBatch[$.l].actualCostExisting=e.data.updateSubmissionBatch.invoiceSilverCost/100,t.metalsInBatch[$.j].actualCostExisting=e.data.updateSubmissionBatch.invoice9ctYellowGoldCost/100,t.metalsInBatch[$.h].actualCostExisting=e.data.updateSubmissionBatch.invoice9ctRoseGoldCost/100,t.metalsInBatch[$.i].actualCostExisting=e.data.updateSubmissionBatch.invoice9ctWhiteGoldCost/100,t.metalsInBatch[$.d].actualCostExisting=e.data.updateSubmissionBatch.invoice14ctYellowGoldCost/100,t.metalsInBatch[$.b].actualCostExisting=e.data.updateSubmissionBatch.invoice14ctRoseGoldCost/100,t.metalsInBatch[$.c].actualCostExisting=e.data.updateSubmissionBatch.invoice14ctWhiteGoldCost/100,t.metalsInBatch[$.g].actualCostExisting=e.data.updateSubmissionBatch.invoice18ctYellowGoldCost/100,t.metalsInBatch[$.e].actualCostExisting=e.data.updateSubmissionBatch.invoice18ctRoseGoldCost/100,t.metalsInBatch[$.f].actualCostExisting=e.data.updateSubmissionBatch.invoice18ctWhiteGoldCost/100,t.metalsInBatch[$.k].actualCostExisting=e.data.updateSubmissionBatch.invoicePlatinumCost/100,t.data.totalActualCost=0;for(var c=0,n=Object.keys(t.metalsInBatch);c<n.length;c++)t.data.totalActualCost+=t.metalsInBatch[n[c]].actualCostExisting;t.data.totalActualCost+=t.model.labourCostExisting,t.data.totalActualCost+=t.model.deliveryCostExisting,t.toastr.success("","Batch Updated"),t.state.submitting=!1}))):this.toastr.warning("In order to update batch costs, please add an invoice number","Warning")},t.prototype.formatCurrency=function(t){return null===t?null:Math.round(100*t)},t.prototype.objectKeys=function(t){return Object.keys(t)},t.prototype.chartClicked=function(t){},t.prototype.chartHovered=function(t){},t.\u0275fac=function(e){return new(e||t)(v.ac(u.a),v.ac(u.b),v.ac(O),v.ac(ec.a),v.ac(_.a),v.ac(Ze.a),v.ac(tc.a),v.ac(b.a),v.ac(f.a),v.ac(W.i),v.ac(R.a),v.ac(D.a),v.ac(G.a),v.ac(F.a),v.ac(q.b))},t.\u0275cmp=v.Ub({type:t,selectors:[["ng-component"]],hostBindings:function(t,e){1&t&&v.rc("beforeunload",(function(t){return e.unloadNotification(t)}),!1,v.Nc)},decls:13,vars:7,consts:[[3,"title",4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","batch-table-container row mt-5",4,"ngIf"],["id","jobLabels",1,"pdfLabel"],[4,"ngFor","ngForOf"],["id","idLabels",1,"pdfLabel"],["jobActionsModal",""],["jobCostsModal",""],["size","100",4,"ngIf"],[3,"title"],[1,"container-fluid"],[1,"row"],[1,"col-lg-12","col-xl-5"],[1,"row","mb-4"],[1,"col"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"col-md-6"],[1,"col-auto"],["class","mb-0",4,"ngIf"],[1,"mb-0"],[1,"muted","mr-2"],["class","btn btn-outline-primary mr-2",3,"disabled","click",4,"ngIf"],["class","btn btn-outline-primary mr-2",3,"click",4,"ngIf"],["class","col-lg-12 col-xl-7",4,"ngIf"],[1,"btn","btn-outline-primary","mr-2",3,"disabled","click"],[1,"btn","btn-outline-primary","mr-2",3,"click"],[1,"col-lg-12","col-xl-7"],[1,"col-xl-4","col-lg-6","col-md-12","mb-4"],[3,"ngSubmit"],["batchInvoiceDataForm","ngForm"],[1,"row","mb-2"],[1,"form-group"],["for","invoice",1,"req"],["appShowErrorInputClass","","id","invoice","maxlength","50","name","invoice","placeholder","Invoice number","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"checkbox-wrapper","with-label"],["id","invoicedCheckbox","name","invoicedCheckbox","type","checkbox",3,"ngModel","ngModelChange"],["for","invoicedCheckbox"],[4,"ngIf"],[1,"row","justify-content-end"],["type","submit",1,"btn","btn-lg","btn-primary","float-right","fas",3,"disabled"],["aria-hidden","true","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["class","col-xl-8 col-lg-6 col-md-12",4,"ngIf"],[1,"form-group","mb-2"],["for","labour"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["appShowErrorInputClass","","id","labour","limitDecimalPlaces","","min","0","name","labour","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["class","row",4,"ngIf"],["for","delivery"],["appShowErrorInputClass","","id","delivery","limitDecimalPlaces","","min","0","name","delivery","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","silver"],["appShowErrorInputClass","","id","silver","limitDecimalPlaces","","min","0","name","silver","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctYellow"],["appShowErrorInputClass","","id","invoice9ctYellow","limitDecimalPlaces","","min","0","name","invoice9ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctRose"],["appShowErrorInputClass","","id","invoice9ctRose","limitDecimalPlaces","","min","0","name","invoice9ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice9ctWhite"],["appShowErrorInputClass","","id","invoice9ctWhite","limitDecimalPlaces","","min","0","name","invoice9ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctYellow"],["appShowErrorInputClass","","id","invoice14ctYellow","limitDecimalPlaces","","min","0","name","invoice14ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctRose"],["appShowErrorInputClass","","id","invoice14ctRose","limitDecimalPlaces","","min","0","name","invoice14ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice14ctWhite"],["appShowErrorInputClass","","id","invoice14ctWhite","limitDecimalPlaces","","min","0","name","invoice14ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctYellow"],["appShowErrorInputClass","","id","invoice18ctYellow","limitDecimalPlaces","","min","0","name","invoice18ctYellow","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctRose"],["appShowErrorInputClass","","id","invoice18ctRose","limitDecimalPlaces","","min","0","name","invoice18ctRose","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoice18ctWhite"],["appShowErrorInputClass","","id","invoice18ctWhite","limitDecimalPlaces","","min","0","name","invoice18ctWhite","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","invoicePlatinum"],["appShowErrorInputClass","","id","invoicePlatinum","limitDecimalPlaces","","min","0","name","invoicePlatinum","placeholder","","step","0.01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],[1,"col-xl-8","col-lg-6","col-md-12"],[1,"table","bs-table","table-sm"],[1,"batch-table-container","row","mt-5"],[1,"mb-2"],[1,"table-responsive"],[1,"data-table"],["class","checkbox sm",4,"ngIf"],["scope","col",1,"sm"],["scope","col"],["scope","col",4,"ngIf"],["colspan","72","scope","row"],["class","tc mt-5",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"checkbox","sm"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],["class","pr-0 checkbox","scope","row",4,"ngIf"],["scope","row",1,"sm"],[3,"photos"],[1,"sm"],[1,"sm","muted"],[1,"sm",3,"click"],["class","color-warning fas fa-circle",4,"ngIf"],[1,"status","status-pill"],[1,"tr"],[1,"btn-group"],["class","btn hover icon-btn-outline mx-1 fas fa-cogs color-primary","ngbTooltip","Edit Job Actions","type","button",3,"disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-pound-sign","type","button",3,"click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas","type","button",3,"fa-print","disabled","click",4,"ngIf"],["class","btn icon-btn-outline mx-1 fas","type","button",3,"fa-camera","fa-stop","hover","disabled","click",4,"ngIf"],["class","btn hover icon-btn-outline mx-1 fas fa-trash","type","button",3,"click",4,"ngIf"],[3,"customerNote","hover","isAdmin","loadingNotes","notes","submissionId"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission",4,"ngIf"],["scope","row",1,"pr-0","checkbox"],["type","checkbox",3,"ngModel","disabled","name","id","click","ngModelChange"],[3,"for"],["class","fa fa-shipping-fast text-primary",3,"ngbTooltip",4,"ngIf"],["class","fa fa-shipping-fast text-muted",3,"ngbTooltip",4,"ngIf"],[1,"fa","fa-shipping-fast","text-primary",3,"ngbTooltip"],[1,"fa","fa-shipping-fast","text-muted",3,"ngbTooltip"],[1,"color-warning","fas","fa-circle"],["name","dueDate","placeholder","Due Date","required","",3,"ngModel","owlDateTimeTrigger","owlDateTime","ngModelChange"],[3,"pickerType"],["dt2",""],["min","0","name","metalWeight","placeholder","Metal Weight (g)","required","","type","number",3,"ngModel","blur","ngModelChange"],["class","small muted",4,"ngIf"],[1,"small","muted"],["ngbTooltip","Edit Job Actions","type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-cogs","color-primary",3,"disabled","click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-pound-sign",3,"click"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas",3,"disabled","click"],["type","button",1,"btn","icon-btn-outline","mx-1","fas",3,"disabled","click"],["aria-hidden","true","class","spinner-border spinner-border-sm",4,"ngIf"],["aria-hidden","true",1,"spinner-border","spinner-border-sm"],["type","button",1,"btn","hover","icon-btn-outline","mx-1","fas","fa-trash",3,"click"],[3,"buttonStyle","isAdmin","loadingStones","photos","stones","submission"],[1,"tc","mt-5"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-center"],[3,"size"],[3,"hidden","id"],[1,"size-label","manufacturing","page"],[1,"label-inner-wrapper"],[1,"tin-size"],["border","0",1,"logoTable","mb-2","w-100"],["valign","middle"],["alt","CAST Logo","src","/assets/img/cast-logo-black.png",3,"width"],[1,"text-right"],[1,"job_details","mb-1"],[3,"colSpan"],[3,"colSpan",4,"ngIf"],["class","job_details mb-1",4,"ngIf"],[1,"row","label-jobs","align-content-start"],[1,"action","col-2"],[3,"bc-display-value","bc-element-type","bc-height","bc-value","bc-width"],[1,"footer"],["id","printPdf","name","printPdf"],["valign","top",1,"notes"],[1,"size-label","page"],[1,"tin-size",2,"display","table-cell","vertical-align","middle"],[2,"width","100%"],["name","printPdf",1,"printIframeContainer"],["title","Add/Remove Job Actions",3,"modal"],[1,"modal-body"],["novalidate",""],["updateJobActionsForm","ngForm"],["class","col-sm-4 mb-3 tc",4,"ngFor","ngForOf"],[3,"form","modal","saveButtonName","modalSaved"],[1,"col-sm-4","mb-3","tc"],[1,"tc",3,"for"],["appShowErrorInputClass","","type","checkbox",1,"form-control",3,"ngModel","id","name","ngModelChange"],[3,"modal","title"],["size","100"]],template:function(t,e){1&t&&(v.ad(0,lc,1,1,"page-title",0),v.ad(1,dc,1,1,"page-title",0),v.ad(2,Nc,46,14,"div",1),v.ad(3,gn,36,7,"div",2),v.gc(4,"div",3),v.ad(5,Pn,82,52,"ng-container",4),v.gc(6,"div",5),v.ad(7,En,22,13,"ng-container",4),v.fc(),v.fc(),v.ad(8,Jn,8,7,"ng-template",null,6,v.bd),v.ad(10,_n,16,5,"ng-template",null,7,v.bd),v.ad(12,Dn,1,0,"loading-ring",8)),2&t&&(v.Cc("ngIf",e.state.isAdmin),v.Mb(1),v.Cc("ngIf",e.state.isSupplier),v.Mb(1),v.Cc("ngIf",!e.state.loading),v.Mb(1),v.Cc("ngIf",!e.state.loading),v.Mb(2),v.Cc("ngForOf",e.data.submissionInfos),v.Mb(2),v.Cc("ngForOf",e.data.selections),v.Mb(5),v.Cc("ngIf",e.state.loading))},directives:[l.u,l.t,z.a,d.z,d.l,d.m,d.d,It.a,d.g,d.u,d.k,d.n,d.a,d.q,Te.a,vt,Ct.a,W.m,nc.e,nc.g,nc.c,Mt.a,At.a,ic.a,ut.a,wt.a],pipes:[xt.a,oc.a,l.G,l.g,Bt.a,jt.a,Ot.a,l.f,l.I,l.m],styles:[""]}),t}();function Ln(t,e){1&t&&(v.gc(0,"th",7),v.cd(1,"Parent"),v.fc())}function $n(t,e){if(1&t&&(v.gc(0,"td"),v.cd(1),v.wc(2,"titlecase"),v.fc()),2&t){var c=v.vc(2).$implicit;v.Sb("muted",!c.node.parent),v.Mb(1),v.ed(" ",c.node.parent?v.xc(2,3,c.node.parent.company):"None"," ")}}function Gn(t,e){if(1&t&&(v.gc(0,"tr"),v.gc(1,"th",11),v.cd(2),v.wc(3,"numericId"),v.fc(),v.gc(4,"td"),v.cd(5),v.wc(6,"titlecase"),v.fc(),v.gc(7,"td"),v.cd(8),v.wc(9,"titlecase"),v.fc(),v.ad(10,$n,3,5,"td",12),v.bc(11,"td",13),v.fc()),2&t){var c=v.vc().$implicit,n=v.vc(2);v.Mb(2),v.ed("#",v.xc(3,4,c.node.id),""),v.Mb(3),v.dd(v.xc(6,6,c.node.company)),v.Mb(3),v.dd(c.node.contactName?v.xc(9,8,c.node.contactName):""),v.Mb(2),v.Cc("ngIf",n.state.isAdmin)}}function Wn(t,e){if(1&t&&(v.ec(0),v.ad(1,Gn,12,10,"tr",10),v.dc()),2&t){var c=e.$implicit,n=v.vc(2);v.Mb(1),v.Cc("ngIf",c.node.parent||n.state.isAdmin)}}function qn(t,e){if(1&t&&(v.gc(0,"div",5),v.gc(1,"table",6),v.gc(2,"thead"),v.gc(3,"tr"),v.gc(4,"th"),v.cd(5,"ID"),v.fc(),v.gc(6,"th",7),v.cd(7,"Supplier"),v.fc(),v.gc(8,"th",7),v.cd(9,"Contact Name"),v.fc(),v.ad(10,Ln,2,0,"th",8),v.bc(11,"th",7),v.fc(),v.fc(),v.gc(12,"tbody"),v.ad(13,Wn,2,1,"ng-container",9),v.fc(),v.fc(),v.fc()),2&t){var c=v.vc();v.Mb(10),v.Cc("ngIf",c.state.isAdmin),v.Mb(3),v.Cc("ngForOf",c.data.suppliers)}}function zn(t,e){1&t&&v.bc(0,"loading-ring",14),2&t&&v.Cc("size",60)}var Un=[{path:"incoming-batches",component:Ke},{path:"jobs",component:Pe},{path:"outgoing-batches",component:Ke},{path:"create-supplier",component:Ge},{path:"suppliers",component:function(){function t(t,e,c){this.appUserService=t,this.supplierService=e,this.toastrService=c,this.data={suppliers:[]},this.state={isAdmin:!1,loading:!0}}return t.prototype.ngOnInit=function(){var t=this;this.appUserService.getMe().subscribe((function(e){t.state.isAdmin=t.appUserService.isAdmin(e.data.appUser.roles)})),this.supplierService.list(null).subscribe((function(e){for(var c=0,n=e.data.suppliers.edges;c<n.length;c++)t.data.suppliers.push(n[c]);t.state.loading=!1}))},t.prototype.getNumericId=function(t){return t.replace(/\D/g,"")},t.\u0275fac=function(e){return new(e||t)(v.ac(_.a),v.ac(P.a),v.ac(q.b))},t.\u0275cmp=v.Ub({type:t,selectors:[["app-supplier-view"]],decls:5,vars:3,consts:[[3,"title"],[1,"batch-table-container","row","mt-5"],[1,"col"],["class","table-responsive",4,"ngIf"],[3,"size",4,"ngIf"],[1,"table-responsive"],[1,"data-table"],["scope","col"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["scope","row"],[3,"muted",4,"ngIf"],[1,"sm"],[3,"size"]],template:function(t,e){1&t&&(v.bc(0,"page-title",0),v.gc(1,"div",1),v.gc(2,"div",2),v.ad(3,qn,14,2,"div",3),v.ad(4,zn,1,1,"loading-ring",4),v.fc(),v.fc()),2&t&&(v.Cc("title","Supplier List"),v.Mb(3),v.Cc("ngIf",!e.state.loading),v.Mb(1),v.Cc("ngIf",e.state.loading))},directives:[z.a,l.u,l.t,At.a],pipes:[jt.a,l.G],styles:[""]}),t}()},{path:"batches/view/:id",component:Hn}],Yn=function(){function t(){}return t.\u0275mod=v.Yb({type:t}),t.\u0275inj=v.Xb({factory:function(e){return new(e||t)},imports:[[u.f.forChild(Un)],u.f]}),t}(),Qn=c("kvL/"),Vn=c("c3nT"),Xn=c("1lsF"),Kn=function(){function t(){}return t.\u0275mod=v.Yb({type:t}),t.\u0275inj=v.Xb({factory:function(e){return new(e||t)},imports:[[Xn.BatchModule,l.c,d.f,Yn,yt.b,W.g,Qn.c,ic.b,r.a,nc.f,nc.j,Vn.SubmissionModule]]}),t}()}}]);