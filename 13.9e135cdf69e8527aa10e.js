(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{ZtzB:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),a=function(){function e(e){this.el=e,this.allowedKeys=["0","1","2","3","4","5","6","7","8","9","-","."]}return e.prototype.onKeyDown=function(e){if(-1!==this.allowedKeys.indexOf(e.key)){var t;t=this.decimalPlaces?new RegExp("^-?[0-9]*.?[0-9]{0,"+String(this.decimalPlaces)+"}$","g"):new RegExp("^-?[0-9]*$","g");var n=this.el.nativeElement.value.concat(e.key);window.getSelection().toString().length>0||!n||String(n).match(t)||e.preventDefault()}},e.prototype.onChange=function(){var e=this.el.nativeElement.value;if(e){var t=new RegExp("^-?\\d+(?:.\\d{0,"+String(this.decimalPlaces||-1)+"})?");this.el.nativeElement.value=e.toString().match(t)[0]}},e.\u0275fac=function(t){return new(t||e)(i.ac(i.o))},e.\u0275dir=i.Vb({type:e,selectors:[["","limitDecimalPlaces",""]],hostBindings:function(e,t){1&e&&i.rc("keydown",(function(e){return t.onKeyDown(e)}))("change",(function(e){return t.onChange(e)}))},inputs:{decimalPlaces:"decimalPlaces"}}),e}()},jkDv:function(e,t,n){"use strict";n.r(t),n.d(t,"AdminModule",(function(){return Q}));var i,a,c,o,r=n("ofXK"),s=n("3Pt+"),d=n("PCNd"),l=n("tyNb"),g=n("OwiP"),u=n("1uah"),f=n("PC64"),m=n("lTCR"),p=n.n(m),b=p()(i||(c=["\n    query royalMailZoneList {\n        royalMailZones {\n            edges  {\n                node {\n                    id\n                    zone\n                    shippingPrice\n                }\n            }\n        }\n    }\n"],o=["\n    query royalMailZoneList {\n        royalMailZones {\n            edges  {\n                node {\n                    id\n                    zone\n                    shippingPrice\n                }\n            }\n        }\n    }\n"],Object.defineProperty?Object.defineProperty(c,"raw",{value:o}):c.raw=o,i=c)),h=p()(a||(a=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(['\n    mutation updateRoyalMailZone(\n        $id: ID!,\n        $shippingPrice: Int,\n    ) {\n        updateRoyalMailZone(input: {\n            id: $id,\n            shippingPrice: $shippingPrice,\n            clientMutationId: "",\n        }) {\n            id\n            zone\n        }\n    }\n'],['\n    mutation updateRoyalMailZone(\n        $id: ID!,\n        $shippingPrice: Int,\n    ) {\n        updateRoyalMailZone(input: {\n            id: $id,\n            shippingPrice: $shippingPrice,\n            clientMutationId: "",\n        }) {\n            id\n            zone\n        }\n    }\n']))),v=n("fXoL"),M=n("/IUn"),C=function(){function e(e){this.apollo=e}return e.prototype.list=function(){return this.apollo.watchQuery({query:b}).valueChanges},e.prototype.update=function(e){return this.apollo.mutate({mutation:h,variables:e})},e.\u0275fac=function(t){return new(t||e)(v.oc(M.b))},e.\u0275prov=v.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),P=n("5eHb"),y=n("n4kJ"),w=n("ZtzB"),E=n("wOBz"),S=["updatePricingForm"];function I(e,t){1&e&&v.bc(0,"span",23)}function k(e,t){if(1&e){var n=v.hc();v.gc(0,"tr"),v.gc(1,"th",13),v.dd(2),v.fc(),v.gc(3,"td"),v.gc(4,"div",14),v.gc(5,"input",15,16),v.rc("ngModelChange",(function(e){v.Pc(n);var i=t.$implicit;return v.vc(2).model.baseMetals[i.node.name]=e})),v.fc(),v.gc(7,"div",17),v.gc(8,"span",18),v.dd(9,"\xa3 / gram"),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(10,"td",19),v.gc(11,"div",20),v.gc(12,"button",21),v.rc("click",(function(){v.Pc(n);var e=t.$implicit;return v.vc(2).onUpdateBaseMetal(e.node)})),v.bd(13,I,1,0,"span",22),v.fc(),v.fc(),v.fc(),v.fc()}if(2&e){var i=t.$implicit,a=v.Mc(6),c=v.vc(2);v.Mb(2),v.ed(i.node.name),v.Mb(3),v.Cc("ngModel",c.model.baseMetals[i.node.name])("name",i.node.name),v.Mb(7),v.Sb("fa-save",!c.state.submitting),v.Cc("disabled",!a.dirty),v.Mb(1),v.Cc("ngIf",c.state.submitting)}}function T(e,t){if(1&e){var n=v.hc();v.gc(0,"input",26,27),v.rc("ngModelChange",(function(e){v.Pc(n);var t=v.vc().$implicit;return v.vc(2).model.castingPrices[t.node.name].price=e})),v.fc()}if(2&e){var i=v.vc().$implicit,a=v.vc(2);v.Cc("ngModel",a.model.castingPrices[i.node.name].price)("decimalPlaces",2)("name",i.node.name)}}function x(e,t){if(1&e){var n=v.hc();v.gc(0,"input",26,28),v.rc("ngModelChange",(function(e){v.Pc(n);var t=v.vc().$implicit;return v.vc(2).model.castingPrices[t.node.name].rate=e})),v.fc()}if(2&e){var i=v.vc().$implicit,a=v.vc(2);v.Cc("ngModel",a.model.castingPrices[i.node.name].rate)("decimalPlaces",1)("name",i.node.name)}}function R(e,t){1&e&&v.bc(0,"span",23)}function z(e,t){if(1&e){var n=v.hc();v.gc(0,"tr"),v.gc(1,"th",13),v.dd(2),v.fc(),v.gc(3,"td"),v.gc(4,"div",14),v.bd(5,T,2,3,"input",24),v.bd(6,x,2,3,"input",24),v.gc(7,"div",17),v.gc(8,"span",18),v.dd(9),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(10,"td",19),v.gc(11,"div",20),v.gc(12,"button",25),v.rc("click",(function(){v.Pc(n);var e=t.$implicit;return v.vc(2).onUpdateCastingPrice(e.node)})),v.bd(13,R,1,0,"span",22),v.fc(),v.fc(),v.fc(),v.fc()}if(2&e){var i=t.$implicit,a=v.vc(2);v.Mb(2),v.ed(i.node.displayName),v.Mb(3),v.Cc("ngIf",null!==i.node.price),v.Mb(1),v.Cc("ngIf",null===i.node.price),v.Mb(3),v.ed(i.node.price?"\xa3":"%"),v.Mb(3),v.Sb("fa-save",!a.state.submitting),v.Mb(1),v.Cc("ngIf",a.state.submitting)}}function D(e,t){1&e&&v.bc(0,"span",23)}function Z(e,t){if(1&e){var n=v.hc();v.gc(0,"tr"),v.gc(1,"th",13),v.dd(2),v.fc(),v.gc(3,"td"),v.gc(4,"div",14),v.gc(5,"input",29,30),v.rc("ngModelChange",(function(e){v.Pc(n);var i=t.$implicit;return v.vc(2).model.royalMailZones[i.node.zone]=e})),v.fc(),v.gc(7,"div",17),v.gc(8,"span",18),v.dd(9,"\xa3"),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(10,"td",19),v.gc(11,"div",20),v.gc(12,"button",21),v.rc("click",(function(){v.Pc(n);var e=t.$implicit;return v.vc(2).onUpdateRoyalMailZone(e.node)})),v.bd(13,D,1,0,"span",22),v.fc(),v.fc(),v.fc(),v.fc()}if(2&e){var i=t.$implicit,a=v.Mc(6),c=v.vc(2);v.Mb(2),v.ed(i.node.zone),v.Mb(3),v.Cc("name",i.node.zone)("ngModel",c.model.royalMailZones[i.node.zone]),v.Mb(7),v.Sb("fa-save",!c.state.submitting),v.Cc("disabled",!a.dirty),v.Mb(1),v.Cc("ngIf",c.state.submitting)}}function $(e,t){if(1&e&&(v.gc(0,"form",5,6),v.gc(2,"div",7),v.gc(3,"div",8),v.gc(4,"h5"),v.dd(5,"Metal Prices"),v.fc(),v.gc(6,"div",9),v.gc(7,"table",10),v.gc(8,"thead"),v.gc(9,"tr"),v.gc(10,"th"),v.dd(11,"Metal"),v.fc(),v.gc(12,"th"),v.dd(13,"Price"),v.fc(),v.bc(14,"th"),v.fc(),v.fc(),v.gc(15,"tbody"),v.bd(16,k,14,7,"tr",11),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(17,"div",8),v.gc(18,"h5"),v.dd(19,"Casting and Event Prices"),v.fc(),v.gc(20,"div",9),v.gc(21,"table",10),v.gc(22,"thead"),v.gc(23,"tr"),v.gc(24,"th"),v.dd(25,"Service"),v.fc(),v.gc(26,"th"),v.dd(27,"Price"),v.fc(),v.bc(28,"th"),v.fc(),v.fc(),v.gc(29,"tbody"),v.bd(30,z,14,7,"tr",11),v.fc(),v.fc(),v.fc(),v.fc(),v.gc(31,"div",8),v.gc(32,"h5"),v.dd(33,"Shipping Prices"),v.fc(),v.gc(34,"div",12),v.gc(35,"table",10),v.gc(36,"thead"),v.gc(37,"tr"),v.gc(38,"th"),v.dd(39,"Zone"),v.fc(),v.gc(40,"th"),v.dd(41,"Price"),v.fc(),v.bc(42,"th"),v.fc(),v.fc(),v.gc(43,"tbody"),v.bd(44,Z,14,7,"tr",11),v.fc(),v.fc(),v.fc(),v.fc(),v.fc(),v.fc()),2&e){var n=v.vc();v.Mb(16),v.Cc("ngForOf",n.data.baseMetals),v.Mb(14),v.Cc("ngForOf",n.data.castingPrices),v.Mb(14),v.Cc("ngForOf",n.data.royalMailZones)}}function O(e,t){1&e&&v.bc(0,"loading-ring",31),2&e&&v.Cc("size",60)}var U=function(){return function(){this.baseMetals={},this.castingPrices={},this.royalMailZones={}}}(),A=function(){function e(e,t,n,i){this.baseMetalService=e,this.castingPriceService=t,this.royalMailZoneService=n,this.toastr=i,this.model=new U,this.data={baseMetals:[],castingPrices:[],royalMailZones:[]},this.state={loading:!0,submitting:!1}}return e.prototype.ngOnInit=function(){var e=this;Object(u.a)(this.baseMetalService.listAll(),this.castingPriceService.list(),this.royalMailZoneService.list()).subscribe((function(t){var n=t[1],i=t[2];e.data.baseMetals=t[0].data.baseMetals.edges,e.data.castingPrices=n.data.castingPrices.edges,e.data.royalMailZones=i.data.royalMailZones.edges;for(var a=0,c=e.data.baseMetals;a<c.length;a++){var o=c[a];e.model.baseMetals[o.node.name]=o.node.pricePerGram/100}for(var r=0,s=e.data.castingPrices;r<s.length;r++){var d=s[r];e.model.castingPrices[d.node.name]={price:null!==d.node.price?d.node.price/100:null,rate:null!==d.node.rate?Math.round(1e3*d.node.rate)/10:null}}for(var l=0,g=e.data.royalMailZones;l<g.length;l++){var u=g[l];e.model.royalMailZones[u.node.zone]=u.node.shippingPrice/100}e.state.loading=!1}))},e.prototype.onUpdateBaseMetal=function(e){var t=this;this.state.submitting=!0,this.toastr.success("","Updating");var n={id:e.id,pricePerGram:Math.round(100*this.model.baseMetals[e.name])};this.baseMetalService.update(n).subscribe((function(e){t.state.submitting=!1,t.updatePricingForm.form.markAsPristine(),t.toastr.success("",e.data.updateBaseMetal.name+" Updated")}))},e.prototype.onUpdateCastingPrice=function(e){var t=this;this.state.submitting=!0,this.toastr.success("","Updating");var n={id:e.id,price:null!==this.model.castingPrices[e.name].price?Math.round(100*this.model.castingPrices[e.name].price):null,rate:null!==this.model.castingPrices[e.name].rate?this.model.castingPrices[e.name].rate/100:null};this.castingPriceService.update(n).subscribe((function(e){t.state.submitting=!1,t.updatePricingForm.form.markAsPristine(),t.toastr.success("",e.data.updateCastingPrice.displayName+" Updated")}))},e.prototype.onUpdateRoyalMailZone=function(e){var t=this;this.state.submitting=!0,this.toastr.success("","Updating");var n={id:e.id,shippingPrice:Math.round(100*this.model.royalMailZones[e.zone])};this.royalMailZoneService.update(n).subscribe((function(e){t.state.submitting=!1,t.updatePricingForm.form.markAsPristine(),t.toastr.success("",e.data.updateRoyalMailZone.zone+" Updated")}))},e.\u0275fac=function(t){return new(t||e)(v.ac(f.a),v.ac(g.a),v.ac(C),v.ac(P.b))},e.\u0275cmp=v.Ub({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&v.jd(S,!0),2&e&&v.Lc(n=v.sc())&&(t.updatePricingForm=n.first)},decls:5,vars:2,consts:[["subtitle","Metal, Making, and Money","title","View And Update Pricing"],[1,"card"],[1,"card-body"],["id","updatePricingForm","novalidate","",4,"ngIf"],[3,"size",4,"ngIf"],["id","updatePricingForm","novalidate",""],["updatePricingForm","ngForm"],[1,"row"],[1,"col-md-6"],[1,"table-responsive","mb-3"],[1,"data-table"],[4,"ngFor","ngForOf"],[1,"table-responsive"],["scope","row"],[1,"input-group"],["type","number",1,"form-control",3,"ngModel","name","ngModelChange"],["metalInput","ngModel"],[1,"input-group-append"],[1,"input-group-text"],[1,"tr"],[1,"btn-group"],["type","button",1,"btn","icon-btn-outline","mx-1","fas","color-primary",3,"disabled","click"],["aria-hidden","true","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],["class","form-control","limitDecimalPlaces","","type","number",3,"ngModel","decimalPlaces","name","ngModelChange",4,"ngIf"],["type","button",1,"btn","icon-btn-outline","mx-1","fas","color-primary",3,"click"],["limitDecimalPlaces","","type","number",1,"form-control",3,"ngModel","decimalPlaces","name","ngModelChange"],["pricesNumber","ngModel"],["pricesPercent","ngModel"],["type","number",1,"form-control",3,"name","ngModel","ngModelChange"],["royalMailInput","ngModel"],[3,"size"]],template:function(e,t){1&e&&(v.bc(0,"page-title",0),v.gc(1,"div",1),v.gc(2,"div",2),v.bd(3,$,45,3,"form",3),v.bd(4,O,1,1,"loading-ring",4),v.fc(),v.fc()),2&e&&(v.Mb(3),v.Cc("ngIf",!t.state.loading),v.Mb(1),v.Cc("ngIf",t.state.loading))},directives:[y.a,r.u,s.z,s.l,s.m,r.t,s.q,s.d,s.k,s.n,w.a,E.a],encapsulation:2}),e}(),F=n("9TxS"),L=n("zz98"),W=n("S6Vu"),j=n("1kSV"),G=n("z17N"),B=n("r1eF"),q=n("zVvu");function N(e,t){if(1&e&&(v.gc(0,"div",25),v.gc(1,"div",26),v.gc(2,"h4"),v.dd(3),v.fc(),v.gc(4,"h4"),v.dd(5),v.wc(6,"currency"),v.fc(),v.fc(),v.gc(7,"div",26),v.gc(8,"h4"),v.dd(9),v.fc(),v.gc(10,"h4"),v.dd(11),v.wc(12,"currency"),v.fc(),v.fc(),v.gc(13,"div",26),v.gc(14,"h4"),v.dd(15),v.fc(),v.gc(16,"h4"),v.dd(17),v.wc(18,"currency"),v.fc(),v.fc(),v.fc()),2&e){var n=v.vc(2);v.Mb(3),v.fd("Created: ",n.data.created.length,""),v.Mb(2),v.fd("Estimated Cost: ",v.xc(6,6,n.data.createdEstimatedCost),""),v.Mb(4),v.fd("Redeemed: ",n.data.redeemed.length,""),v.Mb(2),v.fd("Estimated Cost: ",v.xc(12,8,n.data.redeemedEstimatedCost),""),v.Mb(4),v.fd("Expired: ",n.data.expired.length,""),v.Mb(2),v.fd("Estimated Savings: ",v.xc(18,10,n.data.expiredEstimatedCost),"")}}function X(e,t){1&e&&v.bc(0,"loading-ring",27),2&e&&v.Cc("size",60)}function V(e,t){if(1&e){var n=v.hc();v.gc(0,"form",3,4),v.gc(2,"div",5),v.gc(3,"div",6),v.gc(4,"div",7),v.gc(5,"div",8),v.gc(6,"h4"),v.dd(7),v.fc(),v.gc(8,"h4"),v.dd(9),v.wc(10,"currency"),v.fc(),v.gc(11,"p",9),v.dd(12,"Estimated cost value of kit casting code"),v.fc(),v.fc(),v.gc(13,"div",8),v.gc(14,"h4"),v.dd(15),v.fc(),v.gc(16,"h4"),v.dd(17),v.wc(18,"currency"),v.wc(19,"currency"),v.wc(20,"currency"),v.fc(),v.gc(21,"p",9),v.dd(22,"Estimated cost value of in-progress items (based on wax weight)"),v.fc(),v.fc(),v.fc(),v.gc(23,"button",10),v.rc("click",(function(){v.Pc(n);var e=v.vc(),t=v.Mc(3);return e.modalService.open(t)})),v.dd(24," Refresh Cost Estimates "),v.fc(),v.fc(),v.fc(),v.gc(25,"div",11),v.gc(26,"div",6),v.gc(27,"div",12),v.gc(28,"div",8),v.gc(29,"div",13),v.gc(30,"label",14),v.dd(31,"Start"),v.fc(),v.gc(32,"input",15),v.rc("ngModelChange",(function(e){return v.Pc(n),v.vc().model.range=e})),v.fc(),v.bc(33,"owl-date-time",16,17),v.fc(),v.fc(),v.gc(35,"div",8),v.gc(36,"div",13),v.gc(37,"label",18),v.dd(38,"End"),v.fc(),v.gc(39,"input",19),v.rc("ngModelChange",(function(e){return v.Pc(n),v.vc().model.range=e})),v.fc(),v.bc(40,"owl-date-time",16,20),v.fc(),v.fc(),v.gc(42,"div",21),v.gc(43,"button",22),v.rc("click",(function(){return v.Pc(n),v.vc().fetchCastingCodesInRange()})),v.dd(44," Search "),v.fc(),v.fc(),v.fc(),v.bc(45,"hr"),v.bd(46,N,19,12,"div",23),v.bd(47,X,1,1,"loading-ring",24),v.fc(),v.fc(),v.fc()}if(2&e){var i=v.Mc(34),a=v.Mc(41),c=v.vc();v.Mb(7),v.fd("Total Outstanding: ",c.data.castingCodes.length,""),v.Mb(2),v.fd("Estimated Outstanding: ",v.xc(10,19,c.data.totalEstimatedCost),""),v.Mb(6),v.fd("Total In Progress: ",c.data.submissionsInProgress.length,""),v.Mb(2),v.hd(" Estimated In Progress: ",v.xc(18,21,c.data.inProgressLaborEstimatedCost+c.data.inProgressMetalEstimatedCost)," (Labor: ",v.xc(19,23,c.data.inProgressLaborEstimatedCost),", Metal: ",v.xc(20,25,c.data.inProgressMetalEstimatedCost),") "),v.Mb(6),v.Cc("disabled",c.state.refreshingCostEstimates),v.Mb(9),v.Cc("ngModel",c.model.range)("owlDateTimeTrigger",i)("owlDateTime",i)("selectMode","rangeFrom"),v.Mb(1),v.Cc("startAt",c.getStart()),v.Mb(6),v.Cc("ngModel",c.model.range)("owlDateTimeTrigger",a)("owlDateTime",a)("selectMode","rangeTo"),v.Mb(1),v.Cc("startAt",c.getEnd()),v.Mb(6),v.Cc("ngIf",!c.state.loadingRange),v.Mb(1),v.Cc("ngIf",c.state.loading||c.state.loadingRange)}}function K(e,t){if(1&e){var n=v.hc();v.bc(0,"modal-header",28),v.gc(1,"div",29),v.gc(2,"p"),v.dd(3," This will recalculate the cost estimates of all non-expired, non-redeemed items. "),v.fc(),v.gc(4,"p"),v.dd(5,"The old values cannot be restored. Continue?"),v.fc(),v.fc(),v.gc(6,"div",30),v.gc(7,"div"),v.gc(8,"button",31),v.rc("click",(function(){return v.Pc(n),v.vc().modalService.dismissAll()})),v.dd(9," Go Back "),v.fc(),v.gc(10,"button",22),v.rc("click",(function(){return v.Pc(n),v.vc().refreshCostEstimates()})),v.dd(11," Refresh "),v.fc(),v.fc(),v.fc()}2&e&&v.Cc("modal",t.$implicit)}var Y=function(){return function(){}}(),J=[{path:"accounting-report",component:function(){function e(e,t,n,i){this.castingCodeService=e,this.modalService=t,this.pricingAndWeightService=n,this.submissionService=i,this.model=new Y,this.data={baseMetals:[],castingCodes:[],created:[],createdEstimatedCost:0,estimatedCostInRange:0,expired:[],expiredEstimatedCost:0,inProgressLaborEstimatedCost:0,inProgressMetalEstimatedCost:0,redeemed:[],redeemedEstimatedCost:0,submissionsInProgress:[],totalEstimatedCost:0},this.state={loading:!0,loadingRange:!1,refreshingCostEstimates:!1,timeNow:new Date}}return e.prototype.ngOnInit=function(){var e=this;this.state.loading=!0,this.model.range=[this.getStart(),this.getEnd()],this.fetchCastingCodesInRange(),Object(u.a)(this.castingCodeService.list(null,null,null,null,!1,!1),this.submissionService.listForAccounting()).subscribe((function(t){var n=t[1];e.data.castingCodes=t[0].data.castingCodes.edges,e.data.submissionsInProgress=n.data.submissions.edges,e.data.totalEstimatedCost=0;for(var i=0,a=e.data.castingCodes;i<a.length;i++)e.data.totalEstimatedCost+=a[i].node.estimatedCost;e.data.inProgressLaborEstimatedCost=0,e.data.inProgressMetalEstimatedCost=0;for(var c=0,o=e.data.submissionsInProgress;c<o.length;c++){var r=o[c];e.data.inProgressLaborEstimatedCost+=r.node.estimatedLaborCost,e.data.inProgressMetalEstimatedCost+=r.node.estimatedMetalCost}e.state.loading=!1}))},e.prototype.fetchCastingCodesInRange=function(){var e=this;this.state.loadingRange=!0,this.model.range[0]=this.getStart(),this.model.range[1]=this.getEnd();var t=this.model.range[0].toUTCString(),n=this.model.range[1].toUTCString();Object(u.a)(this.castingCodeService.listWithTimings(null,null,"DESC",null,null,!0,null,null,t,n),this.castingCodeService.listWithTimings(null,null,"DESC",null,null,!1,t,n),this.castingCodeService.listWithTimings(null,null,"DESC",null,null,!1,null,null,null,null,t,n)).subscribe((function(t){var n=t[1],i=t[2];e.data.redeemed=t[0].data.castingCodes.edges,e.data.expired=n.data.castingCodes.edges,e.data.created=i.data.castingCodes.edges,e.data.redeemedEstimatedCost=0;for(var a=0,c=e.data.redeemed;a<c.length;a++)e.data.redeemedEstimatedCost+=c[a].node.estimatedCost;e.data.expiredEstimatedCost=0;for(var o=0,r=e.data.expired;o<r.length;o++)e.data.expiredEstimatedCost+=r[o].node.estimatedCost;e.data.createdEstimatedCost=0;for(var s=0,d=e.data.created;s<d.length;s++)e.data.createdEstimatedCost+=d[s].node.estimatedCost;e.state.loadingRange=!1}))},e.prototype.refreshCostEstimates=function(){var e=this;this.state.refreshingCostEstimates=!0,this.modalService.dismissAll(),this.pricingAndWeightService.refreshEstimatedCosts().subscribe((function(t){e.state.refreshingCostEstimates=!1,e.ngOnInit()}))},e.prototype.getStart=function(){return this.model.range&&this.model.range[0]?new Date(this.model.range[0]):e.getDaysAgo(7)},e.getDaysAgo=function(e){var t=new Date;return t.setDate(t.getDate()-e),t},e.prototype.getEnd=function(){return this.model.range&&this.model.range[1]?new Date(this.model.range[1]):new Date},e.\u0275fac=function(t){return new(t||e)(v.ac(F.a),v.ac(j.i),v.ac(L.a),v.ac(W.a))},e.\u0275cmp=v.Ub({type:e,selectors:[["ng-component"]],decls:4,vars:1,consts:[["title","View And Update Pricing","subtitle","Metal, Making, and Money"],["novalidate","",4,"ngIf"],["modalRefresh",""],["novalidate",""],["accountingReportForm","ngForm"],[1,"card","mb-4"],[1,"card-body"],[1,"row"],[1,"col-sm-6"],[1,"muted"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"card"],[1,"row","mb-5"],[1,"form-group"],["for","startTime",1,"req"],["id","startTime","name","startTime","placeholder","-- Please Select --","required","",1,"form-control",3,"ngModel","owlDateTimeTrigger","owlDateTime","selectMode","ngModelChange"],[3,"startAt"],["dt1",""],["for","endTime",1,"req"],["id","endTime","name","endTime","placeholder","-- Please Select --","required","",1,"form-control",3,"ngModel","owlDateTimeTrigger","owlDateTime","selectMode","ngModelChange"],["dt2",""],[1,"col-12","tc"],["type","button",1,"btn","btn-primary",3,"click"],["class","row mt-5",4,"ngIf"],[3,"size",4,"ngIf"],[1,"row","mt-5"],[1,"col-4"],[3,"size"],["title","Are you sure?",3,"modal"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark","mr-1",3,"click"]],template:function(e,t){1&e&&(v.bc(0,"page-title",0),v.bd(1,V,48,27,"form",1),v.bd(2,K,12,1,"ng-template",null,2,v.cd)),2&e&&(v.Mb(1),v.Cc("ngIf",!t.state.loading))},directives:[y.a,r.u,s.z,s.l,s.m,s.d,G.c,s.u,s.k,s.n,G.e,G.b,E.a,B.a],pipes:[q.a],encapsulation:2}),e}()},{path:"pricing",component:A}],_=function(){function e(){}return e.\u0275mod=v.Yb({type:e}),e.\u0275inj=v.Xb({factory:function(t){return new(t||e)},imports:[[l.f.forChild(J)],l.f]}),e}(),Q=function(){function e(){}return e.\u0275mod=v.Yb({type:e}),e.\u0275inj=v.Xb({factory:function(t){return new(t||e)},imports:[[r.c,s.f,_,d.a,G.d,G.f]]}),e}()},n4kJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),a=function(){function e(){}return Object.defineProperty(e.prototype,"title",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subtitle",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Ub({type:e,selectors:[["page-title"]],inputs:{title:"title",subtitle:"subtitle"},decls:5,vars:2,consts:[[1,"page-title"],[1,"mb-0"],[1,"text-muted"]],template:function(e,t){1&e&&(i.gc(0,"div",0),i.gc(1,"h3",1),i.dd(2),i.fc(),i.gc(3,"p",2),i.dd(4),i.fc(),i.fc()),2&e&&(i.Mb(2),i.ed(t._title),i.Mb(2),i.ed(t._subtitle))},encapsulation:2}),e}()},zz98:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("y/Ic"),a=n("zOkP"),c=n("PC64"),o=n("AytR"),r=n("fXoL"),s=n("tk/3"),d={Wax:.9,Silver:10.8,"9 Carat Yellow Gold":12.7,"9 Carat Rose Gold":12.7,"9 Carat White Gold":12.7,"14 Carat Yellow Gold":14.6,"14 Carat Rose Gold":14.6,"14 Carat White Gold":14.6,"18 Carat Yellow Gold":15.9,"18 Carat Rose Gold":15.9,"18 Carat White Gold":16.9,Platinum:21.4},l=function(){function e(e){this.http=e}return e.prototype.getPriceAndWeight=function(e,t){for(var n=this.getBaseMetalMap(t),o=[],r=0,s=e;r<s.length;r++){var l=s[r],g=l.node.baseMetal?l.node.baseMetal.name:c.m,u=l.node.waxWeight*(d[g]/d.Wax);l.node.earringConfig&&l.node.earringConfig.name===i.d&&(u*=2);var f,m=n[g]/100*u,p=0;switch(l.node.kitType.name){case a.g:p=1.5;break;case a.f:p=1.5,p+=l.node.jumpRing?3:0;break;case a.e:p=9}o.push({id:l.node.id,metalWeight:u,metalCost:m,finishingCost:p,castingCost:f=u>=4?8:6,cost:m+p+f})}return o},e.prototype.getBaseMetalMap=function(e){for(var t={},n=0,i=e;n<i.length;n++){var a=i[n];t[a.node.name]=a.node.pricePerGram}return t},e.prototype.refreshEstimatedCosts=function(){return this.http.get(o.a.apiNonGraphQLUrl+"refresh-price-estimates",{})},e.\u0275fac=function(t){return new(t||e)(r.oc(s.b))},e.\u0275prov=r.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}]);