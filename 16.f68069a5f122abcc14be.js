(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+EnD":function(e,t,n){"use strict";n.r(t),n.d(t,"KitModule",(function(){return Kn}));var c,i,o,d,r,a,s=n("ofXK"),l=n("PCNd"),g=n("tyNb"),u=n("1uah"),f=n("lTCR"),p=n.n(f),h=p()(c||(r=["\n  query chainLengthList {\n    chainLengths {\n      edges {\n        node {\n          id\n          name\n          price\n        }\n      }\n    }\n  }\n"],a=["\n  query chainLengthList {\n    chainLengths {\n      edges {\n        node {\n          id\n          name\n          price\n        }\n      }\n    }\n  }\n"],Object.defineProperty?Object.defineProperty(r,"raw",{value:a}):r.raw=a,c=r)),m=n("fXoL"),b=n("/IUn"),v=function(){function e(e){this.apollo=e}return e.prototype.list=function(){return this.apollo.watchQuery({query:h}).valueChanges},e.\u0275fac=function(t){return new(t||e)(m.oc(b.b))},e.\u0275prov=m.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),C=n("Rmj+"),y=p()(i||(i=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(["\n  query earringConfigList {\n    earringConfigs {\n      edges {\n        node {\n          id\n          name\n          price\n        }\n      }\n    }\n  }\n"],["\n  query earringConfigList {\n    earringConfigs {\n      edges {\n        node {\n          id\n          name\n          price\n        }\n      }\n    }\n  }\n"]))),M=function(){function e(e){this.apollo=e}return e.prototype.list=function(){return this.apollo.watchQuery({query:y}).valueChanges},e.\u0275fac=function(t){return new(t||e)(m.oc(b.b))},e.\u0275prov=m.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),S=n("zOkP"),k=p()(o||(o=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(["\n    query ringThicknessList {\n        ringThicknesses {\n            edges {\n                node {\n                    id\n                    name\n                    castingPrice\n                    value\n                }\n            }\n        }\n    }\n"],["\n    query ringThicknessList {\n        ringThicknesses {\n            edges {\n                node {\n                    id\n                    name\n                    castingPrice\n                    value\n                }\n            }\n        }\n    }\n"]))),w=function(){function e(e){this.apollo=e}return e.prototype.list=function(){return this.apollo.watchQuery({query:k}).valueChanges},e.\u0275fac=function(t){return new(t||e)(m.oc(b.b))},e.\u0275prov=m.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),T=n("aLF9"),x=n("9TxS"),P=n("cXB8"),I=n("v/Xy"),O=n("zz98"),K=n("p8L8"),z=p()(d||(d=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(["\n  query purchaseSourcesList {\n    purchaseSources {\n      edges {\n        node {\n          id\n          name\n        }\n      }\n    }\n  }\n"],["\n  query purchaseSourcesList {\n    purchaseSources {\n      edges {\n        node {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),D=function(){function e(e){this.apollo=e}return e.prototype.list=function(){return this.apollo.watchQuery({query:z}).valueChanges},e.\u0275fac=function(t){return new(t||e)(m.oc(b.b))},e.\u0275prov=m.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),R=n("7ape"),A=n("1OyB"),F=n("vuIU"),_=new m.w("WindowToken","undefined"!=typeof window&&window.document?{providedIn:"root",factory:function(){return window}}:void 0),E=n("XNiG"),q=function(){var e=function(){function e(t,n){Object(A.a)(this,e),this.document=t,this.window=n,this.copySubject=new E.a,this.copyResponse$=this.copySubject.asObservable(),this.config={}}return Object(F.a)(e,[{key:"configure",value:function(e){this.config=e}},{key:"copy",value:function(e){if(!this.isSupported||!e)return this.pushCopyResponse({isSuccess:!1,content:e});var t=this.copyFromContent(e);return this.pushCopyResponse(t?{content:e,isSuccess:t}:{isSuccess:!1,content:e})}},{key:"isTargetValid",value:function(e){if(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement){if(e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}},{key:"copyFromInputElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{this.selectTarget(e);var n=this.copyText();return this.clearSelection(t?e:void 0,this.window),n&&this.isCopySuccessInIE11()}catch(c){return!1}}},{key:"isCopySuccessInIE11",value:function(){var e=this.window.clipboardData;return!(e&&e.getData&&!e.getData("Text"))}},{key:"copyFromContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.document.body;if(this.tempTextArea&&!t.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{t.appendChild(this.tempTextArea)}catch(c){throw new Error("Container should be a Dom element")}}this.tempTextArea.value=e;var n=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.document.body;this.tempTextArea&&(e.removeChild(this.tempTextArea),this.tempTextArea=void 0)}},{key:"selectTarget",value:function(e){return e.select(),e.setSelectionRange(0,e.value.length),e.value.length}},{key:"copyText",value:function(){return this.document.execCommand("copy")}},{key:"clearSelection",value:function(e,t){var n;e&&e.focus(),null===(n=t.getSelection())||void 0===n||n.removeAllRanges()}},{key:"createTempTextArea",value:function(e,t){var n,c="rtl"===e.documentElement.getAttribute("dir");return(n=e.createElement("textarea")).style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[c?"right":"left"]="-9999px",n.style.top=(t.pageYOffset||e.documentElement.scrollTop)+"px",n.setAttribute("readonly",""),n}},{key:"pushCopyResponse",value:function(e){this.copySubject.next(e)}},{key:"pushCopyReponse",value:function(e){this.pushCopyResponse(e)}},{key:"isSupported",get:function(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}}]),e}();return e.\u0275fac=function(t){return new(t||e)(m.oc(s.e),m.oc(_,8))},e.\u0275prov=Object(m.Wb)({factory:function(){return new e(Object(m.oc)(s.e),Object(m.oc)(_,8))},token:e,providedIn:"root"}),e}(),N=function(){var e=function e(){Object(A.a)(this,e)};return e.\u0275mod=m.Yb({type:e}),e.\u0275inj=m.Xb({factory:function(t){return new(t||e)},imports:[[s.c]]}),e}(),j=n("5eHb"),$=n("n4kJ"),L=n("IfPz"),W=n("wOBz"),B=n("3Pt+"),V=n("1QgP"),G=n("sMau"),Y=n("57tZ"),U=n("z17N"),X=n("ZtzB"),Q=n("9tk/"),H=function(e,t,n,c){return new(n||(n=Promise))((function(i,o){function d(e){try{a(c.next(e))}catch(t){o(t)}}function r(e){try{a(c.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,r)}a((c=c.apply(e,t||[])).next())}))},J=function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},Z=["generateCodeForm"];function ee(e,t){if(1&e&&(m.ec(0),m.bc(1,"kit-and-casting-label",4),m.dc()),2&e){var n=m.vc();m.Mb(1),m.Cc("castingCode",n.data.generatedCode)("kit",n.data.generatedKit)}}function te(e,t){1&e&&(m.gc(0,"div",5),m.bc(1,"loading-ring",6),m.fc()),2&e&&(m.Mb(1),m.Cc("size",60))}function ne(e,t){if(1&e){var n=m.hc();m.gc(0,"div",16),m.gc(1,"div",17),m.gc(2,"input",26),m.rc("change",(function(){return m.Pc(n),m.vc(3).resetModel()}))("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.castingType=e})),m.fc(),m.gc(3,"label",27),m.dd(4),m.fc(),m.fc(),m.fc()}if(2&e){var c=t.$implicit,i=m.vc(3);m.Mb(2),m.Cc("ngModel",i.model.castingType)("id",c.node.name)("value",c),m.Mb(1),m.Cc("for",c.node.name),m.Mb(1),m.fd(" ",c.node.name," ")}}function ce(e,t){if(1&e&&(m.ec(0),m.gc(1,"div",14),m.gc(2,"label",24),m.dd(3,"Casting Type"),m.fc(),m.bd(4,ne,5,5,"div",25),m.fc(),m.dc()),2&e){var n=m.vc(2);m.Mb(4),m.Cc("ngForOf",n.data.castingTypes)}}function ie(e,t){1&e&&(m.gc(0,"p",35),m.dd(1,"Fetching..."),m.fc())}function oe(e,t){1&e&&(m.gc(0,"p",36),m.dd(1,"Code is Valid"),m.fc())}function de(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"div",14),m.gc(2,"label",28),m.dd(3,"Existing Kit Code"),m.fc(),m.gc(4,"input",29,30),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.existingKitCode=e}))("blur",(function(){return m.Pc(n),m.vc(2).fetchKitInfo()})),m.fc(),m.gc(6,"app-error-messages",31),m.gc(7,"app-error-message",32),m.dd(8,"Code not found"),m.fc(),m.fc(),m.bd(9,ie,2,0,"p",33),m.bd(10,oe,2,0,"p",34),m.fc(),m.dc()}if(2&e){var c=m.Mc(5),i=m.vc(2);m.Mb(4),m.Cc("ngModel",i.model.existingKitCode),m.Mb(2),m.Cc("field",c),m.Mb(1),m.Cc("errorType","invalid-code"),m.Mb(2),m.Cc("ngIf",i.state.fetchingKitInfo),m.Mb(1),m.Cc("ngIf",!i.state.fetchingKitInfo&&i.data.existingKit&&i.data.existingKit.valid)}}function re(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.ed(n.node.name)}}function ae(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.ed(n.node.name)}}function se(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.ed(n.node.name)}}function le(e,t){if(1&e){var n=m.hc();m.gc(0,"div",14),m.gc(1,"label",54),m.dd(2,"Order Ring Size Custom"),m.fc(),m.gc(3,"select",55,52),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(4).model.orderRingSizeCustom=e})),m.gc(5,"option",40),m.dd(6,"-- Please Select --"),m.fc(),m.bd(7,se,2,2,"option",41),m.fc(),m.fc()}if(2&e){var c=m.vc(4);m.Mb(3),m.Cc("ngModel",c.model.orderRingSizeCustom),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.ringSizeCustoms)}}function ge(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"div",14),m.gc(2,"label",50),m.dd(3,"Order Ring Size"),m.fc(),m.gc(4,"select",51,52),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.orderRingSize=e})),m.gc(6,"option",40),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,ae,2,2,"option",41),m.fc(),m.fc(),m.bd(9,le,8,3,"div",53),m.dc()}if(2&e){var c=m.vc(3);m.Mb(4),m.Cc("ngModel",c.model.orderRingSize),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.ringSizes),m.Mb(1),m.Cc("ngIf",c.model.orderRingSize&&"custom"===c.model.orderRingSize.node.name)}}function ue(e,t){if(1&e){var n=m.hc();m.gc(0,"div",56),m.gc(1,"input",57),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.preOrdered=e})),m.fc(),m.gc(2,"label",58),m.dd(3,"Pre-ordered"),m.fc(),m.fc()}if(2&e){var c=m.vc(3);m.Mb(1),m.Cc("ngModel",c.model.preOrdered)("value",c.model.preOrdered)}}function fe(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"div",14),m.gc(2,"label",37),m.dd(3,"Order Purchase Location"),m.fc(),m.gc(4,"select",38,39),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.purchaseSource=e})),m.gc(6,"option",40),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,re,2,2,"option",41),m.fc(),m.fc(),m.gc(9,"div",14),m.gc(10,"label",42),m.dd(11,"Order Reference"),m.fc(),m.gc(12,"input",43),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.orderReference=e})),m.fc(),m.fc(),m.gc(13,"div",14),m.gc(14,"label",44),m.dd(15,"Order Date"),m.fc(),m.gc(16,"input",45),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.orderDate=e})),m.fc(),m.bc(17,"owl-date-time",46,47),m.fc(),m.bd(19,ge,10,4,"ng-container",0),m.gc(20,"div",14),m.bd(21,ue,4,2,"div",48),m.fc(),m.dc()}if(2&e){var c=m.Mc(18),i=m.vc(2);m.Mb(4),m.Cc("ngModel",i.model.purchaseSource),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",i.data.purchaseSources),m.Mb(4),m.Cc("ngModel",i.model.orderReference),m.Mb(4),m.Cc("ngModel",i.model.orderDate)("max",i.timeNow)("owlDateTimeTrigger",c)("owlDateTime",c),m.Mb(1),m.Cc("pickerType","calendar"),m.Mb(2),m.Cc("ngIf",i.model.castingType&&i.model.castingType.node.name===i.castingTypeNone&&!i.state.generateCode),m.Mb(2),m.Cc("ngIf",!i.state.loading)}}function pe(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"h4"),m.dd(2,"Also Generate Casting Code?"),m.fc(),m.gc(3,"div",14),m.gc(4,"div",17),m.gc(5,"input",59),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).state.generateCode=e})),m.fc(),m.gc(6,"label",60),m.dd(7,"No"),m.fc(),m.fc(),m.gc(8,"div",17),m.gc(9,"input",61),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).state.generateCode=e})),m.fc(),m.gc(10,"label",62),m.dd(11,"Yes"),m.fc(),m.fc(),m.fc(),m.dc()}if(2&e){var c=m.vc(2);m.Mb(5),m.Cc("ngModel",c.state.generateCode)("value",!1),m.Mb(4),m.Cc("ngModel",c.state.generateCode)("value",!0)}}function he(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.ed(n.node.name)}}function me(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.gc(1,"div",99),m.gc(2,"div",14),m.gc(3,"label",100),m.dd(4,"Ring Thickness"),m.fc(),m.gc(5,"select",101,52),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.ringThickness=e})),m.gc(7,"option",102),m.dd(8,"-- Please Select --"),m.fc(),m.bd(9,he,2,2,"option",41),m.fc(),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.vc(3);m.Mb(5),m.Cc("ngModel",c.model.ringThickness),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.ringThicknesses)}}function be(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.ed(n.node.name)}}function ve(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.ed(n.node.name)}}function Ce(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.gc(1,"div",14),m.gc(2,"label",105),m.dd(3,"Ring Size Custom"),m.fc(),m.gc(4,"select",106,107),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(4).model.ringSizeCustom=e})),m.gc(6,"option",40),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,ve,2,2,"option",41),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.vc(4);m.Mb(4),m.Cc("ngModel",c.model.ringSizeCustom),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.ringSizeCustoms)}}function ye(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"div",14),m.gc(2,"label",103),m.dd(3),m.fc(),m.gc(4,"select",104,52),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.ringSize=e})),m.gc(6,"option",40),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,be,2,2,"option",41),m.fc(),m.fc(),m.bd(9,Ce,9,3,"div",0),m.dc()}if(2&e){var c=m.vc(3);m.Mb(3),m.fd("Ring Size ",c.state.isCastingType?" (Optional)":"",""),m.Mb(1),m.Cc("ngModel",c.model.ringSize)("required",c.model.kitType&&"ring"===c.model.kitType.node.name),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.ringSizes),m.Mb(1),m.Cc("ngIf",c.model.ringSize&&"custom"===c.model.ringSize.node.name)}}function Me(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.fd(" ",n.node.name," ")}}function Se(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.fd(" ",n.node.name," ")}}function ke(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.gc(1,"h4"),m.dd(2,"Chain Length"),m.fc(),m.gc(3,"div",14),m.gc(4,"select",112,113),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(4).model.chainLength=e})),m.gc(6,"option",102),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,Se,2,2,"option",41),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.vc(4);m.Mb(4),m.Cc("ngModel",c.model.chainLength),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.chainLengths)}}function we(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.gc(1,"h4",108),m.dd(2,"Chain Type"),m.fc(),m.gc(3,"div",14),m.gc(4,"select",109,110),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.chainType=e})),m.gc(6,"option",111),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,Me,2,2,"option",41),m.fc(),m.fc(),m.bd(9,ke,9,3,"div",0),m.fc()}if(2&e){var c=m.vc(3);m.Mb(4),m.Cc("ngModel",c.model.chainType),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.chainTypes),m.Mb(1),m.Cc("ngIf",c.model.chainType&&c.model.chainType.node.price>0)}}function Te(e,t){if(1&e&&(m.gc(0,"option",49),m.dd(1),m.fc()),2&e){var n=t.$implicit;m.Cc("ngValue",n),m.Mb(1),m.fd(" ",n.node.name," ")}}function xe(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.gc(1,"h4",108),m.dd(2,"Earring Configuration"),m.fc(),m.gc(3,"div",14),m.gc(4,"select",114,115),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.earringConfig=e})),m.gc(6,"option",116),m.dd(7,"-- Please Select --"),m.fc(),m.bd(8,Te,2,2,"option",41),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.vc(3);m.Mb(4),m.Cc("ngModel",c.model.earringConfig),m.Mb(2),m.Cc("value",null),m.Mb(2),m.Cc("ngForOf",c.data.earringConfigs)}}function Pe(e,t){if(1&e){var n=m.hc();m.gc(0,"div",14),m.gc(1,"label",117),m.dd(2,"Casting Price Paid (\xa3)"),m.fc(),m.gc(3,"div",88),m.gc(4,"div",89),m.gc(5,"div",90),m.dd(6,"\xa3"),m.fc(),m.fc(),m.gc(7,"input",118),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(3).model.castingPricePaid=e})),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.vc(3);m.Mb(7),m.Cc("ngModel",c.model.castingPricePaid)("decimalPlaces",2)}}function Ie(e,t){if(1&e){var n=m.hc();m.ec(0),m.bd(1,me,10,3,"div",0),m.bd(2,ye,10,6,"ng-container",0),m.bd(3,we,10,4,"div",0),m.bd(4,xe,9,3,"div",0),m.gc(5,"div",14),m.gc(6,"label"),m.dd(7,"Finish / Plating Included"),m.fc(),m.gc(8,"div",17),m.gc(9,"input",63),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.finish=e})),m.fc(),m.gc(10,"label",64),m.dd(11,"No"),m.fc(),m.fc(),m.gc(12,"div",17),m.gc(13,"input",65),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.finish=e})),m.fc(),m.gc(14,"label",66),m.dd(15,"Yes"),m.fc(),m.fc(),m.fc(),m.gc(16,"div",14),m.gc(17,"label"),m.dd(18,"Include Chain"),m.fc(),m.gc(19,"div",17),m.gc(20,"input",67),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.chain=e})),m.fc(),m.gc(21,"label",68),m.dd(22,"No"),m.fc(),m.fc(),m.gc(23,"div",17),m.gc(24,"input",69),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.chain=e})),m.fc(),m.gc(25,"label",70),m.dd(26,"Yes"),m.fc(),m.fc(),m.fc(),m.gc(27,"div",14),m.gc(28,"label"),m.dd(29,"Engraving"),m.fc(),m.gc(30,"div",17),m.gc(31,"input",71),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.internalEngraving=e})),m.fc(),m.gc(32,"label",72),m.dd(33,"No"),m.fc(),m.fc(),m.gc(34,"div",17),m.gc(35,"input",73),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.internalEngraving=e})),m.fc(),m.gc(36,"label",74),m.dd(37,"Yes"),m.fc(),m.fc(),m.fc(),m.gc(38,"div",14),m.gc(39,"label"),m.dd(40,"Stone Setting"),m.fc(),m.gc(41,"div",17),m.gc(42,"input",75),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.stoneSetting=e})),m.fc(),m.gc(43,"label",76),m.dd(44,"No"),m.fc(),m.fc(),m.gc(45,"div",17),m.gc(46,"input",77),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.stoneSetting=e})),m.fc(),m.gc(47,"label",78),m.dd(48,"Yes"),m.fc(),m.fc(),m.fc(),m.gc(49,"div",14),m.gc(50,"label"),m.dd(51,"Free Shipping"),m.fc(),m.gc(52,"div",17),m.gc(53,"input",79),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.freeShipping=e})),m.fc(),m.gc(54,"label",80),m.dd(55,"No"),m.fc(),m.fc(),m.gc(56,"div",17),m.gc(57,"input",81),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.freeShipping=e})),m.fc(),m.gc(58,"label",82),m.dd(59,"Yes"),m.fc(),m.fc(),m.fc(),m.gc(60,"div",14),m.gc(61,"label",83),m.dd(62,"Expires At (Optional)"),m.fc(),m.gc(63,"input",84),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.expiresAt=e})),m.fc(),m.bc(64,"owl-date-time",85,86),m.fc(),m.bd(66,Pe,8,2,"div",53),m.gc(67,"div",14),m.gc(68,"label",87),m.dd(69,"Discount (\xa3)"),m.fc(),m.gc(70,"div",88),m.gc(71,"div",89),m.gc(72,"div",90),m.dd(73,"\xa3"),m.fc(),m.fc(),m.gc(74,"input",91),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.discount=e})),m.fc(),m.fc(),m.fc(),m.gc(75,"div",14),m.gc(76,"label",92),m.dd(77,"Discount Description"),m.fc(),m.gc(78,"p",93),m.dd(79,"The "),m.gc(80,"b"),m.dd(81,"customer will see this"),m.fc(),m.dd(82," if they have a discount"),m.fc(),m.gc(83,"textarea",94),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.discountDescription=e})),m.fc(),m.fc(),m.gc(84,"div",14),m.gc(85,"label",95),m.dd(86,"Internal Reference"),m.fc(),m.gc(87,"textarea",96),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.reference=e})),m.fc(),m.fc(),m.gc(88,"div",14),m.gc(89,"label",97),m.dd(90,"Existing Casting Code (Optional)"),m.fc(),m.gc(91,"input",98),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc(2).model.castingCode=e})),m.fc(),m.fc(),m.dc()}if(2&e){var c=m.Mc(65),i=m.vc(2);m.Mb(1),m.Cc("ngIf",i.model.kitType&&"ring"===i.model.kitType.node.name),m.Mb(1),m.Cc("ngIf",i.model.kitType&&"ring"===i.model.kitType.node.name||i.state.isCastingType),m.Mb(1),m.Cc("ngIf",i.model.kitType&&"pendant"===i.model.kitType.node.name),m.Mb(1),m.Cc("ngIf",i.model.kitType&&"earring"===i.model.kitType.node.name),m.Mb(5),m.Cc("ngModel",i.model.finish)("value",!1),m.Mb(4),m.Cc("ngModel",i.model.finish)("value",!0),m.Mb(7),m.Cc("ngModel",i.model.chain)("value",!1),m.Mb(4),m.Cc("ngModel",i.model.chain)("value",!0),m.Mb(7),m.Cc("ngModel",i.model.internalEngraving)("value",!1),m.Mb(4),m.Cc("ngModel",i.model.internalEngraving)("value",!0),m.Mb(7),m.Cc("ngModel",i.model.stoneSetting)("value",!1),m.Mb(4),m.Cc("ngModel",i.model.stoneSetting)("value",!0),m.Mb(7),m.Cc("ngModel",i.model.freeShipping)("value",!1),m.Mb(4),m.Cc("ngModel",i.model.freeShipping)("value",!0),m.Mb(6),m.Cc("ngModel",i.model.expiresAt)("min",i.timeNow)("owlDateTimeTrigger",c)("owlDateTime",c),m.Mb(1),m.Cc("pickerType","calendar")("startAt",i.getExpiryStart()),m.Mb(2),m.Cc("ngIf",i.model.castingType&&i.model.castingType.node.name!==i.castingTypeNone),m.Mb(8),m.Cc("ngModel",i.model.discount)("decimalPlaces",2),m.Mb(9),m.Cc("ngModel",i.model.discountDescription),m.Mb(4),m.Cc("ngModel",i.model.reference),m.Mb(4),m.Cc("ngModel",i.model.castingCode)}}function Oe(e,t){1&e&&(m.ec(0),m.gc(1,"h4"),m.dd(2,"Generate Another Kit"),m.fc(),m.dc())}function Ke(e,t){1&e&&(m.ec(0),m.dd(1," Another"),m.dc())}function ze(e,t){if(1&e&&(m.gc(0,"div"),m.bd(1,Oe,3,0,"ng-container",0),m.gc(2,"button",119),m.dd(3," Generate "),m.bd(4,Ke,2,0,"ng-container",0),m.dd(5," Kit "),m.fc(),m.fc()),2&e){var n=m.vc(2);m.Mb(1),m.Cc("ngIf",n.data.generatedCode),m.Mb(1),m.Cc("disabled",n.state.creatingCode||n.state.generating||n.state.fetchingKitInfo),m.Mb(2),m.Cc("ngIf",n.data.generatedCode)}}function De(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.bc(1,"hr"),m.gc(2,"h4",120),m.dd(3,"Generated Kit"),m.fc(),m.gc(4,"h2",121,122),m.rc("click",(function(){m.Pc(n);var e=m.vc(2);return e.copyCodeToClipboard(e.data.generatedKit.regCode,"Copied the Kit registration code to clipboard!")})),m.dd(6),m.fc(),m.fc()}if(2&e){var c=m.vc(2);m.Mb(6),m.ed(c.data.generatedKit.regCode)}}function Re(e,t){if(1&e){var n=m.hc();m.gc(0,"div"),m.bc(1,"hr"),m.gc(2,"h4",120),m.dd(3,"Generated Code"),m.fc(),m.gc(4,"h2",121,122),m.rc("click",(function(){m.Pc(n);var e=m.vc(2);return e.copyCodeToClipboard(e.data.generatedCode.code,"Copied the casting code to the clipboard!")})),m.dd(6),m.fc(),m.fc()}if(2&e){var c=m.vc(2);m.Mb(6),m.ed(c.data.generatedCode.code)}}function Ae(e,t){if(1&e&&(m.gc(0,"div",10),m.gc(1,"div",123),m.gc(2,"p"),m.gc(3,"strong"),m.dd(4,"Kit Details:"),m.fc(),m.bc(5,"br"),m.dd(6),m.bc(7,"br"),m.dd(8),m.wc(9,"simpleDateTime"),m.fc(),m.fc(),m.fc()),2&e){var n=m.vc(2);m.Mb(6),m.gd(" For order ref: ",n.data.generatedKit.orderReference?n.data.generatedKit.orderReference:"No ref"," (",n.data.generatedKit.purchaseSource?n.data.generatedKit.purchaseSource.name:"Unknown",")"),m.Mb(2),m.fd(" Created: ",m.xc(9,3,n.data.generatedKit.createdAt)," ")}}function Fe(e,t){if(1&e){var n=m.hc();m.gc(0,"div",10),m.gc(1,"div",123),m.gc(2,"button",124),m.rc("click",(function(){m.Pc(n);var e=m.vc(2);return e.printLabel(e.data.generatedKit.id)})),m.dd(3),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.vc(2);m.Mb(2),m.Cc("disabled",c.state.creatingCode||c.state.generating),m.Mb(1),m.fd("",c.state.creatingCode||c.state.generating?"Please wait...":"Print Label"," ")}}function _e(e,t){if(1&e){var n=m.hc();m.gc(0,"form",7,8),m.rc("submit",(function(){return m.Pc(n),m.vc().onSubmit()})),m.gc(2,"div",9),m.gc(3,"div",10),m.gc(4,"div",11),m.gc(5,"div",12),m.gc(6,"div",13),m.bd(7,ce,5,1,"ng-container",0),m.gc(8,"div",14),m.gc(9,"label",15),m.dd(10,"New or Existing?"),m.fc(),m.gc(11,"div",16),m.gc(12,"div",17),m.gc(13,"input",18),m.rc("change",(function(){return m.Pc(n),m.vc().resetModel()}))("ngModelChange",(function(e){return m.Pc(n),m.vc().model.generateNewKit=e})),m.fc(),m.gc(14,"label",19),m.dd(15," Create New Kit "),m.fc(),m.fc(),m.gc(16,"div",17),m.gc(17,"input",20),m.rc("change",(function(){return m.Pc(n),m.vc().resetModel()}))("ngModelChange",(function(e){return m.Pc(n),m.vc().model.generateNewKit=e})),m.fc(),m.gc(18,"label",21),m.dd(19," Add Casting to Existing Kit "),m.fc(),m.fc(),m.fc(),m.fc(),m.bd(20,de,11,5,"ng-container",0),m.bd(21,fe,22,11,"ng-container",0),m.bd(22,pe,12,4,"ng-container",0),m.bd(23,Ie,92,36,"ng-container",0),m.bd(24,ze,6,3,"div",0),m.gc(25,"div",10),m.gc(26,"div",22),m.bd(27,De,7,1,"div",0),m.fc(),m.gc(28,"div",22),m.bd(29,Re,7,1,"div",0),m.fc(),m.fc(),m.bd(30,Ae,10,5,"div",23),m.bd(31,Fe,4,2,"div",23),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.fc()}if(2&e){var c=m.Mc(1),i=m.vc();m.Mb(7),m.Cc("ngIf",i.state.isCastingType),m.Mb(6),m.Cc("ngModel",i.model.generateNewKit)("value",!0),m.Mb(4),m.Cc("ngModel",i.model.generateNewKit)("value",!1),m.Mb(3),m.Cc("ngIf",!1===i.model.generateNewKit),m.Mb(1),m.Cc("ngIf",i.model.castingType||i.state.generateCode),m.Mb(1),m.Cc("ngIf",i.model.castingType&&i.model.castingType.node.name===i.castingTypeNone),m.Mb(1),m.Cc("ngIf",i.model.castingType&&i.model.castingType.node.name!==i.castingTypeNone||i.state.generateCode),m.Mb(1),m.Cc("ngIf",c.form.valid),m.Mb(3),m.Cc("ngIf",i.data.generatedKit),m.Mb(2),m.Cc("ngIf",i.data.generatedCode),m.Mb(1),m.Cc("ngIf",i.data.generatedKit),m.Mb(1),m.Cc("ngIf",i.data.generatedKit||i.data.generatedCode)}}var Ee,qe=function(){return function(){this.finish=!1,this.chain=!1,this.freeShipping=!1,this.internalEngraving=!1,this.castingCode="",this.stoneSetting=!1,this.preOrdered=null,this.generateNewKit=!0}}(),Ne=function(){function e(e,t,n,c,i,o,d,r,a,s,l,g,u,f,p,h){this.castingCodeService=e,this.castingTypeService=t,this.chainLengthService=n,this.chainTypeService=c,this.clipBoardService=i,this.earringConfigService=o,this.kitService=d,this.kitTypeService=r,this.pricingAndWeightService=a,this.purchaseSourceService=s,this.ringSizeCustomService=l,this.ringSizeService=g,this.ringThicknessService=u,this.toastr=f,this.exportToPdfService=p,this.route=h,this.castingTypeNone="none",this.data={castingTypes:[],kitTypes:[],ringSizes:[],ringSizeCustoms:[],ringThicknesses:[],chainLengths:[],chainTypes:[],earringConfigs:[],purchaseSources:[],generatedCode:null,generatedKit:null,existingKit:null},this.state={isCastingType:!0,generateCode:!1,loading:!0,creatingPdf:!1,creatingCode:!1,generating:!1,fetchingKitInfo:!1},this.model=new qe,this.timeNow=new Date}return e.prototype.ngOnInit=function(){var e=this;Object(u.a)(Object(u.a)(this.kitTypeService.list(),this.ringSizeService.list(),this.ringSizeCustomService.list(),this.ringThicknessService.list()),Object(u.a)(this.chainLengthService.list(),this.chainTypeService.list(),this.earringConfigService.list(),this.castingTypeService.list(),this.purchaseSourceService.list())).subscribe((function(t){var n=t[0],c=t[1];e.data.kitTypes=n[0].data.kitTypes.edges,e.data.ringSizes=n[1].data.ringSizes.edges,e.data.ringSizeCustoms=n[2].data.ringSizeCustoms.edges,e.data.ringThicknesses=n[3].data.ringThicknesses.edges,e.data.chainLengths=c[0].data.chainLengths.edges,e.data.chainTypes=c[1].data.chainTypes.edges,e.data.earringConfigs=c[2].data.earringConfigs.edges,e.data.castingTypes=c[3].data.castingTypes.edges,e.data.purchaseSources=c[4].data.purchaseSources.edges,e.data.castingTypes.push({__typename:"CastingTypeEdge",node:{__typename:"CastingType",id:null,name:e.castingTypeNone,price:null,castingPrice:null,description:null}});var i=e.route.snapshot.queryParamMap.get("preOrder");i&&"true"===i&&(e.model.preOrdered=!0),e.state.loading=!1}))},e.prototype.onSubmit=function(){return H(this,void 0,void 0,(function(){var e,t,n,c,i,o=this;return J(this,(function(d){switch(d.label){case 0:if(this.data.generatedCode=null,this.state.generating=!0,this.model.orderDate)try{e=this.dateTimeISO(this.model.orderDate)}catch(r){return this.toastr.warning(this.model.orderDate+" is not a valid date. Needs to be in format: YYYY-MM-DD."),[2]}else e=null;return t=new Date,this.model.generateNewKit?(n={createdAt:t.toUTCString(),purchaseSource:this.model.purchaseSource?this.model.purchaseSource.node.id:null,orderReference:this.model.orderReference,orderRingSize:this.model.orderRingSize?this.model.orderRingSize.node.id:null,orderRingSizeCustom:this.model.orderRingSizeCustom?this.model.orderRingSizeCustom.node.id:null,orderDate:e,preOrdered:this.model.preOrdered&&!0===this.model.preOrdered?this.model.preOrdered:null},[4,this.kitService.create(n)]):[3,2];case 1:c=d.sent(),this.data.generatedKit=c.data.createKit,d.label=2;case 2:if(this.model.castingType&&this.model.castingType.node.name===this.castingTypeNone&&!this.state.generateCode)return this.resetModel(),this.state.generating=!1,[2];if(this.state.creatingCode=!0,this.state.isCastingType||(this.model.kitType.node.name===S.g&&this.model.ringSize.node.name!==T.b&&(this.model.ringSizeCustom=null),this.model.kitType.node.name===S.f&&this.model.chainType.node.name===C.b&&(this.model.chainLength=null)),this.model.discount||(this.model.discountDescription=null),this.model.castingType&&!this.model.castingPricePaid&&(this.model.castingPricePaid=Math.round(this.model.castingType.node.castingPrice/100)),this.model.expiresAt)try{i=this.dateTimeISO(this.model.expiresAt)}catch(r){return this.toastr.warning(this.model.expiresAt+" is not a valid date. Needs to be in format: YYYY-MM-DD."),[2]}else(i=new Date).setDate(i.getDate()+182.5),i.setHours(23,59,59,999),i=i.toISOString();return this.toastr.success("","Creating"),this.castingCodeService.create({castingType:this.model.castingType?this.model.castingType.node.id:null,kitType:this.model.kitType?this.model.kitType.node.id:null,ringSize:this.model.ringSize?this.model.ringSize.node.id:null,ringSizeCustom:this.model.ringSizeCustom?this.model.ringSizeCustom.node.id:null,ringThickness:this.model.ringThickness?this.model.ringThickness.node.id:null,chainLength:this.model.chainLength?this.model.chainLength.node.id:null,chainType:this.model.chainType?this.model.chainType.node.id:null,earringConfig:this.model.earringConfig?this.model.earringConfig.node.id:null,freeShipping:this.model.freeShipping,chain:this.model.chain,engraving:this.model.internalEngraving,plating:this.model.finish,stoneSetting:this.model.stoneSetting,createdAt:t.toISOString(),expiresAt:i,discount:this.formatCurrency(this.model.discount),castingPricePaid:this.formatCurrency(this.model.castingPricePaid),discountDescription:this.model.discountDescription,castingCode:this.model.castingCode.toUpperCase(),reference:this.model.reference,kit:this.model.generateNewKit?this.data.generatedKit.id:"/kits/"+this.data.existingKit.id}).subscribe((function(e){o.data.generatedCode=e.data.createCastingCode,o.model.kitType=null,o.resetModel(),o.toastr.success("","Created"),o.state.creatingCode=!1,o.state.generating=!1}),(function(e){o.toastr.error(e,"Error, possible duplicate code"),o.state.creatingCode=!1,o.state.generating=!1})),[2]}}))}))},e.prototype.fetchKitInfo=function(){return H(this,void 0,void 0,(function(){var e;return J(this,(function(t){switch(t.label){case 0:return this.state.fetchingKitInfo=!0,this.form.controls.existingKitCode.setErrors(null),[4,this.kitService.getByCodeKitOnly(this.model.existingKitCode)];case 1:return(e=t.sent()).valid?(this.data.existingKit=e,this.form.controls.existingKitCode.setErrors(null)):this.form.controls.existingKitCode.setErrors({"invalid-code":!0}),this.state.fetchingKitInfo=!1,[2]}}))}))},e.prototype.resetModel=function(){var e=null,t=null,n=this.model.generateNewKit,c=this.model.existingKitCode;this.state.isCastingType?e=this.model.castingType:t=this.model.kitType,this.model=new qe,this.model.kitType=t,this.model.castingType=e,this.model.generateNewKit=n,this.model.existingKitCode=c;var i=this.route.snapshot.queryParamMap.get("preOrder");i&&"true"===i&&(this.model.preOrdered=!0),this.model.castingType&&(this.model.castingPricePaid=Math.round(this.model.castingType.node.castingPrice/100))},e.prototype.copyCodeToClipboard=function(e,t){void 0===t&&(t=null),this.clipBoardService.copyFromContent(e),this.toastr.success(t,"Copied!")},e.prototype.formatCurrency=function(e){return null===e?null:Math.round(100*e)},e.prototype.printLabel=function(e){return H(this,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return this.state.creatingPdf?[2]:(e=e.replace(/\D/g,""),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+e))]);case 1:return t.sent(),this.state.creatingPdf=!1,[2]}}))}))},e.prototype.getExpiryStart=function(){return(new Date).getDate()+182.5},e.prototype.dateTimeISO=function(e){return e=new Date(e),new Date(e.getTime()-6e4*e.getTimezoneOffset())},e.\u0275fac=function(t){return new(t||e)(m.ac(x.a),m.ac(I.a),m.ac(v),m.ac(C.a),m.ac(q),m.ac(M),m.ac(K.a),m.ac(S.a),m.ac(O.a),m.ac(D),m.ac(P.a),m.ac(T.a),m.ac(w),m.ac(j.b),m.ac(R.a),m.ac(g.a))},e.\u0275cmp=m.Ub({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&m.jd(Z,!0),2&e&&m.Lc(n=m.sc())&&(t.form=n.first)},decls:4,vars:3,consts:[[4,"ngIf"],["subtitle","Generate kits and casting codes","title","Kit Generator"],["class","mt-5",4,"ngIf"],["novalidate","",3,"submit",4,"ngIf"],[3,"castingCode","kit"],[1,"mt-5"],[3,"size"],["novalidate","",3,"submit"],["generateCodeForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12","col-lg-8","col-xl-6"],[1,"card"],[1,"card-body"],[1,"form-group"],["for","generateNewKitTrue"],[1,"cell","option"],[1,"form-check"],["id","generateNewKitTrue","name","generateNewKit","required","","type","radio",1,"form-check-input",3,"ngModel","value","change","ngModelChange"],["for","generateNewKitTrue",1,"form-check-label"],["id","generateNewKitFalse","name","generateNewKit","required","","type","radio",1,"form-check-input",3,"ngModel","value","change","ngModelChange"],["for","generateNewKitFalse",1,"form-check-label"],[1,"col-md-6"],["class","row",4,"ngIf"],["for","castingType"],["class","cell option",4,"ngFor","ngForOf"],["id","castingType","name","castings","required","","type","radio",1,"form-check-input",3,"ngModel","id","value","change","ngModelChange"],[1,"form-check-label",3,"for"],["for","existingKitCode"],["id","existingKitCode","name","existingKitCode","required","","type","text","placeholder","0000-0000","appShowErrorInputClass","",1,"form-control",3,"ngModel","ngModelChange","blur"],["existingKitCode","ngModel"],[1,"error-messages",3,"field"],[1,"message",3,"errorType"],["class","ml-2",4,"ngIf"],["class","ml-2 color-success",4,"ngIf"],[1,"ml-2"],[1,"ml-2","color-success"],["for","purchaseSource"],["id","purchaseSource","name","purchaseSource",1,"form-control",3,"ngModel","ngModelChange"],["purchaseSource","ngModel"],["disabled","disabled","selected","true",3,"value"],[3,"ngValue",4,"ngFor","ngForOf"],["for","orderReference"],["id","orderReference","name","orderReference","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","orderDate"],["id","orderDate","name","orderDate","placeholder","-- Please Select --",1,"form-control",3,"ngModel","max","owlDateTimeTrigger","owlDateTime","ngModelChange"],[3,"pickerType"],["dt1",""],["class","checkbox-wrapper with-label mt-2","style","margin: 0;",4,"ngIf"],[3,"ngValue"],["for","orderRingSize",1,"req"],["id","orderRingSize","name","orderRingSize",1,"form-control",3,"ngModel","ngModelChange"],["ringSize","ngModel"],["class","form-group",4,"ngIf"],["for","orderRingSizeCustom",1,"req"],["id","orderRingSizeCustom","name","orderRingSizeCustom",1,"form-control",3,"ngModel","ngModelChange"],[1,"checkbox-wrapper","with-label","mt-2",2,"margin","0"],["id","preOrdered","name","preOrdered","type","checkbox",3,"ngModel","value","ngModelChange"],["for","preOrdered"],["checked","checked","id","no_code","name","codeGen","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_code",1,"form-check-label"],["id","yes_code","name","codeGen","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_code",1,"form-check-label"],["checked","checked","id","no_finish","name","finish","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_finish",1,"form-check-label"],["id","yes_finish","name","finish","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_finish",1,"form-check-label"],["checked","checked","id","no_chain","name","chain","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_chain",1,"form-check-label"],["id","yes_chain","name","chain","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_chain",1,"form-check-label"],["checked","checked","id","no_engraving","name","engraving","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","no_engraving",1,"form-check-label"],["id","yes_engraving","name","engraving","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yes_engraving",1,"form-check-label"],["checked","checked","id","noStoneSetting","name","stoneSetting","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","noStoneSetting",1,"form-check-label"],["id","yesStoneSetting","name","stoneSetting","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yesStoneSetting",1,"form-check-label"],["checked","checked","id","noFreeShipping","name","freeShipping","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","noFreeShipping",1,"form-check-label"],["id","yesFreeShipping","name","freeShipping","required","","type","radio",1,"form-check-input",3,"ngModel","value","ngModelChange"],["for","yesFreeShipping",1,"form-check-label"],["for","expires-at"],["id","expires-at","name","expires-at",1,"form-control",3,"ngModel","min","owlDateTimeTrigger","owlDateTime","ngModelChange"],[3,"pickerType","startAt"],["dt2",""],["for","discount"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["id","discount","limitDecimalPlaces","","min","0","name","discount","step",".01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["for","discountDescription"],[1,"mt-0","mb-0"],["id","discountDescription","maxlength","511","name","discountDescription","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","reference"],["id","reference","maxlength","255","name","reference","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","casting-code"],["id","casting-code","name","casting-code","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-wrapper"],["for","ringThickness"],["id","ringThickness","name","ringThickness","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],["for","ringSize",1,"req"],["id","ringSize","name","ringSize",1,"form-control",3,"ngModel","required","ngModelChange"],["for","ringSizeCustom",1,"req"],["id","ringSizeCustom","name","ringSizeCustom","required","",1,"form-control",3,"ngModel","ngModelChange"],["ringSizeCustom","ngModel"],[1,"req"],["id","chainType","name","chainType","required","",1,"form-control",3,"ngModel","ngModelChange"],["chainType","ngModel"],["selected","",3,"disabled","value"],["id","chainLength","name","chainLength","required","",1,"form-control",3,"ngModel","ngModelChange"],["chainLength","ngModel"],["id","earringConfiguration","name","earringConfiguration","required","",1,"form-control",3,"ngModel","ngModelChange"],["earringConfiguration","ngModel"],["disabled","","selected","",3,"value"],["for","castingPricePaid"],["id","castingPricePaid","limitDecimalPlaces","","min","0","name","castingPricePaid","step",".01","type","number",1,"form-control",3,"ngModel","decimalPlaces","ngModelChange"],["type","submit",1,"btn","btn-primary","expanded",3,"disabled"],[2,"text-transform","uppercase"],[2,"margin-top","0","border","2px dashed black","padding","20px","text-transform","uppercase","color","#fa6f6d",3,"click"],["generatedCode",""],[1,"col"],["type","button",1,"btn","btn-secondary","btn-sm",3,"disabled","click"]],template:function(e,t){1&e&&(m.bd(0,ee,2,2,"ng-container",0),m.bc(1,"page-title",1),m.bd(2,te,2,1,"div",2),m.bd(3,_e,32,14,"form",3)),2&e&&(m.Cc("ngIf",t.data.generatedKit||t.data.generatedCode),m.Mb(2),m.Cc("ngIf",t.state.loading),m.Mb(1),m.Cc("ngIf",!t.state.loading))},directives:[s.u,$.a,L.a,W.a,B.z,B.l,B.m,B.s,B.d,B.u,B.k,B.n,s.t,V.a,G.a,Y.a,B.v,B.p,B.y,U.e,U.g,U.c,B.a,B.q,X.a,B.g],pipes:[Q.a],styles:[""]}),e}(),je=n("HKlZ"),$e=n("Xv7A"),Le=n("rhck"),We=n("zVvu"),Be=n("G0jp"),Ve=(Ee=function(e,t){return(Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Ee(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Ge(e,t){if(1&e&&(m.gc(0,"div",4),m.bc(1,"kit-and-casting-label",5),m.fc()),2&e){var n=t.$implicit;m.Mb(1),m.Cc("castingCode",n.node)("kit",n.node.kit)}}function Ye(e,t){if(1&e&&(m.gc(0,"h4"),m.dd(1),m.fc()),2&e){var n=m.vc(2);m.Mb(1),m.fd("Total Kits: ",n.data.totalCount,"")}}function Ue(e,t){if(1&e&&(m.gc(0,"h4"),m.dd(1),m.wc(2,"currency"),m.fc()),2&e){var n=m.vc(2);m.Mb(1),m.fd("Predicted Total: ",m.xc(2,1,n.data.averageOutstanding),"")}}function Xe(e,t){if(1&e&&(m.ec(0),m.gc(1,"td"),m.dd(2),m.fc(),m.dc()),2&e){var n=m.vc(2).$implicit;m.Mb(2),m.ed(n.node.ringSize.name)}}function Qe(e,t){if(1&e&&(m.ec(0),m.gc(1,"td"),m.dd(2),m.fc(),m.dc()),2&e){var n=m.vc(2).$implicit;m.Mb(2),m.ed(n.node.ringSizeCustom.name)}}function He(e,t){if(1&e&&(m.ec(0),m.bd(1,Xe,3,1,"ng-container",3),m.bd(2,Qe,3,1,"ng-container",3),m.dc()),2&e){var n=m.vc().$implicit;m.Mb(1),m.Cc("ngIf",!n.node.ringSizeCustom),m.Mb(1),m.Cc("ngIf",n.node.ringSizeCustom)}}function Je(e,t){1&e&&(m.ec(0),m.bc(1,"td"),m.dc())}function Ze(e,t){if(1&e){var n=m.hc();m.gc(0,"tr"),m.gc(1,"td"),m.dd(2),m.fc(),m.gc(3,"td"),m.dd(4),m.fc(),m.bd(5,He,3,2,"ng-container",3),m.bd(6,Je,2,0,"ng-container",3),m.gc(7,"td"),m.dd(8),m.wc(9,"simpleDate"),m.fc(),m.gc(10,"td"),m.dd(11),m.fc(),m.gc(12,"td"),m.dd(13),m.wc(14,"currency"),m.fc(),m.gc(15,"td"),m.gc(16,"confirm-delete",9),m.rc("confirmedDelete",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).removeCastingCode(e)})),m.fc(),m.fc(),m.gc(17,"td"),m.gc(18,"button",10),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).printCode(e)})),m.bc(19,"span",11),m.fc(),m.fc(),m.fc()}if(2&e){var c=t.$implicit;m.Mb(2),m.ed(c.node.code),m.Mb(2),m.ed(c.node.kitType?c.node.kitType.name:c.node.castingType.name),m.Mb(1),m.Cc("ngIf",c.node.ringSize),m.Mb(1),m.Cc("ngIf",!c.node.ringSize),m.Mb(2),m.ed(m.xc(9,7,c.node.expiresAt)),m.Mb(3),m.ed(c.node.redeemed),m.Mb(2),m.ed(m.xc(14,9,c.node.estimatedCost))}}function et(e,t){if(1&e&&(m.gc(0,"div",6),m.bd(1,Ye,2,1,"h4",3),m.bd(2,Ue,3,3,"h4",3),m.gc(3,"table",7),m.gc(4,"thead"),m.gc(5,"tr"),m.gc(6,"th"),m.dd(7,"Code"),m.fc(),m.gc(8,"th"),m.dd(9,"Type"),m.fc(),m.gc(10,"th"),m.dd(11,"Size"),m.fc(),m.gc(12,"th"),m.dd(13,"Expiry"),m.fc(),m.gc(14,"th"),m.dd(15,"Redeemed"),m.fc(),m.gc(16,"th"),m.dd(17,"Est Cost"),m.fc(),m.bc(18,"th"),m.bc(19,"th"),m.fc(),m.fc(),m.gc(20,"tbody"),m.bd(21,Ze,20,11,"tr",8),m.fc(),m.fc(),m.fc()),2&e){var n=m.vc();m.Mb(1),m.Cc("ngIf",n.data.totalCount),m.Mb(1),m.Cc("ngIf",n.data.averageOutstanding),m.Mb(18),m.Sb("text-muted",n.state.paginating),m.Mb(1),m.Cc("ngForOf",n.data.castingCodes)}}function tt(e,t){1&e&&(m.gc(0,"div"),m.bc(1,"loading-ring",12),m.fc()),2&e&&(m.Mb(1),m.Cc("size",60))}var nt=function(e){function t(t,n,c){var i=e.call(this)||this;return i.castingCodeService=t,i.toastr=n,i.exportToPdfService=c,i.averagePrices={},i.data={averageOutstanding:null,castingCodes:[],totalCount:null},i.averagePrices[S.d]=1682.94,i.averagePrices[S.c]=2014.15,i.averagePrices[S.b]=2014.15,i}return Ve(t,e),Object.defineProperty(t.prototype,"redeemed",{set:function(e){this._redeemed=e,(null!==e&&this._kitType||this._castingType)&&(this.softReset(),this.updateTable(null))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expired",{set:function(e){this._expired=e,null!==e&&(this._kitType||this._castingType)&&(this.softReset(),this.updateTable(null))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kitType",{set:function(e){this._kitType=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"castingType",{set:function(e){this._castingType=e},enumerable:!1,configurable:!0}),t.prototype.updateTable=function(e){var t=this;this.state.paginating=!0,this.data.averageOutstanding=null,this.data.totalCount=null,this.castingCodeService.list(10,e,this._kitType,this._castingType,this._expired,this._redeemed).subscribe((function(e){t.data.castingCodes=e.data.castingCodes.edges,t.handlePagination(e.data.castingCodes),t.data.totalCount=e.data.castingCodes.totalCount,!t._kitType||t._expired||t._redeemed||(t.data.averageOutstanding=t.averagePrices[t._kitType]*e.data.castingCodes.totalCount)}))},t.prototype.removeCastingCode=function(e){var t=this;this.toastr.success(null,"Deleting Casting Code"),this.castingCodeService.delete(e.node.id).subscribe((function(n){t.data.castingCodes=t.data.castingCodes.filter((function(t){return t.node.id!==e.node.id})),t.toastr.success(null,"Casting Code Deleted")}))},t.prototype.printCode=function(e){return t=this,void 0,c=function(){var t;return function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}(this,(function(n){switch(n.label){case 0:return this.state.creatingPdf?[2]:(t="0"+e.node.id.replace(/\D/g,""),e.node.kit&&(t=e.node.kit.id.replace(/\D/g,"")),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+t))]);case 1:return n.sent(),this.state.creatingPdf=!1,[2]}}))},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{r(c.next(e))}catch(t){i(t)}}function d(e){try{r(c.throw(e))}catch(t){i(t)}}function r(t){var c;t.done?e(t.value):(c=t.value,c instanceof n?c:new n((function(e){e(c)}))).then(o,d)}r((c=c.apply(t,[])).next())}));var t,n,c},t.\u0275fac=function(e){return new(e||t)(m.ac(x.a),m.ac(j.b),m.ac(R.a))},t.\u0275cmp=m.Ub({type:t,selectors:[["codes-table"]],inputs:{redeemed:"redeemed",expired:"expired",kitType:"kitType",castingType:"castingType"},features:[m.Jb],decls:5,vars:4,consts:[["class","print_wrapper",4,"ngFor","ngForOf"],["class","table-responsive",4,"ngIf"],[3,"state","nextPage","previousPage"],[4,"ngIf"],[1,"print_wrapper"],[3,"castingCode","kit"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[3,"confirmedDelete"],["type","button",1,"small-button","btn-outline-secondary","round",3,"click"],[1,"fa","fa-print"],[3,"size"]],template:function(e,t){1&e&&(m.bd(0,Ge,2,2,"div",0),m.ec(1),m.bd(2,et,22,5,"div",1),m.gc(3,"table-controls",2),m.rc("nextPage",(function(){return t.nextPage()}))("previousPage",(function(){return t.previousPage()})),m.fc(),m.dc(),m.bd(4,tt,2,1,"div",3)),2&e&&(m.Cc("ngForOf",t.data.castingCodes),m.Mb(2),m.Cc("ngIf",!t.state.loading),m.Mb(1),m.Cc("state",t.state),m.Mb(1),m.Cc("ngIf",t.state.loading))},directives:[s.t,s.u,$e.a,L.a,Le.a,W.a],pipes:[We.a,Be.a],styles:[""]}),t}(je.a);function ct(e,t){if(1&e&&(m.ec(0),m.gc(1,"div",13),m.gc(2,"div",14),m.gc(3,"div",15),m.gc(4,"div",16),m.gc(5,"h3",17),m.dd(6,"Standard"),m.fc(),m.bc(7,"codes-table",18),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(8,"div",19),m.gc(9,"div",14),m.gc(10,"div",15),m.gc(11,"div",16),m.gc(12,"h3",17),m.dd(13,"Heavy"),m.fc(),m.bc(14,"codes-table",18),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(15,"div",19),m.gc(16,"div",14),m.gc(17,"div",15),m.gc(18,"div",16),m.gc(19,"h3",17),m.dd(20,"Double"),m.fc(),m.bc(21,"codes-table",18),m.fc(),m.fc(),m.fc(),m.fc(),m.dc()),2&e){var n=m.vc();m.Mb(7),m.Cc("redeemed",n.redeemed)("expired",n.expired)("castingType",n.castingIdStandard),m.Mb(7),m.Cc("redeemed",n.redeemed)("expired",n.expired)("castingType",n.castingIdHeavy),m.Mb(7),m.Cc("redeemed",n.redeemed)("expired",n.expired)("castingType",n.castingIdDouble)}}function it(e,t){if(1&e&&(m.ec(0),m.gc(1,"div",13),m.gc(2,"div",14),m.gc(3,"div",15),m.gc(4,"div",16),m.gc(5,"h3",17),m.dd(6,"Rings"),m.fc(),m.bc(7,"codes-table",20),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(8,"div",19),m.gc(9,"div",14),m.gc(10,"div",15),m.gc(11,"div",16),m.gc(12,"h3",17),m.dd(13,"Pendants"),m.fc(),m.bc(14,"codes-table",20),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(15,"div",19),m.gc(16,"div",14),m.gc(17,"div",15),m.gc(18,"div",16),m.gc(19,"h3",17),m.dd(20,"Earrings"),m.fc(),m.bc(21,"codes-table",20),m.fc(),m.fc(),m.fc(),m.fc(),m.dc()),2&e){var n=m.vc();m.Mb(7),m.Cc("redeemed",n.redeemed)("expired",n.expired)("kitType",n.kitIdRing),m.Mb(7),m.Cc("redeemed",n.redeemed)("expired",n.expired)("kitType",n.kitIdPendant),m.Mb(7),m.Cc("redeemed",n.redeemed)("expired",n.expired)("kitType",n.kitIdEarring)}}var ot=function(){function e(){this.redeemed=!1,this.expired=!1,this.oldKits=!1,this.kitIdRing=S.d,this.kitIdPendant=S.c,this.kitIdEarring=S.b,this.castingIdStandard=I.d,this.castingIdHeavy=I.c,this.castingIdDouble=I.b}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Ub({type:e,selectors:[["ng-component"]],decls:29,vars:26,consts:[["title","Casting Codes","subtitle","All active casting codes"],[1,"row","text-center","mb-5"],[1,"col-sm-4"],["data-toggle","buttons",1,"btn-group","btn-group-toggle"],[1,"btn","btn-primary"],["type","radio","name","kitType","id","new","autocomplete","off",3,"value","ngModel","ngModelChange"],["type","radio","name","kitType","id","old","autocomplete","off",3,"value","ngModel","ngModelChange"],["type","radio","name","redeemed","id","unredeemed","autocomplete","off",3,"value","ngModel","ngModelChange"],["type","radio","name","redeemed","id","redeemed","autocomplete","off",3,"value","ngModel","ngModelChange"],["type","radio","name","expired","id","notExpired","autocomplete","off",3,"value","ngModel","ngModelChange"],["type","radio","name","expired","id","expired","autocomplete","off",3,"value","ngModel","ngModelChange"],[1,"container-fluid"],[4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"card-title"],[3,"redeemed","expired","castingType"],[1,"row","mt-3"],[3,"redeemed","expired","kitType"]],template:function(e,t){1&e&&(m.bc(0,"page-title",0),m.gc(1,"div",1),m.gc(2,"div",2),m.gc(3,"div",3),m.gc(4,"label",4),m.gc(5,"input",5),m.rc("ngModelChange",(function(e){return t.oldKits=e})),m.fc(),m.dd(6,"New Kits "),m.fc(),m.gc(7,"label",4),m.gc(8,"input",6),m.rc("ngModelChange",(function(e){return t.oldKits=e})),m.fc(),m.dd(9,"Old Kits "),m.fc(),m.fc(),m.fc(),m.gc(10,"div",2),m.gc(11,"div",3),m.gc(12,"label",4),m.gc(13,"input",7),m.rc("ngModelChange",(function(e){return t.redeemed=e})),m.fc(),m.dd(14,"Unredeemed "),m.fc(),m.gc(15,"label",4),m.gc(16,"input",8),m.rc("ngModelChange",(function(e){return t.redeemed=e})),m.fc(),m.dd(17,"Redeemed "),m.fc(),m.fc(),m.fc(),m.gc(18,"div",2),m.gc(19,"div",3),m.gc(20,"label",4),m.gc(21,"input",9),m.rc("ngModelChange",(function(e){return t.expired=e})),m.fc(),m.dd(22,"Not Expired "),m.fc(),m.gc(23,"label",4),m.gc(24,"input",10),m.rc("ngModelChange",(function(e){return t.expired=e})),m.fc(),m.dd(25,"Expired "),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(26,"div",11),m.bd(27,ct,22,9,"ng-container",12),m.bd(28,it,22,9,"ng-container",12),m.fc()),2&e&&(m.Mb(4),m.Sb("active",!t.oldKits),m.Mb(1),m.Cc("value",!1)("ngModel",t.oldKits),m.Mb(2),m.Sb("active",t.oldKits),m.Mb(1),m.Cc("value",!0)("ngModel",t.oldKits),m.Mb(4),m.Sb("active",!t.redeemed),m.Mb(1),m.Cc("value",!1)("ngModel",t.redeemed),m.Mb(2),m.Sb("active",t.redeemed),m.Mb(1),m.Cc("value",!0)("ngModel",t.redeemed),m.Mb(4),m.Sb("active",!t.expired),m.Mb(1),m.Cc("value",!1)("ngModel",t.expired),m.Mb(2),m.Sb("active",t.expired),m.Mb(1),m.Cc("value",!0)("ngModel",t.expired),m.Mb(3),m.Cc("ngIf",!t.oldKits),m.Mb(1),m.Cc("ngIf",t.oldKits))},directives:[$.a,B.s,B.d,B.k,B.n,s.u,nt],styles:[""]}),e}(),dt=n("CIHE"),rt=n("S6Vu"),at=n("uzfv"),st=n("5Ndf"),lt=n("1kSV"),gt=n("PxxC"),ut=n("r1eF"),ft=n("VdD3"),pt=n("SjCM"),ht=n("XXSO"),mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function c(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(c.prototype=n.prototype,new c)}}(),bt=function(e,t,n,c){return new(n||(n=Promise))((function(i,o){function d(e){try{a(c.next(e))}catch(t){o(t)}}function r(e){try{a(c.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,r)}a((c=c.apply(e,t||[])).next())}))},vt=function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},Ct=["submissionWeightModal"];function yt(e,t){if(1&e){var n=m.hc();m.gc(0,"div",23),m.gc(1,"input",24),m.rc("click",(function(){return m.Pc(n),m.vc().selectAll()}))("ngModelChange",(function(e){return m.Pc(n),m.vc().state.allSelected=e})),m.fc(),m.bc(2,"label",25),m.fc()}if(2&e){var c=m.vc();m.Mb(1),m.Cc("ngModel",c.state.allSelected)("value",c.state.allSelected)}}function Mt(e,t){if(1&e){var n=m.hc();m.gc(0,"button",39),m.rc("click",(function(){m.Pc(n);var e=m.vc().$implicit;return m.vc(2).openWeightModal(e.node)})),m.dd(1," Mark as Received "),m.fc()}if(2&e){var c=m.vc().$implicit;m.Cc("disabled",c.markingAsReceived)}}function St(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"tr"),m.wc(2,"lowercaseDashes"),m.gc(3,"td",30),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.gc(4,"div",23),m.gc(5,"input",31),m.rc("ngModelChange",(function(e){return m.Pc(n),t.$implicit.node.selected=e}))("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.fc(),m.bc(6,"label",32),m.fc(),m.fc(),m.gc(7,"td"),m.gc(8,"a",33),m.wc(9,"numericId"),m.dd(10),m.wc(11,"numericId"),m.fc(),m.fc(),m.gc(12,"td",34),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.dd(13),m.bc(14,"br"),m.gc(15,"span",35),m.dd(16),m.fc(),m.fc(),m.gc(17,"td",36),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.dd(18),m.fc(),m.gc(19,"td",36),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.dd(20),m.fc(),m.gc(21,"td",36),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.dd(22),m.wc(23,"titlecase"),m.fc(),m.gc(24,"td",36),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.dd(25),m.wc(26,"currency"),m.fc(),m.gc(27,"td",36),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.dd(28),m.wc(29,"simpleDateTime"),m.fc(),m.gc(30,"td",37),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).selectRow(e.node)})),m.gc(31,"span"),m.dd(32),m.fc(),m.fc(),m.gc(33,"td"),m.bd(34,Mt,2,1,"button",38),m.fc(),m.fc(),m.dc()}if(2&e){var c=t.$implicit;m.Mb(1),m.Pb("status-",m.xc(2,21,c.node.status.name),""),m.Sb("selected",c.node.selected),m.Mb(4),m.Ec("id","sub-cb-",c.node.id,""),m.Cc("ngModel",c.node.selected)("name","submission"+c.node.id),m.Mb(1),m.Ec("for","sub-cb-",c.node.id,""),m.Mb(2),m.Ec("routerLink","/submission/view/",m.xc(9,23,c.node.id),""),m.Mb(2),m.ed(m.xc(11,25,c.node.id)),m.Mb(3),m.fd(" ",c.node.customer.fullName,""),m.Mb(3),m.gd("",c.node.customer.city,", ",c.node.customer.country,""),m.Mb(2),m.ed(c.node.castingCode),m.Mb(2),m.ed(c.node.kit?c.node.kit.regCode:"-"),m.Mb(2),m.ed(m.xc(23,27,c.node.kitType.name)),m.Mb(3),m.ed(m.xc(26,29,c.node.amountPaid)),m.Mb(3),m.ed(m.xc(29,31,c.node.submittedAt)),m.Mb(4),m.ed(c.node.status.name),m.Mb(2),m.Cc("ngIf",!c.node.status.partnerComplete&&c.node.status.customerComplete)}}function kt(e,t){1&e&&(m.gc(0,"tr"),m.gc(1,"td",40),m.gc(2,"p",41),m.dd(3,"There are no kit submissions?!"),m.fc(),m.fc(),m.fc())}function wt(e,t){if(1&e&&(m.gc(0,"tbody"),m.gc(1,"tr",26),m.gc(2,"td",27),m.gc(3,"p",28),m.dd(4),m.fc(),m.fc(),m.fc(),m.bd(5,St,35,33,"ng-container",29),m.bd(6,kt,4,0,"tr",17),m.fc()),2&e){var n=m.vc();m.Mb(4),m.hd("",n.model.selections.length?n.model.selections.length:"","",n.model.selections.length&&1==n.model.selections.length?" Submission selected":"","",n.model.selections.length&&n.model.selections.length>1?" Submissions selected":""," "),m.Mb(1),m.Cc("ngForOf",n.data.submissions),m.Mb(1),m.Cc("ngIf",!n.data.submissions.length)}}function Tt(e,t){1&e&&(m.gc(0,"tr"),m.gc(1,"td"),m.gc(2,"app-loading-shimmer"),m.gc(3,"div",42),m.gc(4,"div",43),m.bc(5,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(6,"td"),m.gc(7,"app-loading-shimmer"),m.gc(8,"div",45),m.gc(9,"div",46),m.bc(10,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(11,"td"),m.gc(12,"app-loading-shimmer"),m.gc(13,"div",45),m.gc(14,"div",47),m.bc(15,"div",44),m.fc(),m.fc(),m.gc(16,"div",48),m.gc(17,"div",6),m.bc(18,"div",49),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(19,"td"),m.gc(20,"app-loading-shimmer"),m.gc(21,"div",45),m.gc(22,"div",50),m.bc(23,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(24,"td"),m.gc(25,"app-loading-shimmer"),m.gc(26,"div",45),m.gc(27,"div",51),m.bc(28,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(29,"td"),m.gc(30,"app-loading-shimmer"),m.gc(31,"div",45),m.gc(32,"div",51),m.bc(33,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(34,"td"),m.gc(35,"app-loading-shimmer"),m.gc(36,"div",45),m.gc(37,"div",51),m.bc(38,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(39,"td"),m.gc(40,"app-loading-shimmer"),m.gc(41,"div",45),m.gc(42,"div",52),m.bc(43,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(44,"td"),m.gc(45,"app-loading-shimmer"),m.gc(46,"div",45),m.gc(47,"div",53),m.bc(48,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(49,"td",54),m.gc(50,"app-loading-shimmer"),m.gc(51,"div",42),m.gc(52,"div",50),m.bc(53,"div",44),m.fc(),m.fc(),m.fc(),m.fc(),m.fc())}function xt(e,t){1&e&&(m.gc(0,"tbody"),m.gc(1,"tr",26),m.gc(2,"td",27),m.bc(3,"p",28),m.fc(),m.fc(),m.bd(4,Tt,54,0,"tr",29),m.fc()),2&e&&(m.Mb(4),m.Cc("ngForOf"," ".repeat(3).split("")))}function Pt(e,t){1&e&&(m.gc(0,"div",55),m.bc(1,"loading-ring",56),m.fc()),2&e&&(m.Mb(1),m.Cc("size",60))}function It(e,t){if(1&e){var n=m.hc();m.bc(0,"modal-header",57),m.gc(1,"div",58),m.gc(2,"form",2,59),m.gc(4,"div",60),m.gc(5,"label",61),m.dd(6,"Wax Weight"),m.fc(),m.gc(7,"input",62),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc().model.waxWeight=e})),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(8,"modal-footer",63),m.rc("modalSaved",(function(){return m.Pc(n),m.vc().markAsReceived()})),m.fc()}if(2&e){var c=t.$implicit,i=m.Mc(3),o=m.vc();m.Cc("modal",c),m.Mb(7),m.Cc("ngModel",o.model.waxWeight),m.Mb(1),m.Cc("form",i)("modal",c)("saveButtonName","Confirm")}}var Ot=function(e){function t(t,n,c,i,o,d,r){var a=e.call(this)||this;return a.exportDataService=t,a.route=n,a.modalService=c,a.stoneSubmissionService=i,a.submissionService=o,a.toastr=d,a.renderer=r,a.submissionStatusPending=st.l,a.submissionStatusReceived=st.o,a.submissionStatusCreated=st.e,a.bodyClass="kit-submission-list",a.model={selections:[],status:null,stoneSelections:[],waxWeight:null},a.data={stones:[],submissions:[],submission:null},a.renderer.addClass(document.body,a.bodyClass),a}return mt(t,e),t.prototype.ngOnInit=function(){return bt(this,void 0,void 0,(function(){return vt(this,(function(e){switch(e.label){case 0:return[4,this.updateTable(null)];case 1:return e.sent(),[2]}}))}))},t.prototype.updateTable=function(e){return bt(this,void 0,void 0,(function(){var t,n,c,i,o,d=this;return vt(this,(function(r){switch(r.label){case 0:return this.state.loading=!0,[4,this.submissionService.listKitSubmission(e,"DESC",this.model.status?this.model.status.name:null)];case 1:for(t=r.sent(),this.data.submissions=t.data.submissions.edges,this.state.allSelected=!0,n=[],c=0,i=this.data.submissions;c<i.length;c++)n.push((o=i[c]).node.id),-1===this.model.selections.indexOf(o.node)?(o.node.selected=!1,this.state.allSelected=!1):o.node.selected=!0;return this.stoneSubmissionService.listBySubmission(n).subscribe((function(e){d.data.stones=e.data.stoneSubmissions.edges,d.handlePagination(t.data.submissions)})),[2]}}))}))},t.prototype.onChangeStatusFilter=function(){return bt(this,void 0,void 0,(function(){return vt(this,(function(e){return this.model.selections=[],this.model.stoneSelections=[],this.state.allSelected=!1,this.softReset(),this.updateTable(null),[2]}))}))},t.prototype.selectRow=function(e){if(e.selected){e.selected=!e.selected;var t=this.model.selections.findIndex((function(t){return t.id===e.id}));this.model.selections.splice(t,1),this.model.stoneSelections=this.model.stoneSelections.filter((function(t){return t.submission.id!==e.id}))}else{e.selected=!0,this.model.selections.push(e);for(var n=0,c=this.data.stones;n<c.length;n++){var i=c[n];e.id===i.node.submission.id&&this.model.stoneSelections.push(i.node)}}},t.prototype.selectAll=function(){if(this.state.allSelected=!this.state.allSelected,this.state.allSelected)for(var e=0,t=this.data.stones;e<t.length;e++){var n=t[e];-1===this.model.stoneSelections.indexOf(n.node)&&this.model.stoneSelections.push(n.node)}else for(var c=0,i=this.data.submissions;c<i.length;c++)(r=i[c]).node.selected=!0,this.selectRow(r.node);for(var o=0,d=this.data.submissions;o<d.length;o++){var r;(r=d[o]).node.selected=this.state.allSelected,this.state.allSelected&&-1===this.model.selections.indexOf(r.node)&&this.model.selections.push(r.node)}},t.prototype.downloadData=function(){for(var e,t=[],n=[],c=0,i=this.model.selections;c<i.length;c++){for(var o=i[c],d=1,r=0,a=this.model.stoneSelections;r<a.length;r++){var s=a[r];s.submission.id===o.id&&(delete s.stoneSize.size,o["stones_"+d]=s,d++)}e=this.exportDataService.flattenObject(o,t),n.push(e.data),t=e.headers}this.exportDataService.exportToCsv("Kit Submissions"+(new Date).toLocaleString(),t,n)},t.prototype.openWeightModal=function(e){this.modalService.open(this.submissionWeightModal,{keyboard:!1,centered:!0,backdrop:"static",size:"sm"}),this.data.submission=e},t.prototype.markAsReceived=function(){return bt(this,void 0,void 0,(function(){var e,t,n,c;return vt(this,(function(i){switch(i.label){case 0:return this.data.submission?(e=this.model.waxWeight,this.model.waxWeight=null,t=this.data.submission,this.toastr.info("Updating submission","Processing"),t.markingAsReceived=!0,n={id:t.id,status:st.o.id,updatedAt:(new Date).toISOString(),waxWeight:e},[4,this.submissionService.update(n)]):(this.toastr.warning("No submission selected","Warning"),[2]);case 1:return(c=i.sent()).data&&c.data.updateSubmission.status.id===st.o.id&&(t.status={id:c.data.updateSubmission.status.id,name:c.data.updateSubmission.status.name,partnerComplete:c.data.updateSubmission.status.partnerComplete,customerComplete:c.data.updateSubmission.status.customerComplete,__typename:"Status"},this.toastr.success("Submission ("+t.castingCode+") has been updated.","Complete")),t.markingAsReceived=!1,this.data.submission=null,[2]}}))}))},t.prototype.ngOnDestroy=function(){this.renderer.removeClass(document.body,this.bodyClass)},t.\u0275fac=function(e){return new(e||t)(m.ac(at.a),m.ac(g.a),m.ac(lt.i),m.ac(dt.a),m.ac(rt.a),m.ac(j.b),m.ac(m.O))},t.\u0275cmp=m.Ub({type:t,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&m.jd(Ct,!0),2&e&&m.Lc(n=m.sc())&&(t.submissionWeightModal=n.first)},features:[m.Jb],decls:52,vars:22,consts:[["subtitle","All Created Kit Submissions","title","Kit Submissions"],[1,"container","form-container"],["novalidate",""],["downloadSubmissionsForm","ngForm"],[1,"row","card","mt-5","transparent","justify-content-center"],[1,"row","text-center","mb-5"],[1,"col-12"],["data-toggle","buttons",1,"btn-group","btn-group-toggle"],[1,"btn","btn-primary"],["autocomplete","off","id","allStatuses","name","allStatuses","type","radio",3,"ngModel","value","change","ngModelChange"],["autocomplete","off","id","statusPending","name","statusPending","type","radio",3,"ngModel","value","change","ngModelChange"],["autocomplete","off","id","statusCreated","name","statusCreated","type","radio",3,"ngModel","value","change","ngModelChange"],["autocomplete","off","id","statusReceived","name","statusReceived","type","radio",3,"ngModel","value","change","ngModelChange"],[1,"table-responsive"],[1,"table","list-view","kit-submissions"],[1,"checkbox"],["class","checkbox-wrapper checkbox-inline","style","margin: 0;",4,"ngIf"],[4,"ngIf"],["class","text-center",4,"ngIf"],[3,"state","nextPage","previousPage"],[1,"mt-4","tc"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["submissionWeightModal",""],[1,"checkbox-wrapper","checkbox-inline",2,"margin","0"],["id","selectAll","name","selectAll","type","checkbox",3,"ngModel","value","click","ngModelChange"],["for","selectAll"],[1,"spacer",2,"height","21px"],["colspan","42"],[1,"selected-text"],[4,"ngFor","ngForOf"],[1,"pr-0","checkbox",3,"click"],["type","checkbox",3,"ngModel","name","id","ngModelChange","click"],[3,"for"],["target","_blank",3,"routerLink"],[2,"white-space","nowrap","padding-right","15px",3,"click"],[1,"muted"],[3,"click"],[1,"status",3,"click"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["colspan","6"],[1,"text-muted","text-center"],[1,"row","align-items-center","justify-content-center"],[1,"col-4"],[1,"shimmer","py-2"],[1,"row","align-items-center"],[1,"col-5"],[1,"col-10"],[1,"row","align-items-center","mt-1"],[1,"shimmer","py-1"],[1,"col-6"],[1,"col-8"],[1,"col-9"],[1,"col-11"],[1,"tr"],[1,"text-center"],[3,"size"],["title","Enter the wax weight",3,"modal"],[1,"modal-body"],["updateWaxWeightForm","ngForm"],[1,"form-group"],["for","waxWeight",1,"req"],["appShowErrorInputClass","","id","waxWeight","maxlength","255","min","0","name","waxWeight","placeholder","0.000g","required","","type","number",1,"form-control",3,"ngModel","ngModelChange"],[3,"form","modal","saveButtonName","modalSaved"]],template:function(e,t){1&e&&(m.bc(0,"page-title",0),m.gc(1,"div",1),m.gc(2,"form",2,3),m.gc(4,"div",4),m.gc(5,"div",5),m.gc(6,"div",6),m.gc(7,"div",7),m.gc(8,"label",8),m.gc(9,"input",9),m.rc("change",(function(){return t.onChangeStatusFilter()}))("ngModelChange",(function(e){return t.model.status=e})),m.fc(),m.dd(10," All "),m.fc(),m.gc(11,"label",8),m.gc(12,"input",10),m.rc("change",(function(){return t.onChangeStatusFilter()}))("ngModelChange",(function(e){return t.model.status=e})),m.fc(),m.dd(13," Pending "),m.fc(),m.gc(14,"label",8),m.gc(15,"input",11),m.rc("change",(function(){return t.onChangeStatusFilter()}))("ngModelChange",(function(e){return t.model.status=e})),m.fc(),m.dd(16," Created "),m.fc(),m.gc(17,"label",8),m.gc(18,"input",12),m.rc("change",(function(){return t.onChangeStatusFilter()}))("ngModelChange",(function(e){return t.model.status=e})),m.fc(),m.dd(19," Received "),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(20,"div",13),m.gc(21,"table",14),m.gc(22,"thead"),m.gc(23,"tr"),m.gc(24,"th",15),m.bd(25,yt,3,2,"div",16),m.fc(),m.gc(26,"th"),m.dd(27,"ID"),m.fc(),m.gc(28,"th"),m.dd(29,"Customer"),m.fc(),m.gc(30,"th"),m.dd(31,"Code"),m.fc(),m.gc(32,"th"),m.dd(33,"Reg Code"),m.fc(),m.gc(34,"th"),m.dd(35,"Type"),m.fc(),m.gc(36,"th"),m.dd(37,"Paid (\xa3)"),m.fc(),m.gc(38,"th"),m.dd(39,"Submitted"),m.fc(),m.gc(40,"th"),m.dd(41,"Status"),m.fc(),m.bc(42,"th"),m.fc(),m.fc(),m.bd(43,wt,7,5,"tbody",17),m.bd(44,xt,5,1,"tbody",17),m.fc(),m.bd(45,Pt,2,1,"div",18),m.fc(),m.gc(46,"table-controls",19),m.rc("nextPage",(function(){return t.nextPage()}))("previousPage",(function(){return t.previousPage()})),m.fc(),m.gc(47,"div",20),m.gc(48,"button",21),m.rc("click",(function(){return t.downloadData()})),m.dd(49," Download Data "),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.bd(50,It,9,5,"ng-template",null,22,m.cd)),2&e&&(m.Mb(8),m.Sb("active",null===t.model.status),m.Mb(1),m.Cc("ngModel",t.model.status)("value",null),m.Mb(2),m.Sb("active",t.model.status&&t.model.status.id===t.submissionStatusPending.id),m.Mb(1),m.Cc("ngModel",t.model.status)("value",t.submissionStatusPending),m.Mb(2),m.Sb("active",t.model.status&&t.model.status.id===t.submissionStatusCreated.id),m.Mb(1),m.Cc("ngModel",t.model.status)("value",t.submissionStatusCreated),m.Mb(2),m.Sb("active",t.model.status&&t.model.status.id===t.submissionStatusReceived.id),m.Mb(1),m.Cc("ngModel",t.model.status)("value",t.submissionStatusReceived),m.Mb(7),m.Cc("ngIf",!t.state.loading),m.Mb(18),m.Cc("ngIf",!t.state.loading),m.Mb(1),m.Cc("ngIf",t.state.loading),m.Mb(1),m.Cc("ngIf",t.state.loading),m.Mb(1),m.Cc("state",t.state),m.Mb(2),m.Cc("disabled",!t.model.selections.length||t.state.loading))},directives:[$.a,B.z,B.l,B.m,B.s,B.d,B.k,B.n,s.u,$e.a,B.a,s.t,g.e,gt.a,W.a,ut.a,B.q,V.a,B.g,B.u,ft.a],pipes:[pt.a,ht.a,s.G,We.a,Q.a],styles:[""]}),t}(je.a),Kt=n("mhvR"),zt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function c(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(c.prototype=n.prototype,new c)}}(),Dt=function(e,t,n,c){return new(n||(n=Promise))((function(i,o){function d(e){try{a(c.next(e))}catch(t){o(t)}}function r(e){try{a(c.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,r)}a((c=c.apply(e,t||[])).next())}))},Rt=function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},At=["quickAddKitModal"];function Ft(e,t){if(1&e&&(m.gc(0,"div",22),m.bc(1,"kit-and-casting-label",23),m.fc()),2&e){var n=t.$implicit,c=m.vc();m.Mb(1),m.Cc("castingCode",n.node.activeCastingCodes&&1===n.node.activeCastingCodes.length?n.node.activeCastingCodes[0].node:null)("kit",n.node)("refill",c.refill)}}function _t(e,t){1&e&&(m.gc(0,"td"),m.gc(1,"app-loading-shimmer"),m.gc(2,"div",34),m.gc(3,"div",35),m.bc(4,"div",36),m.fc(),m.fc(),m.fc(),m.fc())}function Et(e,t){1&e&&m.bc(0,"td")}function qt(e,t){if(1&e&&(m.gc(0,"td"),m.dd(1),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(1),m.ed(n.node.castingCodes[0].node.code)}}function Nt(e,t){if(1&e&&(m.gc(0,"td"),m.bc(1,"status-pill",37),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(1),m.Cc("content","Multiple")("pillType","warning")("tooltipText",n.node.castingCodes.length+" Casting Codes")}}function jt(e,t){1&e&&m.bc(0,"span",38)}function $t(e,t){if(1&e){var n=m.hc();m.ec(0),m.gc(1,"tr",25),m.gc(2,"td",26),m.dd(3),m.wc(4,"simpleDateTime"),m.fc(),m.gc(5,"td"),m.dd(6),m.fc(),m.gc(7,"td"),m.dd(8),m.fc(),m.gc(9,"td"),m.dd(10),m.fc(),m.bd(11,_t,5,0,"td",18),m.bd(12,Et,1,0,"td",18),m.bd(13,qt,2,1,"td",18),m.bd(14,Nt,2,3,"td",18),m.gc(15,"td",17),m.gc(16,"div",27),m.gc(17,"div",28),m.gc(18,"button",29),m.bd(19,jt,1,0,"span",30),m.fc(),m.gc(20,"div",31),m.gc(21,"button",32),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).printCode(e)})),m.dd(22," Print Kit Label "),m.fc(),m.gc(23,"button",32),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).printCode(e,!0)})),m.dd(24," Print Refill Label "),m.fc(),m.fc(),m.fc(),m.gc(25,"button",33),m.rc("click",(function(){m.Pc(n);var e=t.$implicit;return m.vc(2).viewKit(e.node.id)})),m.fc(),m.fc(),m.fc(),m.fc(),m.dc()}if(2&e){var c=t.$implicit,i=m.vc(2);m.Mb(3),m.ed(m.xc(4,12,c.node.createdAt)),m.Mb(3),m.ed(c.node.regCode),m.Mb(2),m.ed(c.node.purchaseSource?c.node.purchaseSource.name:""),m.Mb(2),m.ed(c.node.orderReference),m.Mb(1),m.Cc("ngIf",i.loadingCastingCodes),m.Mb(1),m.Cc("ngIf",!i.loadingCastingCodes&&0===c.node.castingCodes.length),m.Mb(1),m.Cc("ngIf",!i.loadingCastingCodes&&1===c.node.castingCodes.length),m.Mb(1),m.Cc("ngIf",!i.loadingCastingCodes&&c.node.castingCodes.length>1),m.Mb(4),m.Sb("fa-print",!i.state.creatingPdf),m.Cc("disabled",i.state.creatingPdf),m.Mb(1),m.Cc("ngIf",!0===i.state.creatingPdf)}}function Lt(e,t){1&e&&(m.gc(0,"tr"),m.gc(1,"td",39),m.gc(2,"p",40),m.dd(3,"No kits found"),m.fc(),m.fc(),m.fc())}function Wt(e,t){if(1&e&&(m.gc(0,"tbody"),m.bd(1,$t,26,14,"ng-container",24),m.bd(2,Lt,4,0,"tr",18),m.fc()),2&e){var n=m.vc();m.Mb(1),m.Cc("ngForOf",n.data.kits),m.Mb(1),m.Cc("ngIf",!n.data.kits.length)}}function Bt(e,t){1&e&&(m.gc(0,"div",41),m.bc(1,"loading-ring",42),m.fc()),2&e&&(m.Mb(1),m.Cc("size",60))}function Vt(e,t){if(1&e){var n=m.hc();m.bc(0,"modal-header",43),m.gc(1,"div",44),m.gc(2,"form",7,45),m.gc(4,"div",46),m.gc(5,"label",47),m.dd(6,"Order Reference"),m.fc(),m.gc(7,"input",48),m.rc("ngModelChange",(function(e){return m.Pc(n),m.vc().quickAdd.orderRef=e})),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(8,"modal-footer",49),m.rc("modalSaved",(function(){return m.Pc(n),m.vc().requestToAddKit()})),m.fc()}if(2&e){var c=t.$implicit,i=m.Mc(3),o=m.vc();m.Cc("modal",c),m.Mb(7),m.Cc("ngModel",o.quickAdd.orderRef),m.Mb(1),m.Cc("form",i)("modal",c)("saveButtonName","Add")}}var Gt,Yt=function(){return function(){this.regCode=null,this.source=null,this.reference=null}}(),Ut=function(e){function t(t,n,c,i,o,d){var r=e.call(this)||this;return r.router=t,r.kitService=n,r.castingCodeService=c,r.exportToPdfService=i,r.toastrService=o,r.modalService=d,r.data={kits:[]},r.quickAdd={orderRef:null},r.model=new Yt,r.refill=!1,r.loadingCastingCodes=!0,r.currentKitSearch=null,r}return zt(t,e),t.prototype.ngOnInit=function(){return Dt(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return[4,this.updateTable(null)];case 1:return e.sent(),[2]}}))}))},t.prototype.updateTable=function(e){return Dt(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(n){return clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(n){t.state.loading=!0,t.loadingCastingCodes=!0,t.currentKitSearch&&t.currentKitSearch.unsubscribe(),Object.keys(t.model).forEach((function(e,n){t.model[e]=t.model[e]?t.model[e]:null})),t.currentKitSearch=t.kitService.list(25,e,"DESC",t.model.regCode,t.model.source,t.model.reference).subscribe((function(e){t.data.kits=e.data.kits.edges;for(var n=[],c=0,i=t.data.kits;c<i.length;c++){var o=i[c];o.node.castingCodes=[],o.node.activeCastingCodes=[];var d=o.node.id.replace(/^\D+/,"");n.push(d)}t.currentKitSearch=null,t.handlePagination(e.data.kits),0!==n.length&&t.castingCodeService.listByKitIds(n).subscribe((function(e){var n=(new Date).toISOString();if(e&&e.data&&e.data.castingCodes)for(var c=0,i=t.data.kits;c<i.length;c++)for(var o=i[c],d=0,r=e.data.castingCodes.edges;d<r.length;d++){var a=r[d];a.node.kit.id===o.node.id&&(o.node.castingCodes.push(a),!0!==a.node.redeemed&&n<a.node.expiresAt&&o.node.activeCastingCodes.push(a))}t.loadingCastingCodes=!1}))}))}),500),[2]}))}))},t.prototype.clearSearches=function(){this.model=new Yt,this.updateTable(null)},t.prototype.viewKit=function(e){this.router.navigate(["kit","view",e.replace(/\D/g,"")])},t.prototype.printCode=function(e,t){return void 0===t&&(t=!1),Dt(this,void 0,void 0,(function(){var n=this;return Rt(this,(function(c){return this.state.creatingPdf||(this.refill=t,setTimeout((function(t){return Dt(n,void 0,void 0,(function(){var t;return Rt(this,(function(n){switch(n.label){case 0:return t=e.node.id.replace(/\D/g,""),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+t))];case 1:return n.sent(),this.state.creatingPdf=!1,this.refill=!1,[2]}}))}))}),100)),[2]}))}))},t.prototype.openAddKitModal=function(){this.modalService.open(this.quickAddKitModal,{keyboard:!0,centered:!0,backdrop:"static",size:"sm"})},t.prototype.requestToAddKit=function(){return Dt(this,void 0,void 0,(function(){var e=this;return Rt(this,(function(t){return this.quickAdd.orderRef||this.toastrService.warning("You must provide an order reference from WooCommerce","Warning"),this.kitService.quickAddKit(this.quickAdd.orderRef).subscribe((function(t){e.toastrService.info(t,"Info"),e.updateTable(null)})),this.quickAdd.orderRef=null,[2]}))}))},t.\u0275fac=function(e){return new(e||t)(m.ac(g.b),m.ac(K.a),m.ac(x.a),m.ac(R.a),m.ac(j.b),m.ac(lt.i))},t.\u0275cmp=m.Ub({type:t,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&m.jd(At,!0),2&e&&m.Lc(n=m.sc())&&(t.quickAddKitModal=n.first)},features:[m.Jb],decls:47,vars:7,consts:[["class","print_wrapper",4,"ngFor","ngForOf"],["subtitle","All Outstanding Kits","title","All Kits"],[1,"card","mt-5"],[1,"card-body"],[1,"row"],[1,"col"],[1,"btn","btn-primary",3,"click"],["novalidate",""],["kitsForm","ngForm"],[1,"table-responsive"],[1,"data-table"],[1,"search-head-top"],[1,"search-head"],["name","regCode",1,"form-control",3,"ngModel","keyup","ngModelChange"],["name","source",1,"form-control",3,"ngModel","keyup","ngModelChange"],["name","reference",1,"form-control",3,"ngModel","keyup","ngModelChange"],["disabled","","name","ghost",1,"form-control"],[1,"tr"],[4,"ngIf"],["class","text-center",4,"ngIf"],[3,"state","nextPage","previousPage"],["quickAddKitModal",""],[1,"print_wrapper"],[3,"castingCode","kit","refill"],[4,"ngFor","ngForOf"],[1,"nowrap"],[1,"color-muted"],[1,"btn-group"],["ngbDropdown","","placement","left auto",1,"d-inline-block"],["id","printMenu","ngbDropdownToggle","",1,"btn","icon-btn-outline","mx-1","fas",3,"disabled"],["aria-hidden","true","class","spinner-border spinner-border-sm",4,"ngIf"],["aria-labelledby","printMenu","ngbDropdownMenu",""],["ngbDropdownItem","",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","icon-btn-outline","mx-1","fas","fa-search",3,"click"],[1,"row","align-items-center"],[1,"col-6"],[1,"shimmer","py-2"],[3,"content","pillType","tooltipText"],["aria-hidden","true",1,"spinner-border","spinner-border-sm"],["colspan","6"],[1,"text-muted","text-center"],[1,"text-center"],[3,"size"],["title","Quick Add - Kit Create",3,"modal"],[1,"modal-body"],["quickAddKit","ngForm"],[1,"form-group"],["for","orderRef",1,"req"],["appShowErrorInputClass","","id","orderRef","name","orderRef","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],[3,"form","modal","saveButtonName","modalSaved"]],template:function(e,t){1&e&&(m.bd(0,Ft,2,3,"div",0),m.bc(1,"page-title",1),m.gc(2,"div",2),m.gc(3,"div",3),m.gc(4,"div",4),m.gc(5,"div",5),m.gc(6,"h5"),m.dd(7,"Quick Add"),m.fc(),m.gc(8,"button",6),m.rc("click",(function(){return t.openAddKitModal()})),m.dd(9," Add a Kit "),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(10,"form",7,8),m.gc(12,"div",2),m.gc(13,"div",3),m.gc(14,"div",9),m.gc(15,"table",10),m.gc(16,"thead"),m.gc(17,"tr",11),m.gc(18,"th"),m.dd(19,"Created"),m.fc(),m.gc(20,"th"),m.dd(21,"Code"),m.fc(),m.gc(22,"th"),m.dd(23,"Source"),m.fc(),m.gc(24,"th"),m.dd(25,"Reference"),m.fc(),m.gc(26,"th"),m.dd(27,"Casting Code"),m.fc(),m.bc(28,"th"),m.fc(),m.gc(29,"tr",12),m.bc(30,"th"),m.gc(31,"th"),m.gc(32,"input",13),m.rc("keyup",(function(){return t.updateTable(null)}))("ngModelChange",(function(e){return t.model.regCode=e})),m.fc(),m.fc(),m.gc(33,"th"),m.gc(34,"input",14),m.rc("keyup",(function(){return t.updateTable(null)}))("ngModelChange",(function(e){return t.model.source=e})),m.fc(),m.fc(),m.gc(35,"th"),m.gc(36,"input",15),m.rc("keyup",(function(){return t.updateTable(null)}))("ngModelChange",(function(e){return t.model.reference=e})),m.fc(),m.fc(),m.gc(37,"th"),m.bc(38,"input",16),m.fc(),m.gc(39,"th",17),m.gc(40,"button",6),m.rc("click",(function(){return t.clearSearches()})),m.dd(41,"Clear"),m.fc(),m.fc(),m.fc(),m.fc(),m.bd(42,Wt,3,2,"tbody",18),m.fc(),m.bd(43,Bt,2,1,"div",19),m.fc(),m.gc(44,"table-controls",20),m.rc("nextPage",(function(){return t.nextPage()}))("previousPage",(function(){return t.previousPage()})),m.fc(),m.fc(),m.fc(),m.fc(),m.bd(45,Vt,9,5,"ng-template",null,21,m.cd)),2&e&&(m.Cc("ngForOf",t.data.kits),m.Mb(32),m.Cc("ngModel",t.model.regCode),m.Mb(2),m.Cc("ngModel",t.model.source),m.Mb(2),m.Cc("ngModel",t.model.reference),m.Mb(6),m.Cc("ngIf",!t.state.loading),m.Mb(1),m.Cc("ngIf",t.state.loading),m.Mb(1),m.Cc("state",t.state))},directives:[s.t,$.a,B.z,B.l,B.m,B.d,B.k,B.n,s.u,$e.a,L.a,lt.c,lt.h,lt.f,lt.e,gt.a,Kt.a,W.a,ut.a,V.a,B.u,ft.a],pipes:[Q.a],styles:[""]}),t}(je.a),Xt=p()(Gt||(Gt=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(["\n    query submissionsByKit($kit: String!) {\n        submissions(\n            first: 999,\n            kit: $kit\n        ) {\n            edges  {\n                node {\n                    id\n                    castingCode\n                    submittedAt\n                    kitType {\n                        id\n                        name\n                    }\n                    status {\n                        id\n                        name\n                    }\n                    customer {\n                        id\n                        fullName\n                    }\n                }\n            }\n        }\n    }\n"],["\n    query submissionsByKit($kit: String!) {\n        submissions(\n            first: 999,\n            kit: $kit\n        ) {\n            edges  {\n                node {\n                    id\n                    castingCode\n                    submittedAt\n                    kitType {\n                        id\n                        name\n                    }\n                    status {\n                        id\n                        name\n                    }\n                    customer {\n                        id\n                        fullName\n                    }\n                }\n            }\n        }\n    }\n"]))),Qt=n("tk/3"),Ht=function(){function e(e,t){this.apollo=e,this.http=t}return e.prototype.listByKitId=function(e){return this.apollo.query({query:Xt,variables:{kit:e}})},e.\u0275fac=function(t){return new(t||e)(m.oc(b.b),m.oc(Qt.b))},e.\u0275prov=m.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Jt(e,t){if(1&e&&(m.gc(0,"div",5),m.bc(1,"kit-and-casting-label",6),m.fc()),2&e){var n=t.$implicit,c=m.vc(2);m.Mb(1),m.Cc("castingCode",n.node)("kit",n.node.kit)("useCastingCodeForId",c.data.castingCodes.length>1)}}function Zt(e,t){if(1&e&&(m.ec(0),m.bd(1,Jt,2,3,"div",4),m.dc()),2&e){var n=m.vc();m.Mb(1),m.Cc("ngForOf",n.data.castingCodes)}}function en(e,t){if(1&e&&(m.ec(0),m.gc(1,"div",5),m.bc(2,"kit-and-casting-label",7),m.fc(),m.dc()),2&e){var n=m.vc();m.Mb(2),m.Cc("castingCode",null)("kit",n.data.kit)}}function tn(e,t){if(1&e&&(m.gc(0,"span"),m.dd(1),m.wc(2,"uppercase"),m.fc()),2&e){var n=m.vc(3);m.Mb(1),m.fd(" - ",m.xc(2,1,n.model.orderRingSizeCustom.name),"")}}function nn(e,t){if(1&e&&(m.gc(0,"li"),m.dd(1," Ring Size: "),m.gc(2,"strong"),m.dd(3),m.wc(4,"titlecase"),m.bd(5,tn,3,3,"span",0),m.fc(),m.fc()),2&e){var n=m.vc(2);m.Mb(3),m.ed(m.xc(4,2,n.model.orderRingSize.name)),m.Mb(2),m.Cc("ngIf",n.model.orderRingSizeCustom)}}function cn(e,t){if(1&e&&(m.gc(0,"li"),m.dd(1," Ring Size: "),m.gc(2,"strong"),m.dd(3),m.wc(4,"titlecase"),m.fc(),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(3),m.ed(n.node.ringSize?n.node.ringSize.name:m.xc(4,1,""))}}function on(e,t){if(1&e&&(m.gc(0,"li"),m.dd(1," Ring Size Custom: "),m.gc(2,"strong"),m.dd(3),m.wc(4,"titlecase"),m.fc(),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(3),m.ed(n.node.ringSizeCustom?n.node.ringSize.name:m.xc(4,1,""))}}function dn(e,t){if(1&e&&(m.gc(0,"li"),m.dd(1," Redeemed At: "),m.gc(2,"strong"),m.dd(3),m.wc(4,"simpleDate"),m.fc(),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(3),m.ed(m.xc(4,1,n.node.redeemedAt))}}function rn(e,t){if(1&e&&(m.gc(0,"li"),m.dd(1,"Casting Price Paid: "),m.gc(2,"strong"),m.dd(3),m.wc(4,"currency"),m.fc(),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(3),m.ed(m.xc(4,1,n.node.castingPricePaid))}}function an(e,t){if(1&e&&(m.gc(0,"li"),m.dd(1," Discount Description: "),m.gc(2,"strong"),m.dd(3),m.fc(),m.fc()),2&e){var n=m.vc().$implicit;m.Mb(3),m.ed(n.node.discount)}}function sn(e,t){if(1&e){var n=m.hc();m.gc(0,"div",24),m.gc(1,"button",25),m.rc("click",(function(){m.Pc(n);var e=m.vc().$implicit;return m.vc(2).printKit(e.node)})),m.bc(2,"span",26),m.dd(3," Print "),m.fc(),m.fc()}}function ln(e,t){if(1&e&&(m.gc(0,"div",23),m.gc(1,"div",13),m.gc(2,"div",14),m.gc(3,"div",15),m.gc(4,"h5",16),m.dd(5),m.fc(),m.gc(6,"div",11),m.gc(7,"div",17),m.gc(8,"ul",18),m.gc(9,"li"),m.dd(10,"Kit Type: "),m.gc(11,"strong"),m.dd(12),m.wc(13,"titlecase"),m.fc(),m.fc(),m.gc(14,"li"),m.dd(15,"Casting Type: "),m.gc(16,"strong"),m.dd(17),m.wc(18,"titlecase"),m.fc(),m.fc(),m.bd(19,cn,5,3,"li",0),m.bd(20,on,5,3,"li",0),m.gc(21,"li"),m.dd(22,"Engraving: "),m.gc(23,"strong"),m.dd(24),m.fc(),m.fc(),m.gc(25,"li"),m.dd(26,"Redeemed: "),m.gc(27,"strong"),m.dd(28),m.fc(),m.fc(),m.bd(29,dn,5,3,"li",0),m.gc(30,"li"),m.dd(31,"Expires At: "),m.gc(32,"strong"),m.dd(33),m.wc(34,"simpleDate"),m.fc(),m.fc(),m.bd(35,rn,5,3,"li",0),m.fc(),m.fc(),m.gc(36,"div",17),m.gc(37,"ul",18),m.gc(38,"li"),m.dd(39,"Reference: "),m.gc(40,"strong"),m.dd(41),m.fc(),m.fc(),m.gc(42,"li"),m.dd(43,"Stone Setting: "),m.gc(44,"strong"),m.dd(45),m.fc(),m.fc(),m.gc(46,"li"),m.dd(47,"Discount: "),m.gc(48,"strong"),m.dd(49),m.fc(),m.fc(),m.bd(50,an,4,1,"li",0),m.gc(51,"li"),m.dd(52,"Estimated Cost: "),m.gc(53,"strong"),m.dd(54),m.wc(55,"currency"),m.fc(),m.fc(),m.fc(),m.fc(),m.bd(56,sn,4,0,"div",22),m.fc(),m.fc(),m.fc(),m.fc(),m.fc()),2&e){var n=t.$implicit,c=m.vc(2);m.Mb(5),m.fd("Casting Code: ",n.node.code,""),m.Mb(7),m.ed(m.xc(13,16,n.node.kitType?n.node.kitType.name:"")),m.Mb(5),m.ed(m.xc(18,18,n.node.castingType?n.node.castingType.name:"")),m.Mb(2),m.Cc("ngIf",n.node.ringSize&&n.node.ringSize.name!==c.ringSizeCustom),m.Mb(1),m.Cc("ngIf",n.node.ringSize&&n.node.ringSize.name===c.ringSizeCustom),m.Mb(4),m.ed(n.node.engraving),m.Mb(4),m.ed(n.node.redeemed),m.Mb(1),m.Cc("ngIf",n.node.redeemed),m.Mb(4),m.ed(m.xc(34,20,n.node.expiresAt)),m.Mb(2),m.Cc("ngIf",n.node.castingPricePaid),m.Mb(6),m.ed(n.node.reference),m.Mb(4),m.ed(n.node.stoneSetting),m.Mb(4),m.ed(n.node.discount),m.Mb(1),m.Cc("ngIf",n.node.discount>0),m.Mb(4),m.ed(m.xc(55,22,n.node.estimatedCost)),m.Mb(2),m.Cc("ngIf",c.data.castingCodes.length>1)}}function gn(e,t){if(1&e&&(m.ec(0),m.gc(1,"tr"),m.gc(2,"th"),m.dd(3),m.wc(4,"numericId"),m.fc(),m.gc(5,"td"),m.dd(6),m.wc(7,"titlecase"),m.fc(),m.gc(8,"td"),m.dd(9),m.wc(10,"uppercase"),m.fc(),m.gc(11,"td"),m.dd(12),m.wc(13,"titlecase"),m.fc(),m.gc(14,"td",36),m.dd(15),m.wc(16,"simpleDateTime"),m.fc(),m.gc(17,"td"),m.dd(18),m.fc(),m.gc(19,"td",37),m.gc(20,"div",38),m.bc(21,"button",39),m.wc(22,"numericId"),m.fc(),m.fc(),m.fc(),m.dc()),2&e){var n=t.$implicit;m.Mb(3),m.ed(m.xc(4,7,n.node.id)),m.Mb(3),m.ed(m.xc(7,9,n.node.customer.fullName)),m.Mb(3),m.ed(m.xc(10,11,n.node.castingCode)),m.Mb(3),m.ed(m.xc(13,13,n.node.kitType.name)),m.Mb(3),m.ed(m.xc(16,15,n.node.submittedAt)),m.Mb(3),m.ed(n.node.status.name),m.Mb(3),m.Cc("routerLink","/submission/view/"+m.xc(22,17,n.node.id))}}function un(e,t){1&e&&(m.gc(0,"tr",40),m.gc(1,"td",41),m.gc(2,"p",42),m.dd(3,"No submissions yet for this kit \ud83c\udfd6"),m.fc(),m.fc(),m.fc())}function fn(e,t){if(1&e&&(m.gc(0,"div",27),m.gc(1,"div",28),m.gc(2,"div",29),m.gc(3,"h5",30),m.dd(4,"Submissions"),m.fc(),m.fc(),m.fc(),m.gc(5,"div",31),m.gc(6,"div",32),m.gc(7,"table",33),m.gc(8,"thead"),m.gc(9,"tr"),m.gc(10,"th"),m.dd(11,"ID"),m.fc(),m.gc(12,"th"),m.dd(13,"Customer"),m.fc(),m.gc(14,"th"),m.dd(15,"Code"),m.fc(),m.gc(16,"th"),m.dd(17,"Type"),m.fc(),m.gc(18,"th"),m.dd(19,"Submitted"),m.fc(),m.gc(20,"th"),m.dd(21,"Status"),m.fc(),m.bc(22,"th"),m.fc(),m.fc(),m.gc(23,"tbody"),m.bd(24,gn,23,19,"ng-container",34),m.bd(25,un,4,0,"tr",35),m.fc(),m.fc(),m.fc(),m.fc(),m.fc()),2&e){var n=m.vc(2);m.Mb(24),m.Cc("ngForOf",n.data.submissions),m.Mb(1),m.Cc("ngIf",!n.data.submissions.length)}}function pn(e,t){if(1&e){var n=m.hc();m.gc(0,"div",24),m.gc(1,"button",25),m.rc("click",(function(){return m.Pc(n),m.vc(2).printKit(null)})),m.bc(2,"span",26),m.dd(3," Print "),m.fc(),m.fc()}}function hn(e,t){if(1&e&&(m.gc(0,"form",8,9),m.gc(2,"div",10),m.gc(3,"div",11),m.gc(4,"div",12),m.gc(5,"div",13),m.gc(6,"div",14),m.gc(7,"div",15),m.gc(8,"h5",16),m.dd(9,"Kit"),m.fc(),m.gc(10,"div",11),m.gc(11,"div",17),m.gc(12,"ul",18),m.gc(13,"li"),m.dd(14,"RegCod: "),m.gc(15,"strong"),m.dd(16),m.fc(),m.fc(),m.bd(17,nn,6,4,"li",0),m.gc(18,"li"),m.dd(19,"Customer: "),m.gc(20,"strong"),m.dd(21),m.fc(),m.fc(),m.gc(22,"li"),m.dd(23,"Source: "),m.gc(24,"strong"),m.dd(25),m.wc(26,"titlecase"),m.fc(),m.fc(),m.fc(),m.fc(),m.gc(27,"div",17),m.gc(28,"ul",18),m.gc(29,"li"),m.dd(30,"Reference: "),m.gc(31,"strong"),m.dd(32),m.fc(),m.fc(),m.gc(33,"li"),m.dd(34,"Created At: "),m.gc(35,"strong"),m.dd(36),m.wc(37,"simpleDate"),m.fc(),m.fc(),m.gc(38,"li"),m.dd(39,"Order Date: "),m.gc(40,"strong"),m.dd(41),m.wc(42,"simpleDate"),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.fc(),m.bd(43,ln,57,24,"div",19),m.bd(44,fn,26,2,"div",20),m.fc(),m.gc(45,"div",21),m.bd(46,pn,4,0,"div",22),m.fc(),m.fc(),m.fc()),2&e){var n=m.vc();m.Mb(16),m.ed(n.model.regCode),m.Mb(1),m.Cc("ngIf",n.model.orderRingSize),m.Mb(4),m.ed(n.model.customer?n.model.customer.fullName:""),m.Mb(4),m.ed(n.model.purchaseSource?n.model.purchaseSource.name:m.xc(26,10,"")),m.Mb(7),m.ed(n.model.orderReference),m.Mb(4),m.ed(m.xc(37,12,n.model.createdAt)),m.Mb(5),m.ed(m.xc(42,14,n.model.orderDate)),m.Mb(2),m.Cc("ngForOf",n.data.castingCodes),m.Mb(1),m.Cc("ngIf",n.data.submissions),m.Mb(2),m.Cc("ngIf",n.data.castingCodes.length<2)}}function mn(e,t){1&e&&(m.gc(0,"h3"),m.dd(1,"Kit Not Found"),m.fc())}function bn(e,t){1&e&&m.bc(0,"loading-ring",43),2&e&&m.Cc("size",60)}var vn=function(){return function(){}}(),Cn=function(){function e(e,t,n,c,i,o){this.route=e,this.router=t,this.kitService=n,this.castingCodeService=c,this.exportToPdfService=i,this.submissionService=o,this.state={creatingPdf:!1,found:!1,isAdmin:!1,loading:!0},this.data={id:null,kit:null,castingCodes:null,submissions:null},this.model=new vn,this.ringSizeCustom=T.b}return e.prototype.ngOnInit=function(){var e=this;this.route.paramMap.subscribe((function(t){e.data.id=t.get("id"),Object(u.a)(e.kitService.getById("/kits/"+e.data.id),e.castingCodeService.listByKitId("/kits/"+e.data.id),e.submissionService.listByKitId("/kits/"+e.data.id)).subscribe((function(t){var n=t[0],c=t[1],i=t[2];n.data.kit?(e.state.found=!0,e.model=JSON.parse(JSON.stringify(n.data.kit)),e.data.kit=n.data.kit,e.data.castingCodes=c.data.castingCodes.edges,e.data.submissions=i.data.submissions.edges,e.state.loading=!1):e.state.loading=!1}))}))},e.prototype.printKit=function(e){return t=this,void 0,c=function(){var t;return function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}(this,(function(n){switch(n.label){case 0:return this.state.creatingPdf?[2]:(t=this.data.kit.id.replace(/\D/g,""),e&&(t="0"+e.id.replace(/\D/g,"")),this.state.creatingPdf=!0,[4,this.exportToPdfService.makeLabel(document.getElementById("label-"+t))]);case 1:return n.sent(),this.state.creatingPdf=!1,[2]}}))},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{r(c.next(e))}catch(t){i(t)}}function d(e){try{r(c.throw(e))}catch(t){i(t)}}function r(t){var c;t.done?e(t.value):(c=t.value,c instanceof n?c:new n((function(e){e(c)}))).then(o,d)}r((c=c.apply(t,[])).next())}));var t,n,c},e.\u0275fac=function(t){return new(t||e)(m.ac(g.a),m.ac(g.b),m.ac(K.a),m.ac(x.a),m.ac(R.a),m.ac(Ht))},e.\u0275cmp=m.Ub({type:e,selectors:[["ng-component"]],decls:6,vars:5,consts:[[4,"ngIf"],["subtitle","View Kit Details","title","Kit Info"],["novalidate","",4,"ngIf"],[3,"size",4,"ngIf"],["class","print_wrapper",4,"ngFor","ngForOf"],[1,"print_wrapper"],[3,"castingCode","kit","useCastingCodeForId"],[3,"castingCode","kit"],["novalidate",""],["viewKitForm","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"inner-section"],[1,"card-title"],[1,"col-sm-6"],[1,"card-details"],["class","col-md-12 mt-3",4,"ngFor","ngForOf"],["class","col Section mb-5",4,"ngIf"],[1,"row","mt-3"],["class","col-12 tc",4,"ngIf"],[1,"col-md-12","mt-3"],[1,"col-12","tc"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-print"],[1,"col","Section","mb-5"],[1,"row","py-3","box-divider-bottom","justify-content-start"],[1,"col"],[1,"mb-2"],[1,"row","mb-4"],[1,"table-responsive"],[1,"data-table"],[4,"ngFor","ngForOf"],["style","border-bottom: none;",4,"ngIf"],[1,"text-muted"],[1,"tr"],[1,"btn-group"],["type","button",1,"btn","icon-btn-outline","mx-1","fas","fa-search",3,"routerLink"],[2,"border-bottom","none"],["colspan","68"],[1,"text-muted","text-center"],[3,"size"]],template:function(e,t){1&e&&(m.bd(0,Zt,2,1,"ng-container",0),m.bd(1,en,3,2,"ng-container",0),m.bc(2,"page-title",1),m.bd(3,hn,47,16,"form",2),m.bd(4,mn,2,0,"h3",0),m.bd(5,bn,1,1,"loading-ring",3)),2&e&&(m.Cc("ngIf",t.data.castingCodes&&t.data.castingCodes.length>0),m.Mb(1),m.Cc("ngIf",t.data.kit&&(!t.data.castingCodes||0===t.data.castingCodes.length)),m.Mb(2),m.Cc("ngIf",!t.state.loading&&t.state.found),m.Mb(1),m.Cc("ngIf",!t.state.loading&&!t.state.found),m.Mb(1),m.Cc("ngIf",t.state.loading))},directives:[s.u,$.a,s.t,L.a,B.z,B.l,B.m,g.c,W.a],pipes:[s.G,Be.a,s.I,We.a,ht.a,Q.a],styles:[""]}),e}(),yn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function c(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(c.prototype=n.prototype,new c)}}();function Mn(e,t){1&e&&(m.gc(0,"span"),m.dd(1,"Chain "),m.fc())}function Sn(e,t){1&e&&(m.gc(0,"span"),m.dd(1,"Engraving "),m.fc())}function kn(e,t){1&e&&(m.gc(0,"span"),m.dd(1,"Engraving "),m.fc())}function wn(e,t){1&e&&(m.gc(0,"span"),m.dd(1,"Stone Setting "),m.fc())}function Tn(e,t){if(1&e&&(m.ec(0),m.gc(1,"tr",12),m.gc(2,"td",13),m.dd(3),m.wc(4,"simpleDate"),m.fc(),m.gc(5,"td"),m.dd(6),m.fc(),m.gc(7,"td"),m.gc(8,"a",14),m.dd(9),m.fc(),m.fc(),m.gc(10,"td"),m.dd(11),m.wc(12,"titlecase"),m.fc(),m.gc(13,"td"),m.dd(14),m.wc(15,"simpleDate"),m.fc(),m.gc(16,"td"),m.bd(17,Mn,2,0,"span",8),m.bd(18,Sn,2,0,"span",8),m.bd(19,kn,2,0,"span",8),m.bd(20,wn,2,0,"span",8),m.fc(),m.gc(21,"td"),m.dd(22),m.fc(),m.gc(23,"td"),m.dd(24),m.fc(),m.fc(),m.dc()),2&e){var n=t.$implicit;m.Mb(3),m.ed(m.xc(4,12,n.node.createdAt)),m.Mb(3),m.ed(n.node.code),m.Mb(2),m.Cc("href","mailto:"+n.node.senderEmail,m.Sc),m.Mb(1),m.ed(n.node.senderEmail),m.Mb(2),m.ed(m.xc(12,14,n.node.castingType.name)),m.Mb(3),m.ed(m.xc(15,16,n.node.expiresAt)),m.Mb(3),m.Cc("ngIf",n.node.chain),m.Mb(1),m.Cc("ngIf",n.node.plating),m.Mb(1),m.Cc("ngIf",n.node.engraving),m.Mb(1),m.Cc("ngIf",n.node.stoneSetting),m.Mb(2),m.ed(n.node.redeemed?"Yes":"No"),m.Mb(2),m.ed(n.node.uuid)}}function xn(e,t){if(1&e&&(m.gc(0,"tbody"),m.bd(1,Tn,25,18,"ng-container",11),m.fc()),2&e){var n=m.vc();m.Mb(1),m.Cc("ngForOf",n.data.vouchers)}}function Pn(e,t){1&e&&(m.gc(0,"div",15),m.bc(1,"loading-ring",16),m.fc()),2&e&&(m.Mb(1),m.Cc("size",60))}var In=[{path:"generate",component:Ne},{path:"list-castings",component:ot},{path:"submissions",component:Ot},{path:"list",component:Ut},{path:"view/:id",component:Cn},{path:"vouchers",component:function(e){function t(t){var n=e.call(this)||this;return n.castingCodeService=t,n.data={vouchers:[]},n}return yn(t,e),t.prototype.ngOnInit=function(){return e=this,void 0,n=function(){return function(e,t){var n,c,i,o,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,c&&(i=2&o[0]?c.return:o[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,o[1])).done)return i;switch(c=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return d.label++,{value:o[1],done:!1};case 5:d.label++,c=o[1],o=[0];continue;case 7:o=d.ops.pop(),d.trys.pop();continue;default:if(!((i=(i=d.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){d=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){d.label=o[1];break}if(6===o[0]&&d.label<i[1]){d.label=i[1],i=o;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(o);break}i[2]&&d.ops.pop(),d.trys.pop();continue}o=t.call(e,d)}catch(r){o=[6,r],c=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}(this,(function(e){return this.updateTable(null),[2]}))},new((t=void 0)||(t=Promise))((function(c,i){function o(e){try{r(n.next(e))}catch(t){i(t)}}function d(e){try{r(n.throw(e))}catch(t){i(t)}}function r(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,d)}r((n=n.apply(e,[])).next())}));var e,t,n},t.prototype.updateTable=function(e){var t=this;this.castingCodeService.listVouchers(e).subscribe((function(e){t.data.vouchers=e.data.castingCodes.edges,t.handlePagination(e.data.castingCodes),t.state.loading=!1}))},t.\u0275fac=function(e){return new(e||t)(m.ac(x.a))},t.\u0275cmp=m.Ub({type:t,selectors:[["ng-component"]],features:[m.Jb],decls:28,vars:3,consts:[["subtitle","All Vouchers","title","All Vouchers"],["novalidate",""],["voucherForm","ngForm"],[1,"card","mt-5"],[1,"card-body"],[1,"table-responsive"],[1,"data-table"],[1,"search-head-top"],[4,"ngIf"],["class","text-center",4,"ngIf"],[3,"state","nextPage","previousPage"],[4,"ngFor","ngForOf"],[1,"nowrap"],[1,"color-muted"],[3,"href"],[1,"text-center"],[3,"size"]],template:function(e,t){1&e&&(m.bc(0,"page-title",0),m.gc(1,"form",1,2),m.gc(3,"div",3),m.gc(4,"div",4),m.gc(5,"div",5),m.gc(6,"table",6),m.gc(7,"thead"),m.gc(8,"tr",7),m.gc(9,"th"),m.dd(10,"Created"),m.fc(),m.gc(11,"th"),m.dd(12,"Code"),m.fc(),m.gc(13,"th"),m.dd(14,"Email"),m.fc(),m.gc(15,"th"),m.dd(16,"Type"),m.fc(),m.gc(17,"th"),m.dd(18,"Expires"),m.fc(),m.gc(19,"th"),m.dd(20,"Extras"),m.fc(),m.gc(21,"th"),m.dd(22,"Redeemed"),m.fc(),m.gc(23,"th"),m.dd(24,"UUID"),m.fc(),m.fc(),m.fc(),m.bd(25,xn,2,1,"tbody",8),m.fc(),m.bd(26,Pn,2,1,"div",9),m.fc(),m.gc(27,"table-controls",10),m.rc("nextPage",(function(){return t.nextPage()}))("previousPage",(function(){return t.previousPage()})),m.fc(),m.fc(),m.fc(),m.fc()),2&e&&(m.Mb(25),m.Cc("ngIf",!t.state.loading),m.Mb(1),m.Cc("ngIf",t.state.loading),m.Mb(1),m.Cc("state",t.state))},directives:[$.a,B.z,B.l,B.m,s.u,$e.a,s.t,W.a],pipes:[Be.a,s.G],styles:[""]}),t}(je.a)}],On=function(){function e(){}return e.\u0275mod=m.Yb({type:e}),e.\u0275inj=m.Xb({factory:function(t){return new(t||e)},imports:[[g.f.forChild(In)],g.f]}),e}(),Kn=function(){function e(){}return e.\u0275mod=m.Yb({type:e}),e.\u0275inj=m.Xb({factory:function(t){return new(t||e)},providers:[{provide:U.a,useValue:"gb"}],imports:[[N,s.c,B.f,On,U.f,U.j,l.a,lt.g]]}),e}()}}]);